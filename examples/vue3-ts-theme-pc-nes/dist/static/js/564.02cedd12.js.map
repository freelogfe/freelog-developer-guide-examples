{"version":3,"file":"static/js/564.02cedd12.js","mappings":"oNAGA,MAAMA,EAAa,CAAEC,MAAO,kCACtBC,GAA0BC,EAAAA,EAAAA,GAAoB,MAAO,CAAEC,GAAI,gBAAkB,MAAO,GACpFC,EAAa,CACjBH,GAOF,OAA4BI,EAAAA,EAAAA,IAAiB,CAC3CC,OAAQ,WACRC,MAAO,CACLJ,GAAI,CAAC,GAEPK,MAAMC,GAER,MAAMF,EAAQE,EAId,IAAIC,EAAqB,KACzB,MAAMC,GAAUC,EAAAA,EAAAA,IAAI,IACdC,GAAWD,EAAAA,EAAAA,IAAI,KACrBE,EAAAA,EAAAA,KACE,IAAMP,EAAMJ,KACXY,IACMA,GACLC,EAAAA,WAAWC,eAAeF,GAAKG,MAAKC,UAC9BC,EAAIC,KAAKC,QACXC,EAAAA,GAAQC,MAAMJ,EAAIC,KAAKI,MAGzBd,EAAQe,YAAcV,EAAAA,WAAWW,qBAC/BP,EAAIC,KAAKA,KAAKO,UACd,CACEC,WAAW,IAGfhB,EAASa,MAAQN,EAAIC,KAAKA,KAAKS,YAC1BpB,EAILA,EAAcqB,SAASC,UAAUrB,EAAQe,MAAOb,EAASa,OAHvDO,EAAmBtB,EAAQe,MAAOb,EAASa,OAGkB,GAC/D,GAEJ,CAAEQ,WAAW,KAIfC,EAAAA,EAAAA,KAAYhB,gBACJT,GAAe0B,UAAS,IAEhC,MAAMH,EAAqBd,MAAOkB,EAAaC,KAsB7C,MAAMC,QAAgBvB,EAAAA,WAAWwB,YACjCC,QAAQC,IAAIH,GACZA,EAAQI,OAAOC,MAAKzB,MAAO0B,EAASC,KAElC,GAAc,IAAVA,EAAa,OAAO,EACxBpC,QAAsBM,EAAAA,WAAW+B,YAC/B,CACEC,OAAQH,EACRI,UAAWC,SAASC,eAAe,gBACnCC,eAAgBb,EAChBc,OAAQ,CACNC,eAAgBjB,EAChBkB,gBAAiBjB,GAEnBkB,IAAK,MAGR,GACD,EAGJ,MAAO,CAACC,EAAUC,MACRC,EAAAA,EAAAA,OAAcC,EAAAA,EAAAA,IAAoB,MAAO7D,EAAYK,GAE/D,ICpGA,MAAMyD,EAAc,EAEpB,O","sources":["webpack://vue3-ts-theme-/./src/views/HomeView.vue?de46","webpack://vue3-ts-theme-/./src/views/HomeView.vue"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"w-100x h-100x p-20 flex-column\" }\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"div\", { id: \"freelog-game\" }, null, -1)\nconst _hoisted_3 = [\n  _hoisted_2\n]\n\nimport { freelogApp } from \"freelog-runtime\";\nimport { ref, onUnmounted, watch } from \"vue\";\nimport { message } from \"ant-design-vue\";\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'HomeView',\n  props: {\n    id: {}\n  },\n  setup(__props: any) {\n\nconst props = __props;\n\n\n\nlet exhibitWidget: any = null;\nconst gameUrl = ref(\"\");\nconst gameName = ref(\"\");\nwatch(\n  () => props.id,\n  (val: any) => {\n    if (!val) return;\n    freelogApp.getExhibitInfo(val).then(async (res: any) => {\n      if (res.data.errCode) {\n        message.error(res.data.msg);\n        return;\n      }\n      gameUrl.value = await freelogApp.getExhibitFileStream(\n        res.data.data.exhibitId,\n        {\n          returnUrl: true,\n        }\n      );\n      gameName.value = res.data.data.exhibitName;\n      if (!exhibitWidget) {\n        mountExhibitWidget(gameUrl.value, gameName.value);\n        return;\n      }\n      exhibitWidget.getApi().startGame(gameUrl.value, gameName.value);\n    });\n  },\n  { immediate: true }\n);\n\n// 离开记得卸载插件喔\nonUnmounted(async () => {\n  await exhibitWidget?.unmount();\n});\nconst mountExhibitWidget = async (url: string, name: string) => {\n  // const res = await freelogApp.getExhibitListByPaging({\n  //   articleResourceTypes: \"插件\",\n  //   isLoadVersionProperty: 1,\n  // });\n  // const widgets = res.data.data.dataList;\n  // widgets.forEach(async (widget: any, index: number) => {\n  //   if (widget.exhibitName === \"红白机插件\") {\n  //     // widget.exhibitId = widget.exhibitId + '111'\n  //     exhibitWidget = await freelogApp.mountWidget({\n  //       widget: widget, // 必传，子插件数据\n  //       container: document.getElementById(\"freelog-game\"), // 必传，自定义一个让插件挂载的div容器\n  //       topExhibitData: null, // 必传，最外层展品数据（子孙插件都需要用）\n  //       config: {\n  //         defaultGameUrl: url,\n  //         defaultGameName: name,\n  //       }, // 传递给子插件配置数据，会合并到作品上的配置数据\n  //       seq: null, // 如果要用多个同样的子插件需要传递序号，可以考虑与其余节点插件避免相同的序号, 注意用户数据是根据插件id+序号保存的。\n  //       // widget_entry: \"https://localhost:8002\", // 本地url，dev模式下，可以使用本地url调试子插件\n  //     });\n  //   }\n  // });\n  const subData = await freelogApp.getSubDep();\n  console.log(subData)\n  subData.subDep.some(async (sub:any, index:number) => {\n\n    if (index === 1) return true;\n    exhibitWidget = await freelogApp.mountWidget(\n      {\n        widget: sub, // 必传，子插件数据\n        container: document.getElementById(\"freelog-game\"), // 必传，自定义一个让插件挂载的div容器\n        topExhibitData: subData, // 必传，最外层展品数据（子孙插件都需要用）\n        config: {\n          defaultGameUrl: url,\n          defaultGameName: name,\n        }, // 传递给子插件配置数据，会合并到作品上的配置数据\n        seq: null, // 如果要用多个同样的子插件需要传递序号，可以考虑与其余节点插件避免相同的序号, 注意用户数据是根据插件id+序号保存的。\n        // widget_entry: \"https://localhost:8002\", // 本地url，dev模式下，可以使用本地url调试子插件\n      }\n    );\n  });\n};\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, _hoisted_3))\n}\n}\n\n})","import script from \"./HomeView.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./HomeView.vue?vue&type=script&lang=ts&setup=true\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_createElementVNode","id","_hoisted_3","_defineComponent","__name","props","setup","__props","exhibitWidget","gameUrl","ref","gameName","watch","val","freelogApp","getExhibitInfo","then","async","res","data","errCode","message","error","msg","value","getExhibitFileStream","exhibitId","returnUrl","exhibitName","getApi","startGame","mountExhibitWidget","immediate","onUnmounted","unmount","url","name","subData","getSubDep","console","log","subDep","some","sub","index","mountWidget","widget","container","document","getElementById","topExhibitData","config","defaultGameUrl","defaultGameName","seq","_ctx","_cache","_openBlock","_createElementBlock","__exports__"],"sourceRoot":""}