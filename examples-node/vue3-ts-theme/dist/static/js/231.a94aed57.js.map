{"version":3,"file":"static/js/231.a94aed57.js","mappings":"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","sources":["webpack://vue3-ts-theme-/./src/views/auth/AuthProcess.vue?8c74","webpack://vue3-ts-theme-/./src/views/auth/AuthProcess.vue","webpack://vue3-ts-theme-/./src/views/auth/AuthProcess.vue?0d50"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, normalizeClass as _normalizeClass, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"p-40 w-100x h-100x y-auto\" }\nconst _hoisted_2 = { class: \"\" }\nconst _hoisted_3 = { class: \"h-80 over-h cur-pointer\" }\nconst _hoisted_4 = [\"src\"]\nconst _hoisted_5 = { class: \"w-100x flex-column-center h-400 over-h mt-40\" }\nconst _hoisted_6 = {\n  key: 0,\n  class: \"f-title-3\"\n}\nconst _hoisted_7 = [\"src\"]\n\nimport {\r\n  freelogApp,\r\n  GetExhibitListByPagingResult,\r\n  GetExhibitAuthStatusResult,\r\n  ExhibitInfo,\r\n  AuthResult,\r\n  AddAuthResult,\r\n} from \"freelog-runtime\";\r\nimport { ref } from \"vue\";\r\ntype DataType = ExhibitInfo & { auth: AuthResult };\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'AuthProcess',\n  setup(__props) {\n\r\nconst data = ref([] as DataType[]);\r\nconst imgUrl = ref(\"\");\r\n// 获取展品列表\r\nfreelogApp\r\n  .getExhibitListByPaging({\r\n    skip: 0,\r\n    limit: 20,\r\n    articleResourceTypes: \"图片\",\r\n  })\r\n  .then((res: GetExhibitListByPagingResult) => {\r\n    let arr = [] as string[];\r\n\r\n    res.data.data.dataList.forEach((element: ExhibitInfo) => {\r\n      arr.push(element.exhibitId);\r\n    });\r\n    // 查询是否拥有授权\r\n    freelogApp\r\n      .getExhibitAuthStatus(arr.join(\",\"))\r\n      .then((auth: GetExhibitAuthStatusResult) => {\r\n        data.value = res.data.data.dataList.map((item: ExhibitInfo) => {\r\n          let authData: AuthResult = {} as AuthResult;\r\n          auth.data.data.some((au: AuthResult) => {\r\n            if (au.exhibitId === item.exhibitId) {\r\n              authData = au;\r\n              return true;\r\n            }\r\n            return false;\r\n          });\r\n          return { auth: authData, ...item };\r\n        });\r\n      });\r\n  });\r\nconst show = async (data: DataType) => {\r\n  if (data?.auth.isAuth) {\r\n    imgUrl.value = await freelogApp.getExhibitFileStream(data.exhibitId, {\r\n      returnUrl: true,\r\n    });\r\n  } else {\r\n    // 没有授权\r\n    freelogApp\r\n      .addAuth(\r\n        data.exhibitId\r\n        // ,{\r\n        //   immediate: true,\r\n        // }\r\n      )\r\n      .then(async (result: AddAuthResult) => {\r\n        if (result.status === freelogApp.resultType.SUCCESS) {\r\n          imgUrl.value = await freelogApp.getExhibitFileStream(data.exhibitId, {\r\n            returnUrl: true,\r\n          });\r\n        }\r\n      });\r\n    freelogApp.callAuth();\r\n  }\r\n};\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_a_card = _resolveComponent(\"a-card\")!\n  const _component_a_list_item = _resolveComponent(\"a-list-item\")!\n  const _component_a_list = _resolveComponent(\"a-list\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createVNode(_component_a_list, {\n        grid: { gutter: 16, column: 4 },\n        \"data-source\": data.value\n      }, {\n        renderItem: _withCtx(({ item }) => [\n          _createVNode(_component_a_list_item, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_card, {\n                title: item.exhibitName,\n                onClick: ($event: any) => (show(item)),\n                class: _normalizeClass(item.auth.isAuth ? '' : ' not-auth')\n              }, {\n                default: _withCtx(() => [\n                  _createElementVNode(\"div\", _hoisted_3, [\n                    _createElementVNode(\"img\", {\n                      class: \"h-100x\",\n                      src: item.coverImages[0],\n                      alt: \"\"\n                    }, null, 8, _hoisted_4)\n                  ])\n                ]),\n                _: 2\n              }, 1032, [\"title\", \"onClick\", \"class\"])\n            ]),\n            _: 2\n          }, 1024)\n        ]),\n        _: 1\n      }, 8, [\"data-source\"])\n    ]),\n    _createElementVNode(\"div\", _hoisted_5, [\n      (!imgUrl.value)\n        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_6, \"点击上面图片可在这展示\"))\n        : (_openBlock(), _createElementBlock(\"img\", {\n            key: 1,\n            src: imgUrl.value,\n            alt: \"\",\n            class: \"h-100x\"\n          }, null, 8, _hoisted_7))\n    ])\n  ]))\n}\n}\n\n})","<template>\r\n  <div class=\"p-40 w-100x h-100x y-auto\">\r\n    <div class=\"\">\r\n      <a-list :grid=\"{ gutter: 16, column: 4 }\" :data-source=\"data\">\r\n        <template #renderItem=\"{ item }\">\r\n          <a-list-item>\r\n            <a-card\r\n              :title=\"item.exhibitName\"\r\n              @click=\"show(item)\"\r\n              :class=\"item.auth.isAuth ? '' : ' not-auth'\"\r\n            >\r\n              <div class=\"h-80 over-h cur-pointer\">\r\n                <img class=\"h-100x\" :src=\"item.coverImages[0]\" alt=\"\" />\r\n              </div>\r\n            </a-card>\r\n          </a-list-item>\r\n        </template>\r\n      </a-list>\r\n    </div>\r\n    <div class=\"w-100x flex-column-center h-400 over-h mt-40\">\r\n      <span v-if=\"!imgUrl\" class=\"f-title-3\">点击上面图片可在这展示</span>\r\n      <img :src=\"imgUrl\" alt=\"\" v-else class=\"h-100x\" />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport {\r\n  freelogApp,\r\n  GetExhibitListByPagingResult,\r\n  GetExhibitAuthStatusResult,\r\n  ExhibitInfo,\r\n  AuthResult,\r\n  AddAuthResult,\r\n} from \"freelog-runtime\";\r\nimport { ref } from \"vue\";\r\ntype DataType = ExhibitInfo & { auth: AuthResult };\r\nconst data = ref([] as DataType[]);\r\nconst imgUrl = ref(\"\");\r\n// 获取展品列表\r\nfreelogApp\r\n  .getExhibitListByPaging({\r\n    skip: 0,\r\n    limit: 20,\r\n    articleResourceTypes: \"图片\",\r\n  })\r\n  .then((res: GetExhibitListByPagingResult) => {\r\n    let arr = [] as string[];\r\n\r\n    res.data.data.dataList.forEach((element: ExhibitInfo) => {\r\n      arr.push(element.exhibitId);\r\n    });\r\n    // 查询是否拥有授权\r\n    freelogApp\r\n      .getExhibitAuthStatus(arr.join(\",\"))\r\n      .then((auth: GetExhibitAuthStatusResult) => {\r\n        data.value = res.data.data.dataList.map((item: ExhibitInfo) => {\r\n          let authData: AuthResult = {} as AuthResult;\r\n          auth.data.data.some((au: AuthResult) => {\r\n            if (au.exhibitId === item.exhibitId) {\r\n              authData = au;\r\n              return true;\r\n            }\r\n            return false;\r\n          });\r\n          return { auth: authData, ...item };\r\n        });\r\n      });\r\n  });\r\nconst show = async (data: DataType) => {\r\n  if (data?.auth.isAuth) {\r\n    imgUrl.value = await freelogApp.getExhibitFileStream(data.exhibitId, {\r\n      returnUrl: true,\r\n    });\r\n  } else {\r\n    // 没有授权\r\n    freelogApp\r\n      .addAuth(\r\n        data.exhibitId\r\n        // ,{\r\n        //   immediate: true,\r\n        // }\r\n      )\r\n      .then(async (result: AddAuthResult) => {\r\n        if (result.status === freelogApp.resultType.SUCCESS) {\r\n          imgUrl.value = await freelogApp.getExhibitFileStream(data.exhibitId, {\r\n            returnUrl: true,\r\n          });\r\n        }\r\n      });\r\n    freelogApp.callAuth();\r\n  }\r\n};\r\n</script>\r\n<style>\r\n.not-auth {\r\n  /* background-color: lightblue; */\r\n}\r\n</style>\r\n","import script from \"./AuthProcess.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./AuthProcess.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./AuthProcess.vue?vue&type=style&index=0&id=66db39fd&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","key","_hoisted_7","_defineComponent","__name","setup","__props","data","ref","imgUrl","freelogApp","getExhibitListByPaging","skip","limit","articleResourceTypes","then","res","arr","dataList","forEach","element","push","exhibitId","getExhibitAuthStatus","join","auth","value","map","item","authData","some","au","show","async","isAuth","getExhibitFileStream","returnUrl","addAuth","result","status","resultType","SUCCESS","callAuth","_ctx","_cache","_component_a_card","_resolveComponent","_component_a_list_item","_component_a_list","_openBlock","_createElementBlock","_createElementVNode","_createVNode","grid","gutter","column","renderItem","_withCtx","default","title","exhibitName","onClick","$event","_normalizeClass","src","coverImages","alt","_","__exports__"],"sourceRoot":""}