class EJS_COMPRESSION{constructor(e){this.EJS=e}isCompressed(e){return 80===e[0]&&75===e[1]&&(3===e[2]&&4===e[3]||5===e[2]&&6===e[3]||7===e[2]&&8===e[3])?"zip":55===e[0]&&122===e[1]&&188===e[2]&&175===e[3]&&39===e[4]&&28===e[5]?"7z":82===e[0]&&97===e[1]&&114===e[2]&&33===e[3]&&26===e[4]&&7===e[5]&&(0===e[6]||1===e[6]&&0==e[7])?"rar":null}decompress(e,t,i){const n=this.isCompressed(e.slice(0,10));return null===n?("function"==typeof i&&i("!!notCompressedData",e),new Promise((t=>t({"!!notCompressedData":e})))):this.decompressFile(n,e,t,i)}getWorkerFile(e){return new Promise((async(t,i)=>{let n,o;"7z"===e?(n="compression/extract7z.js",o="sevenZip"):"zip"===e?(n="compression/extractzip.js",o="zip"):"rar"===e&&(n="compression/libunrar.js",o="rar");const r=await this.EJS.downloadFile(n,null,!1,{responseType:"text",method:"GET"});if(-1!==r)if("rar"===e){const e=await this.EJS.downloadFile("compression/libunrar.wasm",null,!1,{responseType:"arraybuffer",method:"GET"});if(-1===e)return void this.EJS.startGameError(this.EJS.localization("Network Error"));let i='\n                    let dataToPass = [];\n                    Module = {\n                        monitorRunDependencies: function(left) {\n                            if (left == 0) {\n                                setTimeout(function() {\n                                    unrar(dataToPass, null);\n                                }, 100);\n                            }\n                        },\n                        onRuntimeInitialized: function() {},\n                        locateFile: function(file) {\n                            console.log("locateFile");\n                            return "'+URL.createObjectURL(new Blob([e.data],{type:"application/wasm"}))+'";\n                        }\n                    };\n                    '+r.data+'\n                    let unrar = function(data, password) {\n                        let cb = function(fileName, fileSize, progress) {\n                            postMessage({ "t": 4, "current": progress, "total": fileSize, "name": fileName });\n                        };\n                        let rarContent = readRARContent(data.map(function(d) {\n                            return {\n                                name: d.name,\n                                content: new Uint8Array(d.content)\n                            }\n                        }), password, cb)\n                        let rec = function(entry) {\n                            if (!entry) return;\n                            if (entry.type === "file") {\n                                postMessage({ "t": 2, "file": entry.fullFileName, "size": entry.fileSize, "data": entry.fileContent });\n                            } else if (entry.type === "dir") {\n                                Object.keys(entry.ls).forEach(function(k) {\n                                    rec(entry.ls[k]);\n                                });\n                            } else {\n                                throw "Unknown type";\n                            }\n                        }\n                        rec(rarContent);\n                        postMessage({ "t": 1 });\n                        return rarContent;\n                    };\n                    onmessage = function(data) {\n                        dataToPass.push({ name: "test.rar", content: data.data });\n                    };\n                ';t(new Blob([i],{type:"application/javascript"}))}else{t(new Blob([r.data],{type:"application/javascript"}))}else this.EJS.startGameError(this.EJS.localization("Network Error"))}))}decompressFile(e,t,i,n){return new Promise((async o=>{const r=await this.getWorkerFile(e),s=new Worker(URL.createObjectURL(r)),a={};s.onmessage=e=>{if(e.data){if(4===e.data.t){const t=e.data,n=Math.floor(t.current/t.total*100);if(isNaN(n))return;const o=" "+n.toString()+"%";i(o,!0)}2===e.data.t&&("function"==typeof n?(n(e.data.file,e.data.data),a[e.data.file]=!0):a[e.data.file]=e.data.data),1===e.data.t&&o(a)}},s.postMessage(t)}))}}window.EJS_COMPRESSION=EJS_COMPRESSION;class EmulatorJS{getCores(){let e={atari5200:["a5200"],vb:["beetle_vb"],nds:["melonds","desmume","desmume2015"],arcade:["fbneo","fbalpha2012_cps1","fbalpha2012_cps2"],nes:["fceumm","nestopia"],gb:["gambatte"],coleco:["gearcoleco"],segaMS:["smsplus","genesis_plus_gx","picodrive"],segaMD:["genesis_plus_gx","picodrive"],segaGG:["genesis_plus_gx"],segaCD:["genesis_plus_gx","picodrive"],sega32x:["picodrive"],sega:["genesis_plus_gx","picodrive"],lynx:["handy"],mame:["mame2003_plus","mame2003"],ngp:["mednafen_ngp"],pce:["mednafen_pce"],pcfx:["mednafen_pcfx"],psx:["pcsx_rearmed","mednafen_psx_hw"],ws:["mednafen_wswan"],gba:["mgba"],n64:["mupen64plus_next","parallel_n64"],"3do":["opera"],psp:["ppsspp"],atari7800:["prosystem"],snes:["snes9x"],atari2600:["stella2014"],jaguar:["virtualjaguar"],segaSaturn:["yabause"],amiga:["puae"],c64:["vice_x64sc"],c128:["vice_x128"],pet:["vice_xpet"],plus4:["vice_xplus4"],vic20:["vice_xvic"],dos:["dosbox_pure"]};return this.isSafari&&this.isMobile&&(e.n64=e.n64.reverse()),e}requiresThreads(e){return["ppsspp","dosbox_pure"].includes(e)}requiresWebGL2(e){return["ppsspp"].includes(e)}getCore(e){const t=this.getCores(),i=this.config.system;if(e){for(const e in t)if(t[e].includes(i))return e;return i}const n=this.getCore(!0);return t[n]&&t[n].includes(this.preGetSetting("retroarch_core"))?this.preGetSetting("retroarch_core"):t[i]?t[i][0]:i}createElement(e){return document.createElement(e)}addEventListener(e,t,i){const n=t.split(" ");let o=[];for(let t=0;t<n.length;t++){e.addEventListener(n[t],i);const r={cb:i,elem:e,listener:n[t]};o.push(r)}return o}removeEventListener(e){for(let t=0;t<e.length;t++)e[t].elem.removeEventListener(e[t].listener,e[t].cb)}downloadFile(e,t,i,n){return new Promise((async o=>{const r=this.toData(e);if(r)return void r.then((e=>{"HEAD"===n.method?o({headers:{}}):o({headers:{},data:e})}));const s=i?"":this.config.dataPath;let a;e=s+e,!i&&this.config.filePaths&&"string"==typeof this.config.filePaths[e.split("/").pop()]&&(e=this.config.filePaths[e.split("/").pop()]);try{a=new URL(e)}catch(e){}if(a&&!["http:","https:"].includes(a.protocol)){if("HEAD"===n.method)return void o({headers:{}});try{let t=await fetch(e);if(n.type&&"arraybuffer"===n.type.toLowerCase()||!n.type)t=await t.arrayBuffer();else{t=await t.text();try{t=JSON.parse(t)}catch(e){}}e.startsWith("blob:")&&URL.revokeObjectURL(e),o({data:t,headers:{}})}catch(e){o(-1)}return}const l=new XMLHttpRequest;t instanceof Function&&l.addEventListener("progress",(e=>{const i=e.total?" "+Math.floor(e.loaded/e.total*100).toString()+"%":" "+(e.loaded/1048576).toFixed(2)+"MB";t(i)})),l.onload=function(){if(l.readyState===l.DONE){let e=l.response;if(l.status.toString().startsWith("4")||l.status.toString().startsWith("5"))return void o(-1);try{e=JSON.parse(e)}catch(e){}o({data:e,headers:{"content-length":l.getResponseHeader("content-length")}})}},n.responseType&&(l.responseType=n.responseType),l.onerror=()=>o(-1),l.open(n.method,e,!0),l.send()}))}toData(e,t){return e instanceof ArrayBuffer||e instanceof Uint8Array||e instanceof Blob?!!t||new Promise((async t=>{e instanceof ArrayBuffer?t(new Uint8Array(e)):e instanceof Uint8Array?t(e):e instanceof Blob&&t(new Uint8Array(await e.arrayBuffer())),t()})):null}checkForUpdates(){this.ejs_version.endsWith("-beta")?console.warn("Using EmulatorJS beta. Not checking for updates. This instance may be out of date. Using stable is highly recommended unless you build and ship your own cores."):fetch("https://cdn.emulatorjs.org/stable/data/version.json").then((e=>{e.ok&&e.text().then((e=>{let t=JSON.parse(e);this.versionAsInt(this.ejs_version)<this.versionAsInt(t.version)&&console.log(`Using EmulatorJS version ${this.ejs_version} but the newest version is ${t.current_version}\nopen https://github.com/EmulatorJS/EmulatorJS to update`)}))}))}versionAsInt(e){if(e.endsWith("-beta"))return 99999999;let t=e.split(".");return 1===t[t.length-1].length&&(t[t.length-1]="0"+t[t.length-1]),parseInt(t.join(""))}constructor(e,t){if(this.ejs_version="4.2.3",this.extensions=[],this.initControlVars(),this.debug=!0===window.EJS_DEBUG_XX,(this.debug||window.location&&["localhost","127.0.0.1"].includes(location.hostname))&&this.checkForUpdates(),this.netplayEnabled=!0===window.EJS_DEBUG_XX&&!0===window.EJS_EXPERIMENTAL_NETPLAY,this.config=t,this.config.buttonOpts=this.buildButtonOptions(this.config.buttonOpts),this.config.settingsLanguage=window.EJS_settingsLanguage||!1,this.currentPopup=null,this.isFastForward=!1,this.isSlowMotion=!1,this.failedToStart=!1,this.rewindEnabled="enabled"===this.preGetSetting("rewindEnabled"),this.touch=!1,this.cheats=[],this.started=!1,this.volume="number"==typeof this.config.volume?this.config.volume:.5,this.config.defaultControllers&&(this.defaultControllers=this.config.defaultControllers),this.muted=!1,this.paused=!0,this.missingLang=[],this.setElements(e),this.setColor(this.config.color||""),this.config.alignStartButton="string"==typeof this.config.alignStartButton?this.config.alignStartButton:"bottom",this.config.backgroundColor="string"==typeof this.config.backgroundColor?this.config.backgroundColor:"rgb(51, 51, 51)",this.config.adUrl&&(this.config.adSize=Array.isArray(this.config.adSize)?this.config.adSize:["300px","250px"],this.setupAds(this.config.adUrl,this.config.adSize[0],this.config.adSize[1])),this.isMobile=function(){let e=!1;var t;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e}(),this.hasTouchScreen=function(){if(window.PointerEvent&&"maxTouchPoints"in navigator){if(navigator.maxTouchPoints>0)return!0}else{if(window.matchMedia&&window.matchMedia("(any-pointer:coarse)").matches)return!0;if(window.TouchEvent||"ontouchstart"in window)return!0}return!1}(),this.canvas=this.createElement("canvas"),this.canvas.classList.add("ejs_canvas"),this.videoRotation=[0,1,2,3].includes(this.config.videoRotation)?this.config.videoRotation:this.preGetSetting("videoRotation")||0,this.videoRotationChanged=!1,this.capture=this.capture||{},this.capture.photo=this.capture.photo||{},this.capture.photo.source=["canvas","retroarch"].includes(this.capture.photo.source)?this.capture.photo.source:"canvas",this.capture.photo.format="string"==typeof this.capture.photo.format?this.capture.photo.format:"png",this.capture.photo.upscale="number"==typeof this.capture.photo.upscale?this.capture.photo.upscale:1,this.capture.video=this.capture.video||{},this.capture.video.format="string"==typeof this.capture.video.format?this.capture.video.format:"detect",this.capture.video.upscale="number"==typeof this.capture.video.upscale?this.capture.video.upscale:1,this.capture.video.fps="number"==typeof this.capture.video.fps?this.capture.video.fps:30,this.capture.video.videoBitrate="number"==typeof this.capture.video.videoBitrate?this.capture.video.videoBitrate:2621440,this.capture.video.audioBitrate="number"==typeof this.capture.video.audioBitrate?this.capture.video.audioBitrate:196608,this.bindListeners(),this.config.netplayUrl=this.config.netplayUrl||"https://netplay.emulatorjs.org",this.fullscreen=!1,this.enableMouseLock=!1,this.supportsWebgl2=!!document.createElement("canvas").getContext("webgl2")&&!0!==this.config.forceLegacyCores,this.webgl2Enabled=(()=>{let e=this.preGetSetting("webgl2Enabled");return!("disabled"===e||!this.supportsWebgl2)&&("enabled"===e||null)})(),this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.config.disableDatabases?this.storage={rom:new window.EJS_DUMMYSTORAGE,bios:new window.EJS_DUMMYSTORAGE,core:new window.EJS_DUMMYSTORAGE}:this.storage={rom:new window.EJS_STORAGE("EmulatorJS-roms","rom"),bios:new window.EJS_STORAGE("EmulatorJS-bios","bios"),core:new window.EJS_STORAGE("EmulatorJS-core","core")},this.storage.states=new window.EJS_STORAGE("EmulatorJS-states","states"),this.game.classList.add("ejs_game"),"string"==typeof this.config.backgroundImg?(this.game.classList.add("ejs_game_background"),this.config.backgroundBlur&&this.game.classList.add("ejs_game_background_blur"),this.game.setAttribute("style",`--ejs-background-image: url("${this.config.backgroundImg}"); --ejs-background-color: ${this.config.backgroundColor};`),this.on("start",(()=>{this.game.classList.remove("ejs_game_background"),this.config.backgroundBlur&&this.game.classList.remove("ejs_game_background_blur")}))):this.game.setAttribute("style","--ejs-background-color: "+this.config.backgroundColor+";"),Array.isArray(this.config.cheats))for(let e=0;e<this.config.cheats.length;e++){const t=this.config.cheats[e];Array.isArray(t)&&t[0]&&t[1]&&this.cheats.push({desc:t[0],checked:!1,code:t[1],is_permanent:!0})}this.createStartButton(),this.handleResize()}setColor(e){"string"!=typeof e&&(e="");let t=function(e){if((e=e.toLowerCase())&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e)){if(4===e.length){let t="#";for(let i=1;i<4;i++)t+=e.slice(i,i+1)+e.slice(i,i+1);e=t}let t=[];for(let i=1;i<7;i+=2)t.push(parseInt("0x"+e.slice(i,i+2),16));return t.join(", ")}return null};e&&null!==t(e)?this.elements.parent.setAttribute("style","--ejs-primary-color:"+t(e)+";"):this.elements.parent.setAttribute("style","--ejs-primary-color: 26,175,255;")}setupAds(e,t,i){const n=this.createElement("div");"number"==typeof this.config.adMode&&this.config.adMode>-1&&this.config.adMode<3&&this.config.adMode;n.classList.add("ejs_ad_iframe");const o=this.createElement("iframe");o.src=e,o.setAttribute("scrolling","no"),o.setAttribute("frameborder","no"),o.style.width=t,o.style.height=i;const r=this.createElement("div");r.classList.add("ejs_ad_close");const s=this.createElement("a");r.appendChild(s),r.setAttribute("hidden",""),n.appendChild(r),n.appendChild(o),1!==this.config.adMode&&this.elements.parent.appendChild(n),this.addEventListener(s,"click",(()=>{n.remove()})),this.on("start-clicked",(()=>{0===this.config.adMode&&n.remove(),1===this.config.adMode&&this.elements.parent.appendChild(n)})),this.on("start",(()=>{r.removeAttribute("hidden");const e="number"==typeof this.config.adTimer&&this.config.adTimer>0?this.config.adTimer:1e4;-1===this.config.adTimer&&n.remove(),0!==this.config.adTimer&&setTimeout((()=>{n.remove()}),e)}))}adBlocked(e,t){if(t)document.querySelector('div[class="ejs_ad_iframe"]').remove();else{try{document.querySelector('div[class="ejs_ad_iframe"]').remove()}catch(e){}this.config.adUrl=e,this.setupAds(this.config.adUrl,this.config.adSize[0],this.config.adSize[1])}}on(e,t){this.functions||(this.functions={}),Array.isArray(this.functions[e])||(this.functions[e]=[]),this.functions[e].push(t)}callEvent(e,t){return this.functions||(this.functions={}),Array.isArray(this.functions[e])?(this.functions[e].forEach((e=>e(t))),this.functions[e].length):0}setElements(e){const t=this.createElement("div"),i=document.querySelector(e);i.innerHTML="",i.appendChild(t),this.game=t,this.elements={main:this.game,parent:i},this.elements.parent.classList.add("ejs_parent"),this.elements.parent.setAttribute("tabindex",-1)}createStartButton(){const e=this.createElement("div");e.classList.add("ejs_start_button");let t=0;"string"==typeof this.config.backgroundImg&&(e.classList.add("ejs_start_button_border"),t=1),e.innerText="string"==typeof this.config.startBtnName?this.config.startBtnName:this.localization("Start Game"),"top"==this.config.alignStartButton?e.style.bottom="calc(100% - 20px)":"center"==this.config.alignStartButton&&(e.style.bottom="calc(50% + 22.5px + "+t+"px)"),this.elements.parent.appendChild(e),this.addEventListener(e,"touchstart",(()=>{this.touch=!0})),this.addEventListener(e,"click",this.startButtonClicked.bind(this)),!0===this.config.startOnLoad&&this.startButtonClicked(e),setTimeout((()=>{this.callEvent("ready")}),20)}startButtonClicked(e){this.callEvent("start-clicked"),"touch"===e.pointerType&&(this.touch=!0),e.preventDefault?(e.preventDefault(),e.target.remove()):e.remove(),this.createText(),this.downloadGameCore()}createText(){this.textElem=this.createElement("div"),this.textElem.classList.add("ejs_loading_text"),"string"==typeof this.config.backgroundImg&&this.textElem.classList.add("ejs_loading_text_glow"),this.textElem.innerText=this.localization("Loading..."),this.elements.parent.appendChild(this.textElem)}localization(e,t){if(void 0!==e&&0!==e.length)return(e=e.toString()).includes("EmulatorJS v")?e:this.config.langJson?(void 0===t&&(t=!0),!this.config.langJson[e]&&t&&(this.missingLang.includes(e)||this.missingLang.push(e),console.log(`Translation not found for '${e}'. Language set to '${this.config.language}'`)),this.config.langJson[e]||e):e}checkCompression(e,t,i){return this.compression||(this.compression=new window.EJS_COMPRESSION(this)),t&&(this.textElem.innerText=t),this.compression.decompress(e,((e,i)=>{this.textElem.innerText=i?t+e:e}),i)}checkCoreCompatibility(e){if(this.versionAsInt(e.minimumEJSVersion)>this.versionAsInt(this.ejs_version))throw this.startGameError(this.localization("Outdated EmulatorJS version")),new Error("Core requires minimum EmulatorJS version of "+e.minimumEJSVersion)}startGameError(e){console.log(e),this.textElem.innerText=e,this.textElem.classList.add("ejs_error_text"),this.setupSettingsMenu(),this.loadSettings(),this.menu.failedToStart(),this.handleResize(),this.failedToStart=!0}downloadGameCore(){if(this.textElem.innerText=this.localization("Download Game Core"),!this.config.threads&&this.requiresThreads(this.getCore()))return this.startGameError(this.localization("Error for site owner")+"\n"+this.localization("Check console")),void console.warn("This core requires threads, but EJS_threads is not set!");if(!this.supportsWebgl2&&this.requiresWebGL2(this.getCore()))return void this.startGameError(this.localization("Outdated graphics driver"));if(this.config.threads&&"function"!=typeof window.SharedArrayBuffer)return this.startGameError(this.localization("Error for site owner")+"\n"+this.localization("Check console")),void console.warn("Threads is set to true, but the SharedArrayBuffer function is not exposed. Threads requires 2 headers to be set when sending you html page. See https://stackoverflow.com/a/68630724");const e=e=>{console.log(23333,e),this.defaultCoreOpts={},this.checkCompression(new Uint8Array(e),this.localization("Decompress Game Core")).then((e=>{let t,i,n;for(let o in e)if(o.endsWith(".wasm"))n=e[o];else if(o.endsWith(".worker.js"))i=e[o];else if(o.endsWith(".js"))t=e[o];else if("build.json"===o)this.checkCoreCompatibility(JSON.parse((new TextDecoder).decode(e[o])));else if("core.json"===o){let t=JSON.parse((new TextDecoder).decode(e[o]));this.extensions=t.extensions,this.coreName=t.name,this.repository=t.repo,this.defaultCoreOpts=t.options,this.enableMouseLock=t.options.supportsMouse,this.retroarchOpts=t.retroarchOpts,this.saveFileExt=t.save}else"license.txt"===o&&(this.license=(new TextDecoder).decode(e[o]));!1===this.saveFileExt&&(this.elements.bottomBar.saveSavFiles[0].style.display="none",this.elements.bottomBar.loadSavFiles[0].style.display="none"),console.log(23333,window.EJS_Runtime),this.initGameCore(t,n,i)}))},t="cores/reports/"+this.getCore()+".json";this.downloadFile(t,null,!1,{responseType:"text",method:"GET"}).then((async t=>{(t=-1===t||"string"==typeof t||"string"==typeof t.data?{}:t.data).buildStart||(console.warn("Could not fetch core report JSON! Core caching will be disabled!"),t.buildStart=100*Math.random()),null===this.webgl2Enabled&&(this.webgl2Enabled=!!t.options&&t.options.defaultWebGL2),this.requiresWebGL2(this.getCore())&&(this.webgl2Enabled=!0);let i=!1;if("function"==typeof window.SharedArrayBuffer){const e=this.preGetSetting("ejs_threads");i=e?"enabled"===e:this.config.threads}let n=this.supportsWebgl2&&this.webgl2Enabled?"":"-legacy",o=this.getCore()+(i?"-thread":"")+n+"-wasm.data";if(!this.debug){const i=await this.storage.core.get(o);if(i&&i.version===t.buildStart)return void e(i.data)}const r="cores/"+o;let s=await this.downloadFile(r,(e=>{this.textElem.innerText=this.localization("Download Game Core")+e}),!1,{responseType:"arraybuffer",method:"GET"});if(-1===s){console.log("File not found, attemping to fetch from emulatorjs cdn."),console.error("**THIS METHOD IS A FAILSAFE, AND NOT OFFICIALLY SUPPORTED. USE AT YOUR OWN RISK**");let e=this.ejs_version.endsWith("-beta")?"nightly":this.ejs_version;if(s=await this.downloadFile(`https://cdn.emulatorjs.org/${e}/data/${r}`,(e=>{this.textElem.innerText=this.localization("Download Game Core")+e}),!0,{responseType:"arraybuffer",method:"GET"}),-1===s)return void(this.supportsWebgl2?this.startGameError(this.localization("Error downloading core")+" ("+o+")"):this.startGameError(this.localization("Outdated graphics driver")));console.warn("File was not found locally, but was found on the emulatorjs cdn.\nIt is recommended to download the stable release from here: https://cdn.emulatorjs.org/releases/")}e(s.data),this.storage.core.put(o,{version:t.buildStart,data:s.data})}))}initGameCore(e,t,i){console.log(e,t,new Blob([e]),23333);let n=e;if(e instanceof Uint8Array){const t=(new TextDecoder).decode(e).replace(/var\s+EJS_Runtime\s*=/g,"window.EJS_Runtime =");n=(new TextEncoder).encode(t)}else"string"==typeof e&&(n=e.replace(/var\s+EJS_Runtime\s*=/g,"window.EJS_Runtime ="));let o=this.createElement("script");o.src=URL.createObjectURL(new Blob([n],{type:"application/javascript"})),console.log(23333,window.EJS_Runtime,o.src),o.id="game-core-script",o.addEventListener("load",(()=>{if(console.log(23333,window,window.EJS_Runtime),"function"!=typeof window.EJS_Runtime&&window.__MICRO_APP_WINDOW__&&(window.EJS_Runtime=window.__MICRO_APP_WINDOW__.EJS_Runtime),"function"!=typeof window.EJS_Runtime&&window.__MICRO_APP_PROXY_WINDOW__){const e=window.__MICRO_APP_PROXY_WINDOW__;e.__MICRO_APP_WINDOW__&&e.__MICRO_APP_WINDOW__.EJS_Runtime&&(window.EJS_Runtime=e.__MICRO_APP_WINDOW__.EJS_Runtime)}this.initModule(t,i)})),document.body.appendChild(o)}getBaseFileName(e){if(!this.started&&!e)return null;if(e&&"game"!==this.config.gameUrl&&!this.config.gameUrl.startsWith("blob:"))return this.config.gameUrl.split("/").pop().split("#")[0].split("?")[0];if("string"==typeof this.config.gameName){const e=/[#<$+%>!`&*'|{}/\\?"=@:^\r\n]/gi,t=this.config.gameName.replace(e,"").trim();if(t)return t}if(!this.fileName)return"game";let t=this.fileName.split(".");return t.splice(t.length-1,1),t.join(".")}saveInBrowserSupported(){return!(!window.indexedDB||"string"!=typeof this.config.gameName&&this.config.gameUrl.startsWith("blob:"))}displayMessage(e,t){this.msgElem||(this.msgElem=this.createElement("div"),this.msgElem.classList.add("ejs_message"),this.elements.parent.appendChild(this.msgElem)),clearTimeout(this.msgTimeout),this.msgTimeout=setTimeout((()=>{this.msgElem.innerText=""}),"number"==typeof t&&t>0?t:3e3),this.msgElem.innerText=e}downloadStartState(){return new Promise(((e,t)=>{"string"==typeof this.config.loadState||this.toData(this.config.loadState,!0)?(this.textElem.innerText=this.localization("Download Game State"),this.downloadFile(this.config.loadState,(e=>{this.textElem.innerText=this.localization("Download Game State")+e}),!0,{responseType:"arraybuffer",method:"GET"}).then((t=>{-1!==t?(this.on("start",(()=>{setTimeout((()=>{this.gameManager.loadState(new Uint8Array(t.data))}),10)})),e()):this.startGameError(this.localization("Error downloading game state"))}))):e()}))}downloadGameFile(e,t,i,n){return new Promise((async(o,r)=>{if(!("string"==typeof e&&e.trim()||this.toData(e,!0)))return o(e);const s=async t=>{if(!0===this.config.dontExtractBIOS)return this.gameManager.FS.writeFile(e,new Uint8Array(t)),o(e);const i=await this.checkCompression(new Uint8Array(t),n);for(const t in i){const n="/"+this.fileName,o=n.substring(0,n.length-n.split("/").pop().length);if("!!notCompressedData"===t){this.gameManager.FS.writeFile(o+e.split("/").pop().split("#")[0].split("?")[0],i[t]);break}t.endsWith("/")||this.gameManager.FS.writeFile(o+t.split("/").pop(),i[t])}};if(this.textElem.innerText=i,!this.debug){const i=await this.downloadFile(e,null,!0,{method:"HEAD"}),n=await this.storage.rom.get(e.split("/").pop());if(n&&n["content-length"]===i.headers["content-length"]&&n.type===t)return await s(n.data),o(e)}const a=await this.downloadFile(e,(e=>{this.textElem.innerText=i+e}),!0,{responseType:"arraybuffer",method:"GET"});if(-1===a)return this.startGameError(this.localization("Network Error")),void o(e);e instanceof File?e=e.name:this.toData(e,!0)&&(e="game"),await s(a.data),o(e);const l="number"==typeof this.config.cacheLimit?this.config.cacheLimit:1073741824;parseFloat(a.headers["content-length"])<l&&this.saveInBrowserSupported()&&"game"!==e&&this.storage.rom.put(e.split("/").pop(),{"content-length":a.headers["content-length"],data:a.data,type:t})}))}downloadGamePatch(){return new Promise((async e=>{this.config.gamePatchUrl=await this.downloadGameFile(this.config.gamePatchUrl,"patch",this.localization("Download Game Patch"),this.localization("Decompress Game Patch")),e()}))}downloadGameParent(){return new Promise((async e=>{this.config.gameParentUrl=await this.downloadGameFile(this.config.gameParentUrl,"parent",this.localization("Download Game Parent"),this.localization("Decompress Game Parent")),e()}))}downloadBios(){return new Promise((async e=>{this.config.biosUrl=await this.downloadGameFile(this.config.biosUrl,"bios",this.localization("Download Game BIOS"),this.localization("Decompress Game BIOS")),e()}))}downloadRom(){const e=e=>{this.getCore();return!!this.extensions&&this.extensions.includes(e)};return new Promise((t=>{this.textElem.innerText=this.localization("Download Game Data");const i=i=>{if(["arcade","mame"].includes(this.getCore(!0)))return this.fileName=this.getBaseFileName(!0),this.gameManager.FS.writeFile(this.fileName,new Uint8Array(i)),void t();const n=this.getBaseFileName(!0);let o=!1;o=!(!["pcsx_rearmed","genesis_plus_gx","picodrive","mednafen_pce","smsplus","vice_x64","vice_x64sc","vice_x128","vice_xvic","vice_xplus4","vice_xpet","puae"].includes(this.getCore())||void 0!==this.config.disableCue)||this.config.disableCue;let r=[];this.checkCompression(new Uint8Array(i),this.localization("Decompress Game Data"),((e,t)=>{if(e.includes("/")){const t=e.split("/");let i="";for(let e=0;e<t.length-1;e++)""!==t[e]&&(i+=`/${t[e]}`,this.gameManager.FS.analyzePath(i).exists||this.gameManager.FS.mkdir(i))}e.endsWith("/")?this.gameManager.FS.mkdir(e):"!!notCompressedData"===e?(this.gameManager.FS.writeFile(n,t),r.push(n)):(this.gameManager.FS.writeFile(`/${e}`,t),r.push(e))})).then((()=>{let i=null,n=null,s=null,a=null;r.forEach((t=>{const o=t.split(".").pop().toLowerCase();null===n&&e(o)&&(n=t),null===i&&["iso","cso","chd","elf"].includes(o)&&(i=t),["cue","ccd","toc","m3u"].includes(o)&&("psx"===this.getCore(!0)?"m3u"!==a&&(null!==s&&"m3u"!==o||(s=t,a=o)):["cue","ccd"].includes(a)||(null===s||["cue","ccd"].includes(o))&&(s=t,a=o))})),this.fileName=null!==n?n:r[0],null!==i&&(e("iso")||e("cso")||e("chd")||e("elf"))?this.fileName=i:(e("cue")||e("ccd")||e("toc")||e("m3u"))&&(null!==s?this.fileName=s:o||(this.fileName=this.gameManager.createCueFile(r))),t()}))},n=async()=>{const e=await this.downloadFile(this.config.gameUrl,(e=>{this.textElem.innerText=this.localization("Download Game Data")+e}),!0,{responseType:"arraybuffer",method:"GET"});if(-1===e)return void this.startGameError(this.localization("Network Error"));this.config.gameUrl instanceof File?this.config.gameUrl=this.config.gameUrl.name:this.toData(this.config.gameUrl,!0)&&(this.config.gameUrl="game"),i(e.data);const t="number"==typeof this.config.cacheLimit?this.config.cacheLimit:1073741824;parseFloat(e.headers["content-length"])<t&&this.saveInBrowserSupported()&&"game"!==this.config.gameUrl&&this.storage.rom.put(this.config.gameUrl.split("/").pop(),{"content-length":e.headers["content-length"],data:e.data})};this.debug?n():this.downloadFile(this.config.gameUrl,null,!0,{method:"HEAD"}).then((async e=>{const t="string"==typeof this.config.gameUrl?this.config.gameUrl.split("/").pop():"game",o=await this.storage.rom.get(t);o&&o["content-length"]===e.headers["content-length"]&&"game"!==t?i(o.data):n()}))}))}downloadFiles(){(async()=>{this.gameManager=new window.EJS_GameManager(this.Module,this),await this.gameManager.loadExternalFiles(),await this.gameManager.mountFileSystems(),this.callEvent("saveDatabaseLoaded",this.gameManager.FS),"ppsspp"===this.getCore()&&await this.gameManager.loadPpssppAssets(),await this.downloadRom(),await this.downloadBios(),await this.downloadStartState(),await this.downloadGameParent(),await this.downloadGamePatch(),this.startGame()})()}initModule(e,t){if(console.log(23333,window.EJS_Runtime),"function"!=typeof window.EJS_Runtime)throw console.warn("EJS_Runtime is not defined!"),this.startGameError(this.localization("Error loading EmulatorJS runtime")),new Error("EJS_Runtime is not defined!");window.EJS_Runtime({noInitialRun:!0,onRuntimeInitialized:null,arguments:[],preRun:[],postRun:[],canvas:this.canvas,callbacks:{},parent:this.elements.parent,print:e=>{this.debug&&console.log(e)},printErr:e=>{this.debug&&console.log(e)},totalDependencies:0,locateFile:function(i){return this.debug&&console.log(i),i.endsWith(".wasm")?URL.createObjectURL(new Blob([e],{type:"application/wasm"})):i.endsWith(".worker.js")?URL.createObjectURL(new Blob([t],{type:"application/javascript"})):void 0},getSavExt:()=>this.saveFileExt?"."+this.saveFileExt:".srm"}).then((e=>{this.Module=e,this.downloadFiles()})).catch((e=>{console.warn(e),this.startGameError(this.localization("Failed to start game"))}))}startGame(){try{const e=[];if(this.debug&&e.push("-v"),e.push("/"+this.fileName),this.debug&&console.log(e),this.Module.callMain(e),"number"==typeof this.config.softLoad&&this.config.softLoad>0&&(this.resetTimeout=setTimeout((()=>{this.gameManager.restart()}),1e3*this.config.softLoad)),this.Module.resumeMainLoop(),this.checkSupportedOpts(),this.setupDisksMenu(),this.gameManager.getDiskCount()>1||(this.diskParent.style.display="none"),this.setupSettingsMenu(),this.loadSettings(),this.updateCheatUI(),this.updateGamepadLabels(),this.muted||this.setVolume(this.volume),!0!==this.config.noAutoFocus&&this.elements.parent.focus(),this.textElem.remove(),this.textElem=null,this.game.classList.remove("ejs_game"),this.game.classList.add("ejs_canvas_parent"),this.game.appendChild(this.canvas),this.handleResize(),this.started=!0,this.paused=!1,this.touch&&(this.virtualGamepad.style.display=""),this.handleResize(),this.config.fullscreenOnLoad)try{this.toggleFullscreen(!0)}catch(e){this.debug&&console.warn("Could not fullscreen on load")}this.menu.open(),this.isSafari&&this.isMobile&&this.checkStarted()}catch(e){return console.warn("Failed to start game",e),this.startGameError(this.localization("Failed to start game")),void this.callEvent("exit")}this.callEvent("start")}checkStarted(){(async()=>{let e,t=e=>new Promise((t=>setTimeout(t,e))),i="suspended";for(;"suspended"===i;){if(!this.Module.AL)return;if(this.Module.AL.currentCtx.sources.forEach((e=>{i=e.gain.context.state})),"suspended"!==i)break;if(!e){e=this.createPopup("",{});const t=this.createElement("button");t.innerText=this.localization("Click to resume Emulator"),t.classList.add("ejs_menu_button"),t.style.width="25%",t.style.height="25%",e.appendChild(t),e.style["text-align"]="center",e.style["font-size"]="28px"}await t(10)}e&&this.closePopup()})()}bindListeners(){this.createContextMenu(),this.createBottomMenuBar(),this.createControlSettingMenu(),this.createCheatsMenu(),this.createNetplayMenu(),this.setVirtualGamepad(),this.addEventListener(this.elements.parent,"keydown keyup",this.keyChange.bind(this)),this.addEventListener(this.elements.parent,"mousedown touchstart",(e=>{document.activeElement!==this.elements.parent&&!0!==this.config.noAutoFocus&&this.elements.parent.focus()})),this.addEventListener(window,"resize",this.handleResize.bind(this));let e=0;this.elements.statePopupPanel=this.createPopup("",{},!0),this.elements.statePopupPanel.innerText=this.localization("Drop save state here to load"),this.elements.statePopupPanel.style["text-align"]="center",this.elements.statePopupPanel.style["font-size"]="28px",this.addEventListener(window,"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",(()=>{setTimeout((()=>{this.handleResize.bind(this),!0!==this.config.noAutoFocus&&this.elements.parent.focus()}),0)})),this.addEventListener(window,"beforeunload",(e=>{this.started&&this.callEvent("exit")})),this.addEventListener(this.elements.parent,"dragenter",(t=>{t.preventDefault(),this.started&&(e++,this.elements.statePopupPanel.parentElement.style.display="block")})),this.addEventListener(this.elements.parent,"dragover",(e=>{e.preventDefault()})),this.addEventListener(this.elements.parent,"dragleave",(t=>{t.preventDefault(),this.started&&(e--,0===e&&(this.elements.statePopupPanel.parentElement.style.display="none"))})),this.addEventListener(this.elements.parent,"dragend",(t=>{t.preventDefault(),this.started&&(e=0,this.elements.statePopupPanel.parentElement.style.display="none")})),this.addEventListener(this.elements.parent,"drop",(t=>{if(t.preventDefault(),!this.started)return;this.elements.statePopupPanel.parentElement.style.display="none",e=0;const i=t.dataTransfer.items;let n;for(let e=0;e<i.length;e++)if("file"===i[e].kind){n=i[e];break}if(!n)return;n.getAsFile().arrayBuffer().then((e=>{this.gameManager.loadState(new Uint8Array(e))}))})),this.gamepad=new GamepadHandler,this.gamepad.on("connected",(e=>{if(this.gamepadLabels){for(let t=0;t<this.gamepadSelection.length;t++)if(""===this.gamepadSelection[t]){this.gamepadSelection[t]=this.gamepad.gamepads[e.gamepadIndex].id+"_"+this.gamepad.gamepads[e.gamepadIndex].index;break}this.updateGamepadLabels()}})),this.gamepad.on("disconnected",(e=>{const t=this.gamepad.gamepads.indexOf(this.gamepad.gamepads.find((t=>t.index==e.gamepadIndex))),i=this.gamepad.gamepads[t].id+"_"+this.gamepad.gamepads[t].index;for(let e=0;e<this.gamepadSelection.length;e++)this.gamepadSelection[e]===i&&(this.gamepadSelection[e]="");setTimeout(this.updateGamepadLabels.bind(this),10)})),this.gamepad.on("axischanged",this.gamepadEvent.bind(this)),this.gamepad.on("buttondown",this.gamepadEvent.bind(this)),this.gamepad.on("buttonup",this.gamepadEvent.bind(this))}checkSupportedOpts(){this.gameManager.supportsStates()||(this.elements.bottomBar.saveState[0].style.display="none",this.elements.bottomBar.loadState[0].style.display="none",this.elements.bottomBar.netplay[0].style.display="none",this.elements.contextMenu.save.style.display="none",this.elements.contextMenu.load.style.display="none"),"number"==typeof this.config.gameId&&this.config.netplayUrl&&!1!==this.netplayEnabled||(this.elements.bottomBar.netplay[0].style.display="none")}updateGamepadLabels(){for(let e=0;e<this.gamepadLabels.length;e++){this.gamepadLabels[e].innerHTML="";const t=this.createElement("option");t.setAttribute("value","notconnected"),t.innerText="Not Connected",this.gamepadLabels[e].appendChild(t);for(let t=0;t<this.gamepad.gamepads.length;t++){const i=this.createElement("option");i.setAttribute("value",this.gamepad.gamepads[t].id+"_"+this.gamepad.gamepads[t].index),i.innerText=this.gamepad.gamepads[t].id+"_"+this.gamepad.gamepads[t].index,this.gamepadLabels[e].appendChild(i)}this.gamepadLabels[e].value=this.gamepadSelection[e]||"notconnected"}}createLink(e,t,i,n){const o=this.createElement("a");if(o.href=t,o.target="_blank",o.innerText=this.localization(i),n){const t=this.createElement("p");t.appendChild(o),e.appendChild(t)}else e.appendChild(o)}defaultButtonOptions={playPause:{visible:!0,icon:"play",displayName:"Play/Pause"},play:{visible:!0,icon:'<svg viewBox="0 0 320 512"><path d="M361 215C375.3 223.8 384 239.3 384 256C384 272.7 375.3 288.2 361 296.1L73.03 472.1C58.21 482 39.66 482.4 24.52 473.9C9.377 465.4 0 449.4 0 432V80C0 62.64 9.377 46.63 24.52 38.13C39.66 29.64 58.21 29.99 73.03 39.04L361 215z"/></svg>',displayName:"Play"},pause:{visible:!0,icon:'<svg viewBox="0 0 320 512"><path d="M272 63.1l-32 0c-26.51 0-48 21.49-48 47.1v288c0 26.51 21.49 48 48 48L272 448c26.51 0 48-21.49 48-48v-288C320 85.49 298.5 63.1 272 63.1zM80 63.1l-32 0c-26.51 0-48 21.49-48 48v288C0 426.5 21.49 448 48 448l32 0c26.51 0 48-21.49 48-48v-288C128 85.49 106.5 63.1 80 63.1z"/></svg>',displayName:"Pause"},restart:{visible:!0,icon:'<svg viewBox="0 0 512 512"><path d="M496 48V192c0 17.69-14.31 32-32 32H320c-17.69 0-32-14.31-32-32s14.31-32 32-32h63.39c-29.97-39.7-77.25-63.78-127.6-63.78C167.7 96.22 96 167.9 96 256s71.69 159.8 159.8 159.8c34.88 0 68.03-11.03 95.88-31.94c14.22-10.53 34.22-7.75 44.81 6.375c10.59 14.16 7.75 34.22-6.375 44.81c-39.03 29.28-85.36 44.86-134.2 44.86C132.5 479.9 32 379.4 32 256s100.5-223.9 223.9-223.9c69.15 0 134 32.47 176.1 86.12V48c0-17.69 14.31-32 32-32S496 30.31 496 48z"/></svg>',displayName:"Restart"},mute:{visible:!0,icon:'<svg viewBox="0 0 640 512"><path d="M412.6 182c-10.28-8.334-25.41-6.867-33.75 3.402c-8.406 10.24-6.906 25.35 3.375 33.74C393.5 228.4 400 241.8 400 255.1c0 14.17-6.5 27.59-17.81 36.83c-10.28 8.396-11.78 23.5-3.375 33.74c4.719 5.806 11.62 8.802 18.56 8.802c5.344 0 10.75-1.779 15.19-5.399C435.1 311.5 448 284.6 448 255.1S435.1 200.4 412.6 182zM473.1 108.2c-10.22-8.334-25.34-6.898-33.78 3.34c-8.406 10.24-6.906 25.35 3.344 33.74C476.6 172.1 496 213.3 496 255.1s-19.44 82.1-53.31 110.7c-10.25 8.396-11.75 23.5-3.344 33.74c4.75 5.775 11.62 8.771 18.56 8.771c5.375 0 10.75-1.779 15.22-5.431C518.2 366.9 544 313 544 255.1S518.2 145 473.1 108.2zM534.4 33.4c-10.22-8.334-25.34-6.867-33.78 3.34c-8.406 10.24-6.906 25.35 3.344 33.74C559.9 116.3 592 183.9 592 255.1s-32.09 139.7-88.06 185.5c-10.25 8.396-11.75 23.5-3.344 33.74C505.3 481 512.2 484 519.2 484c5.375 0 10.75-1.779 15.22-5.431C601.5 423.6 640 342.5 640 255.1S601.5 88.34 534.4 33.4zM301.2 34.98c-11.5-5.181-25.01-3.076-34.43 5.29L131.8 160.1H48c-26.51 0-48 21.48-48 47.96v95.92c0 26.48 21.49 47.96 48 47.96h83.84l134.9 119.8C272.7 477 280.3 479.8 288 479.8c4.438 0 8.959-.9314 13.16-2.835C312.7 471.8 320 460.4 320 447.9V64.12C320 51.55 312.7 40.13 301.2 34.98z"/></svg>',displayName:"Mute"},unmute:{visible:!0,icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M301.2 34.85c-11.5-5.188-25.02-3.122-34.44 5.253L131.8 160H48c-26.51 0-48 21.49-48 47.1v95.1c0 26.51 21.49 47.1 48 47.1h83.84l134.9 119.9c5.984 5.312 13.58 8.094 21.26 8.094c4.438 0 8.972-.9375 13.17-2.844c11.5-5.156 18.82-16.56 18.82-29.16V64C319.1 51.41 312.7 40 301.2 34.85zM513.9 255.1l47.03-47.03c9.375-9.375 9.375-24.56 0-33.94s-24.56-9.375-33.94 0L480 222.1L432.1 175c-9.375-9.375-24.56-9.375-33.94 0s-9.375 24.56 0 33.94l47.03 47.03l-47.03 47.03c-9.375 9.375-9.375 24.56 0 33.94c9.373 9.373 24.56 9.381 33.94 0L480 289.9l47.03 47.03c9.373 9.373 24.56 9.381 33.94 0c9.375-9.375 9.375-24.56 0-33.94L513.9 255.1z"/></svg>',displayName:"Unmute"},settings:{visible:!0,icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M495.9 166.6C499.2 175.2 496.4 184.9 489.6 191.2L446.3 230.6C447.4 238.9 448 247.4 448 256C448 264.6 447.4 273.1 446.3 281.4L489.6 320.8C496.4 327.1 499.2 336.8 495.9 345.4C491.5 357.3 486.2 368.8 480.2 379.7L475.5 387.8C468.9 398.8 461.5 409.2 453.4 419.1C447.4 426.2 437.7 428.7 428.9 425.9L373.2 408.1C359.8 418.4 344.1 427 329.2 433.6L316.7 490.7C314.7 499.7 307.7 506.1 298.5 508.5C284.7 510.8 270.5 512 255.1 512C241.5 512 227.3 510.8 213.5 508.5C204.3 506.1 197.3 499.7 195.3 490.7L182.8 433.6C167 427 152.2 418.4 138.8 408.1L83.14 425.9C74.3 428.7 64.55 426.2 58.63 419.1C50.52 409.2 43.12 398.8 36.52 387.8L31.84 379.7C25.77 368.8 20.49 357.3 16.06 345.4C12.82 336.8 15.55 327.1 22.41 320.8L65.67 281.4C64.57 273.1 64 264.6 64 256C64 247.4 64.57 238.9 65.67 230.6L22.41 191.2C15.55 184.9 12.82 175.3 16.06 166.6C20.49 154.7 25.78 143.2 31.84 132.3L36.51 124.2C43.12 113.2 50.52 102.8 58.63 92.95C64.55 85.8 74.3 83.32 83.14 86.14L138.8 103.9C152.2 93.56 167 84.96 182.8 78.43L195.3 21.33C197.3 12.25 204.3 5.04 213.5 3.51C227.3 1.201 241.5 0 256 0C270.5 0 284.7 1.201 298.5 3.51C307.7 5.04 314.7 12.25 316.7 21.33L329.2 78.43C344.1 84.96 359.8 93.56 373.2 103.9L428.9 86.14C437.7 83.32 447.4 85.8 453.4 92.95C461.5 102.8 468.9 113.2 475.5 124.2L480.2 132.3C486.2 143.2 491.5 154.7 495.9 166.6V166.6zM256 336C300.2 336 336 300.2 336 255.1C336 211.8 300.2 175.1 256 175.1C211.8 175.1 176 211.8 176 255.1C176 300.2 211.8 336 256 336z"/></svg>',displayName:"Settings"},fullscreen:{visible:!0,icon:"fullscreen",displayName:"Fullscreen"},enterFullscreen:{visible:!0,icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M208 281.4c-12.5-12.5-32.76-12.5-45.26-.002l-78.06 78.07l-30.06-30.06c-6.125-6.125-14.31-9.367-22.63-9.367c-4.125 0-8.279 .7891-12.25 2.43c-11.97 4.953-19.75 16.62-19.75 29.56v135.1C.0013 501.3 10.75 512 24 512h136c12.94 0 24.63-7.797 29.56-19.75c4.969-11.97 2.219-25.72-6.938-34.87l-30.06-30.06l78.06-78.07c12.5-12.49 12.5-32.75 .002-45.25L208 281.4zM487.1 0h-136c-12.94 0-24.63 7.797-29.56 19.75c-4.969 11.97-2.219 25.72 6.938 34.87l30.06 30.06l-78.06 78.07c-12.5 12.5-12.5 32.76 0 45.26l22.62 22.62c12.5 12.5 32.76 12.5 45.26 0l78.06-78.07l30.06 30.06c9.156 9.141 22.87 11.84 34.87 6.937C504.2 184.6 512 172.9 512 159.1V23.1C512 10.74 501.3 0 487.1 0z"/></svg>',displayName:"Enter Fullscreen"},exitFullscreen:{visible:!0,icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M215.1 272h-136c-12.94 0-24.63 7.797-29.56 19.75C45.47 303.7 48.22 317.5 57.37 326.6l30.06 30.06l-78.06 78.07c-12.5 12.5-12.5 32.75-.0012 45.25l22.62 22.62c12.5 12.5 32.76 12.5 45.26 .0013l78.06-78.07l30.06 30.06c6.125 6.125 14.31 9.367 22.63 9.367c4.125 0 8.279-.7891 12.25-2.43c11.97-4.953 19.75-16.62 19.75-29.56V296C239.1 282.7 229.3 272 215.1 272zM296 240h136c12.94 0 24.63-7.797 29.56-19.75c4.969-11.97 2.219-25.72-6.938-34.87l-30.06-30.06l78.06-78.07c12.5-12.5 12.5-32.76 .0002-45.26l-22.62-22.62c-12.5-12.5-32.76-12.5-45.26-.0003l-78.06 78.07l-30.06-30.06c-9.156-9.141-22.87-11.84-34.87-6.937c-11.97 4.953-19.75 16.62-19.75 29.56v135.1C272 229.3 282.7 240 296 240z"/></svg>',displayName:"Exit Fullscreen"},saveState:{visible:!0,icon:'<svg viewBox="0 0 448 512"><path fill="currentColor" d="M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"/></svg>',displayName:"Save State"},loadState:{visible:!0,icon:'<svg viewBox="0 0 576 512"><path fill="currentColor" d="M572.694 292.093L500.27 416.248A63.997 63.997 0 0 1 444.989 448H45.025c-18.523 0-30.064-20.093-20.731-36.093l72.424-124.155A64 64 0 0 1 152 256h399.964c18.523 0 30.064 20.093 20.73 36.093zM152 224h328v-48c0-26.51-21.49-48-48-48H272l-64-64H48C21.49 64 0 85.49 0 112v278.046l69.077-118.418C86.214 242.25 117.989 224 152 224z"/></svg>',displayName:"Load State"},screenRecord:{visible:!0},gamepad:{visible:!0,icon:'<svg viewBox="0 0 640 512"><path fill="currentColor" d="M480 96H160C71.6 96 0 167.6 0 256s71.6 160 160 160c44.8 0 85.2-18.4 114.2-48h91.5c29 29.6 69.5 48 114.2 48 88.4 0 160-71.6 160-160S568.4 96 480 96zM256 276c0 6.6-5.4 12-12 12h-52v52c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-52H76c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h52v-52c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h52c6.6 0 12 5.4 12 12v40zm184 68c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm80-80c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48z"/></svg>',displayName:"Control Settings"},cheat:{visible:!0,icon:'<svg viewBox="0 0 496 512"><path fill="currentColor" d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm-80-216c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm4 72.6c-20.8 25-51.5 39.4-84 39.4s-63.2-14.3-84-39.4c-8.5-10.2-23.7-11.5-33.8-3.1-10.2 8.5-11.5 23.6-3.1 33.8 30 36 74.1 56.6 120.9 56.6s90.9-20.6 120.9-56.6c8.5-10.2 7.1-25.3-3.1-33.8-10.1-8.4-25.3-7.1-33.8 3.1z" class=""></path></svg>',displayName:"Cheats"},volumeSlider:{visible:!0},saveSavFiles:{visible:!0,icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 23 23"><path d="M3 6.5V5C3 3.89543 3.89543 3 5 3H16.1716C16.702 3 17.2107 3.21071 17.5858 3.58579L20.4142 6.41421C20.7893 6.78929 21 7.29799 21 7.82843V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V17.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="transparent"></path><path d="M8 3H16V8.4C16 8.73137 15.7314 9 15.4 9H8.6C8.26863 9 8 8.73137 8 8.4V3Z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="transparent"></path><path d="M18 21V13.6C18 13.2686 17.7314 13 17.4 13H15" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="transparent"></path><path d="M6 21V17.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="transparent"></path><path d="M12 12H1M1 12L4 9M1 12L4 15" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg>',displayName:"Export Save File"},loadSavFiles:{visible:!0,icon:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 23 23"><path d="M3 7.5V5C3 3.89543 3.89543 3 5 3H16.1716C16.702 3 17.2107 3.21071 17.5858 3.58579L20.4142 6.41421C20.7893 6.78929 21 7.29799 21 7.82843V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V16.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="transparent"></path><path d="M6 21V17" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M18 21V13.6C18 13.2686 17.7314 13 17.4 13H15" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="transparent"></path><path d="M16 3V8.4C16 8.73137 15.7314 9 15.4 9H13.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="transparent"></path><path d="M8 3V6" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path><path d="M1 12H12M12 12L9 9M12 12L9 15" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path></svg>',displayName:"Import Save File"},quickSave:{visible:!0},quickLoad:{visible:!0},screenshot:{visible:!0},cacheManager:{visible:!0,icon:'<svg viewBox="0 0 1800 1800"><path d="M896 768q237 0 443-43t325-127v170q0 69-103 128t-280 93.5-385 34.5-385-34.5T231 896 128 768V598q119 84 325 127t443 43zm0 768q237 0 443-43t325-127v170q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128v-170q119 84 325 127t443 43zm0-384q237 0 443-43t325-127v170q0 69-103 128t-280 93.5-385 34.5-385-34.5-280-93.5-103-128V982q119 84 325 127t443 43zM896 0q208 0 385 34.5t280 93.5 103 128v128q0 69-103 128t-280 93.5T896 640t-385-34.5T231 512 128 384V256q0-69 103-128t280-93.5T896 0z"/></svg>',displayName:"Cache Manager"},exitEmulation:{visible:!0,icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 460 460"><path style="fill:none;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(255,255,255);stroke-opacity:1;stroke-miterlimit:4;" d="M 14.000061 7.636414 L 14.000061 4.5 C 14.000061 4.223877 13.776123 3.999939 13.5 3.999939 L 4.5 3.999939 C 4.223877 3.999939 3.999939 4.223877 3.999939 4.5 L 3.999939 19.5 C 3.999939 19.776123 4.223877 20.000061 4.5 20.000061 L 13.5 20.000061 C 13.776123 20.000061 14.000061 19.776123 14.000061 19.5 L 14.000061 16.363586 " transform="matrix(21.333333,0,0,21.333333,0,0)"/><path style="fill:none;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(255,255,255);stroke-opacity:1;stroke-miterlimit:4;" d="M 9.999939 12 L 21 12 M 21 12 L 18.000366 8.499939 M 21 12 L 18 15.500061 " transform="matrix(21.333333,0,0,21.333333,0,0)"/></svg>',displayName:"Exit Emulation"},netplay:{visible:!1,icon:'<svg viewBox="0 0 512 512"><path fill="currentColor" d="M364.215 192h131.43c5.439 20.419 8.354 41.868 8.354 64s-2.915 43.581-8.354 64h-131.43c5.154-43.049 4.939-86.746 0-128zM185.214 352c10.678 53.68 33.173 112.514 70.125 151.992.221.001.44.008.661.008s.44-.008.661-.008c37.012-39.543 59.467-98.414 70.125-151.992H185.214zm174.13-192h125.385C452.802 84.024 384.128 27.305 300.95 12.075c30.238 43.12 48.821 96.332 58.394 147.925zm-27.35 32H180.006c-5.339 41.914-5.345 86.037 0 128h151.989c5.339-41.915 5.345-86.037-.001-128zM152.656 352H27.271c31.926 75.976 100.6 132.695 183.778 147.925-30.246-43.136-48.823-96.35-58.393-147.925zm206.688 0c-9.575 51.605-28.163 104.814-58.394 147.925 83.178-15.23 151.852-71.949 183.778-147.925H359.344zm-32.558-192c-10.678-53.68-33.174-112.514-70.125-151.992-.221 0-.44-.008-.661-.008s-.44.008-.661.008C218.327 47.551 195.872 106.422 185.214 160h141.572zM16.355 192C10.915 212.419 8 233.868 8 256s2.915 43.581 8.355 64h131.43c-4.939-41.254-5.154-84.951 0-128H16.355zm136.301-32c9.575-51.602 28.161-104.81 58.394-147.925C127.872 27.305 59.198 84.024 27.271 160h125.385z"/></svg>',displayName:"Netplay"},diskButton:{visible:!0,icon:'<svg fill="#FFFFFF" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 473.109 473.109"><path d="M340.963,101.878H12.105C5.423,101.878,0,107.301,0,113.983v328.862c0,6.68,5.423,12.105,12.105,12.105h328.857 c6.685,0,12.104-5.426,12.104-12.105V113.983C353.067,107.301,347.647,101.878,340.963,101.878z M67.584,120.042h217.895v101.884 H67.584V120.042z M296.076,429.228H56.998V278.414h239.079V429.228z M223.947,135.173h30.269v72.638h-30.269V135.173z M274.13,315.741H78.933v-12.105H274.13V315.741z M274.13,358.109H78.933v-12.105H274.13V358.109z M274.13,398.965H78.933v-12.105 H274.13V398.965z M473.109,30.263v328.863c0,6.68-5.426,12.105-12.105,12.105H384.59v-25.724h31.528V194.694H384.59v-56.489h20.93 V36.321H187.625v43.361h-67.583v-49.42c0-6.682,5.423-12.105,12.105-12.105H461.01C467.695,18.158,473.109,23.581,473.109,30.263z M343.989,51.453h30.269v31.321c-3.18-1.918-6.868-3.092-10.853-3.092h-19.416V51.453z M394.177,232.021h-9.581v-12.105h9.581 V232.021z M384.59,262.284h9.581v12.105h-9.581V262.284z M384.59,303.14h9.581v12.104h-9.581V303.14z"/></svg>',displayName:"Disks"},contextMenu:{visible:!0,icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.--\x3e<path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg>',displayName:"Context Menu"}};defaultButtonAliases={volume:"volumeSlider"};buildButtonOptions(e){let t=this.defaultButtonOptions;if(e)for(const i in e){let n=i;if(this.defaultButtonAliases[i]&&(n=this.defaultButtonAliases[i]),"contextMenu"!==n)if(t[n]){if("boolean"==typeof e[n])t[n].visible=e[n];else if("object"==typeof e[n])if(this.defaultButtonOptions[n])for(const i in e[n])null!==e[n][i]&&(t[n][i]=e[n][i]);else e[n].displayName&&e[n].icon&&e[n].callback?t[n]={visible:!0,displayName:e[n].displayName,icon:e[n].icon,callback:e[n].callback,custom:!0}:console.warn(`Custom button "${n}" is missing required properties`);switch(n){case"playPause":t.play.visible=t.playPause.visible,t.pause.visible=t.playPause.visible;break;case"mute":t.unmute.visible=t.mute.visible;break;case"fullscreen":t.enterFullscreen.visible=t.fullscreen.visible,t.exitFullscreen.visible=t.fullscreen.visible}}else console.warn(`Button "${n}" is not a valid button.`)}return t}createContextMenu(){this.elements.contextmenu=this.createElement("div"),this.elements.contextmenu.classList.add("ejs_context_menu"),this.addEventListener(this.game,"contextmenu",(e=>{if(e.preventDefault(),this.config.buttonOpts&&!1===this.config.buttonOpts.rightClick||!this.started)return;const t=this.elements.parent.getBoundingClientRect();this.elements.contextmenu.style.display="block";const i=this.elements.contextmenu.getBoundingClientRect(),n=e.offsetY+i.height>t.height-25,o=e.offsetX+i.width>t.width-5;this.elements.contextmenu.style.left=e.offsetX-(o?i.width:0)+"px",this.elements.contextmenu.style.top=e.offsetY-(n?i.height:0)+"px"}));const e=()=>{this.elements.contextmenu.style.display="none"};this.addEventListener(this.elements.contextmenu,"contextmenu",(e=>e.preventDefault())),this.addEventListener(this.elements.parent,"contextmenu",(e=>e.preventDefault())),this.addEventListener(this.game,"mousedown touchend",e);const t=this.createElement("ul"),i=(i,n,o)=>{const r=this.createElement("li");n&&(r.hidden=!0);const s=this.createElement("a");return o instanceof Function&&this.addEventListener(r,"click",(e=>{e.preventDefault(),o()})),s.href="#",s.onclick="return false",s.innerText=this.localization(i),r.appendChild(s),t.appendChild(r),e(),r};let n;const o=i("Take Screenshot",!1,(()=>{n&&URL.revokeObjectURL(n);const t=new Date,i=this.getBaseFileName()+"-"+t.getMonth()+"-"+t.getDate()+"-"+t.getFullYear();this.screenshot(((t,o)=>{n=URL.createObjectURL(t);const r=this.createElement("a");r.href=n,r.download=i+"."+o,r.click(),e()}))}));let r=null;const s=i("Start Screen Recording",!1,(()=>{null!==r&&r.stop(),r=this.screenRecord(),s.setAttribute("hidden","hidden"),a.removeAttribute("hidden"),e()})),a=i("Stop Screen Recording",!0,(()=>{null!==r&&(r.stop(),r=null),s.removeAttribute("hidden"),a.setAttribute("hidden","hidden"),e()})),l=i("Quick Save",!1,(()=>{const t=this.getSettingValue("save-state-slot")?this.getSettingValue("save-state-slot"):"1";this.gameManager.quickSave(t)?this.displayMessage(this.localization("SAVED STATE TO SLOT")+" "+t):this.displayMessage(this.localization("FAILED TO SAVE STATE")),e()})),c=i("Quick Load",!1,(()=>{const t=this.getSettingValue("save-state-slot")?this.getSettingValue("save-state-slot"):"1";this.gameManager.quickLoad(t),this.displayMessage(this.localization("LOADED STATE FROM SLOT")+" "+t),e()}));this.elements.contextMenu={screenshot:o,startScreenRecording:s,stopScreenRecording:a,save:l,load:c},i("EmulatorJS v"+this.ejs_version,!1,(()=>{e();const t=this.createPopup("EmulatorJS",{Close:()=>{this.closePopup()}});t.style.display="flex";const i=this.createElement("div");t.appendChild(i),i.classList.add("ejs_list_selector");const n=this.createElement("ul"),o=(t,i,o)=>{const r=this.createElement("li");i&&(r.hidden=!0);const s=this.createElement("a");return o instanceof Function&&this.addEventListener(r,"click",(e=>{e.preventDefault(),o(r)})),s.href="#",s.onclick="return false",s.innerText=this.localization(t),r.appendChild(s),n.appendChild(r),e(),r},r=this.createElement("div"),s=this.createElement("div");s.style.display="none";const a=this.createElement("div");a.style.display="none";const l=this.createElement("div");l.style.display="none",t.appendChild(r),t.appendChild(s),t.appendChild(a),t.appendChild(l),r.innerText="EmulatorJS v"+this.ejs_version,r.appendChild(this.createElement("br")),r.appendChild(this.createElement("br")),r.classList.add("ejs_context_menu_tab"),s.classList.add("ejs_context_menu_tab"),a.classList.add("ejs_context_menu_tab"),l.classList.add("ejs_context_menu_tab"),this.createLink(r,"https://github.com/EmulatorJS/EmulatorJS","View on GitHub",!0),this.createLink(r,"https://discord.gg/6akryGkETU","Join the discord",!0);const c=this.createElement("div");this.createLink(c,"https://emulatorjs.org","EmulatorJS"),c.innerHTML+=" is powered by ",this.createLink(c,"https://github.com/libretro/RetroArch/","RetroArch"),this.repository&&this.coreName?(c.innerHTML+=". This core is powered by ",this.createLink(c,this.repository,this.coreName),c.innerHTML+="."):c.innerHTML+=".",r.appendChild(c),r.appendChild(this.createElement("br")),i.appendChild(n);let d=r;const u=(e,t)=>{if(d===e)return;d&&(d.style.display="none");let i=t.parentElement.querySelector(".ejs_active_list_element");i&&i.classList.remove("ejs_active_list_element"),t.classList.add("ejs_active_list_element"),d=e,e.style.display=""};o("Home",!1,(e=>{u(r,e)})).classList.add("ejs_active_list_element"),o("EmulatorJS License",!1,(e=>{u(s,e)})),o("RetroArch License",!1,(e=>{u(a,e)})),this.coreName&&this.license&&(o(this.coreName+" License",!1,(e=>{u(l,e)})),l.innerText=this.license),a.innerText=this.localization("This project is powered by")+" ";const g=this.createElement("a");g.href="https://github.com/libretro/RetroArch",g.target="_blank",g.innerText="RetroArch",a.appendChild(g);const h=this.createElement("a");h.target="_blank",h.href="https://github.com/libretro/RetroArch/blob/master/COPYING",h.innerText=this.localization("View the RetroArch license here"),g.appendChild(this.createElement("br")),g.appendChild(h),s.innerText='                    GNU GENERAL PUBLIC LICENSE\n                       Version 3, 29 June 2007\n\n Copyright (C) 2007 Free Software Foundation, Inc. <https://fsf.org/>\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n                            Preamble\n\n  The GNU General Public License is a free, copyleft license for\nsoftware and other kinds of works.\n\n  The licenses for most software and other practical works are designed\nto take away your freedom to share and change the works.  By contrast,\nthe GNU General Public License is intended to guarantee your freedom to\nshare and change all versions of a program--to make sure it remains free\nsoftware for all its users.  We, the Free Software Foundation, use the\nGNU General Public License for most of our software; it applies also to\nany other work released this way by its authors.  You can apply it to\nyour programs, too.\n\n  When we speak of free software, we are referring to freedom, not\nprice.  Our General Public Licenses are designed to make sure that you\nhave the freedom to distribute copies of free software (and charge for\nthem if you wish), that you receive source code or can get it if you\nwant it, that you can change the software or use pieces of it in new\nfree programs, and that you know you can do these things.\n\n  To protect your rights, we need to prevent others from denying you\nthese rights or asking you to surrender the rights.  Therefore, you have\ncertain responsibilities if you distribute copies of the software, or if\nyou modify it: responsibilities to respect the freedom of others.\n\n  For example, if you distribute copies of such a program, whether\ngratis or for a fee, you must pass on to the recipients the same\nfreedoms that you received.  You must make sure that they, too, receive\nor can get the source code.  And you must show them these terms so they\nknow their rights.\n\n  Developers that use the GNU GPL protect your rights with two steps:\n(1) assert copyright on the software, and (2) offer you this License\ngiving you legal permission to copy, distribute and/or modify it.\n\n  For the developers\' and authors\' protection, the GPL clearly explains\nthat there is no warranty for this free software.  For both users\' and\nauthors\' sake, the GPL requires that modified versions be marked as\nchanged, so that their problems will not be attributed erroneously to\nauthors of previous versions.\n\n  Some devices are designed to deny users access to install or run\nmodified versions of the software inside them, although the manufacturer\ncan do so.  This is fundamentally incompatible with the aim of\nprotecting users\' freedom to change the software.  The systematic\npattern of such abuse occurs in the area of products for individuals to\nuse, which is precisely where it is most unacceptable.  Therefore, we\nhave designed this version of the GPL to prohibit the practice for those\nproducts.  If such problems arise substantially in other domains, we\nstand ready to extend this provision to those domains in future versions\nof the GPL, as needed to protect the freedom of users.\n\n  Finally, every program is threatened constantly by software patents.\nStates should not allow patents to restrict development and use of\nsoftware on general-purpose computers, but in those that do, we wish to\navoid the special danger that patents applied to a free program could\nmake it effectively proprietary.  To prevent this, the GPL assures that\npatents cannot be used to render the program non-free.\n\n  The precise terms and conditions for copying, distribution and\nmodification follow.\n\n                       TERMS AND CONDITIONS\n\n  0. Definitions.\n\n  "This License" refers to version 3 of the GNU General Public License.\n\n  "Copyright" also means copyright-like laws that apply to other kinds of\nworks, such as semiconductor masks.\n\n  "The Program" refers to any copyrightable work licensed under this\nLicense.  Each licensee is addressed as "you".  "Licensees" and\n"recipients" may be individuals or organizations.\n\n  To "modify" a work means to copy from or adapt all or part of the work\nin a fashion requiring copyright permission, other than the making of an\nexact copy.  The resulting work is called a "modified version" of the\nearlier work or a work "based on" the earlier work.\n\n  A "covered work" means either the unmodified Program or a work based\non the Program.\n\n  To "propagate" a work means to do anything with it that, without\npermission, would make you directly or secondarily liable for\ninfringement under applicable copyright law, except executing it on a\ncomputer or modifying a private copy.  Propagation includes copying,\ndistribution (with or without modification), making available to the\npublic, and in some countries other activities as well.\n\n  To "convey" a work means any kind of propagation that enables other\nparties to make or receive copies.  Mere interaction with a user through\na computer network, with no transfer of a copy, is not conveying.\n\n  An interactive user interface displays "Appropriate Legal Notices"\nto the extent that it includes a convenient and prominently visible\nfeature that (1) displays an appropriate copyright notice, and (2)\ntells the user that there is no warranty for the work (except to the\nextent that warranties are provided), that licensees may convey the\nwork under this License, and how to view a copy of this License.  If\nthe interface presents a list of user commands or options, such as a\nmenu, a prominent item in the list meets this criterion.\n\n  1. Source Code.\n\n  The "source code" for a work means the preferred form of the work\nfor making modifications to it.  "Object code" means any non-source\nform of a work.\n\n  A "Standard Interface" means an interface that either is an official\nstandard defined by a recognized standards body, or, in the case of\ninterfaces specified for a particular programming language, one that\nis widely used among developers working in that language.\n\n  The "System Libraries" of an executable work include anything, other\nthan the work as a whole, that (a) is included in the normal form of\npackaging a Major Component, but which is not part of that Major\nComponent, and (b) serves only to enable use of the work with that\nMajor Component, or to implement a Standard Interface for which an\nimplementation is available to the public in source code form.  A\n"Major Component", in this context, means a major essential component\n(kernel, window system, and so on) of the specific operating system\n(if any) on which the executable work runs, or a compiler used to\nproduce the work, or an object code interpreter used to run it.\n\n  The "Corresponding Source" for a work in object code form means all\nthe source code needed to generate, install, and (for an executable\nwork) run the object code and to modify the work, including scripts to\ncontrol those activities.  However, it does not include the work\'s\nSystem Libraries, or general-purpose tools or generally available free\nprograms which are used unmodified in performing those activities but\nwhich are not part of the work.  For example, Corresponding Source\nincludes interface definition files associated with source files for\nthe work, and the source code for shared libraries and dynamically\nlinked subprograms that the work is specifically designed to require,\nsuch as by intimate data communication or control flow between those\nsubprograms and other parts of the work.\n\n  The Corresponding Source need not include anything that users\ncan regenerate automatically from other parts of the Corresponding\nSource.\n\n  The Corresponding Source for a work in source code form is that\nsame work.\n\n  2. Basic Permissions.\n\n  All rights granted under this License are granted for the term of\ncopyright on the Program, and are irrevocable provided the stated\nconditions are met.  This License explicitly affirms your unlimited\npermission to run the unmodified Program.  The output from running a\ncovered work is covered by this License only if the output, given its\ncontent, constitutes a covered work.  This License acknowledges your\nrights of fair use or other equivalent, as provided by copyright law.\n\n  You may make, run and propagate covered works that you do not\nconvey, without conditions so long as your license otherwise remains\nin force.  You may convey covered works to others for the sole purpose\nof having them make modifications exclusively for you, or provide you\nwith facilities for running those works, provided that you comply with\nthe terms of this License in conveying all material for which you do\nnot control copyright.  Those thus making or running the covered works\nfor you must do so exclusively on your behalf, under your direction\nand control, on terms that prohibit them from making any copies of\nyour copyrighted material outside their relationship with you.\n\n  Conveying under any other circumstances is permitted solely under\nthe conditions stated below.  Sublicensing is not allowed; section 10\nmakes it unnecessary.\n\n  3. Protecting Users\' Legal Rights From Anti-Circumvention Law.\n\n  No covered work shall be deemed part of an effective technological\nmeasure under any applicable law fulfilling obligations under article\n11 of the WIPO copyright treaty adopted on 20 December 1996, or\nsimilar laws prohibiting or restricting circumvention of such\nmeasures.\n\n  When you convey a covered work, you waive any legal power to forbid\ncircumvention of technological measures to the extent such circumvention\nis effected by exercising rights under this License with respect to\nthe covered work, and you disclaim any intention to limit operation or\nmodification of the work as a means of enforcing, against the work\'s\nusers, your or third parties\' legal rights to forbid circumvention of\ntechnological measures.\n\n  4. Conveying Verbatim Copies.\n\n  You may convey verbatim copies of the Program\'s source code as you\nreceive it, in any medium, provided that you conspicuously and\nappropriately publish on each copy an appropriate copyright notice;\nkeep intact all notices stating that this License and any\nnon-permissive terms added in accord with section 7 apply to the code;\nkeep intact all notices of the absence of any warranty; and give all\nrecipients a copy of this License along with the Program.\n\n  You may charge any price or no price for each copy that you convey,\nand you may offer support or warranty protection for a fee.\n\n  5. Conveying Modified Source Versions.\n\n  You may convey a work based on the Program, or the modifications to\nproduce it from the Program, in the form of source code under the\nterms of section 4, provided that you also meet all of these conditions:\n\n    a) The work must carry prominent notices stating that you modified\n    it, and giving a relevant date.\n\n    b) The work must carry prominent notices stating that it is\n    released under this License and any conditions added under section\n    7.  This requirement modifies the requirement in section 4 to\n    "keep intact all notices".\n\n    c) You must license the entire work, as a whole, under this\n    License to anyone who comes into possession of a copy.  This\n    License will therefore apply, along with any applicable section 7\n    additional terms, to the whole of the work, and all its parts,\n    regardless of how they are packaged.  This License gives no\n    permission to license the work in any other way, but it does not\n    invalidate such permission if you have separately received it.\n\n    d) If the work has interactive user interfaces, each must display\n    Appropriate Legal Notices; however, if the Program has interactive\n    interfaces that do not display Appropriate Legal Notices, your\n    work need not make them do so.\n\n  A compilation of a covered work with other separate and independent\nworks, which are not by their nature extensions of the covered work,\nand which are not combined with it such as to form a larger program,\nin or on a volume of a storage or distribution medium, is called an\n"aggregate" if the compilation and its resulting copyright are not\nused to limit the access or legal rights of the compilation\'s users\nbeyond what the individual works permit.  Inclusion of a covered work\nin an aggregate does not cause this License to apply to the other\nparts of the aggregate.\n\n  6. Conveying Non-Source Forms.\n\n  You may convey a covered work in object code form under the terms\nof sections 4 and 5, provided that you also convey the\nmachine-readable Corresponding Source under the terms of this License,\nin one of these ways:\n\n    a) Convey the object code in, or embodied in, a physical product\n    (including a physical distribution medium), accompanied by the\n    Corresponding Source fixed on a durable physical medium\n    customarily used for software interchange.\n\n    b) Convey the object code in, or embodied in, a physical product\n    (including a physical distribution medium), accompanied by a\n    written offer, valid for at least three years and valid for as\n    long as you offer spare parts or customer support for that product\n    model, to give anyone who possesses the object code either (1) a\n    copy of the Corresponding Source for all the software in the\n    product that is covered by this License, on a durable physical\n    medium customarily used for software interchange, for a price no\n    more than your reasonable cost of physically performing this\n    conveying of source, or (2) access to copy the\n    Corresponding Source from a network server at no charge.\n\n    c) Convey individual copies of the object code with a copy of the\n    written offer to provide the Corresponding Source.  This\n    alternative is allowed only occasionally and noncommercially, and\n    only if you received the object code with such an offer, in accord\n    with subsection 6b.\n\n    d) Convey the object code by offering access from a designated\n    place (gratis or for a charge), and offer equivalent access to the\n    Corresponding Source in the same way through the same place at no\n    further charge.  You need not require recipients to copy the\n    Corresponding Source along with the object code.  If the place to\n    copy the object code is a network server, the Corresponding Source\n    may be on a different server (operated by you or a third party)\n    that supports equivalent copying facilities, provided you maintain\n    clear directions next to the object code saying where to find the\n    Corresponding Source.  Regardless of what server hosts the\n    Corresponding Source, you remain obligated to ensure that it is\n    available for as long as needed to satisfy these requirements.\n\n    e) Convey the object code using peer-to-peer transmission, provided\n    you inform other peers where the object code and Corresponding\n    Source of the work are being offered to the general public at no\n    charge under subsection 6d.\n\n  A separable portion of the object code, whose source code is excluded\nfrom the Corresponding Source as a System Library, need not be\nincluded in conveying the object code work.\n\n  A "User Product" is either (1) a "consumer product", which means any\ntangible personal property which is normally used for personal, family,\nor household purposes, or (2) anything designed or sold for incorporation\ninto a dwelling.  In determining whether a product is a consumer product,\ndoubtful cases shall be resolved in favor of coverage.  For a particular\nproduct received by a particular user, "normally used" refers to a\ntypical or common use of that class of product, regardless of the status\nof the particular user or of the way in which the particular user\nactually uses, or expects or is expected to use, the product.  A product\nis a consumer product regardless of whether the product has substantial\ncommercial, industrial or non-consumer uses, unless such uses represent\nthe only significant mode of use of the product.\n\n  "Installation Information" for a User Product means any methods,\nprocedures, authorization keys, or other information required to install\nand execute modified versions of a covered work in that User Product from\na modified version of its Corresponding Source.  The information must\nsuffice to ensure that the continued functioning of the modified object\ncode is in no case prevented or interfered with solely because\nmodification has been made.\n\n  If you convey an object code work under this section in, or with, or\nspecifically for use in, a User Product, and the conveying occurs as\npart of a transaction in which the right of possession and use of the\nUser Product is transferred to the recipient in perpetuity or for a\nfixed term (regardless of how the transaction is characterized), the\nCorresponding Source conveyed under this section must be accompanied\nby the Installation Information.  But this requirement does not apply\nif neither you nor any third party retains the ability to install\nmodified object code on the User Product (for example, the work has\nbeen installed in ROM).\n\n  The requirement to provide Installation Information does not include a\nrequirement to continue to provide support service, warranty, or updates\nfor a work that has been modified or installed by the recipient, or for\nthe User Product in which it has been modified or installed.  Access to a\nnetwork may be denied when the modification itself materially and\nadversely affects the operation of the network or violates the rules and\nprotocols for communication across the network.\n\n  Corresponding Source conveyed, and Installation Information provided,\nin accord with this section must be in a format that is publicly\ndocumented (and with an implementation available to the public in\nsource code form), and must require no special password or key for\nunpacking, reading or copying.\n\n  7. Additional Terms.\n\n  "Additional permissions" are terms that supplement the terms of this\nLicense by making exceptions from one or more of its conditions.\nAdditional permissions that are applicable to the entire Program shall\nbe treated as though they were included in this License, to the extent\nthat they are valid under applicable law.  If additional permissions\napply only to part of the Program, that part may be used separately\nunder those permissions, but the entire Program remains governed by\nthis License without regard to the additional permissions.\n\n  When you convey a copy of a covered work, you may at your option\nremove any additional permissions from that copy, or from any part of\nit.  (Additional permissions may be written to require their own\nremoval in certain cases when you modify the work.)  You may place\nadditional permissions on material, added by you to a covered work,\nfor which you have or can give appropriate copyright permission.\n\n  Notwithstanding any other provision of this License, for material you\nadd to a covered work, you may (if authorized by the copyright holders of\nthat material) supplement the terms of this License with terms:\n\n    a) Disclaiming warranty or limiting liability differently from the\n    terms of sections 15 and 16 of this License; or\n\n    b) Requiring preservation of specified reasonable legal notices or\n    author attributions in that material or in the Appropriate Legal\n    Notices displayed by works containing it; or\n\n    c) Prohibiting misrepresentation of the origin of that material, or\n    requiring that modified versions of such material be marked in\n    reasonable ways as different from the original version; or\n\n    d) Limiting the use for publicity purposes of names of licensors or\n    authors of the material; or\n\n    e) Declining to grant rights under trademark law for use of some\n    trade names, trademarks, or service marks; or\n\n    f) Requiring indemnification of licensors and authors of that\n    material by anyone who conveys the material (or modified versions of\n    it) with contractual assumptions of liability to the recipient, for\n    any liability that these contractual assumptions directly impose on\n    those licensors and authors.\n\n  All other non-permissive additional terms are considered "further\nrestrictions" within the meaning of section 10.  If the Program as you\nreceived it, or any part of it, contains a notice stating that it is\ngoverned by this License along with a term that is a further\nrestriction, you may remove that term.  If a license document contains\na further restriction but permits relicensing or conveying under this\nLicense, you may add to a covered work material governed by the terms\nof that license document, provided that the further restriction does\nnot survive such relicensing or conveying.\n\n  If you add terms to a covered work in accord with this section, you\nmust place, in the relevant source files, a statement of the\nadditional terms that apply to those files, or a notice indicating\nwhere to find the applicable terms.\n\n  Additional terms, permissive or non-permissive, may be stated in the\nform of a separately written license, or stated as exceptions;\nthe above requirements apply either way.\n\n  8. Termination.\n\n  You may not propagate or modify a covered work except as expressly\nprovided under this License.  Any attempt otherwise to propagate or\nmodify it is void, and will automatically terminate your rights under\nthis License (including any patent licenses granted under the third\nparagraph of section 11).\n\n  However, if you cease all violation of this License, then your\nlicense from a particular copyright holder is reinstated (a)\nprovisionally, unless and until the copyright holder explicitly and\nfinally terminates your license, and (b) permanently, if the copyright\nholder fails to notify you of the violation by some reasonable means\nprior to 60 days after the cessation.\n\n  Moreover, your license from a particular copyright holder is\nreinstated permanently if the copyright holder notifies you of the\nviolation by some reasonable means, this is the first time you have\nreceived notice of violation of this License (for any work) from that\ncopyright holder, and you cure the violation prior to 30 days after\nyour receipt of the notice.\n\n  Termination of your rights under this section does not terminate the\nlicenses of parties who have received copies or rights from you under\nthis License.  If your rights have been terminated and not permanently\nreinstated, you do not qualify to receive new licenses for the same\nmaterial under section 10.\n\n  9. Acceptance Not Required for Having Copies.\n\n  You are not required to accept this License in order to receive or\nrun a copy of the Program.  Ancillary propagation of a covered work\noccurring solely as a consequence of using peer-to-peer transmission\nto receive a copy likewise does not require acceptance.  However,\nnothing other than this License grants you permission to propagate or\nmodify any covered work.  These actions infringe copyright if you do\nnot accept this License.  Therefore, by modifying or propagating a\ncovered work, you indicate your acceptance of this License to do so.\n\n  10. Automatic Licensing of Downstream Recipients.\n\n  Each time you convey a covered work, the recipient automatically\nreceives a license from the original licensors, to run, modify and\npropagate that work, subject to this License.  You are not responsible\nfor enforcing compliance by third parties with this License.\n\n  An "entity transaction" is a transaction transferring control of an\norganization, or substantially all assets of one, or subdividing an\norganization, or merging organizations.  If propagation of a covered\nwork results from an entity transaction, each party to that\ntransaction who receives a copy of the work also receives whatever\nlicenses to the work the party\'s predecessor in interest had or could\ngive under the previous paragraph, plus a right to possession of the\nCorresponding Source of the work from the predecessor in interest, if\nthe predecessor has it or can get it with reasonable efforts.\n\n  You may not impose any further restrictions on the exercise of the\nrights granted or affirmed under this License.  For example, you may\nnot impose a license fee, royalty, or other charge for exercise of\nrights granted under this License, and you may not initiate litigation\n(including a cross-claim or counterclaim in a lawsuit) alleging that\nany patent claim is infringed by making, using, selling, offering for\nsale, or importing the Program or any portion of it.\n\n  11. Patents.\n\n  A "contributor" is a copyright holder who authorizes use under this\nLicense of the Program or a work on which the Program is based.  The\nwork thus licensed is called the contributor\'s "contributor version".\n\n  A contributor\'s "essential patent claims" are all patent claims\nowned or controlled by the contributor, whether already acquired or\nhereafter acquired, that would be infringed by some manner, permitted\nby this License, of making, using, or selling its contributor version,\nbut do not include claims that would be infringed only as a\nconsequence of further modification of the contributor version.  For\npurposes of this definition, "control" includes the right to grant\npatent sublicenses in a manner consistent with the requirements of\nthis License.\n\n  Each contributor grants you a non-exclusive, worldwide, royalty-free\npatent license under the contributor\'s essential patent claims, to\nmake, use, sell, offer for sale, import and otherwise run, modify and\npropagate the contents of its contributor version.\n\n  In the following three paragraphs, a "patent license" is any express\nagreement or commitment, however denominated, not to enforce a patent\n(such as an express permission to practice a patent or covenant not to\nsue for patent infringement).  To "grant" such a patent license to a\nparty means to make such an agreement or commitment not to enforce a\npatent against the party.\n\n  If you convey a covered work, knowingly relying on a patent license,\nand the Corresponding Source of the work is not available for anyone\nto copy, free of charge and under the terms of this License, through a\npublicly available network server or other readily accessible means,\nthen you must either (1) cause the Corresponding Source to be so\navailable, or (2) arrange to deprive yourself of the benefit of the\npatent license for this particular work, or (3) arrange, in a manner\nconsistent with the requirements of this License, to extend the patent\nlicense to downstream recipients.  "Knowingly relying" means you have\nactual knowledge that, but for the patent license, your conveying the\ncovered work in a country, or your recipient\'s use of the covered work\nin a country, would infringe one or more identifiable patents in that\ncountry that you have reason to believe are valid.\n\n  If, pursuant to or in connection with a single transaction or\narrangement, you convey, or propagate by procuring conveyance of, a\ncovered work, and grant a patent license to some of the parties\nreceiving the covered work authorizing them to use, propagate, modify\nor convey a specific copy of the covered work, then the patent license\nyou grant is automatically extended to all recipients of the covered\nwork and works based on it.\n\n  A patent license is "discriminatory" if it does not include within\nthe scope of its coverage, prohibits the exercise of, or is\nconditioned on the non-exercise of one or more of the rights that are\nspecifically granted under this License.  You may not convey a covered\nwork if you are a party to an arrangement with a third party that is\nin the business of distributing software, under which you make payment\nto the third party based on the extent of your activity of conveying\nthe work, and under which the third party grants, to any of the\nparties who would receive the covered work from you, a discriminatory\npatent license (a) in connection with copies of the covered work\nconveyed by you (or copies made from those copies), or (b) primarily\nfor and in connection with specific products or compilations that\ncontain the covered work, unless you entered into that arrangement,\nor that patent license was granted, prior to 28 March 2007.\n\n  Nothing in this License shall be construed as excluding or limiting\nany implied license or other defenses to infringement that may\notherwise be available to you under applicable patent law.\n\n  12. No Surrender of Others\' Freedom.\n\n  If conditions are imposed on you (whether by court order, agreement or\notherwise) that contradict the conditions of this License, they do not\nexcuse you from the conditions of this License.  If you cannot convey a\ncovered work so as to satisfy simultaneously your obligations under this\nLicense and any other pertinent obligations, then as a consequence you may\nnot convey it at all.  For example, if you agree to terms that obligate you\nto collect a royalty for further conveying from those to whom you convey\nthe Program, the only way you could satisfy both those terms and this\nLicense would be to refrain entirely from conveying the Program.\n\n  13. Use with the GNU Affero General Public License.\n\n  Notwithstanding any other provision of this License, you have\npermission to link or combine any covered work with a work licensed\nunder version 3 of the GNU Affero General Public License into a single\ncombined work, and to convey the resulting work.  The terms of this\nLicense will continue to apply to the part which is the covered work,\nbut the special requirements of the GNU Affero General Public License,\nsection 13, concerning interaction through a network will apply to the\ncombination as such.\n\n  14. Revised Versions of this License.\n\n  The Free Software Foundation may publish revised and/or new versions of\nthe GNU General Public License from time to time.  Such new versions will\nbe similar in spirit to the present version, but may differ in detail to\naddress new problems or concerns.\n\n  Each version is given a distinguishing version number.  If the\nProgram specifies that a certain numbered version of the GNU General\nPublic License "or any later version" applies to it, you have the\noption of following the terms and conditions either of that numbered\nversion or of any later version published by the Free Software\nFoundation.  If the Program does not specify a version number of the\nGNU General Public License, you may choose any version ever published\nby the Free Software Foundation.\n\n  If the Program specifies that a proxy can decide which future\nversions of the GNU General Public License can be used, that proxy\'s\npublic statement of acceptance of a version permanently authorizes you\nto choose that version for the Program.\n\n  Later license versions may give you additional or different\npermissions.  However, no additional obligations are imposed on any\nauthor or copyright holder as a result of your choosing to follow a\nlater version.\n\n  15. Disclaimer of Warranty.\n\n  THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY\nAPPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT\nHOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY\nOF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,\nTHE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\nPURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM\nIS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF\nALL NECESSARY SERVICING, REPAIR OR CORRECTION.\n\n  16. Limitation of Liability.\n\n  IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\nWILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS\nTHE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY\nGENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE\nUSE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF\nDATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD\nPARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),\nEVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF\nSUCH DAMAGES.\n\n  17. Interpretation of Sections 15 and 16.\n\n  If the disclaimer of warranty and limitation of liability provided\nabove cannot be given local legal effect according to their terms,\nreviewing courts shall apply local law that most closely approximates\nan absolute waiver of all civil liability in connection with the\nProgram, unless a warranty or assumption of liability accompanies a\ncopy of the Program in return for a fee.\n\n                     END OF TERMS AND CONDITIONS\n\n            How to Apply These Terms to Your New Programs\n\n  If you develop a new program, and you want it to be of the greatest\npossible use to the public, the best way to achieve this is to make it\nfree software which everyone can redistribute and change under these terms.\n\n  To do so, attach the following notices to the program.  It is safest\nto attach them to the start of each source file to most effectively\nstate the exclusion of warranty; and each file should have at least\nthe "copyright" line and a pointer to where the full notice is found.\n\n    EmulatorJS: RetroArch on the web\n    Copyright (C) 2022-2024  Ethan O\'Brien\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <https://www.gnu.org/licenses/>.\n\nAlso add information on how to contact you by electronic and paper mail.\n\n  If the program does terminal interaction, make it output a short\nnotice like this when it starts in an interactive mode:\n\n    EmulatorJS  Copyright (C) 2023-2025  Ethan O\'Brien\n    This program comes with ABSOLUTELY NO WARRANTY; for details type `show w\'.\n    This is free software, and you are welcome to redistribute it\n    under certain conditions; type `show c\' for details.\n\nThe hypothetical commands `show w\' and `show c\' should show the appropriate\nparts of the General Public License.  Of course, your program\'s commands\nmight be different; for a GUI interface, you would use an "about box".\n\n  You should also get your employer (if you work as a programmer) or school,\nif any, to sign a "copyright disclaimer" for the program, if necessary.\nFor more information on this, and how to apply and follow the GNU GPL, see\n<https://www.gnu.org/licenses/>.\n\n  The GNU General Public License does not permit incorporating your program\ninto proprietary programs.  If your program is a subroutine library, you\nmay consider it more useful to permit linking proprietary applications with\nthe library.  If this is what you want to do, use the GNU Lesser General\nPublic License instead of this License.  But first, please read\n<https://www.gnu.org/licenses/why-not-lgpl.html>.\n'})),this.config.buttonOpts&&(!1===this.config.buttonOpts.screenshot.visible&&o.setAttribute("hidden",""),!1===this.config.buttonOpts.screenRecord.visible&&s.setAttribute("hidden",""),!1===this.config.buttonOpts.quickSave.visible&&l.setAttribute("hidden",""),!1===this.config.buttonOpts.quickLoad.visible&&c.setAttribute("hidden","")),this.elements.contextmenu.appendChild(t),this.elements.parent.appendChild(this.elements.contextmenu)}closePopup(){if(null!==this.currentPopup){try{this.currentPopup.remove()}catch(e){}this.currentPopup=null}}createPopup(e,t,i){i||this.closePopup();const n=this.createElement("div");n.classList.add("ejs_popup_container"),this.elements.parent.appendChild(n);const o=this.createElement("h4");o.innerText=this.localization(e);const r=this.createElement("div");r.classList.add("ejs_popup_body"),n.appendChild(o),n.appendChild(r);const s=this.createElement("div");s.style["padding-top"]="10px",n.appendChild(s);for(let e in t){const i=this.createElement("a");t[e]instanceof Function&&i.addEventListener("click",(i=>{t[e](),i.preventDefault()})),i.classList.add("ejs_button"),i.innerText=this.localization(e),n.appendChild(i)}return i?n.style.display="none":this.currentPopup=n,r}selectFile(){return new Promise(((e,t)=>{const i=this.createElement("input");i.type="file",this.addEventListener(i,"change",(t=>{e(t.target.files[0])})),i.click()}))}isPopupOpen(){return"none"!==this.cheatMenu.style.display||"none"!==this.netplayMenu.style.display||"none"!==this.controlMenu.style.display||null!==this.currentPopup}isChild(e,t){if(!e||!t)return!1;const i=9===e.nodeType?e.documentElement:e;return e===t||(i.contains?i.contains(t):e.compareDocumentPosition&&16&e.compareDocumentPosition(t))}createBottomMenuBar(){this.elements.menu=this.createElement("div"),this.elements.menu.style.opacity=0,this.on("start",(e=>{this.elements.menu.style.opacity=""})),this.elements.menu.classList.add("ejs_menu_bar"),this.elements.menu.classList.add("ejs_menu_bar_hidden");let e=null,t=!1;const i=()=>{this.paused||this.settingsMenuOpen||this.disksMenuOpen||this.elements.menu.classList.add("ejs_menu_bar_hidden")},n=()=>{clearTimeout(e),e=setTimeout(i,3e3),this.elements.menu.classList.remove("ejs_menu_bar_hidden")};let o;this.menu={close:()=>{clearTimeout(e),this.elements.menu.classList.add("ejs_menu_bar_hidden")},open:t=>{(this.started||!0===t)&&(clearTimeout(e),!0!==t&&(e=setTimeout(i,3e3)),this.elements.menu.classList.remove("ejs_menu_bar_hidden"))},toggle:()=>{this.started&&(clearTimeout(e),this.elements.menu.classList.contains("ejs_menu_bar_hidden")&&(e=setTimeout(i,3e3)),this.elements.menu.classList.toggle("ejs_menu_bar_hidden"))}},this.createBottomMenuBarListeners=()=>{const e=e=>{"touch"!==e.pointerType&&this.started&&!t&&document.pointerLockElement!==this.canvas&&(this.isPopupOpen()||n())},i=e=>{if(!this.started||t||document.pointerLockElement===this.canvas)return;if(this.isPopupOpen())return;const i=e.movementX,o=e.movementY,r=this.elements.menu.offsetHeight+30;if(e.clientY>=window.innerHeight-r)return void n();let s=Math.atan2(o,i)*(180/Math.PI);s<0&&(s+=360),s<85||s>95||n()};this.menu.mousemoveListener&&this.removeEventListener(this.menu.mousemoveListener),"downward"===(this.preGetSetting("menubarBehavior")||"downward")?this.menu.mousemoveListener=this.addEventListener(this.elements.parent,"mousemove",i):this.menu.mousemoveListener=this.addEventListener(this.elements.parent,"mousemove",e),this.addEventListener(this.elements.parent,"click",e)},this.createBottomMenuBarListeners(),this.elements.parent.appendChild(this.elements.menu),this.addEventListener(this.elements.parent,"mousedown touchstart",(e=>{if(this.isChild(this.elements.menu,e.target)||this.isChild(this.elements.menuToggle,e.target))return;if(!this.started||this.elements.menu.classList.contains("ejs_menu_bar_hidden")||this.isPopupOpen())return;this.elements.parent.getBoundingClientRect().width>575||(clearTimeout(o),o=setTimeout((()=>{t=!1}),2e3),t=!0,this.menu.close())}));let r=!1;const s=(e,t,i,n)=>{const o=this.createElement("button");o.type="button";const s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("role","presentation"),s.setAttribute("focusable","false"),s.innerHTML=e.icon;const a=this.createElement("span");return a.innerText=this.localization(e.displayName),r&&a.classList.add("ejs_menu_text_right"),a.classList.add("ejs_menu_text"),o.classList.add("ejs_menu_button"),o.appendChild(s),o.appendChild(a),i?i.appendChild(o):this.elements.menu.appendChild(o),t instanceof Function&&this.addEventListener(o,"click",t),e.callback instanceof Function&&this.addEventListener(o,"click",e.callback),n?[o,s,a]:o},a=s(this.config.buttonOpts.restart,(()=>{this.isNetplay&&this.netplay.owner?(this.gameManager.restart(),this.netplay.reset(),this.netplay.sendMessage({restart:!0}),this.play()):this.isNetplay||this.gameManager.restart()})),l=s(this.config.buttonOpts.pause,(()=>{this.isNetplay&&this.netplay.owner?(this.pause(),this.gameManager.saveSaveFiles(),this.netplay.sendMessage({pause:!0})):this.isNetplay||this.pause()})),c=s(this.config.buttonOpts.play,(()=>{this.isNetplay&&this.netplay.owner?(this.play(),this.netplay.sendMessage({play:!0})):this.isNetplay||this.play()}));let d;c.style.display="none",this.togglePlaying=e=>{this.paused=!this.paused,e||(this.paused?(l.style.display="none",c.style.display=""):(l.style.display="",c.style.display="none")),this.gameManager.toggleMainLoop(this.paused?0:1),this.enableMouseLock&&(this.canvas.exitPointerLock?this.canvas.exitPointerLock():this.canvas.mozExitPointerLock&&this.canvas.mozExitPointerLock())},this.play=e=>{this.paused&&this.togglePlaying(e)},this.pause=e=>{this.paused||this.togglePlaying(e)};const u=s(this.config.buttonOpts.saveState,(async()=>{let e;try{e=this.gameManager.getState()}catch(e){return void this.displayMessage(this.localization("FAILED TO SAVE STATE"))}const{screenshot:t,format:i}=await this.takeScreenshot(this.capture.photo.source,this.capture.photo.format,this.capture.photo.upscale);if(!(this.callEvent("saveState",{screenshot:t,format:i,state:e})>0))if(d&&URL.revokeObjectURL(d),"browser"===this.getSettingValue("save-state-location")&&this.saveInBrowserSupported())this.storage.states.put(this.getBaseFileName()+".state",e),this.displayMessage(this.localization("SAVE SAVED TO BROWSER"));else{const t=new Blob([e]);d=URL.createObjectURL(t);const i=this.createElement("a");i.href=d,i.download=this.getBaseFileName()+".state",i.click()}})),g=s(this.config.buttonOpts.loadState,(async()=>{if(!(this.callEvent("loadState")>0))if("browser"===this.getSettingValue("save-state-location")&&this.saveInBrowserSupported())this.storage.states.get(this.getBaseFileName()+".state").then((e=>{this.gameManager.loadState(e),this.displayMessage(this.localization("SAVE LOADED FROM BROWSER"))}));else{const e=await this.selectFile(),t=new Uint8Array(await e.arrayBuffer());this.gameManager.loadState(t)}})),h=s(this.config.buttonOpts.gamepad,(()=>{this.controlMenu.style.display=""})),p=s(this.config.buttonOpts.cheat,(()=>{this.cheatMenu.style.display=""})),m=s(this.config.buttonOpts.cacheManager,(()=>{this.openCacheMenu()}));let f;this.config.disableDatabases&&(m.style.display="none");const b=s(this.config.buttonOpts.saveSavFiles,(async()=>{const e=await this.gameManager.getSaveFile(),{screenshot:t,format:i}=await this.takeScreenshot(this.capture.photo.source,this.capture.photo.format,this.capture.photo.upscale);if(this.callEvent("saveSave",{screenshot:t,format:i,save:e})>0)return;const n=new Blob([e]);f=URL.createObjectURL(n);const o=this.createElement("a");o.href=f,o.download=this.gameManager.getSaveFilePath().split("/").pop(),o.click()})),C=s(this.config.buttonOpts.loadSavFiles,(async()=>{if(this.callEvent("loadSave")>0)return;const e=await this.selectFile(),t=new Uint8Array(await e.arrayBuffer()),i=this.gameManager.getSaveFilePath(),n=i.split("/");let o="";for(let e=0;e<n.length-1;e++)""!==n[e]&&(o+="/"+n[e],this.gameManager.FS.analyzePath(o).exists||this.gameManager.FS.mkdir(o));this.gameManager.FS.analyzePath(i).exists&&this.gameManager.FS.unlink(i),this.gameManager.FS.writeFile(i,t),this.gameManager.loadSaveFiles()})),I=s(this.config.buttonOpts.netplay,(async()=>{this.openNetplayMenu()}));if(this.config.buttonOpts)for(const[e,t]of Object.entries(this.config.buttonOpts))if(!0===t.custom){s(t)}const y=this.createElement("span");y.classList.add("ejs_menu_bar_spacer"),this.elements.menu.appendChild(y),r=!0;const v=this.createElement("div");v.classList.add("ejs_volume_parent");const Z=s(this.config.buttonOpts.mute,(()=>{Z.style.display="none",S.style.display="",this.muted=!0,this.setVolume(0)}),v),S=s(this.config.buttonOpts.unmute,(()=>{0===this.volume&&(this.volume=.5),Z.style.display="",S.style.display="none",this.muted=!1,this.setVolume(this.volume)}),v);S.style.display="none";const V=this.createElement("input");V.setAttribute("data-range","volume"),V.setAttribute("type","range"),V.setAttribute("min",0),V.setAttribute("max",1),V.setAttribute("step",.01),V.setAttribute("autocomplete","off"),V.setAttribute("role","slider"),V.setAttribute("aria-label","Volume"),V.setAttribute("aria-valuemin",0),V.setAttribute("aria-valuemax",100),this.setVolume=e=>{this.saveSettings(),this.muted=0===e,V.value=e,V.setAttribute("aria-valuenow",100*e),V.setAttribute("aria-valuetext",(100*e).toFixed(1)+"%"),V.setAttribute("style","--value: "+100*e+"%;margin-left: 5px;position: relative;z-index: 2;"),this.Module.AL&&this.Module.AL.currentCtx&&this.Module.AL.currentCtx.sources&&this.Module.AL.currentCtx.sources.forEach((t=>{t.gain.gain.value=e})),this.config.buttonOpts&&!1===this.config.buttonOpts.mute||(S.style.display=0===e?"":"none",Z.style.display=0===e?"none":"")},this.addEventListener(V,"change mousemove touchmove mousedown touchstart mouseup",(e=>{setTimeout((()=>{const e=parseFloat(V.value);0===e&&this.muted||(this.volume=e,this.setVolume(this.volume))}),5)})),this.config.buttonOpts&&!1===this.config.buttonOpts.volume||v.appendChild(V),this.elements.menu.appendChild(v);const w=s(this.config.buttonOpts.contextMenu,(()=>{"none"===this.elements.contextmenu.style.display?(this.elements.contextmenu.style.display="block",this.elements.contextmenu.style.left=getComputedStyle(this.elements.parent).width.split("px")[0]/2-getComputedStyle(this.elements.contextmenu).width.split("px")[0]/2+"px",this.elements.contextmenu.style.top=getComputedStyle(this.elements.parent).height.split("px")[0]/2-getComputedStyle(this.elements.contextmenu).height.split("px")[0]/2+"px",setTimeout(this.menu.close.bind(this),20)):this.elements.contextmenu.style.display="none"}));this.diskParent=this.createElement("div"),this.diskParent.id="ejs_disksMenu",this.disksMenuOpen=!1;const B=s(this.config.buttonOpts.diskButton,(()=>{this.disksMenuOpen=!this.disksMenuOpen,B[1].classList.toggle("ejs_svg_rotate",this.disksMenuOpen),this.disksMenu.style.display=this.disksMenuOpen?"":"none",B[2].classList.toggle("ejs_disks_text",this.disksMenuOpen)}),this.diskParent,!0);this.elements.menu.appendChild(this.diskParent),this.closeDisksMenu=()=>{this.disksMenu&&(this.disksMenuOpen=!1,B[1].classList.toggle("ejs_svg_rotate",this.disksMenuOpen),B[2].classList.toggle("ejs_disks_text",this.disksMenuOpen),this.disksMenu.style.display="none")},this.addEventListener(this.elements.parent,"mousedown touchstart",(e=>{this.isChild(this.disksMenu,e.target)||"touch"!==e.pointerType&&e.target!==B[0]&&e.target!==B[2]&&this.closeDisksMenu()})),this.settingParent=this.createElement("div"),this.settingsMenuOpen=!1;const A=s(this.config.buttonOpts.settings,(()=>{this.settingsMenuOpen=!this.settingsMenuOpen,A[1].classList.toggle("ejs_svg_rotate",this.settingsMenuOpen),this.settingsMenu.style.display=this.settingsMenuOpen?"":"none",A[2].classList.toggle("ejs_settings_text",this.settingsMenuOpen)}),this.settingParent,!0);this.elements.menu.appendChild(this.settingParent),this.closeSettingsMenu=()=>{this.settingsMenu&&(this.settingsMenuOpen=!1,A[1].classList.toggle("ejs_svg_rotate",this.settingsMenuOpen),A[2].classList.toggle("ejs_settings_text",this.settingsMenuOpen),this.settingsMenu.style.display="none")},this.addEventListener(this.elements.parent,"mousedown touchstart",(e=>{this.isChild(this.settingsMenu,e.target)||"touch"!==e.pointerType&&e.target!==A[0]&&e.target!==A[2]&&this.closeSettingsMenu()})),this.addEventListener(this.canvas,"click",(e=>{"touch"!==e.pointerType&&this.enableMouseLock&&!this.paused&&(this.canvas.requestPointerLock?this.canvas.requestPointerLock():this.canvas.mozRequestPointerLock&&this.canvas.mozRequestPointerLock(),this.menu.close())}));const E=s(this.config.buttonOpts.enterFullscreen,(()=>{this.toggleFullscreen(!0)})),U=s(this.config.buttonOpts.exitFullscreen,(()=>{this.toggleFullscreen(!1)}));U.style.display="none",this.toggleFullscreen=e=>{if(e){if(this.elements.parent.requestFullscreen?this.elements.parent.requestFullscreen():this.elements.parent.mozRequestFullScreen?this.elements.parent.mozRequestFullScreen():this.elements.parent.webkitRequestFullscreen?this.elements.parent.webkitRequestFullscreen():this.elements.parent.msRequestFullscreen&&this.elements.parent.msRequestFullscreen(),U.style.display="",E.style.display="none",this.isMobile)try{screen.orientation.lock("nds"===this.getCore(!0)?"portrait":"landscape").catch((e=>{}))}catch(e){}}else if(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),U.style.display="none",E.style.display="",this.isMobile)try{screen.orientation.unlock()}catch(e){}};let N=!1;const k=s(this.config.buttonOpts.exitEmulation,(async()=>{if(N)return;N=!0;const e=this.createSubPopup();this.game.appendChild(e[0]),e[1].classList.add("ejs_cheat_parent"),e[1].style.width="100%";const t=e[1],i=this.createElement("div");i.classList.add("ejs_cheat_header");const n=this.createElement("h2");n.innerText=this.localization("Are you sure you want to exit?"),n.classList.add("ejs_cheat_heading");const o=this.createElement("button");o.classList.add("ejs_cheat_close"),i.appendChild(n),i.appendChild(o),t.appendChild(i),this.addEventListener(o,"click",(t=>{N=!1,e[0].remove()})),t.appendChild(this.createElement("br"));const r=this.createElement("footer"),s=this.createElement("button"),a=this.createElement("button");s.innerText=this.localization("Exit"),a.innerText=this.localization("Cancel"),s.classList.add("ejs_button_button"),a.classList.add("ejs_button_button"),s.classList.add("ejs_popup_submit"),a.classList.add("ejs_popup_submit"),s.style["background-color"]="rgba(var(--ejs-primary-color),1)",r.appendChild(s);const l=this.createElement("span");l.innerText=" ",r.appendChild(l),r.appendChild(a),t.appendChild(r),this.addEventListener(a,"click",(t=>{e[0].remove(),N=!1})),this.addEventListener(s,"click",(t=>{e[0].remove();this.createPopup("EmulatorJS has exited",{});this.callEvent("exit")})),setTimeout(this.menu.close.bind(this),20)}));this.addEventListener(document,"webkitfullscreenchange mozfullscreenchange fullscreenchange",(e=>{e.target===this.elements.parent&&(null===document.fullscreenElement?(U.style.display="none",E.style.display=""):(U.style.display="",E.style.display="none"))}));!!(this.elements.parent.requestFullscreen||this.elements.parent.mozRequestFullScreen||this.elements.parent.webkitRequestFullscreen||this.elements.parent.msRequestFullscreen)||(U.style.display="none",E.style.display="none"),this.elements.bottomBar={playPause:[l,c],restart:[a],settings:[A],contextMenu:[w],fullscreen:[E,U],saveState:[u],loadState:[g],gamepad:[h],cheat:[p],cacheManager:[m],saveSavFiles:[b],loadSavFiles:[C],netplay:[I],exit:[k]},this.config.buttonOpts&&(this.debug&&console.log(this.config.buttonOpts),!1===this.config.buttonOpts.playPause.visible&&(l.style.display="none",c.style.display="none"),!1===this.config.buttonOpts.contextMenuButton&&!1!==this.config.buttonOpts.rightClick&&!1===this.isMobile&&(w.style.display="none"),!1===this.config.buttonOpts.restart.visible&&(a.style.display="none"),!1===this.config.buttonOpts.settings.visible&&(A[0].style.display="none"),!1===this.config.buttonOpts.fullscreen.visible&&(E.style.display="none",U.style.display="none"),!1===this.config.buttonOpts.mute.visible&&(Z.style.display="none",S.style.display="none"),!1===this.config.buttonOpts.saveState.visible&&(u.style.display="none"),!1===this.config.buttonOpts.loadState.visible&&(g.style.display="none"),!1===this.config.buttonOpts.saveSavFiles.visible&&(b.style.display="none"),!1===this.config.buttonOpts.loadSavFiles.visible&&(C.style.display="none"),!1===this.config.buttonOpts.gamepad.visible&&(h.style.display="none"),!1===this.config.buttonOpts.cheat.visible&&(p.style.display="none"),!1===this.config.buttonOpts.cacheManager.visible&&(m.style.display="none"),!1===this.config.buttonOpts.netplay.visible&&(I.style.display="none"),!1===this.config.buttonOpts.diskButton.visible&&(B[0].style.display="none"),!1===this.config.buttonOpts.volumeSlider.visible&&(V.style.display="none"),!1===this.config.buttonOpts.exitEmulation.visible&&(k.style.display="none")),this.menu.failedToStart=()=>{this.config.buttonOpts||(this.config.buttonOpts={}),this.config.buttonOpts.mute=!1,A[0].style.display="",l.style.display="none",c.style.display="none",w.style.display="none",a.style.display="none",E.style.display="none",U.style.display="none",Z.style.display="none",S.style.display="none",u.style.display="none",g.style.display="none",b.style.display="none",C.style.display="none",h.style.display="none",p.style.display="none",m.style.display="none",I.style.display="none",B[0].style.display="none",V.style.display="none",k.style.display="none",this.elements.menu.style.opacity="",this.elements.menu.style.background="transparent",this.virtualGamepad.style.display="none",A[0].classList.add("shadow"),this.menu.open(!0)}}openCacheMenu(){(async()=>{const e=this.createElement("table"),t=this.createElement("tbody"),i=this.createPopup("Cache Manager",{"Clear All":async()=>{const e=await this.storage.rom.getSizes();for(const t in e)await this.storage.rom.remove(t);t.innerHTML=""},Close:()=>{this.closePopup()}}),n=await this.storage.rom.getSizes();e.style.width="100%",e.style["padding-left"]="10px",e.style["text-align"]="left",i.appendChild(e),e.appendChild(t);const o=function(e){let t=-1;do{e/=1024,t++}while(e>1024);return Math.max(e,.1).toFixed(1)+[" kB"," MB"," GB"," TB","PB","EB","ZB","YB"][t]};for(const e in n){const i=this.createElement("tr"),r=this.createElement("td"),s=this.createElement("td"),a=this.createElement("td");a.style.cursor="pointer",r.innerText=e,s.innerText=o(n[e]);const l=this.createElement("a");l.innerText=this.localization("Remove"),this.addEventListener(a,"click",(()=>{this.storage.rom.remove(e),i.remove()})),a.appendChild(l),i.appendChild(r),i.appendChild(s),i.appendChild(a),t.appendChild(i)}})()}getControlScheme(){return this.config.controlScheme&&"string"==typeof this.config.controlScheme?this.config.controlScheme:this.getCore(!0)}createControlSettingMenu(){let e=[];this.checkGamepadInputs=()=>e.forEach((e=>e())),this.gamepadLabels=[],this.gamepadSelection=[],this.controls=JSON.parse(JSON.stringify(this.defaultControllers));const t=this.createPopup("Control Settings",{Reset:()=>{this.controls=JSON.parse(JSON.stringify(this.defaultControllers)),this.setupKeys(),this.checkGamepadInputs(),this.saveSettings()},Clear:()=>{this.controls={0:{},1:{},2:{},3:{}},this.setupKeys(),this.checkGamepadInputs(),this.saveSettings()},Close:()=>{this.controlMenu.style.display="none"}},!0);let i;if(this.setupKeys(),this.controlMenu=t.parentElement,t.classList.add("ejs_control_body"),"gb"===this.getControlScheme()?i=[{id:8,label:this.localization("A")},{id:0,label:this.localization("B")},{id:2,label:this.localization("SELECT")},{id:3,label:this.localization("START")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"nes"===this.getControlScheme()?(i=[{id:8,label:this.localization("A")},{id:0,label:this.localization("B")},{id:9,label:this.localization("X")},{id:1,label:this.localization("Y")},{id:2,label:this.localization("SELECT")},{id:3,label:this.localization("START")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}],"nestopia"===this.getCore()?i.push({id:10,label:this.localization("SWAP DISKS")}):(i.push({id:10,label:this.localization("SWAP DISKS")}),i.push({id:11,label:this.localization("EJECT/INSERT DISK")}))):i="snes"===this.getControlScheme()?[{id:8,label:this.localization("A")},{id:0,label:this.localization("B")},{id:9,label:this.localization("X")},{id:1,label:this.localization("Y")},{id:2,label:this.localization("SELECT")},{id:3,label:this.localization("START")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")},{id:10,label:this.localization("L")},{id:11,label:this.localization("R")}]:"n64"===this.getControlScheme()?[{id:0,label:this.localization("A")},{id:1,label:this.localization("B")},{id:3,label:this.localization("START")},{id:4,label:this.localization("D-PAD UP")},{id:5,label:this.localization("D-PAD DOWN")},{id:6,label:this.localization("D-PAD LEFT")},{id:7,label:this.localization("D-PAD RIGHT")},{id:10,label:this.localization("L")},{id:11,label:this.localization("R")},{id:12,label:this.localization("Z")},{id:19,label:this.localization("STICK UP")},{id:18,label:this.localization("STICK DOWN")},{id:17,label:this.localization("STICK LEFT")},{id:16,label:this.localization("STICK RIGHT")},{id:23,label:this.localization("C-PAD UP")},{id:22,label:this.localization("C-PAD DOWN")},{id:21,label:this.localization("C-PAD LEFT")},{id:20,label:this.localization("C-PAD RIGHT")}]:"gba"===this.getControlScheme()?[{id:8,label:this.localization("A")},{id:0,label:this.localization("B")},{id:10,label:this.localization("L")},{id:11,label:this.localization("R")},{id:2,label:this.localization("SELECT")},{id:3,label:this.localization("START")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"nds"===this.getControlScheme()?[{id:8,label:this.localization("A")},{id:0,label:this.localization("B")},{id:9,label:this.localization("X")},{id:1,label:this.localization("Y")},{id:2,label:this.localization("SELECT")},{id:3,label:this.localization("START")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")},{id:10,label:this.localization("L")},{id:11,label:this.localization("R")},{id:14,label:this.localization("Microphone")}]:"vb"===this.getControlScheme()?[{id:8,label:this.localization("A")},{id:0,label:this.localization("B")},{id:10,label:this.localization("L")},{id:11,label:this.localization("R")},{id:2,label:this.localization("SELECT")},{id:3,label:this.localization("START")},{id:4,label:this.localization("LEFT D-PAD UP")},{id:5,label:this.localization("LEFT D-PAD DOWN")},{id:6,label:this.localization("LEFT D-PAD LEFT")},{id:7,label:this.localization("LEFT D-PAD RIGHT")},{id:19,label:this.localization("RIGHT D-PAD UP")},{id:18,label:this.localization("RIGHT D-PAD DOWN")},{id:17,label:this.localization("RIGHT D-PAD LEFT")},{id:16,label:this.localization("RIGHT D-PAD RIGHT")}]:["segaCD","sega32x"].includes(this.getControlScheme())?[{id:1,label:this.localization("A")},{id:0,label:this.localization("B")},{id:8,label:this.localization("C")},{id:10,label:this.localization("X")},{id:9,label:this.localization("Y")},{id:11,label:this.localization("Z")},{id:3,label:this.localization("START")},{id:2,label:this.localization("MODE")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"segaMS"===this.getControlScheme()?[{id:0,label:this.localization("BUTTON 1 / START")},{id:8,label:this.localization("BUTTON 2")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"segaGG"===this.getControlScheme()?[{id:0,label:this.localization("BUTTON 1")},{id:8,label:this.localization("BUTTON 2")},{id:3,label:this.localization("START")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"segaSaturn"===this.getControlScheme()?[{id:1,label:this.localization("A")},{id:0,label:this.localization("B")},{id:8,label:this.localization("C")},{id:9,label:this.localization("X")},{id:10,label:this.localization("Y")},{id:11,label:this.localization("Z")},{id:12,label:this.localization("L")},{id:13,label:this.localization("R")},{id:3,label:this.localization("START")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"3do"===this.getControlScheme()?[{id:1,label:this.localization("A")},{id:0,label:this.localization("B")},{id:8,label:this.localization("C")},{id:10,label:this.localization("L")},{id:11,label:this.localization("R")},{id:2,label:this.localization("X")},{id:3,label:this.localization("P")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"atari2600"===this.getControlScheme()?[{id:0,label:this.localization("FIRE")},{id:2,label:this.localization("SELECT")},{id:3,label:this.localization("RESET")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")},{id:10,label:this.localization("LEFT DIFFICULTY A")},{id:12,label:this.localization("LEFT DIFFICULTY B")},{id:11,label:this.localization("RIGHT DIFFICULTY A")},{id:13,label:this.localization("RIGHT DIFFICULTY B")},{id:14,label:this.localization("COLOR")},{id:15,label:this.localization("B/W")}]:"atari7800"===this.getControlScheme()?[{id:0,label:this.localization("BUTTON 1")},{id:8,label:this.localization("BUTTON 2")},{id:2,label:this.localization("SELECT")},{id:3,label:this.localization("PAUSE")},{id:9,label:this.localization("RESET")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")},{id:10,label:this.localization("LEFT DIFFICULTY")},{id:11,label:this.localization("RIGHT DIFFICULTY")}]:"lynx"===this.getControlScheme()?[{id:8,label:this.localization("A")},{id:0,label:this.localization("B")},{id:10,label:this.localization("OPTION 1")},{id:11,label:this.localization("OPTION 2")},{id:3,label:this.localization("START")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"jaguar"===this.getControlScheme()?[{id:8,label:this.localization("A")},{id:0,label:this.localization("B")},{id:1,label:this.localization("C")},{id:2,label:this.localization("PAUSE")},{id:3,label:this.localization("OPTION")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"pce"===this.getControlScheme()?[{id:8,label:this.localization("I")},{id:0,label:this.localization("II")},{id:2,label:this.localization("SELECT")},{id:3,label:this.localization("RUN")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"ngp"===this.getControlScheme()?[{id:0,label:this.localization("A")},{id:8,label:this.localization("B")},{id:3,label:this.localization("OPTION")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"ws"===this.getControlScheme()?[{id:8,label:this.localization("A")},{id:0,label:this.localization("B")},{id:3,label:this.localization("START")},{id:4,label:this.localization("X UP")},{id:5,label:this.localization("X DOWN")},{id:6,label:this.localization("X LEFT")},{id:7,label:this.localization("X RIGHT")},{id:13,label:this.localization("Y UP")},{id:12,label:this.localization("Y DOWN")},{id:10,label:this.localization("Y LEFT")},{id:11,label:this.localization("Y RIGHT")}]:"coleco"===this.getControlScheme()?[{id:8,label:this.localization("LEFT BUTTON")},{id:0,label:this.localization("RIGHT BUTTON")},{id:9,label:this.localization("1")},{id:1,label:this.localization("2")},{id:11,label:this.localization("3")},{id:10,label:this.localization("4")},{id:13,label:this.localization("5")},{id:12,label:this.localization("6")},{id:15,label:this.localization("7")},{id:14,label:this.localization("8")},{id:2,label:this.localization("*")},{id:3,label:this.localization("#")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"pcfx"===this.getControlScheme()?[{id:8,label:this.localization("I")},{id:0,label:this.localization("II")},{id:9,label:this.localization("III")},{id:1,label:this.localization("IV")},{id:10,label:this.localization("V")},{id:11,label:this.localization("VI")},{id:3,label:this.localization("RUN")},{id:2,label:this.localization("SELECT")},{id:12,label:this.localization("MODE1")},{id:13,label:this.localization("MODE2")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")}]:"psp"===this.getControlScheme()?[{id:9,label:this.localization("")},{id:1,label:this.localization("")},{id:0,label:this.localization("")},{id:8,label:this.localization("")},{id:2,label:this.localization("SELECT")},{id:3,label:this.localization("START")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")},{id:10,label:this.localization("L")},{id:11,label:this.localization("R")},{id:19,label:this.localization("STICK UP")},{id:18,label:this.localization("STICK DOWN")},{id:17,label:this.localization("STICK LEFT")},{id:16,label:this.localization("STICK RIGHT")}]:[{id:0,label:this.localization("B")},{id:1,label:this.localization("Y")},{id:2,label:this.localization("SELECT")},{id:3,label:this.localization("START")},{id:4,label:this.localization("UP")},{id:5,label:this.localization("DOWN")},{id:6,label:this.localization("LEFT")},{id:7,label:this.localization("RIGHT")},{id:8,label:this.localization("A")},{id:9,label:this.localization("X")},{id:10,label:this.localization("L")},{id:11,label:this.localization("R")},{id:12,label:this.localization("L2")},{id:13,label:this.localization("R2")},{id:14,label:this.localization("L3")},{id:15,label:this.localization("R3")},{id:19,label:this.localization("L STICK UP")},{id:18,label:this.localization("L STICK DOWN")},{id:17,label:this.localization("L STICK LEFT")},{id:16,label:this.localization("L STICK RIGHT")},{id:23,label:this.localization("R STICK UP")},{id:22,label:this.localization("R STICK DOWN")},{id:21,label:this.localization("R STICK LEFT")},{id:20,label:this.localization("R STICK RIGHT")}],["arcade","mame"].includes(this.getControlScheme()))for(const e in i)2===i[e].id&&(i[e].label=this.localization("INSERT COIN"));i.push({id:24,label:this.localization("QUICK SAVE STATE")},{id:25,label:this.localization("QUICK LOAD STATE")},{id:26,label:this.localization("CHANGE STATE SLOT")},{id:27,label:this.localization("FAST FORWARD")},{id:29,label:this.localization("SLOW MOTION")},{id:28,label:this.localization("REWIND")});let n,o=[];for(let e=0;e<i.length;e++)o.push(i[e].id);for(let e=0;e<30;e++)o.includes(e)||(delete this.defaultControllers[0][e],delete this.defaultControllers[1][e],delete this.defaultControllers[2][e],delete this.defaultControllers[3][e],delete this.controls[0][e],delete this.controls[1][e],delete this.controls[2][e],delete this.controls[3][e]);let r=[],s=[];const a=this.createElement("ul");a.classList.add("ejs_control_player_bar");for(let e=1;e<5;e++){const t=this.createElement("li");t.classList.add("tabs-title"),t.setAttribute("role","presentation");const i=this.createElement("a");i.innerText=this.localization("Player")+" "+e,i.setAttribute("role","tab"),i.setAttribute("aria-controls","controls-"+(e-1)),i.setAttribute("aria-selected","false"),i.id="controls-"+(e-1)+"-label",this.addEventListener(i,"click",(t=>{t.preventDefault(),r[n].classList.remove("ejs_control_selected"),s[n].setAttribute("hidden",""),n=e-1,r[e-1].classList.add("ejs_control_selected"),s[e-1].removeAttribute("hidden")})),t.appendChild(i),a.appendChild(t),r.push(t)}t.appendChild(a);const l=this.createElement("div");for(let t=0;t<4;t++){this.controls[t]||(this.controls[t]={});const n=this.createElement("div"),o=this.createElement("div"),r=this.createElement("div");r.innerText=this.localization("Connected Gamepad")+": ";const a=this.createElement("select");a.classList.add("ejs_gamepad_dropdown"),a.setAttribute("title","gamepad-"+t),a.setAttribute("index",t),this.gamepadLabels.push(a),this.gamepadSelection.push(""),this.addEventListener(a,"change",(e=>{const t=e.target.value,i=parseInt(e.target.getAttribute("index"));if("notconnected"===t)this.gamepadSelection[i]="";else{for(let e=0;e<this.gamepadSelection.length;e++)i!==e&&this.gamepadSelection[e]===t&&(this.gamepadSelection[e]="");this.gamepadSelection[i]=t,this.updateGamepadLabels()}}));const c=this.createElement("option");c.setAttribute("value","notconnected"),c.innerText="Not Connected",a.appendChild(c),r.appendChild(a),r.classList.add("ejs_gamepad_section");const d=this.createElement("div");d.style="width:25%;float:left;",d.innerHTML="&nbsp;";const u=this.createElement("div");u.style="font-size:12px;width:50%;float:left;";const g=this.createElement("div");g.style="text-align:center;width:50%;float:left;",g.innerText=this.localization("Gamepad"),u.appendChild(g);const h=this.createElement("div");h.style="text-align:center;width:50%;float:left;",h.innerText=this.localization("Keyboard"),u.appendChild(h);const p=this.createElement("div");if(p.style="clear:both;",o.appendChild(r),o.appendChild(d),o.appendChild(u),(this.touch||this.hasTouchScreen)&&0===t){const e=this.createElement("div");e.style="width:25%;float:right;clear:none;padding:0;font-size: 11px;padding-left: 2.25rem;",e.classList.add("ejs_control_row"),e.classList.add("ejs_cheat_row");const t=this.createElement("input");t.type="checkbox",t.checked=!0,t.value="o",t.id="ejs_vp",e.appendChild(t);const i=this.createElement("label");i.for="ejs_vp",i.innerText="Virtual Gamepad",e.appendChild(i),i.addEventListener("click",(e=>{t.checked=!t.checked,this.changeSettingOption("virtual-gamepad",t.checked?"enabled":"disabled")})),this.on("start",(e=>{"disabled"===this.getSettingValue("virtual-gamepad")&&(t.checked=!1)})),o.appendChild(e)}o.appendChild(p),n.appendChild(o);for(const o in i){const r=i[o].id,s=i[o].label,a=this.createElement("div");a.setAttribute("data-id",r),a.setAttribute("data-index",t),a.setAttribute("data-label",s),a.style="margin-bottom:10px;",a.classList.add("ejs_control_bar");const l=this.createElement("div");l.style="width:25%;float:left;font-size:12px;";const c=this.createElement("label");c.innerText=s+":",l.appendChild(c);const d=this.createElement("div");d.style="width:50%;float:left;";const u=this.createElement("div");u.style="width:50%;float:left;padding: 0 5px;";const g=this.createElement("input");g.style="text-align:center;height:25px;width: 100%;",g.type="text",g.setAttribute("readonly",""),g.setAttribute("placeholder",""),u.appendChild(g);const h=this.createElement("div");h.style="width:50%;float:left;padding: 0 5px;";const p=this.createElement("input");if(p.style="text-align:center;height:25px;width: 100%;",p.type="text",p.setAttribute("readonly",""),p.setAttribute("placeholder",""),h.appendChild(p),e.push((()=>{if(p.value="",g.value="",this.controls[t][r]&&void 0!==this.controls[t][r].value){let e=this.keyMap[this.controls[t][r].value];e=this.localization(e),p.value=e}if(this.controls[t][r]&&void 0!==this.controls[t][r].value2&&""!==this.controls[t][r].value2){let e=this.controls[t][r].value2.toString();e.includes(":")?(e=e.split(":"),e=this.localization(e[0])+":"+this.localization(e[1])):e=isNaN(e)?this.localization(e):this.localization("BUTTON")+" "+this.localization(e),g.value=e}})),this.controls[t][r]&&this.controls[t][r].value){let e=this.keyMap[this.controls[t][r].value];e=this.localization(e),p.value=e}if(this.controls[t][r]&&this.controls[t][r].value2){let e=this.controls[t][r].value2.toString();e.includes(":")?(e=e.split(":"),e=this.localization(e[0])+":"+this.localization(e[1])):e=isNaN(e)?this.localization(e):this.localization("BUTTON")+" "+this.localization(e),g.value=e}d.appendChild(u),d.appendChild(h);const m=this.createElement("div");m.style="clear:both;",d.appendChild(m);const f=this.createElement("div");f.style="width:25%;float:left;";const b=this.createElement("a");b.classList.add("ejs_control_set_button"),b.innerText=this.localization("Set"),f.appendChild(b);const C=this.createElement("div");C.style="clear:both;",a.appendChild(l),a.appendChild(d),a.appendChild(f),a.appendChild(C),n.appendChild(a),this.addEventListener(a,"mousedown",(e=>{e.preventDefault(),this.controlPopup.parentElement.parentElement.removeAttribute("hidden"),this.controlPopup.innerText="[ "+s+" ]\n"+this.localization("Press Keyboard"),this.controlPopup.setAttribute("button-num",r),this.controlPopup.setAttribute("player-num",t)}))}l.appendChild(n),n.setAttribute("hidden",""),s.push(n)}t.appendChild(l),n=0,r[0].classList.add("ejs_control_selected"),s[0].removeAttribute("hidden");const c=this.createElement("div");c.classList.add("ejs_popup_container");const d=this.createElement("div");this.addEventListener(c,"mousedown click touchstart",(e=>{this.isChild(d,e.target)||this.controlPopup.parentElement.parentElement.setAttribute("hidden","")}));const u=this.createElement("a");u.classList.add("ejs_control_set_button"),u.innerText=this.localization("Clear"),this.addEventListener(u,"mousedown click touchstart",(e=>{const t=this.controlPopup.getAttribute("button-num"),i=this.controlPopup.getAttribute("player-num");this.controls[i][t]||(this.controls[i][t]={}),this.controls[i][t].value=0,this.controls[i][t].value2="",this.controlPopup.parentElement.parentElement.setAttribute("hidden",""),this.checkGamepadInputs(),this.saveSettings()})),d.classList.add("ejs_popup_box"),d.innerText="",c.setAttribute("hidden","");const g=this.createElement("div");this.controlPopup=g,c.appendChild(d),d.appendChild(g),d.appendChild(this.createElement("br")),d.appendChild(u),this.controlMenu.appendChild(c)}initControlVars(){this.defaultControllers={0:{0:{value:"x",value2:"BUTTON_2"},1:{value:"s",value2:"BUTTON_4"},2:{value:"v",value2:"SELECT"},3:{value:"enter",value2:"START"},4:{value:"up arrow",value2:"DPAD_UP"},5:{value:"down arrow",value2:"DPAD_DOWN"},6:{value:"left arrow",value2:"DPAD_LEFT"},7:{value:"right arrow",value2:"DPAD_RIGHT"},8:{value:"z",value2:"BUTTON_1"},9:{value:"a",value2:"BUTTON_3"},10:{value:"q",value2:"LEFT_TOP_SHOULDER"},11:{value:"e",value2:"RIGHT_TOP_SHOULDER"},12:{value:"tab",value2:"LEFT_BOTTOM_SHOULDER"},13:{value:"r",value2:"RIGHT_BOTTOM_SHOULDER"},14:{value:"",value2:"LEFT_STICK"},15:{value:"",value2:"RIGHT_STICK"},16:{value:"h",value2:"LEFT_STICK_X:+1"},17:{value:"f",value2:"LEFT_STICK_X:-1"},18:{value:"g",value2:"LEFT_STICK_Y:+1"},19:{value:"t",value2:"LEFT_STICK_Y:-1"},20:{value:"l",value2:"RIGHT_STICK_X:+1"},21:{value:"j",value2:"RIGHT_STICK_X:-1"},22:{value:"k",value2:"RIGHT_STICK_Y:+1"},23:{value:"i",value2:"RIGHT_STICK_Y:-1"},24:{value:"1"},25:{value:"2"},26:{value:"3"},27:{},28:{},29:{}},1:{},2:{},3:{}},this.keyMap={0:"",8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause/break",20:"caps lock",27:"escape",32:"space",33:"page up",34:"page down",35:"end",36:"home",37:"left arrow",38:"up arrow",39:"right arrow",40:"down arrow",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"left window key",92:"right window key",93:"select key",96:"numpad 0",97:"numpad 1",98:"numpad 2",99:"numpad 3",100:"numpad 4",101:"numpad 5",102:"numpad 6",103:"numpad 7",104:"numpad 8",105:"numpad 9",106:"multiply",107:"add",109:"subtract",110:"decimal point",111:"divide",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"num lock",145:"scroll lock",186:"semi-colon",187:"equal sign",188:"comma",189:"dash",190:"period",191:"forward slash",192:"grave accent",219:"open bracket",220:"back slash",221:"close braket",222:"single quote"}}setupKeys(){for(let e=0;e<4;e++)for(let t=0;t<30;t++)this.controls[e][t]&&(this.controls[e][t].value=parseInt(this.keyLookup(this.controls[e][t].value)),-1===this.controls[e][t].value&&this.debug&&(delete this.controls[e][t].value,console.warn("Invalid key for control "+t+" player "+e)))}keyLookup(e){if(void 0===e)return 0;if("number"==typeof e)return e;e=e.toString().toLowerCase();const t=Object.values(this.keyMap);if(t.includes(e)){const i=t.indexOf(e);return Object.keys(this.keyMap)[i]}return-1}keyChange(e){if(e.repeat)return;if(!this.started)return;if(null===this.controlPopup.parentElement.parentElement.getAttribute("hidden")){const t=this.controlPopup.getAttribute("button-num"),i=this.controlPopup.getAttribute("player-num");return this.controls[i][t]||(this.controls[i][t]={}),this.controls[i][t].value=e.keyCode,this.controlPopup.parentElement.parentElement.setAttribute("hidden",""),this.checkGamepadInputs(),void this.saveSettings()}if("none"!==this.settingsMenu.style.display||this.isPopupOpen()||"enabled"===this.getSettingValue("keyboardInput"))return;e.preventDefault();const t=[16,17,18,19,20,21,22,23];for(let i=0;i<4;i++)for(let n=0;n<30;n++)if(this.controls[i][n]&&this.controls[i][n].value===e.keyCode){let o=n;"nes"===this.getControlScheme()&&(9===n?o=8:1===n&&(o=0)),this.gameManager.simulateInput(i,o,"keyup"===e.type?0:t.includes(o)?32767:1)}}gamepadEvent(e){if(!this.started)return;const t=this.gamepadSelection.indexOf(this.gamepad.gamepads[e.gamepadIndex].id+"_"+this.gamepad.gamepads[e.gamepadIndex].index);if(t<0)return;const i=function(e){return e>.5||e<-.5?e>0?1:-1:0}(e.value||0);if(null===this.controlPopup.parentElement.parentElement.getAttribute("hidden")){if("buttonup"===e.type||"axischanged"===e.type&&0===i)return;const n=this.controlPopup.getAttribute("button-num"),o=parseInt(this.controlPopup.getAttribute("player-num"));if(t!==o)return;return this.controls[o][n]||(this.controls[o][n]={}),this.controls[o][n].value2=e.label,this.controlPopup.parentElement.parentElement.setAttribute("hidden",""),this.checkGamepadInputs(),void this.saveSettings()}if("none"!==this.settingsMenu.style.display||this.isPopupOpen())return;const n=[16,17,18,19,20,21,22,23];if("nes"!==this.getControlScheme()){for(let o=0;o<4;o++)if(t===o)for(let t=0;t<30;t++){if(!this.controls[o][t]||void 0===this.controls[o][t].value2)continue;const r=this.controls[o][t].value2;!["buttonup","buttondown"].includes(e.type)||r!==e.label&&r!==e.index?"axischanged"===e.type&&"string"==typeof r&&r.split(":")[0]===e.axis&&(n.includes(t)?16===t||17===t?e.value>0?(this.gameManager.simulateInput(o,16,32767*e.value),this.gameManager.simulateInput(o,17,0)):(this.gameManager.simulateInput(o,17,-32767*e.value),this.gameManager.simulateInput(o,16,0)):18===t||19===t?e.value>0?(this.gameManager.simulateInput(o,18,32767*e.value),this.gameManager.simulateInput(o,19,0)):(this.gameManager.simulateInput(o,19,-32767*e.value),this.gameManager.simulateInput(o,18,0)):20===t||21===t?e.value>0?(this.gameManager.simulateInput(o,20,32767*e.value),this.gameManager.simulateInput(o,21,0)):(this.gameManager.simulateInput(o,21,-32767*e.value),this.gameManager.simulateInput(o,20,0)):22!==t&&23!==t||(e.value>0?(this.gameManager.simulateInput(o,22,32767*e.value),this.gameManager.simulateInput(o,23,0)):(this.gameManager.simulateInput(o,23,-32767*e.value),this.gameManager.simulateInput(o,22,0))):0!==i&&r!==e.label&&r!==`${e.axis}:${i}`||this.gameManager.simulateInput(o,t,0===i?0:1)):this.gameManager.simulateInput(o,t,"buttonup"===e.type?0:n.includes(t)?32767:1)}}else for(let i=0;i<4;i++)if(t===i)for(let t=0;t<30;t++){if(!this.controls[i][t]||void 0===this.controls[i][t].value2)continue;const o=this.controls[i][t].value2;let r=t;9===t?r=8:1===t&&(r=0),!["buttonup","buttondown"].includes(e.type)||o!==e.label&&o!==e.index||(9===t||1===t?"buttondown"===e.type?(this.gameManager.simulateInput(i,r,n.includes(r)?32767:1),this.controls[i][t].nesRapidFireInterval&&clearInterval(this.controls[i][t].nesRapidFireInterval),this.controls[i][t].nesRapidFireInterval=setInterval((()=>{this.gameManager.simulateInput(i,r,n.includes(r)?32767:1),setTimeout((()=>{this.gameManager.simulateInput(i,r,0)}),30)}),100)):"buttonup"===e.type&&(this.controls[i][t].nesRapidFireInterval&&(clearInterval(this.controls[i][t].nesRapidFireInterval),this.controls[i][t].nesRapidFireInterval=null),this.gameManager.simulateInput(i,r,0)):this.gameManager.simulateInput(i,r,"buttonup"===e.type?0:n.includes(r)?32767:1))}}setVirtualGamepad(){this.virtualGamepad=this.createElement("div"),this.toggleVirtualGamepad=e=>{this.virtualGamepad.style.display=e?"":"none"},this.virtualGamepad.classList.add("ejs_virtualGamepad_parent"),this.elements.parent.appendChild(this.virtualGamepad);const e=[{type:"button",text:"Fast",id:"speed_fast",location:"center",left:-35,top:50,fontSize:15,block:!0,input_value:27},{type:"button",text:"Slow",id:"speed_slow",location:"center",left:95,top:50,fontSize:15,block:!0,input_value:29}];let t;this.rewindEnabled&&e.push({type:"button",text:"Rewind",id:"speed_rewind",location:"center",left:30,top:50,fontSize:15,block:!0,input_value:28}),this.config.VirtualGamepadSettings&&function(e){if(!Array.isArray(e))return console.warn("Virtual gamepad settings is not array! Using default gamepad settings"),!1;if(!e.length)return console.warn("Virtual gamepad settings is empty! Using default gamepad settings"),!1;for(let t=0;t<e.length;t++)if(e[t].type)try{if("zone"===e[t].type||"dpad"===e[t].type){if(!e[t].location)return console.warn("Missing location value for "+e[t].type+"! Using default gamepad settings"),!1;if(!e[t].inputValues)return console.warn("Missing inputValues for "+e[t].type+"! Using default gamepad settings"),!1;continue}if(!e[t].location)return console.warn("Missing location value for button "+e[t].text+"! Using default gamepad settings"),!1;if(!e[t].type)return console.warn("Missing type value for button "+e[t].text+"! Using default gamepad settings"),!1;if(!e[t].id.toString())return console.warn("Missing id value for button "+e[t].text+"! Using default gamepad settings"),!1;if(!e[t].input_value.toString())return console.warn("Missing input_value for button "+e[t].text+"! Using default gamepad settings"),!1}catch(e){return console.warn("Error checking values! Using default gamepad settings"),!1}return!0}(this.config.VirtualGamepadSettings)?t=this.config.VirtualGamepadSettings:"gba"===this.getControlScheme()?(t=[{type:"button",text:"B",id:"b",location:"right",left:10,top:70,bold:!0,input_value:0},{type:"button",text:"A",id:"a",location:"right",left:81,top:40,bold:!0,input_value:8},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2},{type:"button",text:"L",id:"l",location:"left",left:3,top:-90,bold:!0,block:!0,input_value:10},{type:"button",text:"R",id:"r",location:"right",right:3,top:-90,bold:!0,block:!0,input_value:11}],t.push(...e)):"gb"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",left:81,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:10,top:70,bold:!0,input_value:0},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"nes"===this.getControlScheme()?(t=[{type:"button",text:"Y",id:"y",location:"right",left:40,bold:!0,input_value:1},{type:"button",text:"X",id:"x",location:"right",top:40,bold:!0,input_value:9},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"A",id:"a",location:"right",left:40,top:80,bold:!0,input_value:8},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"n64"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",left:40,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"Z",id:"z",location:"right",left:40,top:80,bold:!0,input_value:1},{type:"button",text:"C-Up",id:"c-up",location:"right",left:40,top:120,bold:!0,input_value:2},{type:"button",text:"C-Down",id:"c-down",location:"right",left:40,top:160,bold:!0,input_value:3},{type:"button",text:"C-Left",id:"c-left",location:"right",left:40,top:200,bold:!0,input_value:4},{type:"button",text:"C-Right",id:"c-right",location:"right",left:40,top:240,bold:!0,input_value:5},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"snes"===this.getControlScheme()?(t=[{type:"button",text:"X",id:"x",location:"right",left:40,bold:!0,input_value:9},{type:"button",text:"Y",id:"y",location:"right",top:40,bold:!0,input_value:1},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"A",id:"a",location:"right",left:40,top:80,bold:!0,input_value:8},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"md"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",left:40,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"X",id:"x",location:"right",left:40,top:80,bold:!0,input_value:9},{type:"button",text:"Y",id:"y",location:"right",left:81,top:80,bold:!0,input_value:1},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"psx"===this.getControlScheme()||"ps2"===this.getControlScheme()?(t=[{type:"button",text:"X",id:"x",location:"right",left:40,bold:!0,input_value:9},{type:"button",text:"O",id:"o",location:"right",top:40,bold:!0,input_value:8},{type:"button",text:"Triangle",id:"triangle",location:"right",left:81,top:40,bold:!0,input_value:1},{type:"button",text:"Square",id:"square",location:"right",left:40,top:80,bold:!0,input_value:0},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"xbox"===this.getControlScheme()||"xbox360"===this.getControlScheme()||"xboxone"===this.getControlScheme()||"switch"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",left:40,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"X",id:"x",location:"right",left:40,top:80,bold:!0,input_value:9},{type:"button",text:"Y",id:"y",location:"right",left:81,top:80,bold:!0,input_value:1},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"dreamcast"===this.getControlScheme()||"genesis"===this.getControlScheme()||"arcade"===this.getControlScheme()||"atari"===this.getControlScheme()||"c64"===this.getControlScheme()||"lynx"===this.getControlScheme()||"tg16"===this.getControlScheme()||"tgcd"===this.getControlScheme()||"3do"===this.getControlScheme()||"saturn"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",left:40,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"C",id:"c",location:"right",left:40,top:80,bold:!0,input_value:9},{type:"button",text:"X",id:"x",location:"right",left:81,top:80,bold:!0,input_value:1},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"psp"===this.getControlScheme()||"ps3"===this.getControlScheme()||"ps4"===this.getControlScheme()||"ps5"===this.getControlScheme()?(t=[{type:"button",text:"X",id:"x",location:"right",left:40,bold:!0,input_value:9},{type:"button",text:"O",id:"o",location:"right",top:40,bold:!0,input_value:8},{type:"button",text:"Triangle",id:"triangle",location:"right",left:81,top:40,bold:!0,input_value:1},{type:"button",text:"Square",id:"square",location:"right",left:40,top:80,bold:!0,input_value:0},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"wii"===this.getControlScheme()||"wiiu"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",left:40,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"1",id:"1",location:"right",left:40,top:80,bold:!0,input_value:9},{type:"button",text:"2",id:"2",location:"right",left:81,top:80,bold:!0,input_value:1},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"3ds"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",left:40,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"X",id:"x",location:"right",left:40,top:80,bold:!0,input_value:9},{type:"button",text:"Y",id:"y",location:"right",left:81,top:80,bold:!0,input_value:1},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"vita"===this.getControlScheme()?(t=[{type:"button",text:"X",id:"x",location:"right",left:40,bold:!0,input_value:9},{type:"button",text:"O",id:"o",location:"right",top:40,bold:!0,input_value:8},{type:"button",text:"Triangle",id:"triangle",location:"right",left:81,top:40,bold:!0,input_value:1},{type:"button",text:"Square",id:"square",location:"right",left:40,top:80,bold:!0,input_value:0},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"n3ds"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",left:40,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"X",id:"x",location:"right",left:40,top:80,bold:!0,input_value:9},{type:"button",text:"Y",id:"y",location:"right",left:81,top:80,bold:!0,input_value:1},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"psv"===this.getControlScheme()?(t=[{type:"button",text:"X",id:"x",location:"right",left:40,bold:!0,input_value:9},{type:"button",text:"O",id:"o",location:"right",top:40,bold:!0,input_value:8},{type:"button",text:"Triangle",id:"triangle",location:"right",left:81,top:40,bold:!0,input_value:1},{type:"button",text:"Square",id:"square",location:"right",left:40,top:80,bold:!0,input_value:0},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"xboxseries"===this.getControlScheme()||"xboxxr"===this.getControlScheme()||"xboxxs"===this.getControlScheme()||"xboxx"===this.getControlScheme()||"xboxs"===this.getControlScheme()||"xboxr"===this.getControlScheme()||"xboxone"===this.getControlScheme()||"xbox360"===this.getControlScheme()||"xbox"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",left:40,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"X",id:"x",location:"right",left:40,top:80,bold:!0,input_value:9},{type:"button",text:"Y",id:"y",location:"right",left:81,top:80,bold:!0,input_value:1},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"ps2"===this.getControlScheme()||"psx"===this.getControlScheme()?(t=[{type:"button",text:"X",id:"x",location:"right",left:40,bold:!0,input_value:9},{type:"button",text:"O",id:"o",location:"right",top:40,bold:!0,input_value:8},{type:"button",text:"Triangle",id:"triangle",location:"right",left:81,top:40,bold:!0,input_value:1},{type:"button",text:"Square",id:"square",location:"right",left:40,top:80,bold:!0,input_value:0},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"md"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",left:40,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"X",id:"x",location:"right",left:40,top:80,bold:!0,input_value:9},{type:"button",text:"Y",id:"y",location:"right",left:81,top:80,bold:!0,input_value:1},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"snes"===this.getControlScheme()?(t=[{type:"button",text:"X",id:"x",location:"right",left:40,bold:!0,input_value:9},{type:"button",text:"Y",id:"y",location:"right",top:40,bold:!0,input_value:1},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"A",id:"a",location:"right",left:40,top:80,bold:!0,input_value:8},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"nes"===this.getControlScheme()?(t=[{type:"button",text:"Y",id:"y",location:"right",left:40,bold:!0,input_value:1},{type:"button",text:"X",id:"x",location:"right",top:40,bold:!0,input_value:9},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"A",id:"a",location:"right",left:40,top:80,bold:!0,input_value:8},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"gb"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",left:81,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:10,top:70,bold:!0,input_value:0},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"n64"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",left:40,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"button",text:"Z",id:"z",location:"right",left:40,top:80,bold:!0,input_value:1},{type:"button",text:"C-Up",id:"c-up",location:"right",left:40,top:120,bold:!0,input_value:2},{type:"button",text:"C-Down",id:"c-down",location:"right",left:40,top:160,bold:!0,input_value:3},{type:"button",text:"C-Left",id:"c-left",location:"right",left:40,top:200,bold:!0,input_value:4},{type:"button",text:"C-Right",id:"c-right",location:"right",left:40,top:240,bold:!0,input_value:5},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"n64"===this.getControlScheme()?(t=[{type:"button",text:"B",id:"b",location:"right",left:-10,top:95,input_value:1,bold:!0},{type:"button",text:"A",id:"a",location:"right",left:40,top:150,input_value:0,bold:!0},{type:"zone",id:"stick",location:"left",left:"50%",top:"100%",joystickInput:!0,inputValues:[16,17,18,19]},{type:"zone",id:"dpad",location:"left",left:"50%",top:"0%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:30,top:-10,fontSize:15,block:!0,input_value:3},{type:"button",text:"L",id:"l",block:!0,location:"top",left:10,top:-40,bold:!0,input_value:10},{type:"button",text:"R",id:"r",block:!0,location:"top",right:10,top:-40,bold:!0,input_value:11},{type:"button",text:"Z",id:"z",block:!0,location:"top",left:10,bold:!0,input_value:12},{fontSize:20,type:"button",text:"CU",id:"cu",joystickInput:!0,location:"right",left:25,top:-65,input_value:23},{fontSize:20,type:"button",text:"CD",id:"cd",joystickInput:!0,location:"right",left:25,top:15,input_value:22},{fontSize:20,type:"button",text:"CL",id:"cl",joystickInput:!0,location:"right",left:-15,top:-25,input_value:21},{fontSize:20,type:"button",text:"CR",id:"cr",joystickInput:!0,location:"right",left:65,top:-25,input_value:20}],t.push(...e)):"nds"===this.getControlScheme()||"snes"===this.getControlScheme()?(t=[{type:"button",text:"X",id:"x",location:"right",left:40,bold:!0,input_value:9},{type:"button",text:"Y",id:"y",location:"right",top:40,bold:!0,input_value:1},{type:"button",text:"A",id:"a",location:"right",left:81,top:40,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",left:40,top:80,bold:!0,input_value:0},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2},{type:"button",text:"L",id:"l",location:"left",left:3,top:-100,bold:!0,block:!0,input_value:10},{type:"button",text:"R",id:"r",location:"right",right:3,top:-100,bold:!0,block:!0,input_value:11}],t.push(...e)):["segaMD","segaCD","sega32x"].includes(this.getControlScheme())?(t=[{type:"button",text:"A",id:"a",location:"right",right:145,top:70,bold:!0,input_value:1},{type:"button",text:"B",id:"b",location:"right",right:75,top:70,bold:!0,input_value:0},{type:"button",text:"C",id:"c",location:"right",right:5,top:70,bold:!0,input_value:8},{type:"button",text:"X",id:"x",location:"right",right:145,top:0,bold:!0,input_value:10},{type:"button",text:"Y",id:"y",location:"right",right:75,top:0,bold:!0,input_value:9},{type:"button",text:"Z",id:"z",location:"right",right:5,top:0,bold:!0,input_value:11},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Mode",id:"mode",location:"center",left:-5,fontSize:15,block:!0,input_value:2},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3}],t.push(...e)):"segaMS"===this.getControlScheme()?(t=[{type:"button",text:"1",id:"button_1",location:"right",left:10,top:40,bold:!0,input_value:0},{type:"button",text:"2",id:"button_2",location:"right",left:81,top:40,bold:!0,input_value:8},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]}],t.push(...e)):"segaGG"===this.getControlScheme()?(t=[{type:"button",text:"1",id:"button_1",location:"right",left:10,top:70,bold:!0,input_value:0},{type:"button",text:"2",id:"button_2",location:"right",left:81,top:40,bold:!0,input_value:8},{type:"dpad",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:30,fontSize:15,block:!0,input_value:3}],t.push(...e)):"segaSaturn"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",right:145,top:70,bold:!0,input_value:1},{type:"button",text:"B",id:"b",location:"right",right:75,top:70,bold:!0,input_value:0},{type:"button",text:"C",id:"c",location:"right",right:5,top:70,bold:!0,input_value:8},{type:"button",text:"X",id:"x",location:"right",right:145,top:0,bold:!0,input_value:9},{type:"button",text:"Y",id:"y",location:"right",right:75,top:0,bold:!0,input_value:10},{type:"button",text:"Z",id:"z",location:"right",right:5,top:0,bold:!0,input_value:11},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"L",id:"l",location:"left",left:3,top:-90,bold:!0,block:!0,input_value:12},{type:"button",text:"R",id:"r",location:"right",right:3,top:-90,bold:!0,block:!0,input_value:13},{type:"button",text:"Start",id:"start",location:"center",left:30,fontSize:15,block:!0,input_value:3}],t.push(...e)):"atari2600"===this.getControlScheme()?(t=[{type:"button",text:"",id:"button_1",location:"right",right:10,top:70,bold:!0,input_value:0},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Reset",id:"reset",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"atari7800"===this.getControlScheme()?(t=[{type:"button",text:"1",id:"button_1",location:"right",right:75,top:70,bold:!0,input_value:0},{type:"button",text:"2",id:"button_2",location:"right",right:5,top:70,bold:!0,input_value:8},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Reset",id:"reset",location:"center",left:-35,fontSize:15,block:!0,input_value:9},{type:"button",text:"Pause",id:"pause",location:"center",left:95,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:30,fontSize:15,block:!0,input_value:2}],t.push(...e)):"lynx"===this.getControlScheme()?(t=[{type:"button",text:"B",id:"button_1",location:"right",right:75,top:70,bold:!0,input_value:0},{type:"button",text:"A",id:"button_2",location:"right",right:5,top:70,bold:!0,input_value:8},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Opt 1",id:"option_1",location:"center",left:-35,fontSize:15,block:!0,input_value:10},{type:"button",text:"Opt 2",id:"option_2",location:"center",left:95,fontSize:15,block:!0,input_value:11},{type:"button",text:"Start",id:"start",location:"center",left:30,fontSize:15,block:!0,input_value:3}],t.push(...e)):"jaguar"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",right:145,top:70,bold:!0,input_value:8},{type:"button",text:"B",id:"b",location:"right",right:75,top:70,bold:!0,input_value:0},{type:"button",text:"C",id:"c",location:"right",right:5,top:70,bold:!0,input_value:1},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Option",id:"option",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Pause",id:"pause",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"vb"===this.getControlScheme()?(t=[{type:"button",text:"B",id:"b",location:"right",right:75,top:150,bold:!0,input_value:0},{type:"button",text:"A",id:"a",location:"right",right:5,top:150,bold:!0,input_value:8},{type:"dpad",id:"left_dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"dpad",id:"right_dpad",location:"right",left:"50%",right:"50%",joystickInput:!1,inputValues:[19,18,17,16]},{type:"button",text:"L",id:"l",location:"left",left:3,top:-90,bold:!0,block:!0,input_value:10},{type:"button",text:"R",id:"r",location:"right",right:3,top:-90,bold:!0,block:!0,input_value:11},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"3do"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",right:145,top:70,bold:!0,input_value:1},{type:"button",text:"B",id:"b",location:"right",right:75,top:70,bold:!0,input_value:0},{type:"button",text:"C",id:"c",location:"right",right:5,top:70,bold:!0,input_value:8},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"L",id:"l",location:"left",left:3,top:-90,bold:!0,block:!0,input_value:10},{type:"button",text:"R",id:"r",location:"right",right:3,top:-90,bold:!0,block:!0,input_value:11},{type:"button",text:"X",id:"x",location:"center",left:-5,fontSize:15,block:!0,bold:!0,input_value:2},{type:"button",text:"P",id:"p",location:"center",left:60,fontSize:15,block:!0,bold:!0,input_value:3}],t.push(...e)):"pce"===this.getControlScheme()?(t=[{type:"button",text:"II",id:"ii",location:"right",right:75,top:70,bold:!0,input_value:0},{type:"button",text:"I",id:"i",location:"right",right:5,top:70,bold:!0,input_value:8},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Run",id:"run",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e)):"ngp"===this.getControlScheme()?(t=[{type:"button",text:"A",id:"a",location:"right",right:75,top:70,bold:!0,input_value:0},{type:"button",text:"B",id:"b",location:"right",right:5,top:50,bold:!0,input_value:8},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Option",id:"option",location:"center",left:30,fontSize:15,block:!0,input_value:3}],t.push(...e)):"ws"===this.getControlScheme()?(t=[{type:"button",text:"B",id:"b",location:"right",right:75,top:150,bold:!0,input_value:0},{type:"button",text:"A",id:"a",location:"right",right:5,top:150,bold:!0,input_value:8},{type:"dpad",id:"x_dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"dpad",id:"y_dpad",location:"right",left:"50%",right:"50%",joystickInput:!1,inputValues:[13,12,10,11]},{type:"button",text:"Start",id:"start",location:"center",left:30,fontSize:15,block:!0,input_value:3}],t.push(...e)):"coleco"===this.getControlScheme()?(t=[{type:"button",text:"L",id:"l",location:"right",left:10,top:40,bold:!0,input_value:8},{type:"button",text:"R",id:"r",location:"right",left:81,top:40,bold:!0,input_value:0},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]}],t.push(...e)):"pcfx"===this.getControlScheme()?(t=[{type:"button",text:"I",id:"i",location:"right",right:5,top:70,bold:!0,input_value:8},{type:"button",text:"II",id:"ii",location:"right",right:75,top:70,bold:!0,input_value:0},{type:"button",text:"III",id:"iii",location:"right",right:145,top:70,bold:!0,input_value:9},{type:"button",text:"IV",id:"iv",location:"right",right:5,top:0,bold:!0,input_value:1},{type:"button",text:"V",id:"v",location:"right",right:75,top:0,bold:!0,input_value:10},{type:"button",text:"VI",id:"vi",location:"right",right:145,top:0,bold:!0,input_value:11},{type:"dpad",id:"dpad",location:"left",left:"50%",right:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2},{type:"button",text:"Run",id:"run",location:"center",left:60,fontSize:15,block:!0,input_value:3}],t.push(...e)):(t=[{type:"button",text:"Y",id:"y",location:"right",left:40,bold:!0,input_value:9},{type:"button",text:"X",id:"x",location:"right",top:40,bold:!0,input_value:1},{type:"button",text:"B",id:"b",location:"right",left:81,top:40,bold:!0,input_value:8},{type:"button",text:"A",id:"a",location:"right",left:40,top:80,bold:!0,input_value:0},{type:"zone",id:"dpad",location:"left",left:"50%",top:"50%",joystickInput:!1,inputValues:[4,5,6,7]},{type:"button",text:"Start",id:"start",location:"center",left:60,fontSize:15,block:!0,input_value:3},{type:"button",text:"Select",id:"select",location:"center",left:-5,fontSize:15,block:!0,input_value:2}],t.push(...e));for(let e=0;e<t.length;e++)t[e].text&&(t[e].text=this.localization(t[e].text));t=JSON.parse(JSON.stringify(t));const i=this.createElement("div");i.classList.add("ejs_virtualGamepad_top");const n=this.createElement("div");n.classList.add("ejs_virtualGamepad_bottom");const o=this.createElement("div");o.classList.add("ejs_virtualGamepad_left");const r=this.createElement("div");r.classList.add("ejs_virtualGamepad_right");const s={top:i,center:n,left:o,right:r};this.virtualGamepad.appendChild(i),this.virtualGamepad.appendChild(n),this.virtualGamepad.appendChild(o),this.virtualGamepad.appendChild(r),this.toggleVirtualGamepadLeftHanded=e=>{o.classList.toggle("ejs_virtualGamepad_left",!e),r.classList.toggle("ejs_virtualGamepad_right",!e),o.classList.toggle("ejs_virtualGamepad_right",e),r.classList.toggle("ejs_virtualGamepad_left",e)};const a=!1,l=`cs_${this.getControlScheme()}`.split(/\s/g).join("_");for(let e=0;e<t.length;e++){if("button"!==t[e].type)continue;a;let i="";if(t[e].left&&(i+="left:"+t[e].left+("number"==typeof t[e].left?"px":"")+";"),t[e].right&&(i+="right:"+t[e].right+("number"==typeof t[e].right?"px":"")+";"),t[e].top&&(i+="top:"+t[e].top+("number"==typeof t[e].top?"px":"")+";"),t[e].bold?t[e].bold&&(i+="font-weight:bold;"):i+="font-weight:normal;",t[e].fontSize=t[e].fontSize||30,i+="font-size:"+t[e].fontSize+"px;",t[e].block&&(i+="height:31px;text-align:center;border:1px solid #ccc;border-radius:5px;line-height:31px;"),["top","center","left","right"].includes(t[e].location)){const n=this.createElement("div");n.style=i,n.innerText=t[e].text,n.classList.add("ejs_virtualGamepad_button",l),t[e].id&&n.classList.add(`b_${t[e].id}`),s[t[e].location].appendChild(n);const o=t[e].input_new_cores||t[e].input_value;let r=!0===t[e].joystickInput?32767:1;this.addEventListener(n,"touchstart touchend touchcancel",(e=>{if(e.preventDefault(),"touchend"===e.type||"touchcancel"===e.type)e.target.classList.remove("ejs_virtualGamepad_button_down"),e.target.nesRapidFireInterval&&(clearInterval(e.target.nesRapidFireInterval),e.target.nesRapidFireInterval=null),window.setTimeout((()=>{let e=o;"nes"===this.getControlScheme()&&(9==o?e=8:1==o&&(e=0)),this.gameManager.simulateInput(0,e,0)}));else{e.target.classList.add("ejs_virtualGamepad_button_down");let t=o;"nes"===this.getControlScheme()&&(9==o?t=8:1==o&&(t=0)),this.gameManager.simulateInput(0,t,r),"nes"!==this.getControlScheme()||9!=o&&1!=o||(e.target.nesRapidFireInterval&&clearInterval(e.target.nesRapidFireInterval),e.target.nesRapidFireInterval=setInterval((()=>{this.gameManager.simulateInput(0,t,r),setTimeout((()=>{this.gameManager.simulateInput(0,t,0)}),30)}),100))}}))}}const c=e=>{const t=e.container,i=e.event,n=this.createElement("div");n.classList.add("ejs_dpad_main");const o=this.createElement("div");o.classList.add("ejs_dpad_vertical");const r=this.createElement("div");r.classList.add("ejs_dpad_horizontal");const s=this.createElement("div");s.classList.add("ejs_dpad_bar");const a=this.createElement("div");a.classList.add("ejs_dpad_bar"),r.appendChild(s),o.appendChild(a),n.appendChild(o),n.appendChild(r);this.addEventListener(n,"touchstart touchmove",(e=>{e.preventDefault();const t=e.targetTouches[0];if(!t)return;const o=n.getBoundingClientRect(),r=t.clientX-o.left-n.clientWidth/2,s=t.clientY-o.top-n.clientHeight/2;let a=0,l=0,c=0,d=0,u=Math.atan(r/s)/(Math.PI/180);s<=-10&&(a=1),s>=10&&(l=1),r>=10&&(d=1,c=0,(u<0&&u>=-35||u>0&&u<=35)&&(d=0),a=u<0&&u>=-55?1:0,l=u>0&&u<=55?1:0),r<=-10&&(d=0,c=1,(u<0&&u>=-35||u>0&&u<=35)&&(c=0),a=u>0&&u<=55?1:0,l=u<0&&u>=-55?1:0),n.classList.toggle("ejs_dpad_up_pressed",a),n.classList.toggle("ejs_dpad_down_pressed",l),n.classList.toggle("ejs_dpad_right_pressed",d),n.classList.toggle("ejs_dpad_left_pressed",c),i(a,l,c,d)})),this.addEventListener(n,"touchend touchcancel",(e=>{e.preventDefault(),n.classList.remove("ejs_dpad_up_pressed"),n.classList.remove("ejs_dpad_down_pressed"),n.classList.remove("ejs_dpad_right_pressed"),n.classList.remove("ejs_dpad_left_pressed"),i(0,0,0,0)})),t.appendChild(n)};if(t.forEach(((e,t)=>{if("dpad"!==e.type)return;const i=this.createElement("div");let n="";e.left&&(n+="left:"+e.left+";"),e.right&&(n+="right:"+e.right+";"),e.top&&(n+="top:"+e.top+";"),i.classList.add(l),e.id&&i.classList.add(`b_${e.id}`),i.style=n,s[e.location].appendChild(i),c({container:i,event:(t,i,n,o)=>{e.joystickInput&&(1===t&&(t=32767),1===i&&(i=32767),1===n&&(n=32767),1===o&&(o=32767)),this.gameManager.simulateInput(0,e.inputValues[0],t),this.gameManager.simulateInput(0,e.inputValues[1],i),this.gameManager.simulateInput(0,e.inputValues[2],n),this.gameManager.simulateInput(0,e.inputValues[3],o)}})})),t.forEach(((e,t)=>{if("zone"!==e.type)return;const i=this.createElement("div");this.addEventListener(i,"touchstart touchmove touchend touchcancel",(e=>{e.preventDefault()})),i.classList.add(l),e.id&&i.classList.add(`b_${e.id}`),s[e.location].appendChild(i);const n=nipplejs.create({zone:i,mode:"static",position:{left:e.left,top:e.top},color:e.color||"red"});n.on("end",(()=>{this.gameManager.simulateInput(0,e.inputValues[0],0),this.gameManager.simulateInput(0,e.inputValues[1],0),this.gameManager.simulateInput(0,e.inputValues[2],0),this.gameManager.simulateInput(0,e.inputValues[3],0)})),n.on("move",((t,i)=>{const n=i.angle.degree,o=i.distance;if(!0===e.joystickInput){let t=0,i=0;n>0&&n<=45&&(t=o/50,i=-.022222222222222223*n*o/50),n>45&&n<=90&&(t=.022222222222222223*(90-n)*o/50,i=-o/50),n>90&&n<=135&&(t=.022222222222222223*(90-n)*o/50,i=-o/50),n>135&&n<=180&&(t=-o/50,i=-.022222222222222223*(180-n)*o/50),n>135&&n<=225&&(t=-o/50,i=-.022222222222222223*(180-n)*o/50),n>225&&n<=270&&(t=-.022222222222222223*(270-n)*o/50,i=o/50),n>270&&n<=315&&(t=-.022222222222222223*(270-n)*o/50,i=o/50),n>315&&n<=359.9&&(t=o/50,i=.022222222222222223*(360-n)*o/50),t>0?(this.gameManager.simulateInput(0,e.inputValues[0],32767*t),this.gameManager.simulateInput(0,e.inputValues[1],0)):(this.gameManager.simulateInput(0,e.inputValues[1],32767*-t),this.gameManager.simulateInput(0,e.inputValues[0],0)),i>0?(this.gameManager.simulateInput(0,e.inputValues[2],32767*i),this.gameManager.simulateInput(0,e.inputValues[3],0)):(this.gameManager.simulateInput(0,e.inputValues[3],32767*-i),this.gameManager.simulateInput(0,e.inputValues[2],0))}else n>=30&&n<150?this.gameManager.simulateInput(0,e.inputValues[0],1):window.setTimeout((()=>{this.gameManager.simulateInput(0,e.inputValues[0],0)}),30),n>=210&&n<330?this.gameManager.simulateInput(0,e.inputValues[1],1):window.setTimeout((()=>{this.gameManager.simulateInput(0,e.inputValues[1],0)}),30),n>=120&&n<240?this.gameManager.simulateInput(0,e.inputValues[2],1):window.setTimeout((()=>{this.gameManager.simulateInput(0,e.inputValues[2],0)}),30),n>=300||n>=0&&n<60?this.gameManager.simulateInput(0,e.inputValues[3],1):window.setTimeout((()=>{this.gameManager.simulateInput(0,e.inputValues[3],0)}),30)}))})),this.touch||this.hasTouchScreen){const e=this.createElement("div");let t;e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>',e.classList.add("ejs_virtualGamepad_open"),e.style.display="none",this.on("start",(()=>{e.style.display="",matchMedia("(pointer:fine)").matches&&"visible"!==this.getSettingValue("menu-bar-button")&&(e.style.opacity=0,this.changeSettingOption("menu-bar-button","hidden",!0))})),this.elements.parent.appendChild(e);let i=!0;this.addEventListener(e,"touchstart touchend mousedown mouseup click",(e=>{i&&(clearTimeout(t),t=setTimeout((()=>{i=!0}),2e3),i=!1,e.preventDefault(),this.menu.toggle())})),this.elements.menuToggle=e}this.virtualGamepad.style.display="none"}handleResize(){this.virtualGamepad&&"none"===this.virtualGamepad.style.display&&(this.virtualGamepad.style.opacity=0,this.virtualGamepad.style.display="",setTimeout((()=>{this.virtualGamepad.style.display="none",this.virtualGamepad.style.opacity=""}),250));const e=this.elements.parent.getBoundingClientRect();this.game.parentElement.classList.toggle("ejs_small_screen",e.width<=575),this.game.parentElement.classList.toggle("ejs_big_screen",e.width>575),this.handleSettingsResize&&this.handleSettingsResize()}getElementSize(e){let t=e.cloneNode(!0);t.style.position="absolute",t.style.opacity=0,t.removeAttribute("hidden"),e.parentNode.appendChild(t);const i=t.getBoundingClientRect();return t.remove(),{width:i.width,height:i.height}}saveSettings(){if(!window.localStorage||this.config.disableLocalStorage||!this.settingsLoaded)return;if(!this.started&&!this.failedToStart)return;const e={controlSettings:this.controls,settings:this.settings,cheats:this.cheats},t={volume:this.volume,muted:this.muted};localStorage.setItem("ejs-settings",JSON.stringify(t)),localStorage.setItem(this.getLocalStorageKey(),JSON.stringify(e))}getLocalStorageKey(){let e=(this.config.gameId||1)+"-"+this.getCore(!0);return"string"==typeof this.config.gameName?e+="-"+this.config.gameName:"string"!=typeof this.config.gameUrl||this.config.gameUrl.toLowerCase().startsWith("blob:")?this.config.gameUrl instanceof File?e+="-"+this.config.gameUrl.name:"number"!=typeof this.config.gameId&&console.warn("gameId (EJS_gameID) is not set. This may result in settings persisting across games."):e+="-"+this.config.gameUrl,"ejs-"+e+"-settings"}preGetSetting(e){if(window.localStorage&&!this.config.disableLocalStorage){let t=localStorage.getItem(this.getLocalStorageKey());try{if(t=JSON.parse(t),t&&t.settings)return t.settings[e]}catch(e){console.warn("Could not load previous settings",e)}}return this.config.defaultOptions&&this.config.defaultOptions[e]?this.config.defaultOptions[e]:null}getCoreSettings(){if(!window.localStorage||this.config.disableLocalStorage){if(this.config.defaultOptions){let e="";for(const t in this.config.defaultOptions){e+=`${t} = ${isNaN(this.config.defaultOptions[t])?`"${this.config.defaultOptions[t]}"`:this.config.defaultOptions[t]}\n`}return e}return""}let e=localStorage.getItem(this.getLocalStorageKey());if(e)try{if(e=JSON.parse(e),!(e.settings instanceof Object))throw new Error("Not a JSON object");let t="";for(const i in e.settings){t+=`${i} = ${isNaN(e.settings[i])?`"${e.settings[i]}"`:e.settings[i]}\n`}for(const e in this.config.defaultOptions){if(t.includes(e))continue;t+=`${e} = ${isNaN(this.config.defaultOptions[e])?`"${this.config.defaultOptions[e]}"`:this.config.defaultOptions[e]}\n`}return t}catch(e){console.warn("Could not load previous settings",e)}return""}loadSettings(){if(!window.localStorage||this.config.disableLocalStorage)return;this.settingsLoaded=!0;let e=localStorage.getItem("ejs-settings"),t=localStorage.getItem(this.getLocalStorageKey());if(t)try{if(t=JSON.parse(t),!(t.controlSettings instanceof Object&&t.settings instanceof Object&&Array.isArray(t.cheats)))return;this.controls=t.controlSettings,this.checkGamepadInputs();for(const e in t.settings)this.changeSettingOption(e,t.settings[e]);for(let e=0;e<t.cheats.length;e++){const i=t.cheats[e];let n=!1;for(let e=0;e<this.cheats.length;e++)if(this.cheats[e].desc===i.desc&&this.cheats[e].code===i.code){this.cheats[e].checked=i.checked,n=!0;break}n||this.cheats.push(i)}}catch(e){console.warn("Could not load previous settings",e)}if(e)try{if(e=JSON.parse(e),"number"!=typeof e.volume||"boolean"!=typeof e.muted)return;this.volume=e.volume,this.muted=e.muted,this.setVolume(this.muted?0:this.volume)}catch(e){console.warn("Could not load previous settings",e)}}handleSpecialOptions(e,t){if("shader"===e)this.enableShader(t);else if("disk"===e)this.gameManager.setCurrentDisk(t);else if("virtual-gamepad"===e)this.toggleVirtualGamepad("disabled"!==t);else if("menu-bar-button"===e)this.elements.menuToggle.style.display="",this.elements.menuToggle.style.opacity="visible"===t?.5:0;else if("virtual-gamepad-left-handed-mode"===e)this.toggleVirtualGamepadLeftHanded("disabled"!==t);else if("ff-ratio"===e)this.isFastForward&&this.gameManager.toggleFastForward(0),"unlimited"===t?this.gameManager.setFastForwardRatio(0):isNaN(t)||this.gameManager.setFastForwardRatio(parseFloat(t)),setTimeout((()=>{this.isFastForward&&this.gameManager.toggleFastForward(1)}),10);else if("fastForward"===e)"enabled"===t?(this.isFastForward=!0,this.gameManager.toggleFastForward(1)):"disabled"===t&&(this.isFastForward=!1,this.gameManager.toggleFastForward(0));else if("sm-ratio"===e)this.isSlowMotion&&this.gameManager.toggleSlowMotion(0),this.gameManager.setSlowMotionRatio(parseFloat(t)),setTimeout((()=>{this.isSlowMotion&&this.gameManager.toggleSlowMotion(1)}),10);else if("slowMotion"===e)"enabled"===t?(this.isSlowMotion=!0,this.gameManager.toggleSlowMotion(1)):"disabled"===t&&(this.isSlowMotion=!1,this.gameManager.toggleSlowMotion(0));else if("rewind-granularity"===e)this.rewindEnabled&&this.gameManager.setRewindGranularity(parseInt(t));else if("vsync"===e)this.gameManager.setVSync("enabled"===t);else if("videoRotation"===e)t=parseInt(t),!0===this.videoRotationChanged||0!==t?(this.gameManager.setVideoRotation(t),this.videoRotationChanged=!0):!0===this.videoRotationChanged&&0===t&&(this.gameManager.setVideoRotation(0),this.videoRotationChanged=!0);else if("save-save-interval"===e){if(t=parseInt(t),this.saveSaveInterval&&null!==this.saveSaveInterval&&(clearInterval(this.saveSaveInterval),this.saveSaveInterval=null),0===t||isNaN(t))return;this.started&&this.gameManager.saveSaveFiles(),this.debug&&console.log("Saving every",1e3*t,"miliseconds"),this.saveSaveInterval=setInterval((()=>{this.started&&this.gameManager.saveSaveFiles()}),1e3*t)}else"menubarBehavior"===e?this.createBottomMenuBarListeners():"keyboardInput"===e?this.gameManager.setKeyboardEnabled("enabled"===t):"altKeyboardInput"===e?this.gameManager.setAltKeyEnabled("enabled"===t):"lockMouse"===e&&(this.enableMouseLock="enabled"===t)}menuOptionChanged(e,t){this.saveSettings(),this.allSettings[e]=t,this.debug&&console.log(e,t),this.gameManager&&(this.handleSpecialOptions(e,t),this.gameManager.setVariable(e,t),this.saveSettings())}setupDisksMenu(){this.disksMenu=this.createElement("div"),this.disksMenu.classList.add("ejs_settings_parent");const e=this.createElement("div");e.classList.add("ejs_settings_transition"),this.disks={};const t=this.createElement("div");t.style.overflow="auto";const i=[];this.handleDisksResize=()=>{let n=!1;""!==this.disksMenu.style.display&&(this.disksMenu.style.opacity="0",this.disksMenu.style.display="",n=!0);let o=this.elements.parent.getBoundingClientRect().height,r=this.diskParent.parentElement.getBoundingClientRect().width,s=this.diskParent.getBoundingClientRect().x;r>window.innerWidth&&(s+=r-window.innerWidth);const a=s>(r-15)/2;o>375&&(o=375),t.style["max-height"]=o-95+"px",e.style["max-height"]=o-95+"px";for(let e=0;e<i.length;e++)i[e].style["max-height"]=o-95+"px";this.disksMenu.classList.toggle("ejs_settings_center_left",!a),this.disksMenu.classList.toggle("ejs_settings_center_right",a),n&&(this.disksMenu.style.display="none",this.disksMenu.style.opacity="")},t.classList.add("ejs_setting_menu"),e.appendChild(t);let n=[];this.changeDiskOption=(e,t)=>{this.disks[e]=t,n.forEach((t=>t(e)))};let o={};const r=(r,s,a,l)=>{const c=this.createElement("span");c.innerText=r;const d=this.createElement("div");d.innerText="",d.classList.add("ejs_settings_main_bar_selected"),c.appendChild(d);const u=this.createElement("div");i.push(u),u.setAttribute("hidden",""),u.classList.add("ejs_parent_option_div");const g=this.createElement("button"),h=()=>{const i=this.getElementSize(t);e.style.width=i.width+20+"px",e.style.height=i.height+"px",u.setAttribute("hidden",""),t.removeAttribute("hidden")};this.addEventListener(g,"click",h),g.type="button",g.classList.add("ejs_back_button"),u.appendChild(g);const p=this.createElement("span");p.innerText=r,p.classList.add("ejs_menu_text_a"),g.appendChild(p);const m=this.createElement("div");m.classList.add("ejs_setting_menu");let f=[],b=a;if(Array.isArray(a)){b={};for(let e=0;e<a.length;e++)b[a[e]]=a[e]}o[s]=b,n.push((e=>{if(s===e){for(let e=0;e<f.length;e++)f[e].classList.toggle("ejs_option_row_selected",f[e].getAttribute("ejs_value")===this.disks[s]);this.menuOptionChanged(s,this.disks[s]),d.innerText=b[this.disks[s]]}}));for(const e in b){const t=this.createElement("button");f.push(t),t.setAttribute("ejs_value",e),t.type="button",t.value=b[e],t.classList.add("ejs_option_row"),t.classList.add("ejs_button_style"),this.addEventListener(t,"click",(i=>{this.disks[s]=e;for(let e=0;e<f.length;e++)f[e].classList.remove("ejs_option_row_selected");t.classList.add("ejs_option_row_selected"),this.menuOptionChanged(s,e),d.innerText=b[e],h()})),l===e&&(t.classList.add("ejs_option_row_selected"),this.menuOptionChanged(s,e),d.innerText=b[e]);const i=this.createElement("span");i.innerText=b[e],t.appendChild(i),m.appendChild(t)}t.appendChild(m),e.appendChild(u)};if(this.gameManager.getDiskCount()>1){const e={};let t=!1,i={};"m3u"===this.fileName.split(".").pop()&&(i=this.gameManager.Module.FS.readFile(this.fileName,{encoding:"utf8"}).split("\n"),t=!0);for(let n=0;n<this.gameManager.getDiskCount();n++)if(t){const t=i[n].split("|");let o=t[0].replace("."+t[0].split(".").pop(),"");t.length>=2&&(o=t[1]),e[n.toString()]=o}else e[n.toString()]="Disk "+(n+1);r(this.localization("Disk"),"disk",e,this.gameManager.getCurrentDisk().toString())}this.disksMenu.appendChild(e),this.diskParent.appendChild(this.disksMenu),this.diskParent.style.position="relative";const s=this.getElementSize(t);if(e.style.width=s.width+20+"px",e.style.height=s.height+"px",this.disksMenu.style.display="none",this.debug&&console.log("Available core options",o),this.config.defaultOptions)for(const e in this.config.defaultOptions)this.changeDiskOption(e,this.config.defaultOptions[e])}getSettingValue(e){return this.allSettings[e]||this.settings[e]||null}setupSettingsMenu(){this.settingsMenu=this.createElement("div"),this.settingsMenu.classList.add("ejs_settings_parent");const e=this.createElement("div");e.classList.add("ejs_settings_transition"),this.settings={},this.allSettings={};const t=[];let i=0;const n=(n,o,r)=>{const s=this.createElement("div");if(s.classList.add("ejs_setting_menu"),n){const n=this.createElement("div");n.classList.add("ejs_settings_main_bar");const a=this.createElement("span");a.innerText=o,n.appendChild(a),r.appendChild(n);const l=this.createElement("div"),c=this.createElement("div");t.push(l),i++,l.setAttribute("hidden",""),c.classList.add("ejs_parent_option_div");const d=this.createElement("button"),u=()=>{const t=this.getElementSize(r);e.style.width=t.width+20+"px",e.style.height=t.height+"px",l.setAttribute("hidden",""),r.removeAttribute("hidden")};this.addEventListener(n,"click",(t=>{const i=this.getElementSize(l);e.style.width=i.width+20+"px",e.style.height=i.height+"px",l.removeAttribute("hidden"),s.scrollTo(0,0),r.setAttribute("hidden","")}));const g=new MutationObserver((i=>{for(const o of i)for(const i of o.removedNodes)if(i===l){n.remove(),g.disconnect();const i=t.indexOf(l);-1!==i&&t.splice(i,1),this.settingsMenu.style.display="";const o=this.getElementSize(r);e.style.width=o.width+20+"px",e.style.height=o.height+"px",this.settingsMenu.style.display="none"}}));this.addEventListener(d,"click",u),d.type="button",d.classList.add("ejs_back_button"),c.appendChild(d);const h=this.createElement("span");h.innerText=o,h.classList.add("ejs_menu_text_a"),d.appendChild(h),c.appendChild(s),l.appendChild(c),e.appendChild(l),g.observe(e,{childList:!0,subtree:!0})}return s},o=e=>{null===e.firstChild&&(e.parentElement.remove(),i--)},r=n();this.handleSettingsResize=()=>{let i=!1;""!==this.settingsMenu.style.display&&(this.settingsMenu.style.opacity="0",this.settingsMenu.style.display="",i=!0);let n=this.elements.parent.getBoundingClientRect().height,o=this.settingParent.parentElement.getBoundingClientRect().width,s=this.settingParent.getBoundingClientRect().x;o>window.innerWidth&&(s+=o-window.innerWidth);const a=s>(o-15)/2;n>375&&(n=375),r.style["max-height"]=n-95+"px",e.style["max-height"]=n-95+"px";for(let e=0;e<t.length;e++)t[e].style["max-height"]=n-95+"px";this.settingsMenu.classList.toggle("ejs_settings_center_left",!a),this.settingsMenu.classList.toggle("ejs_settings_center_right",a),i&&(this.settingsMenu.style.display="none",this.settingsMenu.style.opacity="")},e.appendChild(r);let s=[],a={};this.changeSettingOption=(e,t,i)=>{this.allSettings[e]=t,!0!==i&&(this.settings[e]=t),a[e]=t,s.forEach((t=>t(e)))};let l={};const c=(i,n,o,c,d,u)=>{if(Array.isArray(this.config.hideSettings)&&this.config.hideSettings.includes(n))return;d=d||r;const g=u?d.parentElement.parentElement:d,h=this.createElement("div");h.classList.add("ejs_settings_main_bar");const p=this.createElement("span");p.innerText=i;const m=this.createElement("div");m.innerText="",m.classList.add("ejs_settings_main_bar_selected"),p.appendChild(m),h.appendChild(p),d.appendChild(h);const f=this.createElement("div");t.push(f);const b=this.createElement("div");f.setAttribute("hidden",""),b.classList.add("ejs_parent_option_div");const C=this.createElement("div");C.classList.add("ejs_setting_menu");const I=this.createElement("button"),y=()=>{g.removeAttribute("hidden"),f.setAttribute("hidden","");const t=this.getElementSize(g);e.style.width=t.width+20+"px",e.style.height=t.height+"px",g.removeAttribute("hidden")};this.addEventListener(h,"click",(t=>{const i=this.getElementSize(f);e.style.width=i.width+20+"px",e.style.height=i.height+"px",f.removeAttribute("hidden"),C.scrollTo(0,0),g.setAttribute("hidden",""),g.setAttribute("hidden","")})),this.addEventListener(I,"click",y),I.type="button",I.classList.add("ejs_back_button"),b.appendChild(I);const v=this.createElement("span");v.innerText=i,v.classList.add("ejs_menu_text_a"),I.appendChild(v);let Z=[],S=o;if(Array.isArray(o)){S={};for(let e=0;e<o.length;e++)S[o[e]]=o[e]}l[n]=S,s.push((e=>{if(n===e){for(let e=0;e<Z.length;e++)Z[e].classList.toggle("ejs_option_row_selected",Z[e].getAttribute("ejs_value")===a[n]);this.menuOptionChanged(n,a[n]),m.innerText=S[a[n]]}}));for(const e in S){const t=this.createElement("button");Z.push(t),t.setAttribute("ejs_value",e),t.type="button",t.value=S[e],t.classList.add("ejs_option_row"),t.classList.add("ejs_button_style"),this.addEventListener(t,"click",(i=>{this.changeSettingOption(n,e);for(let e=0;e<Z.length;e++)Z[e].classList.remove("ejs_option_row_selected");t.classList.add("ejs_option_row_selected"),this.menuOptionChanged(n,e),m.innerText=S[e],y()})),c===e&&(t.classList.add("ejs_option_row_selected"),this.menuOptionChanged(n,e),m.innerText=S[e]);const i=this.createElement("span");i.innerText=S[e],t.appendChild(i),C.appendChild(t)}b.appendChild(C),f.appendChild(b),e.appendChild(f)},d=this.getCores()[this.getCore(!0)];d&&d.length>1&&c(this.localization("Core ("+this.localization("Requires restart")+")"),"retroarch_core",d,this.getCore(),r),"function"!=typeof window.SharedArrayBuffer||this.requiresThreads(this.getCore())||c(this.localization("Threads"),"ejs_threads",{enabled:this.localization("Enabled"),disabled:this.localization("Disabled")},this.config.threads?"enabled":"disabled",r);const u=n(!0,"Graphics Settings",r);if(this.config.shaders){const e={"2xScaleHQ.glslp":this.localization("2xScaleHQ"),"4xScaleHQ.glslp":this.localization("4xScaleHQ"),"crt-aperture.glslp":this.localization("CRT aperture"),"crt-beam":this.localization("CRT beam"),"crt-caligari":this.localization("CRT caligari"),"crt-easymode.glslp":this.localization("CRT easymode"),"crt-geom.glslp":this.localization("CRT geom"),"crt-lottes":this.localization("CRT lottes"),"crt-mattias.glslp":this.localization("CRT mattias"),"crt-yeetron":this.localization("CRT yeetron"),"crt-zfast":this.localization("CRT zfast"),sabr:this.localization("SABR"),bicubic:this.localization("Bicubic"),"mix-frames":this.localization("Mix frames")};let t={disabled:this.localization("Disabled")};for(const i in this.config.shaders)e[i]?t[i]=e[i]:t[i]=i;c(this.localization("Shaders"),"shader",t,"disabled",u,!0)}this.supportsWebgl2&&!this.requiresWebGL2(this.getCore())&&c(this.localization("WebGL2")+" ("+this.localization("Requires restart")+")","webgl2Enabled",{enabled:this.localization("Enabled"),disabled:this.localization("Disabled")},this.webgl2Enabled?"enabled":"disabled",u,!0),c(this.localization("FPS"),"fps",{show:this.localization("show"),hide:this.localization("hide")},"hide",u,!0),c(this.localization("VSync"),"vsync",{enabled:this.localization("Enabled"),disabled:this.localization("Disabled")},"enabled",u,!0),c(this.localization("Video Rotation"),"videoRotation",{0:"0 deg",1:"90 deg",2:"180 deg",3:"270 deg"},this.videoRotation.toString(),u,!0);const g=n(!0,"Screen Capture",r);c(this.localization("Screenshot Source"),"screenshotSource",{canvas:"canvas",retroarch:"retroarch"},this.capture.photo.source,g,!0);let h={png:"png",jpeg:"jpeg",webp:"webp"};this.isSafari&&delete h.webp,this.capture.photo.format in h||(this.capture.photo.format="png"),c(this.localization("Screenshot Format"),"screenshotFormat",h,this.capture.photo.format,g,!0);const p=this.capture.photo.upscale.toString();let m={0:"native",1:"1x",2:"2x",3:"3x"};p in m||(m[p]=p+"x"),c(this.localization("Screenshot Upscale"),"screenshotUpscale",m,p,g,!0);const f=this.capture.video.fps.toString();let b={30:"30",60:"60"};f in b||(b[f]=f),c(this.localization("Screen Recording FPS"),"screenRecordFPS",b,f,g,!0);let C={mp4:"mp4",webm:"webm"};for(const e in C)MediaRecorder.isTypeSupported("video/"+e)||delete C[e];this.capture.video.format in C||(this.capture.video.format=Object.keys(C)[0]),c(this.localization("Screen Recording Format"),"screenRecordFormat",C,this.capture.video.format,g,!0);const I=this.capture.video.upscale.toString();let y={1:"1x",2:"2x",3:"3x",4:"4x"};I in y||(y[I]=I+"x"),c(this.localization("Screen Recording Upscale"),"screenRecordUpscale",y,I,g,!0);const v=this.capture.video.videoBitrate.toString();let Z={1048576:"1 Mbit/sec",2097152:"2 Mbit/sec",2621440:"2.5 Mbit/sec",3145728:"3 Mbit/sec",4194304:"4 Mbit/sec"};v in Z||(Z[v]=v+" Bits/sec"),c(this.localization("Screen Recording Video Bitrate"),"screenRecordVideoBitrate",Z,v,g,!0);const S=this.capture.video.audioBitrate.toString();let V={65536:"64 Kbit/sec",131072:"128 Kbit/sec",196608:"192 Kbit/sec",262144:"256 Kbit/sec",327680:"320 Kbit/sec"};S in V||(V[S]=S+" Bits/sec"),c(this.localization("Screen Recording Audio Bitrate"),"screenRecordAudioBitrate",V,S,g,!0),o(g);const w=n(!0,"Speed Options",r);c(this.localization("Fast Forward"),"fastForward",{enabled:this.localization("Enabled"),disabled:this.localization("Disabled")},"disabled",w,!0),c(this.localization("Fast Forward Ratio"),"ff-ratio",["1.5","2.0","2.5","3.0","3.5","4.0","4.5","5.0","5.5","6.0","6.5","7.0","7.5","8.0","8.5","9.0","9.5","10.0","unlimited"],"3.0",w,!0),c(this.localization("Slow Motion"),"slowMotion",{enabled:this.localization("Enabled"),disabled:this.localization("Disabled")},"disabled",w,!0),c(this.localization("Slow Motion Ratio"),"sm-ratio",["1.5","2.0","2.5","3.0","3.5","4.0","4.5","5.0","5.5","6.0","6.5","7.0","7.5","8.0","8.5","9.0","9.5","10.0"],"3.0",w,!0),c(this.localization("Rewind Enabled ("+this.localization("Requires restart")+")"),"rewindEnabled",{enabled:this.localization("Enabled"),disabled:this.localization("Disabled")},"disabled",w,!0),this.rewindEnabled&&c(this.localization("Rewind Granularity"),"rewind-granularity",["1","3","6","12","25","50","100"],"6",w,!0);const B=n(!0,"Input Options",r);if(c(this.localization("Menubar Mouse Trigger"),"menubarBehavior",{downward:this.localization("Downward Movement"),anywhere:this.localization("Movement Anywhere")},"downward",B,!0),c(this.localization("Direct Keyboard Input"),"keyboardInput",{disabled:this.localization("Disabled"),enabled:this.localization("Enabled")},this.defaultCoreOpts&&!0===this.defaultCoreOpts.useKeyboard?"enabled":"disabled",B,!0),c(this.localization("Forward Alt key"),"altKeyboardInput",{disabled:this.localization("Disabled"),enabled:this.localization("Enabled")},"disabled",B,!0),c(this.localization("Lock Mouse"),"lockMouse",{disabled:this.localization("Disabled"),enabled:this.localization("Enabled")},!0===this.enableMouseLock?"enabled":"disabled",B,!0),o(B),this.saveInBrowserSupported()){const e=n(!0,"Save States",r);c(this.localization("Save State Slot"),"save-state-slot",["1","2","3","4","5","6","7","8","9"],"1",e,!0),c(this.localization("Save State Location"),"save-state-location",{download:this.localization("Download"),browser:this.localization("Keep in Browser")},"download",e,!0),c(this.localization("System Save interval"),"save-save-interval",{0:"Disabled",30:"30 seconds",60:"1 minute",300:"5 minutes",600:"10 minutes",900:"15 minutes",1800:"30 minutes"},"300",e,!0),o(e)}if(this.touch||this.hasTouchScreen){const e=n(!0,"Virtual Gamepad",r);c(this.localization("Virtual Gamepad"),"virtual-gamepad",{enabled:this.localization("Enabled"),disabled:this.localization("Disabled")},this.isMobile?"enabled":"disabled",e,!0),c(this.localization("Menu Bar Button"),"menu-bar-button",{visible:this.localization("visible"),hidden:this.localization("hidden")},"visible",e,!0),c(this.localization("Left Handed Mode"),"virtual-gamepad-left-handed-mode",{enabled:this.localization("Enabled"),disabled:this.localization("Disabled")},"disabled",e,!0),o(e)}let A;try{A=this.gameManager.getCoreOptions()}catch(e){}if(A){const e=n(!0,"Backend Core Options",r);A.split("\n").forEach(((t,i)=>{let n=t.split("; "),o=n[0],r=n[1].split("|"),s=o.split("|")[0].replace(/_/g," ").replace(/.+\-(.+)/,"$1");if(r.slice(1,-1),1===r.length)return;let a={};for(let e=0;e<r.length;e++)a[r[e]]=this.localization(r[e],this.config.settingsLanguage);c(this.localization(s,this.config.settingsLanguage),o.split("|")[0],a,o.split("|").length>1?o.split("|")[1]:r[0].replace("(Default) ",""),e,!0)})),o(e)}if(this.retroarchOpts&&Array.isArray(this.retroarchOpts)){const e=n(!0,"RetroArch Options ("+this.localization("Requires restart")+")",r);this.retroarchOpts.forEach((t=>{c(this.localization(t.title,this.config.settingsLanguage),t.name,t.options,t.default,e,!0)})),o(e)}o(u),o(w),this.settingsMenu.appendChild(e),this.settingParent.appendChild(this.settingsMenu),this.settingParent.style.position="relative",this.settingsMenu.style.display="";const E=this.getElementSize(r);if(e.style.width=E.width+20+"px",e.style.height=E.height+"px",this.settingsMenu.style.display="none",this.debug&&console.log("Available core options",l),this.config.defaultOptions)for(const e in this.config.defaultOptions)this.changeSettingOption(e,this.config.defaultOptions[e],!0);0===i&&this.on("start",(()=>{this.elements.bottomBar.settings[0][0].style.display="none"}))}createSubPopup(e){const t=this.createElement("div");t.classList.add("ejs_popup_container"),t.classList.add("ejs_popup_container_box");const i=this.createElement("div");return i.innerText="",e&&t.setAttribute("hidden",""),t.appendChild(i),[t,i]}createNetplayMenu(){const e=this.createPopup("Netplay",{"Create a Room":()=>{this.isNetplay?this.netplay.leaveRoom():this.netplay.showOpenRoomDialog()},Close:()=>{this.netplayMenu.style.display="none",this.netplay.updateList.stop()}},!0);this.netplayMenu=e.parentElement;const t=this.netplayMenu.getElementsByTagName("a")[0],i=this.createElement("div"),n=this.createElement("strong");n.innerText=this.localization("Rooms");const o=this.createElement("table");o.classList.add("ejs_netplay_table"),o.style.width="100%",o.setAttribute("cellspacing","0");const r=this.createElement("thead"),s=this.createElement("tr"),a=e=>{const t=this.createElement("td");return t.innerText=e,t.style["text-align"]="center",s.appendChild(t),t};r.appendChild(s),a("Room Name").style["text-align"]="left",a("Players").style.width="80px",a("").style.width="80px",o.appendChild(r);const l=this.createElement("tbody");o.appendChild(l),i.appendChild(n),i.appendChild(o);const c=this.createElement("div"),d=this.createElement("strong");d.innerText="{roomname}";const u=this.createElement("div");u.innerText="Password: ";const g=this.createElement("table");g.classList.add("ejs_netplay_table"),g.style.width="100%",g.setAttribute("cellspacing","0");const h=this.createElement("thead"),p=this.createElement("tr"),m=e=>{const t=this.createElement("td");return t.innerText=e,p.appendChild(t),t};h.appendChild(p),m("Player").style.width="80px",m("Name"),m("").style.width="80px",g.appendChild(h);const f=this.createElement("tbody");g.appendChild(f),c.appendChild(d),c.appendChild(u),c.appendChild(g),c.style.display="none",e.appendChild(i),e.appendChild(c),this.openNetplayMenu=()=>{if(this.netplayMenu.style.display="",!this.netplay||this.netplay&&!this.netplay.name){this.netplay={},this.netplay.table=l,this.netplay.playerTable=f,this.netplay.passwordElem=u,this.netplay.roomNameElem=d,this.netplay.createButton=t,this.netplay.tabs=[i,c],this.defineNetplayFunctions();const e=this.createSubPopup();this.netplayMenu.appendChild(e[0]),e[1].classList.add("ejs_cheat_parent");const n=e[1],o=this.createElement("div"),r=this.createElement("h2");r.innerText=this.localization("Set Player Name"),r.classList.add("ejs_netplay_name_heading"),o.appendChild(r),n.appendChild(o);const s=this.createElement("div");s.classList.add("ejs_netplay_header");const a=this.createElement("strong");a.innerText=this.localization("Player Name");const g=this.createElement("input");g.type="text",g.setAttribute("maxlength",20),s.appendChild(a),s.appendChild(this.createElement("br")),s.appendChild(g),n.appendChild(s),n.appendChild(this.createElement("br"));const h=this.createElement("button");h.classList.add("ejs_button_button"),h.classList.add("ejs_popup_submit"),h.style["background-color"]="rgba(var(--ejs-primary-color),1)",h.innerText=this.localization("Submit"),n.appendChild(h),this.addEventListener(h,"click",(t=>{g.value.trim()&&(this.netplay.name=g.value.trim(),e[0].remove())}))}this.netplay.updateList.start()}}defineNetplayFunctions(){function e(){const e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}for(this.netplay.url=this.config.netplayUrl;this.netplay.url.endsWith("/");)this.netplay.url=this.netplay.url.substring(0,this.netplay.url.length-1);this.netplay.current_frame=0,this.netplay.getOpenRooms=async()=>JSON.parse(await(await fetch(this.netplay.url+"/list?domain="+window.location.host+"&game_id="+this.config.gameId)).text()),this.netplay.updateTableList=async()=>{const e=(e,t,i,n)=>{const o=this.createElement("tr");o.classList.add("ejs_netplay_table_row");const r=e=>{const t=this.createElement("td");return t.innerText=e,t.style.padding="10px 0",t.style["text-align"]="center",o.appendChild(t),t};r(t).style["text-align"]="left",r(i+"/"+n).style.width="80px";const s=r("");if(s.style.width="80px",this.netplay.table.appendChild(o),i<n){const i=this.createElement("button");return i.classList.add("ejs_netplay_join_button"),i.classList.add("ejs_button_button"),i.style["background-color"]="rgba(var(--ejs-primary-color),1)",i.innerText=this.localization("Join"),s.appendChild(i),this.addEventListener(i,"click",(i=>{this.netplay.joinRoom(e,t)})),i}},t=await this.netplay.getOpenRooms();this.netplay.table.innerHTML="";for(const i in t)e(i,t[i].room_name,t[i].current,t[i].max)},this.netplay.showOpenRoomDialog=()=>{const e=this.createSubPopup();this.netplayMenu.appendChild(e[0]),e[1].classList.add("ejs_cheat_parent");const t=e[1],i=this.createElement("div"),n=this.createElement("h2");n.innerText=this.localization("Create a room"),n.classList.add("ejs_netplay_name_heading"),i.appendChild(n),t.appendChild(i);const o=this.createElement("div");o.classList.add("ejs_netplay_header");const r=this.createElement("strong");r.innerText=this.localization("Room Name");const s=this.createElement("input");s.type="text",s.setAttribute("maxlength",20);const a=this.createElement("strong");a.innerText=this.localization("Max Players");const l=this.createElement("select");l.setAttribute("disabled","disabled");const c=this.createElement("option");c.value=2,c.innerText="2";const d=this.createElement("option");d.value=3,d.innerText="3";const u=this.createElement("option");u.value=4,u.innerText="4",l.appendChild(c),l.appendChild(d),l.appendChild(u);const g=this.createElement("strong");g.innerText=this.localization("Password (optional)");const h=this.createElement("input");h.type="text",h.setAttribute("maxlength",20),o.appendChild(r),o.appendChild(this.createElement("br")),o.appendChild(s),o.appendChild(a),o.appendChild(this.createElement("br")),o.appendChild(l),o.appendChild(g),o.appendChild(this.createElement("br")),o.appendChild(h),t.appendChild(o),t.appendChild(this.createElement("br"));const p=this.createElement("button");p.classList.add("ejs_button_button"),p.classList.add("ejs_popup_submit"),p.style["background-color"]="rgba(var(--ejs-primary-color),1)",p.style.margin="0 10px",p.innerText=this.localization("Submit"),t.appendChild(p),this.addEventListener(p,"click",(t=>{s.value.trim()&&(this.netplay.openRoom(s.value.trim(),parseInt(l.value),h.value.trim()),e[0].remove())}));const m=this.createElement("button");m.classList.add("ejs_button_button"),m.classList.add("ejs_popup_submit"),m.style.margin="0 10px",m.innerText=this.localization("Close"),t.appendChild(m),this.addEventListener(m,"click",(t=>{e[0].remove()}))},this.netplay.startSocketIO=e=>{this.netplay.socket=io(this.netplay.url),this.netplay.socket.on("connect",(()=>e())),this.netplay.socket.on("users-updated",(e=>{this.netplay.reset(),this.debug&&console.log(e),this.netplay.players=e,this.netplay.updatePlayersTable(),this.netplay.owner&&this.netplay.sync()})),this.netplay.socket.on("disconnect",(()=>this.netplay.roomLeft())),this.netplay.socket.on("data-message",(e=>{this.netplay.dataMessage(e)}))},this.netplay.openRoom=(t,i,n)=>{const o=e();this.netplay.playerID=e(),this.netplay.players={},this.netplay.extra={domain:window.location.host,game_id:this.config.gameId,room_name:t,player_name:this.netplay.name,userid:this.netplay.playerID,sessionid:o},this.netplay.players[this.netplay.playerID]=this.netplay.extra,this.netplay.users={},this.netplay.startSocketIO((e=>{this.netplay.socket.emit("open-room",{extra:this.netplay.extra,maxPlayers:i,password:n},(e=>{e?this.debug&&console.log("error: ",e):this.netplay.roomJoined(!0,t,n,o)}))}))},this.netplay.leaveRoom=()=>{this.debug&&console.log("asd"),this.netplay.roomLeft()},this.netplay.joinRoom=(t,i)=>{this.netplay.playerID=e(),this.netplay.players={},this.netplay.extra={domain:window.location.host,game_id:this.config.gameId,room_name:i,player_name:this.netplay.name,userid:this.netplay.playerID,sessionid:t},this.netplay.players[this.netplay.playerID]=this.netplay.extra,this.netplay.startSocketIO((e=>{this.netplay.socket.emit("join-room",{extra:this.netplay.extra},((e,n)=>{e?this.debug&&console.log("error: ",e):(this.netplay.players=n,this.netplay.roomJoined(!1,i,"",t))}))}))},this.netplay.roomJoined=(e,t,i,n)=>{this.isNetplay=!0,this.netplay.inputs={},this.netplay.owner=e,this.debug&&console.log(this.netplay.extra),this.netplay.roomNameElem.innerText=t,this.netplay.tabs[0].style.display="none",this.netplay.tabs[1].style.display="",i?(this.netplay.passwordElem.style.display="",this.netplay.passwordElem.innerText=this.localization("Password")+": "+i):this.netplay.passwordElem.style.display="none",this.netplay.createButton.innerText=this.localization("Leave Room"),this.netplay.updatePlayersTable(),this.netplay.owner?this.netplay.oldStyles=[this.elements.bottomBar.cheat[0].style.display]:(this.netplay.oldStyles=[this.elements.bottomBar.cheat[0].style.display,this.elements.bottomBar.playPause[0].style.display,this.elements.bottomBar.playPause[1].style.display,this.elements.bottomBar.restart[0].style.display,this.elements.bottomBar.loadState[0].style.display,this.elements.bottomBar.saveState[0].style.display,this.elements.bottomBar.saveSavFiles[0].style.display,this.elements.bottomBar.loadSavFiles[0].style.display,this.elements.contextMenu.save.style.display,this.elements.contextMenu.load.style.display],this.elements.bottomBar.cheat[0].style.display="none",this.elements.bottomBar.playPause[0].style.display="none",this.elements.bottomBar.playPause[1].style.display="none",this.elements.bottomBar.restart[0].style.display="none",this.elements.bottomBar.loadState[0].style.display="none",this.elements.bottomBar.saveState[0].style.display="none",this.elements.bottomBar.saveSavFiles[0].style.display="none",this.elements.bottomBar.loadSavFiles[0].style.display="none",this.elements.contextMenu.save.style.display="none",this.elements.contextMenu.load.style.display="none",this.gameManager.resetCheat()),this.elements.bottomBar.cheat[0].style.display="none"},this.netplay.updatePlayersTable=()=>{const e=this.netplay.playerTable;e.innerHTML="";const t=(t,i)=>{const n=this.createElement("tr"),o=e=>{const t=this.createElement("td");return t.innerText=e,n.appendChild(t),t};o(t).style.width="80px",o(i),o("").style.width="80px",e.appendChild(n)};let i=1;for(const e in this.netplay.players)t(i,this.netplay.players[e].player_name),i++},this.netplay.roomLeft=()=>{this.isNetplay=!1,this.netplay.tabs[0].style.display="",this.netplay.tabs[1].style.display="none",this.netplay.extra=null,this.netplay.playerID=null,this.netplay.createButton.innerText=this.localization("Create a Room"),this.netplay.socket.disconnect(),this.elements.bottomBar.cheat[0].style.display=this.netplay.oldStyles[0],this.netplay.owner||(this.elements.bottomBar.playPause[0].style.display=this.netplay.oldStyles[1],this.elements.bottomBar.playPause[1].style.display=this.netplay.oldStyles[2],this.elements.bottomBar.restart[0].style.display=this.netplay.oldStyles[3],this.elements.bottomBar.loadState[0].style.display=this.netplay.oldStyles[4],this.elements.bottomBar.saveState[0].style.display=this.netplay.oldStyles[5],this.elements.bottomBar.saveSavFiles[0].style.display=this.netplay.oldStyles[6],this.elements.bottomBar.loadSavFiles[0].style.display=this.netplay.oldStyles[7],this.elements.contextMenu.save.style.display=this.netplay.oldStyles[8],this.elements.contextMenu.load.style.display=this.netplay.oldStyles[9]),this.updateCheatUI()},this.netplay.setLoading=e=>{this.debug&&console.log("loading:",e)};let t=!1;this.netplay.sync=async()=>{if(t)return;t=!0,this.debug&&console.log("sync"),this.netplay.ready=0;const e=this.gameManager.getState();this.netplay.sendMessage({state:e}),this.netplay.setLoading(!0),this.pause(!0),this.netplay.ready++,this.netplay.current_frame=0,this.netplay.ready===this.netplay.getUserCount()&&this.play(!0),t=!1},this.netplay.getUserIndex=e=>{let t=0;for(const i in this.netplay.players){if(i===e)return t;t++}return-1},this.netplay.getUserCount=()=>{let e=0;for(const t in this.netplay.players)e++;return e};this.netplay.dataMessage=e=>{!0===e.sync&&this.netplay.owner&&this.netplay.sync(),e.state&&(this.netplay.wait=!0,this.netplay.setLoading(!0),this.pause(!0),this.gameManager.loadState(new Uint8Array(e.state)),this.netplay.sendMessage({ready:!0})),e.play&&!this.owner&&this.play(!0),e.pause&&!this.owner&&this.pause(!0),e.ready&&this.netplay.owner&&(this.netplay.ready++,this.netplay.ready===this.netplay.getUserCount()&&(this.netplay.sendMessage({readyready:!0}),this.netplay.reset(),setTimeout((()=>this.play(!0)),48),this.netplay.setLoading(!1))),e.readyready&&(this.netplay.setLoading(!1),this.netplay.reset(),this.play(!0)),e.shortPause&&console.log(e.shortPause),e.shortPause&&e.shortPause!==this.netplay.playerID&&(this.pause(!0),this.netplay.wait=!0,setTimeout((()=>this.play(!0)),48)),e["sync-control"]&&e["sync-control"].forEach((e=>{let t=parseInt(e.frame),i=this.netplay.currentFrame;!e.connected_input||e.connected_input[0]<0||(console.log(e,t,i),t===i&&(t++,this.gameManager.functions.simulateInput(e.connected_input[0],e.connected_input[1],e.connected_input[2])),this.netplay.inputsData[t]||(this.netplay.inputsData[t]=[]),this.netplay.inputsData[i]||(this.netplay.inputsData[i]=[]),this.netplay.owner?(this.netplay.inputsData[i].push(e),this.gameManager.functions.simulateInput(e.connected_input[0],e.connected_input[1],e.connected_input[2]),i-10>=t&&(this.netplay.wait=!0,this.pause(!0),setTimeout((()=>{this.play(!0),this.netplay.wait=!1}),48))):(this.netplay.inputsData[t].push(e),this.netplay.inputsData[i]&&this.play(!0),i+10<=t&&t>this.netplay.init_frame+100&&this.netplay.sendMessage({shortPause:this.netplay.playerID})))})),e.restart&&(this.gameManager.restart(),this.netplay.reset(),this.play(!0))},this.netplay.simulateInput=(e,t,i,n)=>{if(!this.isNetplay)return;if(0!==e&&!n)return;e=this.netplay.getUserIndex(this.netplay.playerID);let o=this.netplay.currentFrame;this.netplay.owner?(this.netplay.inputsData[o]||(this.netplay.inputsData[o]=[]),this.netplay.inputsData[o].push({frame:o,connected_input:[e,t,i]}),this.gameManager.functions.simulateInput(e,t,i)):this.netplay.sendMessage({"sync-control":[{frame:o+10,connected_input:[e,t,i]}]})},this.netplay.sendMessage=e=>{this.netplay.socket.emit("data-message",e)},this.netplay.reset=()=>{this.netplay.init_frame=this.netplay.currentFrame,this.netplay.inputsData={}},this.netplay.init_frame=0,this.netplay.currentFrame=0,this.netplay.inputsData={},this.Module.postMainLoop=()=>{if(this.netplay.currentFrame=parseInt(this.gameManager.getFrameNum())-this.netplay.init_frame,this.isNetplay){if(this.netplay.owner){let e=[],t=this.netplay.currentFrame-1;this.netplay.inputsData[t]?this.netplay.inputsData[t].forEach((t=>{t.frame+=10,e.push(t)})):e.push({frame:t+10}),this.netplay.sendMessage({"sync-control":e})}else this.netplay.currentFrame<=0||this.netplay.inputsData[this.netplay.currentFrame]?(this.netplay.wait=!1,this.play(),this.netplay.inputsData[this.netplay.currentFrame].forEach((e=>{e.connected_input&&(console.log(e.connected_input),this.gameManager.functions.simulateInput(e.connected_input[0],e.connected_input[1],e.connected_input[2]))}))):this.netplay.syncing||(console.log("sync"),this.pause(!0),this.netplay.sendMessage({sync:!0}),this.netplay.syncing=!0);this.netplay.currentFrame%100==0&&Object.keys(this.netplay.inputsData).forEach((e=>{e<this.netplay.currentFrame-50&&(this.netplay.inputsData[e]=null,delete this.netplay.inputsData[e])}))}},this.netplay.updateList={start:()=>{this.netplay.updateList.interval=setInterval(this.netplay.updateTableList.bind(this),1e3)},stop:()=>{clearInterval(this.netplay.updateList.interval)}}}createCheatsMenu(){const e=this.createPopup("Cheats",{"Add Cheat":()=>{const e=this.createSubPopup();this.cheatMenu.appendChild(e[0]),e[1].classList.add("ejs_cheat_parent"),e[1].style.width="100%";const t=e[1],i=this.createElement("div");i.classList.add("ejs_cheat_header");const n=this.createElement("h2");n.innerText=this.localization("Add Cheat Code"),n.classList.add("ejs_cheat_heading");const o=this.createElement("button");o.classList.add("ejs_cheat_close"),i.appendChild(n),i.appendChild(o),t.appendChild(i),this.addEventListener(o,"click",(t=>{e[0].remove()}));const r=this.createElement("div");r.classList.add("ejs_cheat_main");const s=this.createElement("strong");s.innerText=this.localization("Code"),r.appendChild(s),r.appendChild(this.createElement("br"));const a=this.createElement("textarea");a.classList.add("ejs_cheat_code"),a.style.width="100%",a.style.height="80px",r.appendChild(a),r.appendChild(this.createElement("br"));const l=this.createElement("strong");l.innerText=this.localization("Description"),r.appendChild(l),r.appendChild(this.createElement("br"));const c=this.createElement("input");c.type="text",c.classList.add("ejs_cheat_code"),r.appendChild(c),r.appendChild(this.createElement("br")),t.appendChild(r);const d=this.createElement("footer"),u=this.createElement("button"),g=this.createElement("button");u.innerText=this.localization("Submit"),g.innerText=this.localization("Close"),u.classList.add("ejs_button_button"),g.classList.add("ejs_button_button"),u.classList.add("ejs_popup_submit"),g.classList.add("ejs_popup_submit"),u.style["background-color"]="rgba(var(--ejs-primary-color),1)",d.appendChild(u);const h=this.createElement("span");h.innerText=" ",d.appendChild(h),d.appendChild(g),t.appendChild(d),this.addEventListener(u,"click",(t=>{a.value.trim()&&c.value.trim()&&(e[0].remove(),this.cheats.push({code:a.value,desc:c.value,checked:!1}),this.updateCheatUI(),this.saveSettings())})),this.addEventListener(g,"click",(t=>{e[0].remove()}))},Close:()=>{this.cheatMenu.style.display="none"}},!0);this.cheatMenu=e.parentElement,this.cheatMenu.getElementsByTagName("h4")[0].style["padding-bottom"]="0px";const t=this.createElement("div");t.style["padding-top"]="0px",t.style["padding-bottom"]="15px",t.innerText=this.localization("Note that some cheats require a restart to disable"),e.appendChild(t);const i=this.createElement("div");e.appendChild(i),i.classList.add("ejs_cheat_rows"),this.elements.cheatRows=i}updateCheatUI(){if(!this.gameManager)return;this.elements.cheatRows.innerHTML="";const e=(e,t,i,n,o)=>{const r=this.createElement("div");r.classList.add("ejs_cheat_row");const s=this.createElement("input");s.type="checkbox",s.checked=t,s.value=o,s.id="ejs_cheat_switch_"+o,r.appendChild(s);const a=this.createElement("label");if(a.for="ejs_cheat_switch_"+o,a.innerText=e,r.appendChild(a),a.addEventListener("click",(e=>{s.checked=!s.checked,this.cheats[o].checked=s.checked,this.cheatChanged(s.checked,i,o),this.saveSettings()})),!n){const e=this.createElement("a");e.classList.add("ejs_cheat_row_button"),e.innerText="",r.appendChild(e),e.addEventListener("click",(e=>{this.cheatChanged(!1,i,o),this.cheats.splice(o,1),this.updateCheatUI(),this.saveSettings()}))}this.elements.cheatRows.appendChild(r),this.cheatChanged(t,i,o)};this.gameManager.resetCheat();for(let t=0;t<this.cheats.length;t++)e(this.cheats[t].desc,this.cheats[t].checked,this.cheats[t].code,this.cheats[t].is_permanent,t)}cheatChanged(e,t,i){this.gameManager&&this.gameManager.setCheat(i,e,t)}enableShader(e){if(!this.gameManager)return;try{this.Module.FS.unlink("/shader/shader.glslp")}catch(e){}if("disabled"===e||!this.config.shaders[e])return void this.gameManager.toggleShader(0);const t=this.config.shaders[e];if("string"==typeof t)this.Module.FS.writeFile("/shader/shader.glslp",t,{},"w+");else{const e=t.shader;this.Module.FS.writeFile("/shader/shader.glslp","base64"===e.type?atob(e.value):e.value,{},"w+"),t.resources&&t.resources.length&&t.resources.forEach((e=>{this.Module.FS.writeFile(`/shader/${e.name}`,"base64"===e.type?atob(e.value):e.value,{},"w+")}))}this.gameManager.toggleShader(1)}screenshot(e,t,i,n){const o=i||this.getSettingValue("screenshotFormat")||this.capture.photo.format,r=n||parseInt(this.getSettingValue("screenshotUpscale")||this.capture.photo.upscale),s=t||this.getSettingValue("screenshotSource")||this.capture.photo.source,a=parseInt(this.getSettingValue("videoRotation")||0),l=this.gameManager.getVideoDimensions("aspect")||1.333333,c=(this.gameManager.getVideoDimensions("width"),this.gameManager.getVideoDimensions("height")||224),d=1===a||3===a;let u=this.canvas.width,g=this.canvas.height,h=r,p=r,m=1;if("retroarch"===s)u>=g?u=g*l:u<g&&(g=u/l),this.gameManager.screenshot().then((t=>{const i=new Blob([t],{type:"image/png"});if(0===r)e(i,"png");else if(r>1){m=r;const t=new Image,n=URL.createObjectURL(i);t.src=n,t.onload=()=>{const i=document.createElement("canvas");i.width=u*m,i.height=g*m;const r=i.getContext("2d",{alpha:!1});r.imageSmoothingEnabled=!1,r.scale(p,h),r.drawImage(t,0,0,u,g),i.toBlob((r=>{e(r,o),t.remove(),URL.revokeObjectURL(n),i.remove()}),"image/"+o,1)}}}));else if("canvas"===s){u>=g&&!d?u=g*l:u<g&&!d?g=u/l:u>=g&&d?u=g*(1/l):u<g&&d&&(u=g/(1/l)),0===r?(m=c/g,h=m,p=m):r>1&&(m=r);const t=document.createElement("canvas");t.width=u*m,t.height=g*m,t.style.display="none";const i=t.getContext("2d",{alpha:!1});i.imageSmoothingEnabled=!1,i.scale(m,m);const n=this.canvas.width/this.canvas.height,s=u/g;let a=0,f=0;n>s?a=(this.canvas.width-u)/-2:n<s&&(f=(this.canvas.height-g)/-2);requestAnimationFrame((()=>{i.drawImage(this.canvas,a,f,this.canvas.width,this.canvas.height),t.toBlob((i=>{e(i,o),t.remove()}),"image/"+o,1)}))}}async takeScreenshot(e,t,i){return new Promise((n=>{this.screenshot(((e,t)=>{n({blob:e,format:t})}),e,t,i)}))}collectScreenRecordingMediaTracks(e,t){let i=null;const n=e.captureStream(t).getVideoTracks();if(0===n.length)return console.error("Unable to capture video stream"),null;i=n[0];let o=null;if(this.Module.AL&&this.Module.AL.currentCtx&&this.Module.AL.currentCtx.audioCtx){const e=this.Module.AL.currentCtx,t=e.audioCtx,i=[];for(let t in e.sources)i.push(e.sources[t].gain);const n=t.createChannelMerger(i.length);i.forEach((e=>e.connect(n)));const r=t.createMediaStreamDestination();n.connect(r);const s=r.stream.getAudioTracks();0!==s.length&&(o=s[0])}const r=new MediaStream;return i&&"live"===i.readyState&&r.addTrack(i),o&&"live"===o.readyState&&r.addTrack(o),r}screenRecord(){const e=this.getSettingValue("screenRecordingFPS")||this.capture.video.fps,t=this.getSettingValue("screenRecordFormat")||this.capture.video.format,i=this.getSettingValue("screenRecordUpscale")||this.capture.video.upscale,n=this.getSettingValue("screenRecordVideoBitrate")||this.capture.video.videoBitrate,o=this.getSettingValue("screenRecordAudioBitrate")||this.capture.video.audioBitrate,r=this.gameManager.getVideoDimensions("aspect")||1.333333,s=parseInt(this.getSettingValue("videoRotation")||0),a=1===s||3===s;let l=800,c=600,d=this.canvas.width/this.canvas.height,u=l/c,g=0,h=0;const p=document.createElement("canvas"),m=p.getContext("2d",{alpha:!1});m.fillStyle="#000",m.imageSmoothingEnabled=!1;const f=()=>{l=this.canvas.width,c=this.canvas.height,d=l/c,l>=c&&!a?l=c*r:l<c&&!a?c=l/r:l>=c&&a?l=c*(1/r):l<c&&a&&(l=c/(1/r)),u=l/c,p.width=l*i,p.height=c*i,m.scale(i,i),d>u?g=(this.canvas.width-l)/-2:d<u&&(h=(this.canvas.height-c)/-2)};f(),this.addEventListener(this.canvas,"resize",(()=>{f()}));let b=!0;const C=()=>{m.drawImage(this.canvas,g,h,this.canvas.width,this.canvas.height),b&&requestAnimationFrame(C)};requestAnimationFrame(C);const I=[],y=this.collectScreenRecordingMediaTracks(p,e),v=new MediaRecorder(y,{videoBitsPerSecond:n,audioBitsPerSecond:o,mimeType:"video/"+t});return v.addEventListener("dataavailable",(e=>{I.push(e.data)})),v.addEventListener("stop",(()=>{const e=new Blob(I),i=URL.createObjectURL(e),n=new Date,o=document.createElement("a");o.href=i,o.download=this.getBaseFileName()+"-"+n.getMonth()+"-"+n.getDate()+"-"+n.getFullYear()+"."+t,o.click(),b=!1,p.remove()})),v.start(),v}}window.EmulatorJS=EmulatorJS;class EJS_GameManager{constructor(e,t){this.EJS=t,this.Module=e,this.FS=this.Module.FS,this.functions={restart:this.Module.cwrap("system_restart","",[]),saveStateInfo:this.Module.cwrap("save_state_info","string",[]),loadState:this.Module.cwrap("load_state","number",["string","number"]),screenshot:this.Module.cwrap("cmd_take_screenshot","",[]),simulateInput:this.Module.cwrap("simulate_input","null",["number","number","number"]),toggleMainLoop:this.Module.cwrap("toggleMainLoop","null",["number"]),getCoreOptions:this.Module.cwrap("get_core_options","string",[]),setVariable:this.Module.cwrap("ejs_set_variable","null",["string","string"]),setCheat:this.Module.cwrap("set_cheat","null",["number","number","string"]),resetCheat:this.Module.cwrap("reset_cheat","null",[]),toggleShader:this.Module.cwrap("shader_enable","null",["number"]),getDiskCount:this.Module.cwrap("get_disk_count","number",[]),getCurrentDisk:this.Module.cwrap("get_current_disk","number",[]),setCurrentDisk:this.Module.cwrap("set_current_disk","null",["number"]),getSaveFilePath:this.Module.cwrap("save_file_path","string",[]),saveSaveFiles:this.Module.cwrap("cmd_savefiles","",[]),supportsStates:this.Module.cwrap("supports_states","number",[]),loadSaveFiles:this.Module.cwrap("refresh_save_files","null",[]),toggleFastForward:this.Module.cwrap("toggle_fastforward","null",["number"]),setFastForwardRatio:this.Module.cwrap("set_ff_ratio","null",["number"]),toggleRewind:this.Module.cwrap("toggle_rewind","null",["number"]),setRewindGranularity:this.Module.cwrap("set_rewind_granularity","null",["number"]),toggleSlowMotion:this.Module.cwrap("toggle_slow_motion","null",["number"]),setSlowMotionRatio:this.Module.cwrap("set_sm_ratio","null",["number"]),getFrameNum:this.Module.cwrap("get_current_frame_count","number",[""]),setVSync:this.Module.cwrap("set_vsync","null",["number"]),setVideoRoation:this.Module.cwrap("set_video_rotation","null",["number"]),getVideoDimensions:this.Module.cwrap("get_video_dimensions","number",["string"]),setKeyboardEnabled:this.Module.cwrap("ejs_set_keyboard_enabled","null",["number"])},this.writeFile("/home/web_user/.config/retroarch/retroarch.cfg",this.getRetroArchCfg()),this.writeConfigFile(),this.initShaders(),this.setupPreLoadSettings(),this.EJS.on("exit",(()=>{this.EJS.failedToStart||(this.saveSaveFiles(),this.functions.restart(),this.saveSaveFiles()),this.toggleMainLoop(0),this.FS.unmount("/data/saves"),setTimeout((()=>{try{this.Module.abort()}catch(e){console.warn(e)}}),1e3)}))}setupPreLoadSettings(){this.Module.callbacks.setupCoreSettingFile=e=>{this.EJS.debug&&console.log("Setting up core settings with path:",e),this.writeFile(e,this.EJS.getCoreSettings())}}mountFileSystems(){return new Promise((async e=>{this.mkdir("/data"),this.mkdir("/data/saves"),this.FS.mount(this.FS.filesystems.IDBFS,{autoPersist:!0},"/data/saves"),this.FS.syncfs(!0,e)}))}writeConfigFile(){if(!this.EJS.defaultCoreOpts.file||!this.EJS.defaultCoreOpts.settings)return;let e="";for(const t in this.EJS.defaultCoreOpts.settings)e+=t+' = "'+this.EJS.defaultCoreOpts.settings[t]+'"\n';this.writeFile("/home/web_user/retroarch/userdata/config/"+this.EJS.defaultCoreOpts.file,e)}loadExternalFiles(){return new Promise((async(e,t)=>{if(this.EJS.config.externalFiles&&"Object"===this.EJS.config.externalFiles.constructor.name)for(const e in this.EJS.config.externalFiles)await new Promise((t=>{this.EJS.downloadFile(this.EJS.config.externalFiles[e],null,!0,{responseType:"arraybuffer",method:"GET"}).then((async i=>{if(-1===i)return this.EJS.debug&&console.warn("Failed to fetch file from '"+this.EJS.config.externalFiles[e]+"'. Make sure the file exists."),t();let n=e;if(e.trim().endsWith("/")){const o=/[#<$+%>!`&*'|{}/\\?"=@:^\r\n]/gi;let r=this.EJS.config.externalFiles[e].split("/").pop().split("#")[0].split("?")[0].replace(o,"").trim();if(!r)return t();const s=await this.EJS.checkCompression(new Uint8Array(i.data),this.EJS.localization("Decompress Game Assets"));if(!s["!!notCompressedData"]){for(const e in s)this.writeFile(n+e,s[e]);return t()}n+=r}try{this.writeFile(n,i.data)}catch(e){this.EJS.debug&&console.warn("Failed to write file to '"+n+"'. Make sure there are no conflicting files.")}t()}))}));e()}))}writeFile(e,t){const i=e.split("/");let n="/";for(let e=0;e<i.length-1;e++)i[e].trim()&&(n+=i[e]+"/",this.mkdir(n));this.FS.writeFile(e,t)}mkdir(e){try{this.FS.mkdir(e)}catch(e){}}getRetroArchCfg(){let e='autosave_interval = 60\nscreenshot_directory = "/"\nblock_sram_overwrite = false\nvideo_gpu_screenshot = false\naudio_latency = 64\nvideo_top_portrait_viewport = true\nvideo_vsync = true\nvideo_smooth = false\nfastforward_ratio = 3.0\nslowmotion_ratio = 3.0\n'+(this.EJS.rewindEnabled?"rewind_enable = true\n":"")+(this.EJS.rewindEnabled?"rewind_granularity = 6\n":"")+'savefile_directory = "/data/saves"\n';return this.EJS.retroarchOpts&&Array.isArray(this.EJS.retroarchOpts)&&this.EJS.retroarchOpts.forEach((t=>{let i=this.EJS.preGetSetting(t.name);console.log(i),i||(i=t.default);const n=!1===t.isString?i:'"'+i+'"';e+=t.name+" = "+n+"\n"})),e}initShaders(){if(this.EJS.config.shaders){this.mkdir("/shader");for(const e in this.EJS.config.shaders){const t=this.EJS.config.shaders[e];"string"==typeof t&&this.FS.writeFile(`/shader/${e}`,t)}}}clearEJSResetTimer(){this.EJS.resetTimeout&&(clearTimeout(this.EJS.resetTimeout),delete this.EJS.resetTimeout)}restart(){this.clearEJSResetTimer(),this.functions.restart()}getState(){const e=this.functions.saveStateInfo().split("|");if("1"!==e[2])throw console.error(e[0]),new Error(e[0]);const t=parseInt(e[0]),i=parseInt(e[1]),n=this.Module.HEAPU8.subarray(i,i+t);return new Uint8Array(n)}loadState(e){try{this.FS.unlink("game.state")}catch(e){}this.FS.writeFile("/game.state",e),this.clearEJSResetTimer(),this.functions.loadState("game.state",0),setTimeout((()=>{try{this.FS.unlink("game.state")}catch(e){}}),5e3)}screenshot(){try{this.FS.unlink("screenshot.png")}catch(e){}return this.functions.screenshot(),new Promise((async e=>{for(;;){try{return this.FS.stat("/screenshot.png"),e(this.FS.readFile("/screenshot.png"))}catch(e){}await new Promise((e=>setTimeout(e,50)))}}))}quickSave(e){e||(e=1);let t=e+"-quick.state";try{this.FS.unlink(t)}catch(e){}try{let e=this.getState();this.FS.writeFile("/"+t,e)}catch(e){return!1}return!0}quickLoad(e){e||(e=1),(async()=>{let t=e+"-quick.state";this.clearEJSResetTimer(),this.functions.loadState(t,0)})()}simulateInput(e,t,i){if(this.EJS.isNetplay)this.EJS.netplay.simulateInput(e,t,i);else{if([24,25,26,27,28,29].includes(t)){if(24===t&&1===i){const e=this.EJS.settings["save-state-slot"]?this.EJS.settings["save-state-slot"]:"1";this.quickSave(e)?this.EJS.displayMessage(this.EJS.localization("SAVED STATE TO SLOT")+" "+e):this.EJS.displayMessage(this.EJS.localization("FAILED TO SAVE STATE"))}if(25===t&&1===i){const e=this.EJS.settings["save-state-slot"]?this.EJS.settings["save-state-slot"]:"1";this.quickLoad(e),this.EJS.displayMessage(this.EJS.localization("LOADED STATE FROM SLOT")+" "+e)}if(26===t&&1===i){let e;try{e=parseFloat(this.EJS.settings["save-state-slot"]?this.EJS.settings["save-state-slot"]:"1")+1}catch(t){e=1}e>9&&(e=1),this.EJS.displayMessage(this.EJS.localization("SET SAVE STATE SLOT TO")+" "+e),this.EJS.changeSettingOption("save-state-slot",e.toString())}return 27===t&&this.functions.toggleFastForward(this.EJS.isFastForward?!i:i),29===t&&this.functions.toggleSlowMotion(this.EJS.isSlowMotion?!i:i),void(28===t&&this.EJS.rewindEnabled&&this.functions.toggleRewind(i))}this.functions.simulateInput(e,t,i)}}getFileNames(){return"picodrive"===this.EJS.getCore()?["bin","gen","smd","md","32x","cue","iso","sms","68k","chd"]:["toc","ccd","exe","pbp","chd","img","bin","iso"]}createCueFile(e){try{e.length>1&&(e=(e=e.filter((e=>this.getFileNames().includes(e.split(".").pop().toLowerCase())))).sort(((e,t)=>{if(isNaN(e.charAt())||isNaN(t.charAt()))throw new Error("Incorrect file name format");return parseInt(e.charAt())>parseInt(t.charAt())?1:-1})))}catch(t){if(e.length>1)return console.warn("Could not auto-create cue file(s)."),null}for(let t=0;t<e.length;t++)if("ccd"===e[t].split(".").pop().toLowerCase())return console.warn("Did not auto-create cue file(s). Found a ccd."),null;if(0===e.length)return console.warn("Could not auto-create cue file(s)."),null;let t=e[0].split("/").pop();t.includes(".")&&(t=t.substring(0,t.length-t.split(".").pop().length-1));for(let i=0;i<e.length;i++){const n=' FILE "'+e[i]+'" BINARY\n  TRACK 01 MODE1/2352\n   INDEX 01 00:00:00';this.FS.writeFile("/"+t+"-"+i+".cue",n)}if(e.length>1){let i="";for(let n=0;n<e.length;n++)i+="/"+t+"-"+n+".cue\n";this.FS.writeFile("/"+t+".m3u",i)}return 1===e.length?t+"-0.cue":t+".m3u"}loadPpssppAssets(){return new Promise((e=>{this.EJS.downloadFile("cores/ppsspp-assets.zip",null,!1,{responseType:"arraybuffer",method:"GET"}).then((t=>{this.EJS.checkCompression(new Uint8Array(t.data),this.EJS.localization("Decompress Game Data")).then((t=>{if(-1===t)return this.EJS.textElem.innerText=this.localization("Network Error"),void(this.EJS.textElem.style.color="red");this.mkdir("/PPSSPP");for(const e in t){const i=t[e],n="/PPSSPP/"+e,o=n.split("/");let r="";for(let e=0;e<o.length-1;e++)""!==o[e]&&(r+="/"+o[e],this.FS.analyzePath(r).exists||this.FS.mkdir(r));n.endsWith("/")||this.FS.writeFile(n,i)}e()}))}))}))}setVSync(e){this.functions.setVSync(e)}toggleMainLoop(e){this.functions.toggleMainLoop(e)}getCoreOptions(){return this.functions.getCoreOptions()}setVariable(e,t){this.functions.setVariable(e,t)}setCheat(e,t,i){this.functions.setCheat(e,t,i)}resetCheat(){this.functions.resetCheat()}toggleShader(e){this.functions.toggleShader(e)}getDiskCount(){return this.functions.getDiskCount()}getCurrentDisk(){return this.functions.getCurrentDisk()}setCurrentDisk(e){this.functions.setCurrentDisk(e)}getSaveFilePath(){return this.functions.getSaveFilePath()}saveSaveFiles(){this.functions.saveSaveFiles(),this.EJS.callEvent("saveSaveFiles",this.getSaveFile(!1))}supportsStates(){return!!this.functions.supportsStates()}getSaveFile(e){!1!==e&&this.saveSaveFiles();return this.FS.analyzePath(this.getSaveFilePath()).exists?this.FS.readFile(this.getSaveFilePath()):null}loadSaveFiles(){this.clearEJSResetTimer(),this.functions.loadSaveFiles()}setFastForwardRatio(e){this.functions.setFastForwardRatio(e)}toggleFastForward(e){this.functions.toggleFastForward(e)}setSlowMotionRatio(e){this.functions.setSlowMotionRatio(e)}toggleSlowMotion(e){this.functions.toggleSlowMotion(e)}setRewindGranularity(e){this.functions.setRewindGranularity(e)}getFrameNum(){return this.functions.getFrameNum()}setVideoRotation(e){this.functions.setVideoRoation(e)}getVideoDimensions(e){try{return this.functions.getVideoDimensions(e)}catch(e){console.warn(e)}}setKeyboardEnabled(e){this.functions.setKeyboardEnabled(!0===e?1:0)}setAltKeyEnabled(e){this.functions.setKeyboardEnabled(!0===e?3:2)}}window.EJS_GameManager=EJS_GameManager;class GamepadHandler{gamepads;timeout;listeners;constructor(){this.buttonLabels={0:"BUTTON_1",1:"BUTTON_2",2:"BUTTON_3",3:"BUTTON_4",4:"LEFT_TOP_SHOULDER",5:"RIGHT_TOP_SHOULDER",6:"LEFT_BOTTOM_SHOULDER",7:"RIGHT_BOTTOM_SHOULDER",8:"SELECT",9:"START",10:"LEFT_STICK",11:"RIGHT_STICK",12:"DPAD_UP",13:"DPAD_DOWN",14:"DPAD_LEFT",15:"DPAD_RIGHT"},this.gamepads=[],this.listeners={},this.timeout=null,this.loop()}terminate(){window.clearTimeout(this.timeout)}getGamepads(){return navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[]}loop(){this.updateGamepadState(),this.timeout=setTimeout(this.loop.bind(this),10)}updateGamepadState(){let e=Array.from(this.getGamepads());if(e){if(!Array.isArray(e)&&e.length){let t=[];for(let i=0;i<e.length;i++)t.push(e[i]);e=t}else if(!Array.isArray(e))return;e.forEach(((t,i)=>{if(!t)return;let n=!1;this.gamepads.forEach(((e,i)=>{if(e.index!==t.index)return;const o={axes:[],buttons:{},index:e.index,id:e.id};n=!0,e.axes.forEach(((e,i)=>{const n=e<.01&&e>-.01?0:e,r=t.axes[i]<.01&&t.axes[i]>-.01?0:t.axes[i];if(r!==n){let e=["LEFT_STICK_X","LEFT_STICK_Y","RIGHT_STICK_X","RIGHT_STICK_Y"][i];e||(e="EXTRA_STICK_"+i),this.dispatchEvent("axischanged",{axis:e,value:r,index:t.index,label:this.getAxisLabel(e,r),gamepadIndex:t.index})}o.axes[i]=r})),t.buttons.forEach(((i,n)=>{let r=1===e.buttons[n];"object"==typeof e.buttons[n]&&(r=e.buttons[n].pressed);let s=1===i;"object"==typeof i&&(s=i.pressed),o.buttons[n]={pressed:s},r!==s&&(s?this.dispatchEvent("buttondown",{index:n,label:this.getButtonLabel(n),gamepadIndex:t.index}):this.dispatchEvent("buttonup",{index:n,label:this.getButtonLabel(n),gamepadIndex:t.index}))})),this.gamepads[i]=o})),n||(this.gamepads.push(e[i]),this.gamepads.sort(((e,t)=>null==e&&null==t?0:null==e?1:null==t?-1:e.index-t.index)),this.dispatchEvent("connected",{gamepadIndex:t.index}))}));for(let t=0;t<this.gamepads.length;t++){if(!this.gamepads[t])continue;let i=!1;for(let n=0;n<e.length;n++)if(e[n]&&this.gamepads[t].index===e[n].index){i=!0;break}i||(this.dispatchEvent("disconnected",{gamepadIndex:this.gamepads[t].index}),this.gamepads.splice(t,1),t--)}}}dispatchEvent(e,t){"function"==typeof this.listeners[e]&&(t||(t={}),t.type=e,this.listeners[e](t))}on(e,t){this.listeners[e.toLowerCase()]=t}getButtonLabel(e){return null==e?null:void 0===this.buttonLabels[e]?`GAMEPAD_${e}`:this.buttonLabels[e]}getAxisLabel(e,t){let i=null;return(t>.5||t<-.5)&&(i=t>0?"+1":"-1"),e&&i?`${e}:${i}`:null}}window.GamepadHandler=GamepadHandler,function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("nipplejs",[],t):"object"==typeof exports?exports.nipplejs=t():e.nipplejs=t()}(window,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t);var n,o=function(e,t){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},r=function(e){return e*(Math.PI/180)},s=new Map,a=function(e){s.has(e)&&clearTimeout(s.get(e)),s.set(e,setTimeout(e,100))},l=function(e,t,i){for(var n,o=t.split(/[ ,]+/g),r=0;r<o.length;r+=1)n=o[r],e.addEventListener?e.addEventListener(n,i,!1):e.attachEvent&&e.attachEvent(n,i)},c=function(e,t,i){for(var n,o=t.split(/[ ,]+/g),r=0;r<o.length;r+=1)n=o[r],e.removeEventListener?e.removeEventListener(n,i):e.detachEvent&&e.detachEvent(n,i)},d=function(e){return e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e},u=function(){return{x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},g=function(e,t){t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},h=function(e,t,i){var n=p(e);for(var o in n)if(n.hasOwnProperty(o))if("string"==typeof t)n[o]=t+" "+i;else{for(var r="",s=0,a=t.length;s<a;s+=1)r+=t[s]+" "+i+", ";n[o]=r.slice(0,-2)}return n},p=function(e){var t={};return t[e]="",["webkit","Moz","o"].forEach((function(i){t[i+e.charAt(0).toUpperCase()+e.slice(1)]=""})),t},m=function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},f=function(e,t){if(e.length)for(var i=0,n=e.length;i<n;i+=1)t(e[i]);else t(e)},b=!!("ontouchstart"in window),C=!!window.PointerEvent,I=!!window.MSPointerEvent,y={start:"mousedown",move:"mousemove",end:"mouseup"},v={};function Z(){}C?n={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:I?n={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:b?(n={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},v=y):n=y,Z.prototype.on=function(e,t){var i,n=e.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var o=0;o<n.length;o+=1)i=n[o],this._handlers_[i]=this._handlers_[i]||[],this._handlers_[i].push(t);return this},Z.prototype.off=function(e,t){return this._handlers_=this._handlers_||{},void 0===e?this._handlers_={}:void 0===t?this._handlers_[e]=null:this._handlers_[e]&&this._handlers_[e].indexOf(t)>=0&&this._handlers_[e].splice(this._handlers_[e].indexOf(t),1),this},Z.prototype.trigger=function(e,t){var i,n=this,o=e.split(/[ ,]+/g);n._handlers_=n._handlers_||{};for(var r=0;r<o.length;r+=1)i=o[r],n._handlers_[i]&&n._handlers_[i].length&&n._handlers_[i].forEach((function(e){e.call(n,{type:i,target:n},t)}))},Z.prototype.config=function(e){this.options=this.defaults||{},e&&(this.options=function(e,t){var i={};for(var n in e)e.hasOwnProperty(n)&&t.hasOwnProperty(n)?i[n]=t[n]:e.hasOwnProperty(n)&&(i[n]=e[n]);return i}(this.options,e))},Z.prototype.bindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[t]=function(){"function"==typeof i["on"+t]?i["on"+t].apply(i,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},l(e,n[t],i._domHandlers_[t]),v[t]&&l(e,v[t],i._domHandlers_[t]),i},Z.prototype.unbindEvt=function(e,t){return this._domHandlers_=this._domHandlers_||{},c(e,n[t],this._domHandlers_[t]),v[t]&&c(e,v[t],this._domHandlers_[t]),delete this._domHandlers_[t],this};var S=Z;function V(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=V.id,V.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}V.prototype=new S,V.constructor=V,V.id=0,V.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},V.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=function(){var e=p("borderRadius");for(var t in e)e.hasOwnProperty(t)&&(e[t]="50%");return e}(),i=h("transition","opacity",e),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},m(n.el,i),"circle"===this.options.shape&&m(n.back,t),m(n.front,t),this.applyStyles(n),this},V.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var i in e[t])this.ui[t].style[i]=e[t][i];return this},V.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},V.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},V.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},V.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout((function(){t.ui.el.style.opacity=1}),0),t.showTimeout=setTimeout((function(){t.trigger("shown",t.instance),"function"==typeof e&&e.call(this)}),t.options.fadeTime)),t},V.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout((function(){var i="dynamic"===t.options.mode?"none":"block";t.ui.el.style.display=i,"function"==typeof e&&e.call(t),t.trigger("hidden",t.instance)}),t.options.fadeTime),t.options.restJoystick){var i=t.options.restJoystick,n={};n.x=!0===i||!1!==i.x?0:t.instance.frontPosition.x,n.y=!0===i||!1!==i.y?0:t.instance.frontPosition.y,t.setPosition(e,n)}return t},V.prototype.setPosition=function(e,t){var i=this;i.frontPosition={x:t.x,y:t.y};var n=i.options.fadeTime+"ms",o={};o.front=h("transition",["transform"],n);var r={front:{}};r.front={transform:"translate("+i.frontPosition.x+"px,"+i.frontPosition.y+"px)"},i.applyStyles(o),i.applyStyles(r),i.restTimeout=setTimeout((function(){"function"==typeof e&&e.call(i),i.restCallback()}),i.options.fadeTime)},V.prototype.restCallback=function(){var e={};e.front=h("transition","none",""),this.applyStyles(e),this.trigger("rested",this.instance)},V.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},V.prototype.computeDirection=function(e){var t,i,n,o=e.angle.radian,r=Math.PI/4,s=Math.PI/2;if(o>r&&o<3*r&&!e.lockX?t="up":o>-r&&o<=r&&!e.lockY?t="left":o>3*-r&&o<=-r&&!e.lockX?t="down":e.lockY||(t="right"),e.lockY||(i=o>-s&&o<s?"left":"right"),e.lockX||(n=o>0?"up":"down"),e.force>this.options.threshold){var a,l={};for(a in this.direction)this.direction.hasOwnProperty(a)&&(l[a]=this.direction[a]);var c={};for(a in this.direction={x:i,y:n,angle:t},e.direction=this.direction,l)l[a]===this.direction[a]&&(c[a]=!0);if(c.x&&c.y&&c.angle)return e;c.x&&c.y||this.trigger("plain",e),c.x||this.trigger("plain:"+i,e),c.y||this.trigger("plain:"+n,e),c.angle||this.trigger("dir dir:"+t,e)}else this.resetDirection();return e};var w=V;function B(e,t){this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=e,this.id=B.id,B.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},this.config(t),"static"!==this.options.mode&&"semi"!==this.options.mode||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1);var i=getComputedStyle(this.options.zone.parentElement);return i&&"flex"===i.display&&(this.parentIsFlex=!0),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}B.prototype=new S,B.constructor=B,B.id=0,B.prototype.prepareNipples=function(){var e=this.nipples;e.on=this.on.bind(this),e.off=this.off.bind(this),e.options=this.options,e.destroy=this.destroy.bind(this),e.ids=this.ids,e.id=this.id,e.processOnMove=this.processOnMove.bind(this),e.processOnEnd=this.processOnEnd.bind(this),e.get=function(t){if(void 0===t)return e[0];for(var i=0,n=e.length;i<n;i+=1)if(e[i].identifier===t)return e[i];return!1}},B.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},B.prototype.begin=function(){var e=this.options;if("static"===e.mode){var t=this.createNipple(e.position,this.manager.getIdentifier());t.add(),this.idles.push(t)}},B.prototype.createNipple=function(e,t){var i=this.manager.scroll,n={},o=this.options,r=this.parentIsFlex?i.x:i.x+this.box.left,s=this.parentIsFlex?i.y:i.y+this.box.top;if(e.x&&e.y)n={x:e.x-r,y:e.y-s};else if(e.top||e.right||e.bottom||e.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=e.top,a.style.right=e.right,a.style.bottom=e.bottom,a.style.left=e.left,a.style.position="absolute",o.zone.appendChild(a);var l=a.getBoundingClientRect();o.zone.removeChild(a),n=e,e={x:l.left+i.x,y:l.top+i.y}}var c=new w(this,{color:o.color,size:o.size,threshold:o.threshold,fadeTime:o.fadeTime,dataOnly:o.dataOnly,restJoystick:o.restJoystick,restOpacity:o.restOpacity,mode:o.mode,identifier:t,position:e,zone:o.zone,frontPosition:{x:0,y:0},shape:o.shape});return o.dataOnly||(g(c.ui.el,n),g(c.ui.front,c.frontPosition)),this.nipples.push(c),this.trigger("added "+c.identifier+":added",c),this.manager.trigger("added "+c.identifier+":added",c),this.bindNipple(c),c},B.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},B.prototype.bindNipple=function(e){var t,i=this,n=function(e,n){t=e.type+" "+n.id+":"+e.type,i.trigger(t,n)};e.on("destroyed",i.onDestroyed.bind(i)),e.on("shown hidden rested dir plain",n),e.on("dir:up dir:right dir:down dir:left",n),e.on("plain:up plain:right plain:down plain:left",n)},B.prototype.pressureFn=function(e,t,i){var n=this,o=0;clearInterval(n.pressureIntervals[i]),n.pressureIntervals[i]=setInterval(function(){var i=e.force||e.pressure||e.webkitForce||0;i!==o&&(t.trigger("pressure",i),n.trigger("pressure "+t.identifier+":pressure",i),o=i)}.bind(n),100)},B.prototype.onstart=function(e){var t=this,i=t.options,n=e;return e=d(e),t.updateBox(),f(e,(function(o){t.actives.length<i.maxNumberOfNipples?t.processOnStart(o):n.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach((function(i){if(Object.values(n.touches).findIndex((function(e){return e.identifier===i}))<0){var o=[e[0]];o.identifier=i,t.processOnEnd(o)}})),t.actives.length<i.maxNumberOfNipples&&t.processOnStart(o))})),t.manager.bindDocument(),!1},B.prototype.processOnStart=function(e){var t,i=this,n=i.options,r=i.manager.getIdentifier(e),s=e.force||e.pressure||e.webkitForce||0,a={x:e.pageX,y:e.pageY},l=i.getOrCreate(r,a);l.identifier!==r&&i.manager.removeIdentifier(l.identifier),l.identifier=r;var c=function(t){t.trigger("start",t),i.trigger("start "+t.id+":start",t),t.show(),s>0&&i.pressureFn(e,t,t.identifier),i.processOnMove(e)};if((t=i.idles.indexOf(l))>=0&&i.idles.splice(t,1),i.actives.push(l),i.ids.push(l.identifier),"semi"!==n.mode)c(l);else{if(!(o(a,l.position)<=n.catchDistance))return l.destroy(),void i.processOnStart(e);c(l)}return l},B.prototype.getOrCreate=function(e,t){var i,n=this.options;return/(semi|static)/.test(n.mode)?(i=this.idles[0])?(this.idles.splice(0,1),i):"semi"===n.mode?this.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1):i=this.createNipple(t,e)},B.prototype.processOnMove=function(e){var t=this.options,i=this.manager.getIdentifier(e),n=this.nipples.get(i),s=this.manager.scroll;if(function(e){return isNaN(e.buttons)?0!==e.pressure:0!==e.buttons}(e)){if(!n)return console.error("Found zombie joystick with ID "+i),void this.manager.removeIdentifier(i);if(t.dynamicPage){var a=n.el.getBoundingClientRect();n.position={x:s.x+a.left,y:s.y+a.top}}n.identifier=i;var l=n.options.size/2,c={x:e.pageX,y:e.pageY};t.lockX&&(c.y=n.position.y),t.lockY&&(c.x=n.position.x);var d,u,g,h,p,m,f,b,C,I,y=o(c,n.position),v=(d=c,g=(u=n.position).x-d.x,h=u.y-d.y,function(e){return e*(180/Math.PI)}(Math.atan2(h,g))),Z=r(v),S=y/l,V={distance:y,position:c};if("circle"===n.options.shape?(p=Math.min(y,l),f=n.position,b=p,I={x:0,y:0},C=r(C=v),I.x=f.x-b*Math.cos(C),I.y=f.y-b*Math.sin(C),m=I):(m=function(e,t,i){return{x:Math.min(Math.max(e.x,t.x-i),t.x+i),y:Math.min(Math.max(e.y,t.y-i),t.y+i)}}(c,n.position,l),p=o(m,n.position)),t.follow){if(y>l){var w=c.x-m.x,B=c.y-m.y;n.position.x+=w,n.position.y+=B,n.el.style.top=n.position.y-(this.box.top+s.y)+"px",n.el.style.left=n.position.x-(this.box.left+s.x)+"px",y=o(c,n.position)}}else c=m,y=p;var A=c.x-n.position.x,E=c.y-n.position.y;n.frontPosition={x:A,y:E},t.dataOnly||(n.ui.front.style.transform="translate("+A+"px,"+E+"px)");var U={identifier:n.identifier,position:c,force:S,pressure:e.force||e.pressure||e.webkitForce||0,distance:y,angle:{radian:Z,degree:v},vector:{x:A/l,y:-E/l},raw:V,instance:n,lockX:t.lockX,lockY:t.lockY};(U=n.computeDirection(U)).angle={radian:r(180-v),degree:180-v},n.trigger("move",U),this.trigger("move "+n.id+":move",U)}else this.processOnEnd(e)},B.prototype.processOnEnd=function(e){var t=this,i=t.options,n=t.manager.getIdentifier(e),o=t.nipples.get(n),r=t.manager.removeIdentifier(o.identifier);o&&(i.dataOnly||o.hide((function(){"dynamic"===i.mode&&(o.trigger("removed",o),t.trigger("removed "+o.id+":removed",o),t.manager.trigger("removed "+o.id+":removed",o),o.destroy())})),clearInterval(t.pressureIntervals[o.identifier]),o.resetDirection(),o.trigger("end",o),t.trigger("end "+o.id+":end",o),t.ids.indexOf(o.identifier)>=0&&t.ids.splice(t.ids.indexOf(o.identifier),1),t.actives.indexOf(o)>=0&&t.actives.splice(t.actives.indexOf(o),1),/(semi|static)/.test(i.mode)?t.idles.push(o):t.nipples.indexOf(o)>=0&&t.nipples.splice(t.nipples.indexOf(o),1),t.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(t.manager.ids[r.id]=r.identifier))},B.prototype.onDestroyed=function(e,t){this.nipples.indexOf(t)>=0&&this.nipples.splice(this.nipples.indexOf(t),1),this.actives.indexOf(t)>=0&&this.actives.splice(this.actives.indexOf(t),1),this.idles.indexOf(t)>=0&&this.idles.splice(this.idles.indexOf(t),1),this.ids.indexOf(t.identifier)>=0&&this.ids.splice(this.ids.indexOf(t.identifier),1),this.manager.removeIdentifier(t.identifier),this.manager.unbindDocument()},B.prototype.destroy=function(){for(var e in this.unbindEvt(this.options.zone,"start"),this.nipples.forEach((function(e){e.destroy()})),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(e)&&clearInterval(this.pressureIntervals[e]);this.trigger("destroyed",this.nipples),this.manager.unbindDocument(),this.off()};var A=B;function E(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=u(),t.config(e),t.prepareCollections();var i=function(){var e;t.collections.forEach((function(i){i.forEach((function(i){e=i.el.getBoundingClientRect(),i.position={x:t.scroll.x+e.left,y:t.scroll.y+e.top}}))}))};l(window,"resize",(function(){a(i)}));var n=function(){t.scroll=u()};return l(window,"scroll",(function(){a(n)})),t.collections}E.prototype=new S,E.constructor=E,E.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var i;return e.collections.every((function(e){return!(i=e.get(t))})),i}},E.prototype.create=function(e){return this.createCollection(e)},E.prototype.createCollection=function(e){var t=new A(this,e);return this.bindCollection(t),this.collections.push(t),t},E.prototype.bindCollection=function(e){var t,i=this,n=function(e,n){t=e.type+" "+n.id+":"+e.type,i.trigger(t,n)};e.on("destroyed",i.onDestroyed.bind(i)),e.on("shown hidden rested dir plain",n),e.on("dir:up dir:right dir:down dir:left",n),e.on("plain:up plain:right plain:down plain:left",n)},E.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},E.prototype.unbindDocument=function(e){Object.keys(this.ids).length&&!0!==e||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},E.prototype.getIdentifier=function(e){var t;return e?void 0===(t=void 0===e.identifier?e.pointerId:e.identifier)&&(t=this.latest||0):t=this.index,void 0===this.ids[t]&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]},E.prototype.removeIdentifier=function(e){var t={};for(var i in this.ids)if(this.ids[i]===e){t.id=i,t.identifier=this.ids[i],delete this.ids[i];break}return t},E.prototype.onmove=function(e){return this.onAny("move",e),!1},E.prototype.onend=function(e){return this.onAny("end",e),!1},E.prototype.oncancel=function(e){return this.onAny("end",e),!1},E.prototype.onAny=function(e,t){var i,n=this,o="processOn"+e.charAt(0).toUpperCase()+e.slice(1);return t=d(t),f(t,(function(e){i=n.getIdentifier(e),f(n.collections,function(e,t,i){i.ids.indexOf(t)>=0&&(i[o](e),e._found_=!0)}.bind(null,e,i)),e._found_||n.removeIdentifier(i)})),!1},E.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach((function(e){e.destroy()})),this.off()},E.prototype.onDestroyed=function(e,t){if(this.collections.indexOf(t)<0)return!1;this.collections.splice(this.collections.indexOf(t),1)};var U=new E;t.default={create:function(e){return U.create(e)},factory:U}}]).default})),window.EJS_SHADERS={"2xScaleHQ.glslp":{shader:{type:"text",value:'shaders = 1\n\nshader0 = "2xScaleHQ.glsl"\nfilter_linear0 = false\nscale_type_0 = source\n'},resources:[{name:"2xScaleHQ.glsl",type:"base64",value:"LyoKICAgMnhHTFNMSHFGaWx0ZXIgc2hhZGVyCiAgIAogICBDb3B5cmlnaHQgKEMpIDIwMDUgZ3Vlc3QocikgLSBndWVzdC5yQGdtYWlsLmNvbQoKICAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgogICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogICBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMgogICBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCiAgIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAogICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgogICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCiAgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgogICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQogICBGb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxhY2UgLSBTdWl0ZSAzMzAsIEJvc3RvbiwgTUEgIDAyMTExLTEzMDcsIFVTQS4KKi8KCiNpZiBkZWZpbmVkKFZFUlRFWCkKCiNpZiBfX1ZFUlNJT05fXyA+PSAxMzAKI2RlZmluZSBDT01QQVRfVkFSWUlORyBvdXQKI2RlZmluZSBDT01QQVRfQVRUUklCVVRFIGluCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZQojZWxzZQojZGVmaW5lIENPTVBBVF9WQVJZSU5HIHZhcnlpbmcgCiNkZWZpbmUgQ09NUEFUX0FUVFJJQlVURSBhdHRyaWJ1dGUgCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZTJECiNlbmRpZgoKI2lmZGVmIEdMX0VTCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTiBtZWRpdW1wCiNlbHNlCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTgojZW5kaWYKCkNPTVBBVF9BVFRSSUJVVEUgdmVjNCBWZXJ0ZXhDb29yZDsKQ09NUEFUX0FUVFJJQlVURSB2ZWM0IENPTE9SOwpDT01QQVRfQVRUUklCVVRFIHZlYzQgVGV4Q29vcmQ7CkNPTVBBVF9WQVJZSU5HIHZlYzQgQ09MMDsKQ09NUEFUX1ZBUllJTkcgdmVjNCBURVgwOwpDT01QQVRfVkFSWUlORyB2ZWM0IHQxOwpDT01QQVRfVkFSWUlORyB2ZWM0IHQyOwpDT01QQVRfVkFSWUlORyB2ZWM0IHQzOwpDT01QQVRfVkFSWUlORyB2ZWM0IHQ0OwoKdmVjNCBfb1Bvc2l0aW9uMTsgCnVuaWZvcm0gbWF0NCBNVlBNYXRyaXg7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVEaXJlY3Rpb247CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVDb3VudDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgT3V0cHV0U2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgVGV4dHVyZVNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIElucHV0U2l6ZTsKCi8vIGNvbXBhdGliaWxpdHkgI2RlZmluZXMKI2RlZmluZSB2VGV4Q29vcmQgVEVYMC54eQojZGVmaW5lIFNvdXJjZVNpemUgdmVjNChUZXh0dXJlU2l6ZSwgMS4wIC8gVGV4dHVyZVNpemUpIC8vZWl0aGVyIFRleHR1cmVTaXplIG9yIElucHV0U2l6ZQojZGVmaW5lIE91dFNpemUgdmVjNChPdXRwdXRTaXplLCAxLjAgLyBPdXRwdXRTaXplKQoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBNVlBNYXRyaXggKiBWZXJ0ZXhDb29yZDsKICAgIFRFWDAueHkgPSBUZXhDb29yZC54eTsKICAgZmxvYXQgeCA9IDAuNSAqIFNvdXJjZVNpemUuejsKICAgZmxvYXQgeSA9IDAuNSAqIFNvdXJjZVNpemUudzsKICAgdmVjMiBkZzEgPSB2ZWMyKCB4LCB5KTsKICAgdmVjMiBkZzIgPSB2ZWMyKC14LCB5KTsKICAgdmVjMiBkeCA9IHZlYzIoeCwgMC4wKTsKICAgdmVjMiBkeSA9IHZlYzIoMC4wLCB5KTsKICAgdDEgPSB2ZWM0KHZUZXhDb29yZCAtIGRnMSwgdlRleENvb3JkIC0gZHkpOwogICB0MiA9IHZlYzQodlRleENvb3JkIC0gZGcyLCB2VGV4Q29vcmQgKyBkeCk7CiAgIHQzID0gdmVjNCh2VGV4Q29vcmQgKyBkZzEsIHZUZXhDb29yZCArIGR5KTsKICAgdDQgPSB2ZWM0KHZUZXhDb29yZCArIGRnMiwgdlRleENvb3JkIC0gZHgpOwp9CgojZWxpZiBkZWZpbmVkKEZSQUdNRU5UKQoKI2lmIF9fVkVSU0lPTl9fID49IDEzMAojZGVmaW5lIENPTVBBVF9WQVJZSU5HIGluCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZQpvdXQgdmVjNCBGcmFnQ29sb3I7CiNlbHNlCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgdmFyeWluZwojZGVmaW5lIEZyYWdDb2xvciBnbF9GcmFnQ29sb3IKI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlMkQKI2VuZGlmCgojaWZkZWYgR0xfRVMKI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdICnByZWNpc2lvbiBoaWdocCBmbG9hdDsKI2Vsc2UKcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CiNlbmRpZgojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04gbWVkaXVtcAojZWxzZQojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04KI2VuZGlmCgp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lRGlyZWN0aW9uOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lQ291bnQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIE91dHB1dFNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIFRleHR1cmVTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBJbnB1dFNpemU7CnVuaWZvcm0gc2FtcGxlcjJEIFRleHR1cmU7CkNPTVBBVF9WQVJZSU5HIHZlYzQgVEVYMDsKQ09NUEFUX1ZBUllJTkcgdmVjNCB0MTsKQ09NUEFUX1ZBUllJTkcgdmVjNCB0MjsKQ09NUEFUX1ZBUllJTkcgdmVjNCB0MzsKQ09NUEFUX1ZBUllJTkcgdmVjNCB0NDsKCi8vIGNvbXBhdGliaWxpdHkgI2RlZmluZXMKI2RlZmluZSBTb3VyY2UgVGV4dHVyZQojZGVmaW5lIHZUZXhDb29yZCBURVgwLnh5CgojZGVmaW5lIFNvdXJjZVNpemUgdmVjNChUZXh0dXJlU2l6ZSwgMS4wIC8gVGV4dHVyZVNpemUpIC8vZWl0aGVyIFRleHR1cmVTaXplIG9yIElucHV0U2l6ZQojZGVmaW5lIE91dFNpemUgdmVjNChPdXRwdXRTaXplLCAxLjAgLyBPdXRwdXRTaXplKQoKZmxvYXQgbXggPSAwLjMyNTsgICAgICAvLyBzdGFydCBzbW9vdGhpbmcgd3QuCmZsb2F0IGsgPSAtMC4yNTA7ICAgICAgLy8gd3QuIGRlY3JlYXNlIGZhY3RvcgpmbG9hdCBtYXhfdyA9IDAuMjU7ICAgIC8vIG1heCBmaWx0ZXIgd2VpZ2h0CmZsb2F0IG1pbl93ID0tMC4wNTsgICAgLy8gbWluIGZpbHRlciB3ZWlnaHQKZmxvYXQgbHVtX2FkZCA9IDAuMjU7ICAvLyBhZmZlY3RzIHNtb290aGluZwp2ZWMzIGR0ID0gdmVjMygxLjApOwoKdm9pZCBtYWluKCkKewogICB2ZWMzIGMwMCA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgdDEueHkpLnh5ejsgCiAgIHZlYzMgYzEwID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB0MS56dykueHl6OyAKICAgdmVjMyBjMjAgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHQyLnh5KS54eXo7IAogICB2ZWMzIGMwMSA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgdDQuencpLnh5ejsgCiAgIHZlYzMgYzExID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB2VGV4Q29vcmQpLnh5ejsgCiAgIHZlYzMgYzIxID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB0Mi56dykueHl6OyAKICAgdmVjMyBjMDIgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHQ0Lnh5KS54eXo7IAogICB2ZWMzIGMxMiA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgdDMuencpLnh5ejsgCiAgIHZlYzMgYzIyID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB0My54eSkueHl6OyAKCiAgIGZsb2F0IG1kMSA9IGRvdChhYnMoYzAwIC0gYzIyKSwgZHQpOwogICBmbG9hdCBtZDIgPSBkb3QoYWJzKGMwMiAtIGMyMCksIGR0KTsKCiAgIGZsb2F0IHcxID0gZG90KGFicyhjMjIgLSBjMTEpLCBkdCkgKiBtZDI7CiAgIGZsb2F0IHcyID0gZG90KGFicyhjMDIgLSBjMTEpLCBkdCkgKiBtZDE7CiAgIGZsb2F0IHczID0gZG90KGFicyhjMDAgLSBjMTEpLCBkdCkgKiBtZDI7CiAgIGZsb2F0IHc0ID0gZG90KGFicyhjMjAgLSBjMTEpLCBkdCkgKiBtZDE7CgogICBmbG9hdCB0MSA9IHcxICsgdzM7CiAgIGZsb2F0IHQyID0gdzIgKyB3NDsKICAgZmxvYXQgd3cgPSBtYXgodDEsIHQyKSArIDAuMDAwMTsKCiAgIGMxMSA9ICh3MSAqIGMwMCArIHcyICogYzIwICsgdzMgKiBjMjIgKyB3NCAqIGMwMiArIHd3ICogYzExKSAvICh0MSArIHQyICsgd3cpOwoKICAgZmxvYXQgbGMxID0gayAvICgwLjEyICogZG90KGMxMCArIGMxMiArIGMxMSwgZHQpICsgbHVtX2FkZCk7CiAgIGZsb2F0IGxjMiA9IGsgLyAoMC4xMiAqIGRvdChjMDEgKyBjMjEgKyBjMTEsIGR0KSArIGx1bV9hZGQpOwoKICAgdzEgPSBjbGFtcChsYzEgKiBkb3QoYWJzKGMxMSAtIGMxMCksIGR0KSArIG14LCBtaW5fdywgbWF4X3cpOwogICB3MiA9IGNsYW1wKGxjMiAqIGRvdChhYnMoYzExIC0gYzIxKSwgZHQpICsgbXgsIG1pbl93LCBtYXhfdyk7CiAgIHczID0gY2xhbXAobGMxICogZG90KGFicyhjMTEgLSBjMTIpLCBkdCkgKyBteCwgbWluX3csIG1heF93KTsKICAgdzQgPSBjbGFtcChsYzIgKiBkb3QoYWJzKGMxMSAtIGMwMSksIGR0KSArIG14LCBtaW5fdywgbWF4X3cpOwogICBGcmFnQ29sb3IgPSB2ZWM0KHcxICogYzEwICsgdzIgKiBjMjEgKyB3MyAqIGMxMiArIHc0ICogYzAxICsgKDEuMCAtIHcxIC0gdzIgLSB3MyAtIHc0KSAqIGMxMSwgMS4wKTsKfSAKI2VuZGlmCg=="}]},"4xScaleHQ.glslp":{shader:{type:"text",value:'shaders = 1\n\nshader0 = "4xScaleHQ.glsl"\nfilter_linear0 = false\nscale_type_0 = source\n'},resources:[{name:"4xScaleHQ.glsl",type:"base64",value:"LyoKICAgNHhHTFNMSHFGaWx0ZXIgc2hhZGVyCiAgIAogICBDb3B5cmlnaHQgKEMpIDIwMDUgZ3Vlc3QocikgLSBndWVzdC5yQGdtYWlsLmNvbQoKICAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgogICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogICBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMgogICBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KCiAgIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAogICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgogICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlCiAgIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCgogICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQogICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQogICBGb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxhY2UgLSBTdWl0ZSAzMzAsIEJvc3RvbiwgTUEgIDAyMTExLTEzMDcsIFVTQS4KKi8KCiNpZiBkZWZpbmVkKFZFUlRFWCkKCiNpZiBfX1ZFUlNJT05fXyA+PSAxMzAKI2RlZmluZSBDT01QQVRfVkFSWUlORyBvdXQKI2RlZmluZSBDT01QQVRfQVRUUklCVVRFIGluCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZQojZWxzZQojZGVmaW5lIENPTVBBVF9WQVJZSU5HIHZhcnlpbmcgCiNkZWZpbmUgQ09NUEFUX0FUVFJJQlVURSBhdHRyaWJ1dGUgCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZTJECiNlbmRpZgoKI2lmZGVmIEdMX0VTCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTiBtZWRpdW1wCiNlbHNlCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTgojZW5kaWYKCkNPTVBBVF9BVFRSSUJVVEUgdmVjNCBWZXJ0ZXhDb29yZDsKQ09NUEFUX0FUVFJJQlVURSB2ZWM0IENPTE9SOwpDT01QQVRfQVRUUklCVVRFIHZlYzQgVGV4Q29vcmQ7CkNPTVBBVF9WQVJZSU5HIHZlYzQgQ09MMDsKQ09NUEFUX1ZBUllJTkcgdmVjNCBURVgwOwpDT01QQVRfVkFSWUlORyB2ZWM0IHQxOwpDT01QQVRfVkFSWUlORyB2ZWM0IHQyOwpDT01QQVRfVkFSWUlORyB2ZWM0IHQzOwpDT01QQVRfVkFSWUlORyB2ZWM0IHQ0OwpDT01QQVRfVkFSWUlORyB2ZWM0IHQ1OwpDT01QQVRfVkFSWUlORyB2ZWM0IHQ2OwoKdmVjNCBfb1Bvc2l0aW9uMTsgCnVuaWZvcm0gbWF0NCBNVlBNYXRyaXg7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVEaXJlY3Rpb247CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVDb3VudDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgT3V0cHV0U2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgVGV4dHVyZVNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIElucHV0U2l6ZTsKCi8vIGNvbXBhdGliaWxpdHkgI2RlZmluZXMKI2RlZmluZSB2VGV4Q29vcmQgVEVYMC54eQojZGVmaW5lIFNvdXJjZVNpemUgdmVjNChUZXh0dXJlU2l6ZSwgMS4wIC8gVGV4dHVyZVNpemUpIC8vZWl0aGVyIFRleHR1cmVTaXplIG9yIElucHV0U2l6ZQojZGVmaW5lIE91dFNpemUgdmVjNChPdXRwdXRTaXplLCAxLjAgLyBPdXRwdXRTaXplKQoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBNVlBNYXRyaXggKiBWZXJ0ZXhDb29yZDsKICAgIFRFWDAueHkgPSBUZXhDb29yZC54eTsKICAgZmxvYXQgeCA9IDAuNSAqIFNvdXJjZVNpemUuejsKICAgZmxvYXQgeSA9IDAuNSAqIFNvdXJjZVNpemUudzsKICAgdmVjMiBkZzEgPSB2ZWMyKCB4LCB5KTsKICAgdmVjMiBkZzIgPSB2ZWMyKC14LCB5KTsKICAgdmVjMiBzZDEgPSBkZzEgKiAwLjU7CiAgIHZlYzIgc2QyID0gZGcyICogMC41OwogICB2ZWMyIGRkeCA9IHZlYzIoeCwgMC4wKTsKICAgdmVjMiBkZHkgPSB2ZWMyKDAuMCwgeSk7CiAgIHQxID0gdmVjNCh2VGV4Q29vcmQgLSBzZDEsIHZUZXhDb29yZCAtIGRkeSk7CiAgIHQyID0gdmVjNCh2VGV4Q29vcmQgLSBzZDIsIHZUZXhDb29yZCArIGRkeCk7CiAgIHQzID0gdmVjNCh2VGV4Q29vcmQgKyBzZDEsIHZUZXhDb29yZCArIGRkeSk7CiAgIHQ0ID0gdmVjNCh2VGV4Q29vcmQgKyBzZDIsIHZUZXhDb29yZCAtIGRkeCk7CiAgIHQ1ID0gdmVjNCh2VGV4Q29vcmQgLSBkZzEsIHZUZXhDb29yZCAtIGRnMik7CiAgIHQ2ID0gdmVjNCh2VGV4Q29vcmQgKyBkZzEsIHZUZXhDb29yZCArIGRnMik7Cn0KCiNlbGlmIGRlZmluZWQoRlJBR01FTlQpCgojaWYgX19WRVJTSU9OX18gPj0gMTMwCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgaW4KI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlCm91dCB2ZWM0IEZyYWdDb2xvcjsKI2Vsc2UKI2RlZmluZSBDT01QQVRfVkFSWUlORyB2YXJ5aW5nCiNkZWZpbmUgRnJhZ0NvbG9yIGdsX0ZyYWdDb2xvcgojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUyRAojZW5kaWYKCiNpZmRlZiBHTF9FUwojaWZkZWYgR0xfRlJBR01FTlRfUFJFQ0lTSU9OX0hJR0gKcHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwojZWxzZQpwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKI2VuZGlmCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTiBtZWRpdW1wCiNlbHNlCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTgojZW5kaWYKCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVEaXJlY3Rpb247CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVDb3VudDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgT3V0cHV0U2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgVGV4dHVyZVNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIElucHV0U2l6ZTsKdW5pZm9ybSBzYW1wbGVyMkQgVGV4dHVyZTsKQ09NUEFUX1ZBUllJTkcgdmVjNCBURVgwOwpDT01QQVRfVkFSWUlORyB2ZWM0IHQxOwpDT01QQVRfVkFSWUlORyB2ZWM0IHQyOwpDT01QQVRfVkFSWUlORyB2ZWM0IHQzOwpDT01QQVRfVkFSWUlORyB2ZWM0IHQ0OwpDT01QQVRfVkFSWUlORyB2ZWM0IHQ1OwpDT01QQVRfVkFSWUlORyB2ZWM0IHQ2OwoKLy8gY29tcGF0aWJpbGl0eSAjZGVmaW5lcwojZGVmaW5lIFNvdXJjZSBUZXh0dXJlCiNkZWZpbmUgdlRleENvb3JkIFRFWDAueHkKCiNkZWZpbmUgU291cmNlU2l6ZSB2ZWM0KFRleHR1cmVTaXplLCAxLjAgLyBUZXh0dXJlU2l6ZSkgLy9laXRoZXIgVGV4dHVyZVNpemUgb3IgSW5wdXRTaXplCiNkZWZpbmUgT3V0U2l6ZSB2ZWM0KE91dHB1dFNpemUsIDEuMCAvIE91dHB1dFNpemUpCgpmbG9hdCBteCA9IDEuMDsgICAgICAvLyBzdGFydCBzbW9vdGhpbmcgd3QuCmZsb2F0IGsgPSAtMS4xMDsgICAgICAvLyB3dC4gZGVjcmVhc2UgZmFjdG9yCmZsb2F0IG1heF93ID0gMC43NTsgICAgLy8gbWF4IGZpbHRlciB3ZWlnaHQKZmxvYXQgbWluX3cgPSAwLjAzOyAgICAvLyBtaW4gZmlsdGVyIHdlaWdodApmbG9hdCBsdW1fYWRkID0gMC4zMzsgIC8vIGFmZmVjdHMgc21vb3RoaW5nCnZlYzMgZHQgPSB2ZWMzKDEuMCk7Cgp2b2lkIG1haW4oKQp7CiAgIHZlYzMgYyAgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHZUZXhDb29yZCkueHl6OwogICB2ZWMzIGkxID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB0MS54eSkueHl6OyAKICAgdmVjMyBpMiA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgdDIueHkpLnh5ejsgCiAgIHZlYzMgaTMgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHQzLnh5KS54eXo7IAogICB2ZWMzIGk0ID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB0NC54eSkueHl6OyAKICAgdmVjMyBvMSA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgdDUueHkpLnh5ejsgCiAgIHZlYzMgbzMgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHQ2Lnh5KS54eXo7IAogICB2ZWMzIG8yID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB0NS56dykueHl6OwogICB2ZWMzIG80ID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB0Ni56dykueHl6OwogICB2ZWMzIHMxID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB0MS56dykueHl6OyAKICAgdmVjMyBzMiA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgdDIuencpLnh5ejsgCiAgIHZlYzMgczMgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHQzLnp3KS54eXo7IAogICB2ZWMzIHM0ID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB0NC56dykueHl6OyAKCiAgIGZsb2F0IGtvMT1kb3QoYWJzKG8xLWMpLGR0KTsKICAgZmxvYXQga28yPWRvdChhYnMobzItYyksZHQpOwogICBmbG9hdCBrbzM9ZG90KGFicyhvMy1jKSxkdCk7CiAgIGZsb2F0IGtvND1kb3QoYWJzKG80LWMpLGR0KTsKCiAgIGZsb2F0IGsxPW1pbihkb3QoYWJzKGkxLWkzKSxkdCksbWF4KGtvMSxrbzMpKTsKICAgZmxvYXQgazI9bWluKGRvdChhYnMoaTItaTQpLGR0KSxtYXgoa28yLGtvNCkpOwoKICAgZmxvYXQgdzEgPSBrMjsgaWYoa28zPGtvMSkgdzEqPWtvMy9rbzE7CiAgIGZsb2F0IHcyID0gazE7IGlmKGtvNDxrbzIpIHcyKj1rbzQva28yOwogICBmbG9hdCB3MyA9IGsyOyBpZihrbzE8a28zKSB3Myo9a28xL2tvMzsKICAgZmxvYXQgdzQgPSBrMTsgaWYoa28yPGtvNCkgdzQqPWtvMi9rbzQ7CgogICBjPSh3MSpvMSt3MipvMit3MypvMyt3NCpvNCswLjAwMSpjKS8odzErdzIrdzMrdzQrMC4wMDEpOwogICB3MSA9IGsqZG90KGFicyhpMS1jKSthYnMoaTMtYyksZHQpLygwLjEyNSpkb3QoaTEraTMsZHQpK2x1bV9hZGQpOwogICB3MiA9IGsqZG90KGFicyhpMi1jKSthYnMoaTQtYyksZHQpLygwLjEyNSpkb3QoaTIraTQsZHQpK2x1bV9hZGQpOwogICB3MyA9IGsqZG90KGFicyhzMS1jKSthYnMoczMtYyksZHQpLygwLjEyNSpkb3QoczErczMsZHQpK2x1bV9hZGQpOwogICB3NCA9IGsqZG90KGFicyhzMi1jKSthYnMoczQtYyksZHQpLygwLjEyNSpkb3QoczIrczQsZHQpK2x1bV9hZGQpOwoKICAgdzEgPSBjbGFtcCh3MStteCxtaW5fdyxtYXhfdyk7IAogICB3MiA9IGNsYW1wKHcyK214LG1pbl93LG1heF93KTsKICAgdzMgPSBjbGFtcCh3MytteCxtaW5fdyxtYXhfdyk7IAogICB3NCA9IGNsYW1wKHc0K214LG1pbl93LG1heF93KTsKCiAgIEZyYWdDb2xvciA9IHZlYzQoKHcxKihpMStpMykrdzIqKGkyK2k0KSt3MyooczErczMpK3c0KihzMitzNCkrYykvKDIuMCoodzErdzIrdzMrdzQpKzEuMCksIDEuMCk7Cn0gCiNlbmRpZgo="}]},sabr:{shader:{type:"text",value:"shaders = 1\n\nshader0 = sabr-v3.0.glsl\nfilter_linear0 = false\n"},resources:[{name:"sabr-v3.0.glsl",type:"base64",value:"LyoKCVNBQlIgdjMuMCBTaGFkZXIKCUpvc2h1YSBTdHJlZXQKCQoJUG9ydGlvbnMgb2YgdGhpcyBhbGdvcml0aG0gd2VyZSB0YWtlbiBmcm9tIEh5bGxpYW4ncyA1eEJSIHYzLjdjCglzaGFkZXIuCgkKCVRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCglhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMgoJb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCgoJVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCglidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgoJTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQoJR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KCglZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZQoJYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZyZWUgU29mdHdhcmUKCUZvdW5kYXRpb24sIEluYy4sIDU5IFRlbXBsZSBQbGFjZSAtIFN1aXRlIDMzMCwgQm9zdG9uLCBNQSAgMDIxMTEtMTMwNywgVVNBLgoKKi8KCiNpZiBkZWZpbmVkKFZFUlRFWCkKCiNpZiBfX1ZFUlNJT05fXyA+PSAxMzAKI2RlZmluZSBDT01QQVRfVkFSWUlORyBvdXQKI2RlZmluZSBDT01QQVRfQVRUUklCVVRFIGluCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZQojZWxzZQojZGVmaW5lIENPTVBBVF9WQVJZSU5HIHZhcnlpbmcgCiNkZWZpbmUgQ09NUEFUX0FUVFJJQlVURSBhdHRyaWJ1dGUgCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZTJECiNlbmRpZgoKI2lmZGVmIEdMX0VTCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTiBtZWRpdW1wCiNlbHNlCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTgojZW5kaWYKCkNPTVBBVF9BVFRSSUJVVEUgdmVjNCBWZXJ0ZXhDb29yZDsKQ09NUEFUX0FUVFJJQlVURSB2ZWM0IENPTE9SOwpDT01QQVRfQVRUUklCVVRFIHZlYzQgVGV4Q29vcmQ7CkNPTVBBVF9WQVJZSU5HIHZlYzQgQ09MMDsKQ09NUEFUX1ZBUllJTkcgdmVjNCBURVgwOwoKdW5pZm9ybSBtYXQ0IE1WUE1hdHJpeDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZURpcmVjdGlvbjsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZUNvdW50Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBPdXRwdXRTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBUZXh0dXJlU2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgSW5wdXRTaXplOwpDT01QQVRfVkFSWUlORyB2ZWMyIHRjOwpDT01QQVRfVkFSWUlORyB2ZWM0IHh5cF8xXzJfMzsKQ09NUEFUX1ZBUllJTkcgdmVjNCB4eXBfNV8xMF8xNTsKQ09NUEFUX1ZBUllJTkcgdmVjNCB4eXBfNl83Xzg7CkNPTVBBVF9WQVJZSU5HIHZlYzQgeHlwXzlfMTRfOTsKQ09NUEFUX1ZBUllJTkcgdmVjNCB4eXBfMTFfMTJfMTM7CkNPTVBBVF9WQVJZSU5HIHZlYzQgeHlwXzE2XzE3XzE4OwpDT01QQVRfVkFSWUlORyB2ZWM0IHh5cF8yMV8yMl8yMzsKCi8vIHZlcnRleCBjb21wYXRpYmlsaXR5ICNkZWZpbmVzCiNkZWZpbmUgdlRleENvb3JkIFRFWDAueHkKI2RlZmluZSBTb3VyY2VTaXplIHZlYzQoVGV4dHVyZVNpemUsIDEuMCAvIFRleHR1cmVTaXplKSAvL2VpdGhlciBUZXh0dXJlU2l6ZSBvciBJbnB1dFNpemUKI2RlZmluZSBvdXRzaXplIHZlYzQoT3V0cHV0U2l6ZSwgMS4wIC8gT3V0cHV0U2l6ZSkKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gTVZQTWF0cml4ICogVmVydGV4Q29vcmQ7CiAgICBDT0wwID0gQ09MT1I7CiAgICBURVgwLnh5ID0gVGV4Q29vcmQueHk7CiAgIAlmbG9hdCB4ID0gU291cmNlU2l6ZS56Oy8vMS4wIC8gSU4udGV4dHVyZV9zaXplLng7CglmbG9hdCB5ID0gU291cmNlU2l6ZS53Oy8vMS4wIC8gSU4udGV4dHVyZV9zaXplLnk7CgkKCXRjID0gVEVYMC54eSAqIHZlYzIoMS4wMDA0LCAxLjApOwoJeHlwXzFfMl8zICAgID0gdGMueHh4eSArIHZlYzQoICAgICAgLXgsIDAuMCwgICB4LCAtMi4wICogeSk7Cgl4eXBfNl83XzggICAgPSB0Yy54eHh5ICsgdmVjNCggICAgICAteCwgMC4wLCAgIHgsICAgICAgIC15KTsKCXh5cF8xMV8xMl8xMyA9IHRjLnh4eHkgKyB2ZWM0KCAgICAgIC14LCAwLjAsICAgeCwgICAgICAwLjApOwoJeHlwXzE2XzE3XzE4ID0gdGMueHh4eSArIHZlYzQoICAgICAgLXgsIDAuMCwgICB4LCAgICAgICAgeSk7Cgl4eXBfMjFfMjJfMjMgPSB0Yy54eHh5ICsgdmVjNCggICAgICAteCwgMC4wLCAgIHgsICAyLjAgKiB5KTsKCXh5cF81XzEwXzE1ICA9IHRjLnh5eXkgKyB2ZWM0KC0yLjAgKiB4LCAgLXksIDAuMCwgICAgICAgIHkpOwoJeHlwXzlfMTRfOSAgID0gdGMueHl5eSArIHZlYzQoIDIuMCAqIHgsICAteSwgMC4wLCAgICAgICAgeSk7Cn0KCiNlbGlmIGRlZmluZWQoRlJBR01FTlQpCgojaWYgX19WRVJTSU9OX18gPj0gMTMwCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgaW4KI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlCm91dCB2ZWM0IEZyYWdDb2xvcjsKI2Vsc2UKI2RlZmluZSBDT01QQVRfVkFSWUlORyB2YXJ5aW5nCiNkZWZpbmUgRnJhZ0NvbG9yIGdsX0ZyYWdDb2xvcgojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUyRAojZW5kaWYKCiNpZmRlZiBHTF9FUwojaWZkZWYgR0xfRlJBR01FTlRfUFJFQ0lTSU9OX0hJR0gKcHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwojZWxzZQpwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKI2VuZGlmCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTiBtZWRpdW1wCiNlbHNlCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTgojZW5kaWYKCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVEaXJlY3Rpb247CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVDb3VudDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgT3V0cHV0U2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgVGV4dHVyZVNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIElucHV0U2l6ZTsKdW5pZm9ybSBzYW1wbGVyMkQgVGV4dHVyZTsKQ09NUEFUX1ZBUllJTkcgdmVjNCBURVgwOwpDT01QQVRfVkFSWUlORyB2ZWMyIHRjOwpDT01QQVRfVkFSWUlORyB2ZWM0IHh5cF8xXzJfMzsKQ09NUEFUX1ZBUllJTkcgdmVjNCB4eXBfNV8xMF8xNTsKQ09NUEFUX1ZBUllJTkcgdmVjNCB4eXBfNl83Xzg7CkNPTVBBVF9WQVJZSU5HIHZlYzQgeHlwXzlfMTRfOTsKQ09NUEFUX1ZBUllJTkcgdmVjNCB4eXBfMTFfMTJfMTM7CkNPTVBBVF9WQVJZSU5HIHZlYzQgeHlwXzE2XzE3XzE4OwpDT01QQVRfVkFSWUlORyB2ZWM0IHh5cF8yMV8yMl8yMzsKCi8vIGZyYWdtZW50IGNvbXBhdGliaWxpdHkgI2RlZmluZXMKI2RlZmluZSBTb3VyY2UgVGV4dHVyZQojZGVmaW5lIHZUZXhDb29yZCBURVgwLnh5CgojZGVmaW5lIFNvdXJjZVNpemUgdmVjNChUZXh0dXJlU2l6ZSwgMS4wIC8gVGV4dHVyZVNpemUpIC8vZWl0aGVyIFRleHR1cmVTaXplIG9yIElucHV0U2l6ZQojZGVmaW5lIG91dHNpemUgdmVjNChPdXRwdXRTaXplLCAxLjAgLyBPdXRwdXRTaXplKQoKLyoKCUNvbnN0YW50cwoqLwovKgoJSW5lcXVhdGlvbiBjb2VmZmljaWVudHMgZm9yIGludGVycG9sYXRpb24KRXF1YXRpb25zIGFyZSBpbiB0aGUgZm9ybTogQXkgKyBCeCA9IEMKNDUsIDMwLCBhbmQgNjAgZGVub3RlIHRoZSBhbmdsZSBmcm9tIHggZWFjaCBsaW5lIHRoZSBjb29lZmljaWVudCB2YXJpYWJsZSBzZXQgYnVpbGRzCiovCmNvbnN0IHZlYzQgQWkgID0gdmVjNCggMS4wLCAtMS4wLCAtMS4wLCAgMS4wKTsKY29uc3QgdmVjNCBCNDUgPSB2ZWM0KCAxLjAsICAxLjAsIC0xLjAsIC0xLjApOwpjb25zdCB2ZWM0IEM0NSA9IHZlYzQoIDEuNSwgIDAuNSwgLTAuNSwgIDAuNSk7CmNvbnN0IHZlYzQgQjMwID0gdmVjNCggMC41LCAgMi4wLCAtMC41LCAtMi4wKTsKY29uc3QgdmVjNCBDMzAgPSB2ZWM0KCAxLjAsICAxLjAsIC0wLjUsICAwLjApOwpjb25zdCB2ZWM0IEI2MCA9IHZlYzQoIDIuMCwgIDAuNSwgLTIuMCwgLTAuNSk7CmNvbnN0IHZlYzQgQzYwID0gdmVjNCggMi4wLCAgMC4wLCAtMS4wLCAgMC41KTsKCmNvbnN0IHZlYzQgTTQ1ID0gdmVjNCgwLjQsIDAuNCwgMC40LCAwLjQpOwpjb25zdCB2ZWM0IE0zMCA9IHZlYzQoMC4yLCAwLjQsIDAuMiwgMC40KTsKY29uc3QgdmVjNCBNNjAgPSBNMzAueXh3ejsKY29uc3QgdmVjNCBNc2hpZnQgPSB2ZWM0KDAuMik7CgovLyBDb2VmZmljaWVudCBmb3Igd2VpZ2h0ZWQgZWRnZSBkZXRlY3Rpb24KY29uc3QgZmxvYXQgY29lZiA9IDIuMDsKLy8gVGhyZXNob2xkIGZvciBpZiBsdW1pbmFuY2UgdmFsdWVzIGFyZSAiZXF1YWwiCmNvbnN0IHZlYzQgdGhyZXNob2xkID0gdmVjNCgwLjMyKTsKCi8vIENvbnZlcnNpb24gZnJvbSBSR0IgdG8gTHVtaW5hbmNlIChmcm9tIEdJTVApCmNvbnN0IHZlYzMgbHVtID0gdmVjMygwLjIxLCAwLjcyLCAwLjA3KTsKCi8vIFBlcmZvcm1zIHNhbWUgbG9naWMgb3BlcmF0aW9uIGFzICYmIGZvciB2ZWN0b3JzCmJ2ZWM0IF9hbmRfKGJ2ZWM0IEEsIGJ2ZWM0IEIpIHsKCXJldHVybiBidmVjNChBLnggJiYgQi54LCBBLnkgJiYgQi55LCBBLnogJiYgQi56LCBBLncgJiYgQi53KTsKfQoKLy8gUGVyZm9ybXMgc2FtZSBsb2dpYyBvcGVyYXRpb24gYXMgfHwgZm9yIHZlY3RvcnMKYnZlYzQgX29yXyhidmVjNCBBLCBidmVjNCBCKSB7CglyZXR1cm4gYnZlYzQoQS54IHx8IEIueCwgQS55IHx8IEIueSwgQS56IHx8IEIueiwgQS53IHx8IEIudyk7Cn0KCi8vIENvbnZlcnRzIDQgMy1jb2xvciB2ZWN0b3JzIGludG8gMSA0LXZhbHVlIGx1bWluYW5jZSB2ZWN0b3IKdmVjNCBsdW1fdG8odmVjMyB2MCwgdmVjMyB2MSwgdmVjMyB2MiwgdmVjMyB2MykgewoJcmV0dXJuIHZlYzQoZG90KGx1bSwgdjApLCBkb3QobHVtLCB2MSksIGRvdChsdW0sIHYyKSwgZG90KGx1bSwgdjMpKTsKfQoKLy8gR2V0cyB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIDIgNC12YWx1ZSBsdW1pbmFuY2UgdmVjdG9ycwp2ZWM0IGx1bV9kZih2ZWM0IEEsIHZlYzQgQikgewoJcmV0dXJuIGFicyhBIC0gQik7Cn0KCi8vIERldGVybWluZXMgaWYgMiA0LXZhbHVlIGx1bWluYW5jZSB2ZWN0b3JzIGFyZSAiZXF1YWwiIGJhc2VkIG9uIHRocmVzaG9sZApidmVjNCBsdW1fZXEodmVjNCBBLCB2ZWM0IEIpIHsKCXJldHVybiBsZXNzVGhhbihsdW1fZGYoQSwgQiksIHRocmVzaG9sZCk7Cn0KCnZlYzQgbHVtX3dkKHZlYzQgYSwgdmVjNCBiLCB2ZWM0IGMsIHZlYzQgZCwgdmVjNCBlLCB2ZWM0IGYsIHZlYzQgZywgdmVjNCBoKSB7CglyZXR1cm4gbHVtX2RmKGEsIGIpICsgbHVtX2RmKGEsIGMpICsgbHVtX2RmKGQsIGUpICsgbHVtX2RmKGQsIGYpICsgNC4wICogbHVtX2RmKGcsIGgpOwp9CgovLyBHZXRzIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gMiAzLXZhbHVlIHJnYiBjb2xvcnMKZmxvYXQgY19kZih2ZWMzIGMxLCB2ZWMzIGMyKSB7Cgl2ZWMzIGRmID0gYWJzKGMxIC0gYzIpOwoJcmV0dXJuIGRmLnIgKyBkZi5nICsgZGYuYjsKfQoKdm9pZCBtYWluKCkKewovKgpNYXNrIGZvciBhbGdvcml0aG0KKy0tLS0tKy0tLS0tKy0tLS0tKy0tLS0tKy0tLS0tKwp8ICAgICB8ICAxICB8ICAyICB8ICAzICB8ICAgICB8CistLS0tLSstLS0tLSstLS0tLSstLS0tLSstLS0tLSsKfCAgNSAgfCAgNiAgfCAgNyAgfCAgOCAgfCAgOSAgfAorLS0tLS0rLS0tLS0rLS0tLS0rLS0tLS0rLS0tLS0rCnwgMTAgIHwgMTEgIHwgMTIgIHwgMTMgIHwgMTQgIHwKKy0tLS0tKy0tLS0tKy0tLS0tKy0tLS0tKy0tLS0tKwp8IDE1ICB8IDE2ICB8IDE3ICB8IDE4ICB8IDE5ICB8CistLS0tLSstLS0tLSstLS0tLSstLS0tLSstLS0tLSsKfCAgICAgfCAyMSAgfCAyMiAgfCAyMyAgfCAgICAgfAorLS0tLS0rLS0tLS0rLS0tLS0rLS0tLS0rLS0tLS0rCgkqLwoJLy8gR2V0IG1hc2sgdmFsdWVzIGJ5IHBlcmZvcm1pbmcgdGV4dHVyZSBsb29rdXAgd2l0aCB0aGUgdW5pZm9ybSBzYW1wbGVyCgl2ZWMzIFAxICA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgeHlwXzFfMl8zLnh3ICAgKS5yZ2I7Cgl2ZWMzIFAyICA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgeHlwXzFfMl8zLnl3ICAgKS5yZ2I7Cgl2ZWMzIFAzICA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgeHlwXzFfMl8zLnp3ICAgKS5yZ2I7CgkKCXZlYzMgUDYgID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB4eXBfNl83XzgueHcgICApLnJnYjsKCXZlYzMgUDcgID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB4eXBfNl83XzgueXcgICApLnJnYjsKCXZlYzMgUDggID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB4eXBfNl83XzguencgICApLnJnYjsKCQoJdmVjMyBQMTEgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHh5cF8xMV8xMl8xMy54dykucmdiOwoJdmVjMyBQMTIgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHh5cF8xMV8xMl8xMy55dykucmdiOwoJdmVjMyBQMTMgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHh5cF8xMV8xMl8xMy56dykucmdiOwoJCgl2ZWMzIFAxNiA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgeHlwXzE2XzE3XzE4Lnh3KS5yZ2I7Cgl2ZWMzIFAxNyA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgeHlwXzE2XzE3XzE4Lnl3KS5yZ2I7Cgl2ZWMzIFAxOCA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgeHlwXzE2XzE3XzE4Lnp3KS5yZ2I7CgkKCXZlYzMgUDIxID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB4eXBfMjFfMjJfMjMueHcpLnJnYjsKCXZlYzMgUDIyID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB4eXBfMjFfMjJfMjMueXcpLnJnYjsKCXZlYzMgUDIzID0gQ09NUEFUX1RFWFRVUkUoU291cmNlLCB4eXBfMjFfMjJfMjMuencpLnJnYjsKCQoJdmVjMyBQNSAgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHh5cF81XzEwXzE1Lnh5ICkucmdiOwoJdmVjMyBQMTAgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHh5cF81XzEwXzE1Lnh6ICkucmdiOwoJdmVjMyBQMTUgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHh5cF81XzEwXzE1Lnh3ICkucmdiOwoJCgl2ZWMzIFA5ICA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgeHlwXzlfMTRfOS54eSAgKS5yZ2I7Cgl2ZWMzIFAxNCA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgeHlwXzlfMTRfOS54eiAgKS5yZ2I7Cgl2ZWMzIFAxOSA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgeHlwXzlfMTRfOS54dyAgKS5yZ2I7CgkKCS8vIFN0b3JlIGx1bWluYW5jZSB2YWx1ZXMgb2YgZWFjaCBwb2ludCBpbiBncm91cHMgb2YgNAoJLy8gc28gdGhhdCB3ZSBtYXkgb3BlcmF0ZSBvbiBhbGwgZm91ciBjb3JuZXJzIGF0IG9uY2UKCXZlYzQgcDcgID0gbHVtX3RvKFA3LCAgUDExLCBQMTcsIFAxMyk7Cgl2ZWM0IHA4ICA9IGx1bV90byhQOCwgIFA2LCAgUDE2LCBQMTgpOwoJdmVjNCBwMTEgPSBwNy55end4OyAgICAgICAgICAgICAgICAgICAgICAvLyBQMTEsIFAxNywgUDEzLCBQNwoJdmVjNCBwMTIgPSBsdW1fdG8oUDEyLCBQMTIsIFAxMiwgUDEyKTsKCXZlYzQgcDEzID0gcDcud3h5ejsgICAgICAgICAgICAgICAgICAgICAgLy8gUDEzLCBQNywgIFAxMSwgUDE3Cgl2ZWM0IHAxNCA9IGx1bV90byhQMTQsIFAyLCAgUDEwLCBQMjIpOwoJdmVjNCBwMTYgPSBwOC56d3h5OyAgICAgICAgICAgICAgICAgICAgICAvLyBQMTYsIFAxOCwgUDgsICBQNgoJdmVjNCBwMTcgPSBwNy56d3h5OyAgICAgICAgICAgICAgICAgICAgICAvLyBQMTcsIFAxMywgUDcsICBQMTEKCXZlYzQgcDE4ID0gcDgud3h5ejsgICAgICAgICAgICAgICAgICAgICAgLy8gUDE4LCBQOCwgIFA2LCAgUDE2Cgl2ZWM0IHAxOSA9IGx1bV90byhQMTksIFAzLCAgUDUsICBQMjEpOwoJdmVjNCBwMjIgPSBwMTQud3h5ejsgICAgICAgICAgICAgICAgICAgICAvLyBQMjIsIFAxNCwgUDIsICBQMTAKCXZlYzQgcDIzID0gbHVtX3RvKFAyMywgUDksICBQMSwgIFAxNSk7CgkKCS8vIFNjYWxlIGN1cnJlbnQgdGV4ZWwgY29vcmRpbmF0ZSB0byBbMC4uMV0KCXZlYzIgZnAgPSBmcmFjdCh0YyAqIFNvdXJjZVNpemUueHkpOwoJCgkvLyBEZXRlcm1pbmUgYW1vdW50IG9mICJzbW9vdGhpbmciIG9yIG1peGluZyB0aGF0IGNvdWxkIGJlIGRvbmUgb24gdGV4ZWwgY29ybmVycwoJdmVjNCBtYTQ1ID0gc21vb3Roc3RlcChDNDUgLSBNNDUsIEM0NSArIE00NSwgQWkgKiBmcC55ICsgQjQ1ICogZnAueCk7Cgl2ZWM0IG1hMzAgPSBzbW9vdGhzdGVwKEMzMCAtIE0zMCwgQzMwICsgTTMwLCBBaSAqIGZwLnkgKyBCMzAgKiBmcC54KTsKCXZlYzQgbWE2MCA9IHNtb290aHN0ZXAoQzYwIC0gTTYwLCBDNjAgKyBNNjAsIEFpICogZnAueSArIEI2MCAqIGZwLngpOwoJdmVjNCBtYXJuID0gc21vb3Roc3RlcChDNDUgLSBNNDUgKyBNc2hpZnQsIEM0NSArIE00NSArIE1zaGlmdCwgQWkgKiBmcC55ICsgQjQ1ICogZnAueCk7CgkKCS8vIFBlcmZvcm0gZWRnZSB3ZWlnaHQgY2FsY3VsYXRpb25zCgl2ZWM0IGU0NSAgID0gbHVtX3dkKHAxMiwgcDgsIHAxNiwgcDE4LCBwMjIsIHAxNCwgcDE3LCBwMTMpOwoJdmVjNCBlY29udCA9IGx1bV93ZChwMTcsIHAxMSwgcDIzLCBwMTMsIHA3LCBwMTksIHAxMiwgcDE4KTsKCXZlYzQgZTMwICAgPSBsdW1fZGYocDEzLCBwMTYpOwoJdmVjNCBlNjAgICA9IGx1bV9kZihwOCwgcDE3KTsKCQoJLy8gQ2FsY3VsYXRlIHJ1bGUgcmVzdWx0cyBmb3IgaW50ZXJwb2xhdGlvbgoJYnZlYzQgcjQ1XzEgICA9IF9hbmRfKG5vdEVxdWFsKHAxMiwgcDEzKSwgbm90RXF1YWwocDEyLCBwMTcpKTsKCWJ2ZWM0IHI0NV8yICAgPSBfYW5kXyhub3QobHVtX2VxKHAxMywgcDcpKSwgbm90KGx1bV9lcShwMTMsIHA4KSkpOwoJYnZlYzQgcjQ1XzMgICA9IF9hbmRfKG5vdChsdW1fZXEocDE3LCBwMTEpKSwgbm90KGx1bV9lcShwMTcsIHAxNikpKTsKCWJ2ZWM0IHI0NV80XzEgPSBfYW5kXyhub3QobHVtX2VxKHAxMywgcDE0KSksIG5vdChsdW1fZXEocDEzLCBwMTkpKSk7CglidmVjNCByNDVfNF8yID0gX2FuZF8obm90KGx1bV9lcShwMTcsIHAyMikpLCBub3QobHVtX2VxKHAxNywgcDIzKSkpOwoJYnZlYzQgcjQ1XzQgICA9IF9hbmRfKGx1bV9lcShwMTIsIHAxOCksIF9vcl8ocjQ1XzRfMSwgcjQ1XzRfMikpOwoJYnZlYzQgcjQ1XzUgICA9IF9vcl8obHVtX2VxKHAxMiwgcDE2KSwgbHVtX2VxKHAxMiwgcDgpKTsKCWJ2ZWM0IHI0NSAgICAgPSBfYW5kXyhyNDVfMSwgX29yXyhfb3JfKF9vcl8ocjQ1XzIsIHI0NV8zKSwgcjQ1XzQpLCByNDVfNSkpOwoJYnZlYzQgcjMwID0gX2FuZF8obm90RXF1YWwocDEyLCBwMTYpLCBub3RFcXVhbChwMTEsIHAxNikpOwoJYnZlYzQgcjYwID0gX2FuZF8obm90RXF1YWwocDEyLCBwOCksIG5vdEVxdWFsKHA3LCBwOCkpOwoJCgkvLyBDb21iaW5lIHJ1bGVzIHdpdGggZWRnZSB3ZWlnaHRzCglidmVjNCBlZHI0NSA9IF9hbmRfKGxlc3NUaGFuKGU0NSwgZWNvbnQpLCByNDUpOwoJYnZlYzQgZWRycm4gPSBsZXNzVGhhbkVxdWFsKGU0NSwgZWNvbnQpOwoJYnZlYzQgZWRyMzAgPSBfYW5kXyhsZXNzVGhhbkVxdWFsKGNvZWYgKiBlMzAsIGU2MCksIHIzMCk7CglidmVjNCBlZHI2MCA9IF9hbmRfKGxlc3NUaGFuRXF1YWwoY29lZiAqIGU2MCwgZTMwKSwgcjYwKTsKCQoJLy8gRmluYWxpemUgaW50ZXJwb2xhdGlvbiBydWxlcyBhbmQgY2FzdCB0byBmbG9hdCAoMC4wIGZvciBmYWxzZSwgMS4wIGZvciB0cnVlKQoJdmVjNCBmaW5hbDQ1ID0gdmVjNChfYW5kXyhfYW5kXyhub3QoZWRyMzApLCBub3QoZWRyNjApKSwgZWRyNDUpKTsKCXZlYzQgZmluYWwzMCA9IHZlYzQoX2FuZF8oX2FuZF8oZWRyNDUsIG5vdChlZHI2MCkpLCBlZHIzMCkpOwoJdmVjNCBmaW5hbDYwID0gdmVjNChfYW5kXyhfYW5kXyhlZHI0NSwgbm90KGVkcjMwKSksIGVkcjYwKSk7Cgl2ZWM0IGZpbmFsMzYgPSB2ZWM0KF9hbmRfKF9hbmRfKGVkcjYwLCBlZHIzMCksIGVkcjQ1KSk7Cgl2ZWM0IGZpbmFscm4gPSB2ZWM0KF9hbmRfKG5vdChlZHI0NSksIGVkcnJuKSk7CgkKCS8vIERldGVybWluZSB0aGUgY29sb3IgdG8gbWl4IHdpdGggZm9yIGVhY2ggY29ybmVyCgl2ZWM0IHB4ID0gc3RlcChsdW1fZGYocDEyLCBwMTcpLCBsdW1fZGYocDEyLCBwMTMpKTsKCQoJLy8gRGV0ZXJtaW5lIHRoZSBtaXggYW1vdW50cyBieSBjb21iaW5pbmcgdGhlIGZpbmFsIHJ1bGUgcmVzdWx0IGFuZCBjb3JyZXNwb25kaW5nCgkvLyBtaXggYW1vdW50IGZvciB0aGUgcnVsZSBpbiBlYWNoIGNvcm5lcgoJdmVjNCBtYWMgPSBmaW5hbDM2ICogbWF4KG1hMzAsIG1hNjApICsgZmluYWwzMCAqIG1hMzAgKyBmaW5hbDYwICogbWE2MCArIGZpbmFsNDUgKiBtYTQ1ICsgZmluYWxybiAqIG1hcm47CgkKLyoKQ2FsY3VsYXRlIHRoZSByZXN1bHRpbmcgY29sb3IgYnkgdHJhdmVyc2luZyBjbG9ja3dpc2UgYW5kIGNvdW50ZXItY2xvY2t3aXNlIGFyb3VuZAp0aGUgY29ybmVycyBvZiB0aGUgdGV4ZWwKCkZpbmFsbHkgY2hvb3NlIHRoZSByZXN1bHQgdGhhdCBoYXMgdGhlIGxhcmdlc3QgZGlmZmVyZW5jZSBmcm9tIHRoZSB0ZXhlbCdzIG9yaWdpbmFsCmNvbG9yCiovCgl2ZWMzIHJlczEgPSBQMTI7CglyZXMxID0gbWl4KHJlczEsIG1peChQMTMsIFAxNywgcHgueCksIG1hYy54KTsKCXJlczEgPSBtaXgocmVzMSwgbWl4KFA3LCBQMTMsIHB4LnkpLCBtYWMueSk7CglyZXMxID0gbWl4KHJlczEsIG1peChQMTEsIFA3LCBweC56KSwgbWFjLnopOwoJcmVzMSA9IG1peChyZXMxLCBtaXgoUDE3LCBQMTEsIHB4LncpLCBtYWMudyk7CgkKCXZlYzMgcmVzMiA9IFAxMjsKCXJlczIgPSBtaXgocmVzMiwgbWl4KFAxNywgUDExLCBweC53KSwgbWFjLncpOwoJcmVzMiA9IG1peChyZXMyLCBtaXgoUDExLCBQNywgcHgueiksIG1hYy56KTsKCXJlczIgPSBtaXgocmVzMiwgbWl4KFA3LCBQMTMsIHB4LnkpLCBtYWMueSk7CglyZXMyID0gbWl4KHJlczIsIG1peChQMTMsIFAxNywgcHgueCksIG1hYy54KTsKCQoJRnJhZ0NvbG9yID0gdmVjNChtaXgocmVzMSwgcmVzMiwgc3RlcChjX2RmKFAxMiwgcmVzMSksIGNfZGYoUDEyLCByZXMyKSkpLCAxLjApOwp9IAojZW5kaWYK"}]},"crt-aperture.glslp":{shader:{type:"text",value:"shaders = 1\n\nshader0 = crt-aperture.glsl\nfilter_linear0 = false\n"},resources:[{name:"crt-aperture.glsl",type:"base64",value:"LyoKICAgIENSVCBTaGFkZXIgYnkgRWFzeU1vZGUKICAgIExpY2Vuc2U6IEdQTAoqLwoKI3ByYWdtYSBwYXJhbWV0ZXIgU0hBUlBORVNTX0lNQUdFICJTaGFycG5lc3MgSW1hZ2UiIDEuMCAxLjAgNS4wIDEuMAojcHJhZ21hIHBhcmFtZXRlciBTSEFSUE5FU1NfRURHRVMgIlNoYXJwbmVzcyBFZGdlcyIgMy4wIDEuMCA1LjAgMS4wCiNwcmFnbWEgcGFyYW1ldGVyIEdMT1dfV0lEVEggIkdsb3cgV2lkdGgiIDAuNSAwLjA1IDAuNjUgMC4wNQojcHJhZ21hIHBhcmFtZXRlciBHTE9XX0hFSUdIVCAiR2xvdyBIZWlnaHQiIDAuNSAwLjA1IDAuNjUgMC4wNQojcHJhZ21hIHBhcmFtZXRlciBHTE9XX0hBTEFUSU9OICJHbG93IEhhbGF0aW9uIiAwLjEgMC4wIDEuMCAwLjAxCiNwcmFnbWEgcGFyYW1ldGVyIEdMT1dfRElGRlVTSU9OICJHbG93IERpZmZ1c2lvbiIgMC4wNSAwLjAgMS4wIDAuMDEKI3ByYWdtYSBwYXJhbWV0ZXIgTUFTS19DT0xPUlMgIk1hc2sgQ29sb3JzIiAyLjAgMi4wIDMuMCAxLjAKI3ByYWdtYSBwYXJhbWV0ZXIgTUFTS19TVFJFTkdUSCAiTWFzayBTdHJlbmd0aCIgMC4zIDAuMCAxLjAgMC4wNQojcHJhZ21hIHBhcmFtZXRlciBNQVNLX1NJWkUgIk1hc2sgU2l6ZSIgMS4wIDEuMCA5LjAgMS4wCiNwcmFnbWEgcGFyYW1ldGVyIFNDQU5MSU5FX1NJWkVfTUlOICJTY2FubGluZSBTaXplIE1pbi4iIDAuNSAwLjUgMS41IDAuMDUKI3ByYWdtYSBwYXJhbWV0ZXIgU0NBTkxJTkVfU0laRV9NQVggIlNjYW5saW5lIFNpemUgTWF4LiIgMS41IDAuNSAxLjUgMC4wNQojcHJhZ21hIHBhcmFtZXRlciBTQ0FOTElORV9TSEFQRSAiU2NhbmxpbmUgU2hhcGUiIDIuNSAxLjAgMTAwLjAgMC4xCiNwcmFnbWEgcGFyYW1ldGVyIFNDQU5MSU5FX09GRlNFVCAiU2NhbmxpbmUgT2Zmc2V0IiAxLjAgMC4wIDEuMCAxLjAKI3ByYWdtYSBwYXJhbWV0ZXIgR0FNTUFfSU5QVVQgIkdhbW1hIElucHV0IiAyLjQgMS4wIDUuMCAwLjEKI3ByYWdtYSBwYXJhbWV0ZXIgR0FNTUFfT1VUUFVUICJHYW1tYSBPdXRwdXQiIDIuNCAxLjAgNS4wIDAuMQojcHJhZ21hIHBhcmFtZXRlciBCUklHSFRORVNTICJCcmlnaHRuZXNzIiAxLjUgMC4wIDIuMCAwLjA1CgojZGVmaW5lIENvb3JkIFRFWDAKCiNpZiBkZWZpbmVkKFZFUlRFWCkKCiNpZiBfX1ZFUlNJT05fXyA+PSAxMzAKI2RlZmluZSBPVVQgb3V0CiNkZWZpbmUgSU4gIGluCiNkZWZpbmUgdGV4MkQgdGV4dHVyZQojZWxzZQojZGVmaW5lIE9VVCB2YXJ5aW5nIAojZGVmaW5lIElOIGF0dHJpYnV0ZSAKI2RlZmluZSB0ZXgyRCB0ZXh0dXJlMkQKI2VuZGlmCgojaWZkZWYgR0xfRVMKI2RlZmluZSBQUkVDSVNJT04gbWVkaXVtcAojZWxzZQojZGVmaW5lIFBSRUNJU0lPTgojZW5kaWYKCklOICB2ZWM0IFZlcnRleENvb3JkOwpJTiAgdmVjNCBDb2xvcjsKSU4gIHZlYzIgVGV4Q29vcmQ7Ck9VVCB2ZWM0IGNvbG9yOwpPVVQgdmVjMiBDb29yZDsKCnVuaWZvcm0gbWF0NCBNVlBNYXRyaXg7CnVuaWZvcm0gUFJFQ0lTSU9OIGludCBGcmFtZURpcmVjdGlvbjsKdW5pZm9ybSBQUkVDSVNJT04gaW50IEZyYW1lQ291bnQ7CnVuaWZvcm0gUFJFQ0lTSU9OIHZlYzIgT3V0cHV0U2l6ZTsKdW5pZm9ybSBQUkVDSVNJT04gdmVjMiBUZXh0dXJlU2l6ZTsKdW5pZm9ybSBQUkVDSVNJT04gdmVjMiBJbnB1dFNpemU7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IE1WUE1hdHJpeCAqIFZlcnRleENvb3JkOwogICAgY29sb3IgPSBDb2xvcjsKICAgIENvb3JkID0gVGV4Q29vcmQgKiAxLjAwMDE7Cn0KCiNlbGlmIGRlZmluZWQoRlJBR01FTlQpCgojaWYgX19WRVJTSU9OX18gPj0gMTMwCiNkZWZpbmUgSU4gaW4KI2RlZmluZSB0ZXgyRCB0ZXh0dXJlCm91dCB2ZWM0IEZyYWdDb2xvcjsKI2Vsc2UKI2RlZmluZSBJTiB2YXJ5aW5nCiNkZWZpbmUgRnJhZ0NvbG9yIGdsX0ZyYWdDb2xvcgojZGVmaW5lIHRleDJEIHRleHR1cmUyRAojZW5kaWYKCiNpZmRlZiBHTF9FUwojaWZkZWYgR0xfRlJBR01FTlRfUFJFQ0lTSU9OX0hJR0gKcHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwojZWxzZQpwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKI2VuZGlmCiNkZWZpbmUgUFJFQ0lTSU9OIG1lZGl1bXAKI2Vsc2UKI2RlZmluZSBQUkVDSVNJT04KI2VuZGlmCgp1bmlmb3JtIFBSRUNJU0lPTiBpbnQgRnJhbWVEaXJlY3Rpb247CnVuaWZvcm0gUFJFQ0lTSU9OIGludCBGcmFtZUNvdW50Owp1bmlmb3JtIFBSRUNJU0lPTiB2ZWMyIE91dHB1dFNpemU7CnVuaWZvcm0gUFJFQ0lTSU9OIHZlYzIgVGV4dHVyZVNpemU7CnVuaWZvcm0gUFJFQ0lTSU9OIHZlYzIgSW5wdXRTaXplOwp1bmlmb3JtIHNhbXBsZXIyRCBUZXh0dXJlOwpJTiB2ZWMyIENvb3JkOwoKI2lmZGVmIFBBUkFNRVRFUl9VTklGT1JNCnVuaWZvcm0gUFJFQ0lTSU9OIGZsb2F0IFNIQVJQTkVTU19JTUFHRTsKdW5pZm9ybSBQUkVDSVNJT04gZmxvYXQgU0hBUlBORVNTX0VER0VTOwp1bmlmb3JtIFBSRUNJU0lPTiBmbG9hdCBHTE9XX1dJRFRIOwp1bmlmb3JtIFBSRUNJU0lPTiBmbG9hdCBHTE9XX0hFSUdIVDsKdW5pZm9ybSBQUkVDSVNJT04gZmxvYXQgR0xPV19IQUxBVElPTjsKdW5pZm9ybSBQUkVDSVNJT04gZmxvYXQgR0xPV19ESUZGVVNJT047CnVuaWZvcm0gUFJFQ0lTSU9OIGZsb2F0IE1BU0tfQ09MT1JTOwp1bmlmb3JtIFBSRUNJU0lPTiBmbG9hdCBNQVNLX1NUUkVOR1RIOwp1bmlmb3JtIFBSRUNJU0lPTiBmbG9hdCBNQVNLX1NJWkU7CnVuaWZvcm0gUFJFQ0lTSU9OIGZsb2F0IFNDQU5MSU5FX1NJWkVfTUlOOwp1bmlmb3JtIFBSRUNJU0lPTiBmbG9hdCBTQ0FOTElORV9TSVpFX01BWDsKdW5pZm9ybSBQUkVDSVNJT04gZmxvYXQgU0NBTkxJTkVfU0hBUEU7CnVuaWZvcm0gUFJFQ0lTSU9OIGZsb2F0IFNDQU5MSU5FX09GRlNFVDsKdW5pZm9ybSBQUkVDSVNJT04gZmxvYXQgR0FNTUFfSU5QVVQ7CnVuaWZvcm0gUFJFQ0lTSU9OIGZsb2F0IEdBTU1BX09VVFBVVDsKdW5pZm9ybSBQUkVDSVNJT04gZmxvYXQgQlJJR0hUTkVTUzsKI2Vsc2UKI2RlZmluZSBTSEFSUE5FU1NfSU1BR0UgMS4wCiNkZWZpbmUgU0hBUlBORVNTX0VER0VTIDMuMAojZGVmaW5lIEdMT1dfV0lEVEggMC41CiNkZWZpbmUgR0xPV19IRUlHSFQgMC41CiNkZWZpbmUgR0xPV19IQUxBVElPTiAwLjEKI2RlZmluZSBHTE9XX0RJRkZVU0lPTiAwLjA1CiNkZWZpbmUgTUFTS19DT0xPUlMgMi4wCiNkZWZpbmUgTUFTS19TVFJFTkdUSCAwLjMKI2RlZmluZSBNQVNLX1NJWkUgMS4wCiNkZWZpbmUgU0NBTkxJTkVfU0laRV9NSU4gMC41CiNkZWZpbmUgU0NBTkxJTkVfU0laRV9NQVggMS41CiNkZWZpbmUgU0NBTkxJTkVfU0hBUEUgMS41CiNkZWZpbmUgU0NBTkxJTkVfT0ZGU0VUIDEuMAojZGVmaW5lIEdBTU1BX0lOUFVUIDIuNAojZGVmaW5lIEdBTU1BX09VVFBVVCAyLjQKI2RlZmluZSBCUklHSFRORVNTIDEuNQojZW5kaWYKCiNkZWZpbmUgRklYKGMpIG1heChhYnMoYyksIDFlLTUpCiNkZWZpbmUgUEkgMy4xNDE1OTI2NTM1ODkKI2RlZmluZSBzYXR1cmF0ZShjKSBjbGFtcChjLCAwLjAsIDEuMCkKI2RlZmluZSBURVgyRChjKSBwb3codGV4MkQodGV4LCBjKS5yZ2IsIHZlYzMoR0FNTUFfSU5QVVQpKQoKbWF0MyBnZXRfY29sb3JfbWF0cml4KHNhbXBsZXIyRCB0ZXgsIHZlYzIgY28sIHZlYzIgZHgpCnsKICAgIHJldHVybiBtYXQzKFRFWDJEKGNvIC0gZHgpLCBURVgyRChjbyksIFRFWDJEKGNvICsgZHgpKTsKfQoKdmVjMyBibHVyKG1hdDMgbSwgZmxvYXQgZGlzdCwgZmxvYXQgcmFkKQp7CiAgICB2ZWMzIHggPSB2ZWMzKGRpc3QgLSAxLjAsIGRpc3QsIGRpc3QgKyAxLjApIC8gcmFkOwogICAgdmVjMyB3ID0gZXhwMih4ICogeCAqIC0xLjApOwoKICAgIHJldHVybiAobVswXSAqIHcueCArIG1bMV0gKiB3LnkgKyBtWzJdICogdy56KSAvICh3LnggKyB3LnkgKyB3LnopOwp9Cgp2ZWMzIGZpbHRlcl9nYXVzc2lhbihzYW1wbGVyMkQgdGV4LCB2ZWMyIGNvLCB2ZWMyIHRleF9zaXplKQp7CiAgICB2ZWMyIGR4ID0gdmVjMigxLjAgLyB0ZXhfc2l6ZS54LCAwLjApOwogICAgdmVjMiBkeSA9IHZlYzIoMC4wLCAxLjAgLyB0ZXhfc2l6ZS55KTsKICAgIHZlYzIgcGl4X2NvID0gY28gKiB0ZXhfc2l6ZTsKICAgIHZlYzIgdGV4X2NvID0gKGZsb29yKHBpeF9jbykgKyAwLjUpIC8gdGV4X3NpemU7CiAgICB2ZWMyIGRpc3QgPSAoZnJhY3QocGl4X2NvKSAtIDAuNSkgKiAtMS4wOwoKICAgIG1hdDMgbGluZTAgPSBnZXRfY29sb3JfbWF0cml4KHRleCwgdGV4X2NvIC0gZHksIGR4KTsKICAgIG1hdDMgbGluZTEgPSBnZXRfY29sb3JfbWF0cml4KHRleCwgdGV4X2NvLCBkeCk7CiAgICBtYXQzIGxpbmUyID0gZ2V0X2NvbG9yX21hdHJpeCh0ZXgsIHRleF9jbyArIGR5LCBkeCk7CiAgICBtYXQzIGNvbHVtbiA9IG1hdDMoYmx1cihsaW5lMCwgZGlzdC54LCBHTE9XX1dJRFRIKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsdXIobGluZTEsIGRpc3QueCwgR0xPV19XSURUSCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibHVyKGxpbmUyLCBkaXN0LngsIEdMT1dfV0lEVEgpKTsKCiAgICByZXR1cm4gYmx1cihjb2x1bW4sIGRpc3QueSwgR0xPV19IRUlHSFQpOwp9Cgp2ZWMzIGZpbHRlcl9sYW5jem9zKHNhbXBsZXIyRCB0ZXgsIHZlYzIgY28sIHZlYzIgdGV4X3NpemUsIGZsb2F0IHNoYXJwKQp7CiAgICB0ZXhfc2l6ZS54ICo9IHNoYXJwOwoKICAgIHZlYzIgZHggPSB2ZWMyKDEuMCAvIHRleF9zaXplLngsIDAuMCk7CiAgICB2ZWMyIHBpeF9jbyA9IGNvICogdGV4X3NpemUgLSB2ZWMyKDAuNSwgMC4wKTsKICAgIHZlYzIgdGV4X2NvID0gKGZsb29yKHBpeF9jbykgKyB2ZWMyKDAuNSwgMC4wKSkgLyB0ZXhfc2l6ZTsKICAgIHZlYzIgZGlzdCA9IGZyYWN0KHBpeF9jbyk7CiAgICB2ZWM0IGNvZWYgPSBQSSAqIHZlYzQoZGlzdC54ICsgMS4wLCBkaXN0LngsIGRpc3QueCAtIDEuMCwgZGlzdC54IC0gMi4wKTsKCiAgICBjb2VmID0gRklYKGNvZWYpOwogICAgY29lZiA9IDIuMCAqIHNpbihjb2VmKSAqIHNpbihjb2VmIC8gMi4wKSAvIChjb2VmICogY29lZik7CiAgICBjb2VmIC89IGRvdChjb2VmLCB2ZWM0KDEuMCkpOwoKICAgIHZlYzQgY29sMSA9IHZlYzQoVEVYMkQodGV4X2NvKSwgMS4wKTsKICAgIHZlYzQgY29sMiA9IHZlYzQoVEVYMkQodGV4X2NvICsgZHgpLCAxLjApOwoKICAgIHJldHVybiAobWF0NChjb2wxLCBjb2wxLCBjb2wyLCBjb2wyKSAqIGNvZWYpLnJnYjsKfQoKdmVjMyBnZXRfc2NhbmxpbmVfd2VpZ2h0KGZsb2F0IHgsIHZlYzMgY29sKQp7CiAgICB2ZWMzIGJlYW0gPSBtaXgodmVjMyhTQ0FOTElORV9TSVpFX01JTiksIHZlYzMoU0NBTkxJTkVfU0laRV9NQVgpLCBwb3coY29sLCB2ZWMzKDEuMCAvIFNDQU5MSU5FX1NIQVBFKSkpOwogICAgdmVjMyB4X211bCA9IDIuMCAvIGJlYW07CiAgICB2ZWMzIHhfb2Zmc2V0ID0geF9tdWwgKiAwLjU7CgogICAgcmV0dXJuIHNtb290aHN0ZXAoMC4wLCAxLjAsIDEuMCAtIGFicyh4ICogeF9tdWwgLSB4X29mZnNldCkpICogeF9vZmZzZXQ7Cn0KCnZlYzMgZ2V0X21hc2tfd2VpZ2h0KGZsb2F0IHgpCnsKICAgIGZsb2F0IGkgPSBtb2QoZmxvb3IoeCAqIE91dHB1dFNpemUueCAqIFRleHR1cmVTaXplLnggLyAoSW5wdXRTaXplLnggKiBNQVNLX1NJWkUpKSwgTUFTS19DT0xPUlMpOwoKICAgIGlmIChpID09IDAuMCkgcmV0dXJuIG1peCh2ZWMzKDEuMCwgMC4wLCAxLjApLCB2ZWMzKDEuMCwgMC4wLCAwLjApLCBNQVNLX0NPTE9SUyAtIDIuMCk7CiAgICBlbHNlIGlmIChpID09IDEuMCkgcmV0dXJuIHZlYzMoMC4wLCAxLjAsIDAuMCk7CiAgICBlbHNlIHJldHVybiB2ZWMzKDAuMCwgMC4wLCAxLjApOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBmbG9hdCBzY2FsZSA9IGZsb29yKChPdXRwdXRTaXplLnkgLyBJbnB1dFNpemUueSkgKyAwLjAwMSk7CiAgICBmbG9hdCBvZmZzZXQgPSAxLjAgLyBzY2FsZSAqIDAuNTsKICAgIAogICAgaWYgKGJvb2wobW9kKHNjYWxlLCAyLjApKSkgb2Zmc2V0ID0gMC4wOwogICAgCiAgICB2ZWMyIGNvID0gKENvb3JkICogVGV4dHVyZVNpemUgLSB2ZWMyKDAuMCwgb2Zmc2V0ICogU0NBTkxJTkVfT0ZGU0VUKSkgLyBUZXh0dXJlU2l6ZTsKCiAgICB2ZWMzIGNvbF9nbG93ID0gZmlsdGVyX2dhdXNzaWFuKFRleHR1cmUsIGNvLCBUZXh0dXJlU2l6ZSk7CiAgICB2ZWMzIGNvbF9zb2Z0ID0gZmlsdGVyX2xhbmN6b3MoVGV4dHVyZSwgY28sIFRleHR1cmVTaXplLCBTSEFSUE5FU1NfSU1BR0UpOwogICAgdmVjMyBjb2xfc2hhcnAgPSBmaWx0ZXJfbGFuY3pvcyhUZXh0dXJlLCBjbywgVGV4dHVyZVNpemUsIFNIQVJQTkVTU19FREdFUyk7CiAgICB2ZWMzIGNvbCA9IHNxcnQoY29sX3NoYXJwICogY29sX3NvZnQpOwoKICAgIGNvbCAqPSBnZXRfc2NhbmxpbmVfd2VpZ2h0KGZyYWN0KGNvLnkgKiBUZXh0dXJlU2l6ZS55KSwgY29sX3NvZnQpOwogICAgY29sX2dsb3cgPSBzYXR1cmF0ZShjb2xfZ2xvdyAtIGNvbCk7CiAgICBjb2wgKz0gY29sX2dsb3cgKiBjb2xfZ2xvdyAqIEdMT1dfSEFMQVRJT047CiAgICBjb2wgPSBtaXgoY29sLCBjb2wgKiBnZXRfbWFza193ZWlnaHQoY28ueCkgKiBNQVNLX0NPTE9SUywgTUFTS19TVFJFTkdUSCk7CiAgICBjb2wgKz0gY29sX2dsb3cgKiBHTE9XX0RJRkZVU0lPTjsKICAgIGNvbCA9IHBvdyhjb2wgKiBCUklHSFRORVNTLCB2ZWMzKDEuMCAvIEdBTU1BX09VVFBVVCkpOwoKICAgIEZyYWdDb2xvciA9IHZlYzQoY29sLCAxLjApOwp9CgojZW5kaWYK"}]},"crt-easymode.glslp":{shader:{type:"text",value:"shaders = 1\n\nshader0 = crt-easymode.glsl\nfilter_linear0 = false\n"},resources:[{name:"crt-easymode.glsl",type:"base64",value:"LyoKICAgIENSVCBTaGFkZXIgYnkgRWFzeU1vZGUKICAgIExpY2Vuc2U6IEdQTAoKICAgIEEgZmxhdCBDUlQgc2hhZGVyIGlkZWFsbHkgZm9yIDEwODBwIG9yIGhpZ2hlciBkaXNwbGF5cy4KCiAgICBSZWNvbW1lbmRlZCBTZXR0aW5nczoKCiAgICBWaWRlbwogICAgLSBBc3BlY3QgUmF0aW86ICA0OjMKICAgIC0gSW50ZWdlciBTY2FsZTogT2ZmCgogICAgU2hhZGVyCiAgICAtIEZpbHRlcjogTmVhcmVzdAogICAgLSBTY2FsZTogIERvbid0IENhcmUKCiAgICBFeGFtcGxlIFJHQiBNYXNrIFBhcmFtZXRlciBTZXR0aW5nczoKCiAgICBBcGVydHVyZSBHcmlsbGUgKERlZmF1bHQpCiAgICAtIERvdCBXaWR0aDogIDEKICAgIC0gRG90IEhlaWdodDogMQogICAgLSBTdGFnZ2VyOiAgICAwCgogICAgTG90dGVzJyBTaGFkb3cgTWFzawogICAgLSBEb3QgV2lkdGg6ICAyCiAgICAtIERvdCBIZWlnaHQ6IDEKICAgIC0gU3RhZ2dlcjogICAgMwoqLwoKLy8gUGFyYW1ldGVyIGxpbmVzIGdvIGhlcmU6CiNwcmFnbWEgcGFyYW1ldGVyIFNIQVJQTkVTU19IICJTaGFycG5lc3MgSG9yaXpvbnRhbCIgMC41IDAuMCAxLjAgMC4wNQojcHJhZ21hIHBhcmFtZXRlciBTSEFSUE5FU1NfViAiU2hhcnBuZXNzIFZlcnRpY2FsIiAxLjAgMC4wIDEuMCAwLjA1CiNwcmFnbWEgcGFyYW1ldGVyIE1BU0tfU1RSRU5HVEggIk1hc2sgU3RyZW5ndGgiIDAuMyAwLjAgMS4wIDAuMDEKI3ByYWdtYSBwYXJhbWV0ZXIgTUFTS19ET1RfV0lEVEggIk1hc2sgRG90IFdpZHRoIiAxLjAgMS4wIDEwMC4wIDEuMAojcHJhZ21hIHBhcmFtZXRlciBNQVNLX0RPVF9IRUlHSFQgIk1hc2sgRG90IEhlaWdodCIgMS4wIDEuMCAxMDAuMCAxLjAKI3ByYWdtYSBwYXJhbWV0ZXIgTUFTS19TVEFHR0VSICJNYXNrIFN0YWdnZXIiIDAuMCAwLjAgMTAwLjAgMS4wCiNwcmFnbWEgcGFyYW1ldGVyIE1BU0tfU0laRSAiTWFzayBTaXplIiAxLjAgMS4wIDEwMC4wIDEuMAojcHJhZ21hIHBhcmFtZXRlciBTQ0FOTElORV9TVFJFTkdUSCAiU2NhbmxpbmUgU3RyZW5ndGgiIDEuMCAwLjAgMS4wIDAuMDUKI3ByYWdtYSBwYXJhbWV0ZXIgU0NBTkxJTkVfQkVBTV9XSURUSF9NSU4gIlNjYW5saW5lIEJlYW0gV2lkdGggTWluLiIgMS41IDAuNSA1LjAgMC41CiNwcmFnbWEgcGFyYW1ldGVyIFNDQU5MSU5FX0JFQU1fV0lEVEhfTUFYICJTY2FubGluZSBCZWFtIFdpZHRoIE1heC4iIDEuNSAwLjUgNS4wIDAuNQojcHJhZ21hIHBhcmFtZXRlciBTQ0FOTElORV9CUklHSFRfTUlOICJTY2FubGluZSBCcmlnaHRuZXNzIE1pbi4iIDAuMzUgMC4wIDEuMCAwLjA1CiNwcmFnbWEgcGFyYW1ldGVyIFNDQU5MSU5FX0JSSUdIVF9NQVggIlNjYW5saW5lIEJyaWdodG5lc3MgTWF4LiIgMC42NSAwLjAgMS4wIDAuMDUKI3ByYWdtYSBwYXJhbWV0ZXIgU0NBTkxJTkVfQ1VUT0ZGICJTY2FubGluZSBDdXRvZmYiIDQwMC4wIDEuMCAxMDAwLjAgMS4wCiNwcmFnbWEgcGFyYW1ldGVyIEdBTU1BX0lOUFVUICJHYW1tYSBJbnB1dCIgMi4wIDAuMSA1LjAgMC4xCiNwcmFnbWEgcGFyYW1ldGVyIEdBTU1BX09VVFBVVCAiR2FtbWEgT3V0cHV0IiAxLjggMC4xIDUuMCAwLjEKI3ByYWdtYSBwYXJhbWV0ZXIgQlJJR0hUX0JPT1NUICJCcmlnaHRuZXNzIEJvb3N0IiAxLjIgMS4wIDIuMCAwLjAxCiNwcmFnbWEgcGFyYW1ldGVyIERJTEFUSU9OICJEaWxhdGlvbiIgMS4wIDAuMCAxLjAgMS4wCgojaWYgZGVmaW5lZChWRVJURVgpCgojaWYgX19WRVJTSU9OX18gPj0gMTMwCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgb3V0CiNkZWZpbmUgQ09NUEFUX0FUVFJJQlVURSBpbgojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUKI2Vsc2UKI2RlZmluZSBDT01QQVRfVkFSWUlORyB2YXJ5aW5nIAojZGVmaW5lIENPTVBBVF9BVFRSSUJVVEUgYXR0cmlidXRlIAojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUyRAojZW5kaWYKCiNpZmRlZiBHTF9FUwojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04gbWVkaXVtcAojZWxzZQojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04KI2VuZGlmCgpDT01QQVRfQVRUUklCVVRFIHZlYzQgVmVydGV4Q29vcmQ7CkNPTVBBVF9BVFRSSUJVVEUgdmVjNCBDT0xPUjsKQ09NUEFUX0FUVFJJQlVURSB2ZWM0IFRleENvb3JkOwpDT01QQVRfVkFSWUlORyB2ZWM0IENPTDA7CkNPTVBBVF9WQVJZSU5HIHZlYzQgVEVYMDsKCnZlYzQgX29Qb3NpdGlvbjE7IAp1bmlmb3JtIG1hdDQgTVZQTWF0cml4Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lRGlyZWN0aW9uOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lQ291bnQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIE91dHB1dFNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIFRleHR1cmVTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBJbnB1dFNpemU7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IE1WUE1hdHJpeCAqIFZlcnRleENvb3JkOwogICAgQ09MMCA9IENPTE9SOwogICAgVEVYMC54eSA9IFRleENvb3JkLnh5Owp9CgojZWxpZiBkZWZpbmVkKEZSQUdNRU5UKQoKI2lmIF9fVkVSU0lPTl9fID49IDEzMAojZGVmaW5lIENPTVBBVF9WQVJZSU5HIGluCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZQpvdXQgdmVjNCBGcmFnQ29sb3I7CiNlbHNlCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgdmFyeWluZwojZGVmaW5lIEZyYWdDb2xvciBnbF9GcmFnQ29sb3IKI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlMkQKI2VuZGlmCgojaWZkZWYgR0xfRVMKI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdICnByZWNpc2lvbiBoaWdocCBmbG9hdDsKI2Vsc2UKcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CnByZWNpc2lvbiBtZWRpdW1wIGludDsKI2VuZGlmCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTiBtZWRpdW1wCiNlbHNlCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTgojZW5kaWYKCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVEaXJlY3Rpb247CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVDb3VudDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgT3V0cHV0U2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgVGV4dHVyZVNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIElucHV0U2l6ZTsKdW5pZm9ybSBzYW1wbGVyMkQgVGV4dHVyZTsKQ09NUEFUX1ZBUllJTkcgdmVjNCBURVgwOwoKI2RlZmluZSBGSVgoYykgbWF4KGFicyhjKSwgMWUtNSkKI2RlZmluZSBQSSAzLjE0MTU5MjY1MzU4OQoKI2RlZmluZSBURVgyRChjKSBkaWxhdGUoQ09NUEFUX1RFWFRVUkUoVGV4dHVyZSwgYykpCgovLyBjb21wYXRpYmlsaXR5ICNkZWZpbmVzCiNkZWZpbmUgU291cmNlIFRleHR1cmUKI2RlZmluZSB2VGV4Q29vcmQgVEVYMC54eQoKI2RlZmluZSBTb3VyY2VTaXplIHZlYzQoVGV4dHVyZVNpemUsIDEuMCAvIFRleHR1cmVTaXplKSAvL2VpdGhlciBUZXh0dXJlU2l6ZSBvciBJbnB1dFNpemUKI2RlZmluZSBvdXRzaXplIHZlYzQoT3V0cHV0U2l6ZSwgMS4wIC8gT3V0cHV0U2l6ZSkKCiNpZmRlZiBQQVJBTUVURVJfVU5JRk9STQovLyBBbGwgcGFyYW1ldGVyIGZsb2F0cyBuZWVkIHRvIGhhdmUgQ09NUEFUX1BSRUNJU0lPTiBpbiBmcm9udCBvZiB0aGVtCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBTSEFSUE5FU1NfSDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IFNIQVJQTkVTU19WOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgTUFTS19TVFJFTkdUSDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IE1BU0tfRE9UX1dJRFRIOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgTUFTS19ET1RfSEVJR0hUOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgTUFTS19TVEFHR0VSOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgTUFTS19TSVpFOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgU0NBTkxJTkVfU1RSRU5HVEg7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBTQ0FOTElORV9CRUFNX1dJRFRIX01JTjsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IFNDQU5MSU5FX0JFQU1fV0lEVEhfTUFYOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgU0NBTkxJTkVfQlJJR0hUX01JTjsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IFNDQU5MSU5FX0JSSUdIVF9NQVg7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBTQ0FOTElORV9DVVRPRkY7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBHQU1NQV9JTlBVVDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IEdBTU1BX09VVFBVVDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IEJSSUdIVF9CT09TVDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IERJTEFUSU9OOwojZWxzZQojZGVmaW5lIFNIQVJQTkVTU19IIDAuNQojZGVmaW5lIFNIQVJQTkVTU19WIDEuMAojZGVmaW5lIE1BU0tfU1RSRU5HVEggMC4zCiNkZWZpbmUgTUFTS19ET1RfV0lEVEggMS4wCiNkZWZpbmUgTUFTS19ET1RfSEVJR0hUIDEuMAojZGVmaW5lIE1BU0tfU1RBR0dFUiAwLjAKI2RlZmluZSBNQVNLX1NJWkUgMS4wCiNkZWZpbmUgU0NBTkxJTkVfU1RSRU5HVEggMS4wCiNkZWZpbmUgU0NBTkxJTkVfQkVBTV9XSURUSF9NSU4gMS41CiNkZWZpbmUgU0NBTkxJTkVfQkVBTV9XSURUSF9NQVggMS41CiNkZWZpbmUgU0NBTkxJTkVfQlJJR0hUX01JTiAwLjM1CiNkZWZpbmUgU0NBTkxJTkVfQlJJR0hUX01BWCAwLjY1CiNkZWZpbmUgU0NBTkxJTkVfQ1VUT0ZGIDQwMC4wCiNkZWZpbmUgR0FNTUFfSU5QVVQgMi4wCiNkZWZpbmUgR0FNTUFfT1VUUFVUIDEuOAojZGVmaW5lIEJSSUdIVF9CT09TVCAxLjIKI2RlZmluZSBESUxBVElPTiAxLjAKI2VuZGlmCgovLyBTZXQgdG8gMCB0byB1c2UgbGluZWFyIGZpbHRlciBhbmQgZ2FpbiBzcGVlZAojZGVmaW5lIEVOQUJMRV9MQU5DWk9TIDEKCnZlYzQgZGlsYXRlKHZlYzQgY29sKQp7CiAgICB2ZWM0IHggPSBtaXgodmVjNCgxLjApLCBjb2wsIERJTEFUSU9OKTsKCiAgICByZXR1cm4gY29sICogeDsKfQoKZmxvYXQgY3VydmVfZGlzdGFuY2UoZmxvYXQgeCwgZmxvYXQgc2hhcnApCnsKCi8qCiAgICBhcHBseSBoYWxmLWNpcmNsZSBzLWN1cnZlIHRvIGRpc3RhbmNlIGZvciBzaGFycGVyIChtb3JlIHBpeGVsYXRlZCkgaW50ZXJwb2xhdGlvbgogICAgc2luZ2xlIGxpbmUgZm9ybXVsYSBmb3IgR3JhcGggVG95OgogICAgMC41IC0gc3FydCgwLjI1IC0gKHggLSBzdGVwKDAuNSwgeCkpICogKHggLSBzdGVwKDAuNSwgeCkpKSAqIHNpZ24oMC41IC0geCkKKi8KCiAgICBmbG9hdCB4X3N0ZXAgPSBzdGVwKDAuNSwgeCk7CiAgICBmbG9hdCBjdXJ2ZSA9IDAuNSAtIHNxcnQoMC4yNSAtICh4IC0geF9zdGVwKSAqICh4IC0geF9zdGVwKSkgKiBzaWduKDAuNSAtIHgpOwoKICAgIHJldHVybiBtaXgoeCwgY3VydmUsIHNoYXJwKTsKfQoKbWF0NCBnZXRfY29sb3JfbWF0cml4KHZlYzIgY28sIHZlYzIgZHgpCnsKICAgIHJldHVybiBtYXQ0KFRFWDJEKGNvIC0gZHgpLCBURVgyRChjbyksIFRFWDJEKGNvICsgZHgpLCBURVgyRChjbyArIDIuMCAqIGR4KSk7Cn0KCnZlYzMgZmlsdGVyX2xhbmN6b3ModmVjNCBjb2VmZnMsIG1hdDQgY29sb3JfbWF0cml4KQp7CiAgICB2ZWM0IGNvbCAgICAgICAgPSBjb2xvcl9tYXRyaXggKiBjb2VmZnM7CiAgICB2ZWM0IHNhbXBsZV9taW4gPSBtaW4oY29sb3JfbWF0cml4WzFdLCBjb2xvcl9tYXRyaXhbMl0pOwogICAgdmVjNCBzYW1wbGVfbWF4ID0gbWF4KGNvbG9yX21hdHJpeFsxXSwgY29sb3JfbWF0cml4WzJdKTsKCiAgICBjb2wgPSBjbGFtcChjb2wsIHNhbXBsZV9taW4sIHNhbXBsZV9tYXgpOwoKICAgIHJldHVybiBjb2wucmdiOwp9Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWMyIGR4ICAgICA9IHZlYzIoU291cmNlU2l6ZS56LCAwLjApOwogICAgdmVjMiBkeSAgICAgPSB2ZWMyKDAuMCwgU291cmNlU2l6ZS53KTsKICAgIHZlYzIgcGl4X2NvID0gdlRleENvb3JkICogU291cmNlU2l6ZS54eSAtIHZlYzIoMC41LCAwLjUpOwogICAgdmVjMiB0ZXhfY28gPSAoZmxvb3IocGl4X2NvKSArIHZlYzIoMC41LCAwLjUpKSAqIFNvdXJjZVNpemUuenc7CiAgICB2ZWMyIGRpc3QgICA9IGZyYWN0KHBpeF9jbyk7CiAgICBmbG9hdCBjdXJ2ZV94OwogICAgdmVjMyBjb2wsIGNvbDI7CgojaWYgRU5BQkxFX0xBTkNaT1MKICAgIGN1cnZlX3ggPSBjdXJ2ZV9kaXN0YW5jZShkaXN0LngsIFNIQVJQTkVTU19IICogU0hBUlBORVNTX0gpOwoKICAgIHZlYzQgY29lZmZzID0gUEkgKiB2ZWM0KDEuMCArIGN1cnZlX3gsIGN1cnZlX3gsIDEuMCAtIGN1cnZlX3gsIDIuMCAtIGN1cnZlX3gpOwoKICAgIGNvZWZmcyA9IEZJWChjb2VmZnMpOwogICAgY29lZmZzID0gMi4wICogc2luKGNvZWZmcykgKiBzaW4oY29lZmZzICogMC41KSAvIChjb2VmZnMgKiBjb2VmZnMpOwogICAgY29lZmZzIC89IGRvdChjb2VmZnMsIHZlYzQoMS4wKSk7CgogICAgY29sICA9IGZpbHRlcl9sYW5jem9zKGNvZWZmcywgZ2V0X2NvbG9yX21hdHJpeCh0ZXhfY28sIGR4KSk7CiAgICBjb2wyID0gZmlsdGVyX2xhbmN6b3MoY29lZmZzLCBnZXRfY29sb3JfbWF0cml4KHRleF9jbyArIGR5LCBkeCkpOwojZWxzZQogICAgY3VydmVfeCA9IGN1cnZlX2Rpc3RhbmNlKGRpc3QueCwgU0hBUlBORVNTX0gpOwoKICAgIGNvbCAgPSBtaXgoVEVYMkQodGV4X2NvKS5yZ2IsICAgICAgVEVYMkQodGV4X2NvICsgZHgpLnJnYiwgICAgICBjdXJ2ZV94KTsKICAgIGNvbDIgPSBtaXgoVEVYMkQodGV4X2NvICsgZHkpLnJnYiwgVEVYMkQodGV4X2NvICsgZHggKyBkeSkucmdiLCBjdXJ2ZV94KTsKI2VuZGlmCgogICAgY29sID0gbWl4KGNvbCwgY29sMiwgY3VydmVfZGlzdGFuY2UoZGlzdC55LCBTSEFSUE5FU1NfVikpOwogICAgY29sID0gcG93KGNvbCwgdmVjMyhHQU1NQV9JTlBVVCAvIChESUxBVElPTiArIDEuMCkpKTsKCiAgICBmbG9hdCBsdW1hICAgICAgICA9IGRvdCh2ZWMzKDAuMjEyNiwgMC43MTUyLCAwLjA3MjIpLCBjb2wpOwogICAgZmxvYXQgYnJpZ2h0ICAgICAgPSAobWF4KGNvbC5yLCBtYXgoY29sLmcsIGNvbC5iKSkgKyBsdW1hKSAqIDAuNTsKICAgIGZsb2F0IHNjYW5fYnJpZ2h0ID0gY2xhbXAoYnJpZ2h0LCBTQ0FOTElORV9CUklHSFRfTUlOLCBTQ0FOTElORV9CUklHSFRfTUFYKTsKICAgIGZsb2F0IHNjYW5fYmVhbSAgID0gY2xhbXAoYnJpZ2h0ICogU0NBTkxJTkVfQkVBTV9XSURUSF9NQVgsIFNDQU5MSU5FX0JFQU1fV0lEVEhfTUlOLCBTQ0FOTElORV9CRUFNX1dJRFRIX01BWCk7CiAgICBmbG9hdCBzY2FuX3dlaWdodCA9IDEuMCAtIHBvdyhjb3ModlRleENvb3JkLnkgKiAyLjAgKiBQSSAqIFNvdXJjZVNpemUueSkgKiAwLjUgKyAwLjUsIHNjYW5fYmVhbSkgKiBTQ0FOTElORV9TVFJFTkdUSDsKCiAgICBmbG9hdCBtYXNrICAgPSAxLjAgLSBNQVNLX1NUUkVOR1RIOyAgICAKICAgIHZlYzIgbW9kX2ZhYyA9IGZsb29yKHZUZXhDb29yZCAqIG91dHNpemUueHkgKiBTb3VyY2VTaXplLnh5IC8gKElucHV0U2l6ZS54eSAqIHZlYzIoTUFTS19TSVpFLCBNQVNLX0RPVF9IRUlHSFQgKiBNQVNLX1NJWkUpKSk7CiAgICBpbnQgZG90X25vICAgPSBpbnQobW9kKChtb2RfZmFjLnggKyBtb2QobW9kX2ZhYy55LCAyLjApICogTUFTS19TVEFHR0VSKSAvIE1BU0tfRE9UX1dJRFRILCAzLjApKTsKICAgIHZlYzMgbWFza193ZWlnaHQ7CgogICAgaWYgICAgICAoZG90X25vID09IDApIG1hc2tfd2VpZ2h0ID0gdmVjMygxLjAsICBtYXNrLCBtYXNrKTsKICAgIGVsc2UgaWYgKGRvdF9ubyA9PSAxKSBtYXNrX3dlaWdodCA9IHZlYzMobWFzaywgMS4wLCAgbWFzayk7CiAgICBlbHNlICAgICAgICAgICAgICAgICAgbWFza193ZWlnaHQgPSB2ZWMzKG1hc2ssIG1hc2ssIDEuMCk7CgogICAgaWYgKElucHV0U2l6ZS55ID49IFNDQU5MSU5FX0NVVE9GRikgCiAgICAgICAgc2Nhbl93ZWlnaHQgPSAxLjA7CgogICAgY29sMiA9IGNvbC5yZ2I7CiAgICBjb2wgKj0gdmVjMyhzY2FuX3dlaWdodCk7CiAgICBjb2wgID0gbWl4KGNvbCwgY29sMiwgc2Nhbl9icmlnaHQpOwogICAgY29sICo9IG1hc2tfd2VpZ2h0OwogICAgY29sICA9IHBvdyhjb2wsIHZlYzMoMS4wIC8gR0FNTUFfT1VUUFVUKSk7CgogICAgRnJhZ0NvbG9yID0gdmVjNChjb2wgKiBCUklHSFRfQk9PU1QsIDEuMCk7Cn0gCiNlbmRpZgo="}]},"crt-geom.glslp":{shader:{type:"text",value:"shaders = 1\n\nshader0 = crt-geom.glsl\nfilter_linear0 = false\n"},resources:[{name:"crt-geom.glsl",type:"base64",value:"LyoKICAgIENSVC1pbnRlcmxhY2VkCgogICAgQ29weXJpZ2h0IChDKSAyMDEwLTIwMTIgY2d3ZywgVGhlbWFpc3RlciBhbmQgRE9MTFMKCiAgICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdAogICAgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUKICAgIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikKICAgIGFueSBsYXRlciB2ZXJzaW9uLgoKICAgIChjZ3dnIGdhdmUgdGhlaXIgY29uc2VudCB0byBoYXZlIHRoZSBvcmlnaW5hbCB2ZXJzaW9uIG9mIHRoaXMgc2hhZGVyCiAgICBkaXN0cmlidXRlZCB1bmRlciB0aGUgR1BMIGluIHRoaXMgbWVzc2FnZToKCiAgICAgICAgaHR0cDovL2JvYXJkLmJ5dXUub3JnL3ZpZXd0b3BpYy5waHA/cD0yNjA3NSNwMjYwNzUKCiAgICAgICAgIkZlZWwgZnJlZSB0byBkaXN0cmlidXRlIG15IHNoYWRlcnMgdW5kZXIgdGhlIEdQTC4gQWZ0ZXIgYWxsLCB0aGUKICAgICAgICBiYXJyZWwgZGlzdG9ydGlvbiBjb2RlIHdhcyB0YWtlbiBmcm9tIHRoZSBDdXJ2YXR1cmUgc2hhZGVyLCB3aGljaCBpcwogICAgICAgIHVuZGVyIHRoZSBHUEwuIgogICAgKQoJVGhpcyBzaGFkZXIgdmFyaWFudCBpcyBwcmUtY29uZmlndXJlZCB3aXRoIHNjcmVlbiBjdXJ2YXR1cmUKKi8KCiNwcmFnbWEgcGFyYW1ldGVyIENSVGdhbW1hICJDUlRHZW9tIFRhcmdldCBHYW1tYSIgMi40IDAuMSA1LjAgMC4xCiNwcmFnbWEgcGFyYW1ldGVyIElOViAiSW52ZXJzZSBHYW1tYS9DUlQtR2VvbSBHYW1tYSBvdXQiIDEuMCAwLjAgMS4wIDEuMAojcHJhZ21hIHBhcmFtZXRlciBtb25pdG9yZ2FtbWEgIkNSVEdlb20gTW9uaXRvciBHYW1tYSIgMi4yIDAuMSA1LjAgMC4xCiNwcmFnbWEgcGFyYW1ldGVyIGQgIkNSVEdlb20gRGlzdGFuY2UiIDEuNiAwLjEgMy4wIDAuMQojcHJhZ21hIHBhcmFtZXRlciBDVVJWQVRVUkUgIkNSVEdlb20gQ3VydmF0dXJlIFRvZ2dsZSIgMS4wIDAuMCAxLjAgMS4wCiNwcmFnbWEgcGFyYW1ldGVyIFIgIkNSVEdlb20gQ3VydmF0dXJlIFJhZGl1cyIgMi4wIDAuMSAxMC4wIDAuMQojcHJhZ21hIHBhcmFtZXRlciBjb3JuZXJzaXplICJDUlRHZW9tIENvcm5lciBTaXplIiAwLjAzIDAuMDAxIDEuMCAwLjAwNQojcHJhZ21hIHBhcmFtZXRlciBjb3JuZXJzbW9vdGggIkNSVEdlb20gQ29ybmVyIFNtb290aG5lc3MiIDEwMDAuMCA4MC4wIDIwMDAuMCAxMDAuMAojcHJhZ21hIHBhcmFtZXRlciB4X3RpbHQgIkNSVEdlb20gSG9yaXpvbnRhbCBUaWx0IiAwLjAgLTAuNSAwLjUgMC4wNQojcHJhZ21hIHBhcmFtZXRlciB5X3RpbHQgIkNSVEdlb20gVmVydGljYWwgVGlsdCIgMC4wIC0wLjUgMC41IDAuMDUKI3ByYWdtYSBwYXJhbWV0ZXIgb3ZlcnNjYW5feCAiQ1JUR2VvbSBIb3Jpei4gT3ZlcnNjYW4gJSIgMTAwLjAgLTEyNS4wIDEyNS4wIDEuMAojcHJhZ21hIHBhcmFtZXRlciBvdmVyc2Nhbl95ICJDUlRHZW9tIFZlcnQuIE92ZXJzY2FuICUiIDEwMC4wIC0xMjUuMCAxMjUuMCAxLjAKI3ByYWdtYSBwYXJhbWV0ZXIgRE9UTUFTSyAiQ1JUR2VvbSBEb3QgTWFzayBTdHJlbmd0aCIgMC4zIDAuMCAxLjAgMC4xCiNwcmFnbWEgcGFyYW1ldGVyIFNIQVJQRVIgIkNSVEdlb20gU2hhcnBuZXNzIiAxLjAgMS4wIDMuMCAxLjAKI3ByYWdtYSBwYXJhbWV0ZXIgc2NhbmxpbmVfd2VpZ2h0ICJDUlRHZW9tIFNjYW5saW5lIFdlaWdodCIgMC4zIDAuMSAwLjUgMC4wNQojcHJhZ21hIHBhcmFtZXRlciBsdW0gIkNSVEdlb20gTHVtaW5hbmNlIiAwLjAgMC4wIDEuMCAwLjAxCiNwcmFnbWEgcGFyYW1ldGVyIGludGVybGFjZV9kZXRlY3QgIkNSVEdlb20gSW50ZXJsYWNpbmcgU2ltdWxhdGlvbiIgMS4wIDAuMCAxLjAgMS4wCiNwcmFnbWEgcGFyYW1ldGVyIFNBVFVSQVRJT04gIkNSVEdlb20gU2F0dXJhdGlvbiIgMS4wIDAuMCAyLjAgMC4wNQoKI2lmbmRlZiBQQVJBTUVURVJfVU5JRk9STQojZGVmaW5lIENSVGdhbW1hIDIuNAojZGVmaW5lIG1vbml0b3JnYW1tYSAyLjIKI2RlZmluZSBkIDEuNgojZGVmaW5lIENVUlZBVFVSRSAxLjAKI2RlZmluZSBSIDIuMAojZGVmaW5lIGNvcm5lcnNpemUgMC4wMwojZGVmaW5lIGNvcm5lcnNtb290aCAxMDAwLjAKI2RlZmluZSB4X3RpbHQgMC4wCiNkZWZpbmUgeV90aWx0IDAuMAojZGVmaW5lIG92ZXJzY2FuX3ggMTAwLjAKI2RlZmluZSBvdmVyc2Nhbl95IDEwMC4wCiNkZWZpbmUgRE9UTUFTSyAwLjMKI2RlZmluZSBTSEFSUEVSIDEuMAojZGVmaW5lIHNjYW5saW5lX3dlaWdodCAwLjMKI2RlZmluZSBsdW0gMC4wCiNkZWZpbmUgaW50ZXJsYWNlX2RldGVjdCAxLjAKI2RlZmluZSBTQVRVUkFUSU9OIDEuMAojZGVmaW5lIElOViAxLjAKI2VuZGlmCgojaWYgZGVmaW5lZChWRVJURVgpCgojaWYgX19WRVJTSU9OX18gPj0gMTMwCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgb3V0CiNkZWZpbmUgQ09NUEFUX0FUVFJJQlVURSBpbgojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUKI2Vsc2UKI2RlZmluZSBDT01QQVRfVkFSWUlORyB2YXJ5aW5nIAojZGVmaW5lIENPTVBBVF9BVFRSSUJVVEUgYXR0cmlidXRlIAojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUyRAojZW5kaWYKCiNpZmRlZiBHTF9FUwojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04gbWVkaXVtcAojZWxzZQojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04KI2VuZGlmCgpDT01QQVRfQVRUUklCVVRFIHZlYzQgVmVydGV4Q29vcmQ7CkNPTVBBVF9BVFRSSUJVVEUgdmVjNCBDT0xPUjsKQ09NUEFUX0FUVFJJQlVURSB2ZWM0IFRleENvb3JkOwpDT01QQVRfVkFSWUlORyB2ZWM0IENPTDA7CkNPTVBBVF9WQVJZSU5HIHZlYzQgVEVYMDsKCnZlYzQgX29Qb3NpdGlvbjE7IAp1bmlmb3JtIG1hdDQgTVZQTWF0cml4Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lRGlyZWN0aW9uOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lQ291bnQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIE91dHB1dFNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIFRleHR1cmVTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBJbnB1dFNpemU7CgpDT01QQVRfVkFSWUlORyB2ZWMyIG92ZXJzY2FuOwpDT01QQVRfVkFSWUlORyB2ZWMyIGFzcGVjdDsKQ09NUEFUX1ZBUllJTkcgdmVjMyBzdHJldGNoOwpDT01QQVRfVkFSWUlORyB2ZWMyIHNpbmFuZ2xlOwpDT01QQVRfVkFSWUlORyB2ZWMyIGNvc2FuZ2xlOwpDT01QQVRfVkFSWUlORyB2ZWMyIG9uZTsKQ09NUEFUX1ZBUllJTkcgZmxvYXQgbW9kX2ZhY3RvcjsKQ09NUEFUX1ZBUllJTkcgdmVjMiBpbGZhYzsKCiNpZmRlZiBQQVJBTUVURVJfVU5JRk9STQp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgQ1JUZ2FtbWE7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBtb25pdG9yZ2FtbWE7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBkOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgQ1VSVkFUVVJFOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgUjsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IGNvcm5lcnNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBjb3JuZXJzbW9vdGg7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCB4X3RpbHQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCB5X3RpbHQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBvdmVyc2Nhbl94Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgb3ZlcnNjYW5feTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IERPVE1BU0s7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBTSEFSUEVSOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgc2NhbmxpbmVfd2VpZ2h0Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgbHVtOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgaW50ZXJsYWNlX2RldGVjdDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IFNBVFVSQVRJT047CiNlbmRpZgoKI2RlZmluZSBGSVgoYykgbWF4KGFicyhjKSwgMWUtNSk7CgpmbG9hdCBpbnRlcnNlY3QodmVjMiB4eSkKICAgICAgICB7CglmbG9hdCBBID0gZG90KHh5LHh5KStkKmQ7CglmbG9hdCBCID0gMi4wKihSKihkb3QoeHksc2luYW5nbGUpLWQqY29zYW5nbGUueCpjb3NhbmdsZS55KS1kKmQpOwoJZmxvYXQgQyA9IGQqZCArIDIuMCpSKmQqY29zYW5nbGUueCpjb3NhbmdsZS55OwoJcmV0dXJuICgtQi1zcXJ0KEIqQi00LjAqQSpDKSkvKDIuMCpBKTsKICAgICAgICB9Cgp2ZWMyIGJrd3RyYW5zKHZlYzIgeHkpCiAgICAgICAgewoJZmxvYXQgYyA9IGludGVyc2VjdCh4eSk7Cgl2ZWMyIHBvaW50ID0gdmVjMihjKSp4eTsKCXBvaW50IC09IHZlYzIoLVIpKnNpbmFuZ2xlOwoJcG9pbnQgLz0gdmVjMihSKTsKCXZlYzIgdGFuZyA9IHNpbmFuZ2xlL2Nvc2FuZ2xlOwoJdmVjMiBwb2MgPSBwb2ludC9jb3NhbmdsZTsKCWZsb2F0IEEgPSBkb3QodGFuZyx0YW5nKSsxLjA7CglmbG9hdCBCID0gLTIuMCpkb3QocG9jLHRhbmcpOwoJZmxvYXQgQyA9IGRvdChwb2MscG9jKS0xLjA7CglmbG9hdCBhID0gKC1CK3NxcnQoQipCLTQuMCpBKkMpKS8oMi4wKkEpOwoJdmVjMiB1diA9IChwb2ludC1hKnNpbmFuZ2xlKS9jb3NhbmdsZTsKCWZsb2F0IHIgPSBSKmFjb3MoYSk7CglyZXR1cm4gdXYqci9zaW4oci9SKTsKICAgICAgICB9Cgp2ZWMyIGZ3dHJhbnModmVjMiB1dikKICAgICAgICB7CglmbG9hdCByID0gRklYKHNxcnQoZG90KHV2LHV2KSkpOwoJdXYgKj0gc2luKHIvUikvcjsKCWZsb2F0IHggPSAxLjAtY29zKHIvUik7CglmbG9hdCBEID0gZC9SICsgeCpjb3NhbmdsZS54KmNvc2FuZ2xlLnkrZG90KHV2LHNpbmFuZ2xlKTsKCXJldHVybiBkKih1dipjb3NhbmdsZS14KnNpbmFuZ2xlKS9EOwogICAgICAgIH0KCnZlYzMgbWF4c2NhbGUoKQogICAgICAgIHsKCXZlYzIgYyA9IGJrd3RyYW5zKC1SICogc2luYW5nbGUgLyAoMS4wICsgUi9kKmNvc2FuZ2xlLngqY29zYW5nbGUueSkpOwoJdmVjMiBhID0gdmVjMigwLjUsMC41KSphc3BlY3Q7Cgl2ZWMyIGxvID0gdmVjMihmd3RyYW5zKHZlYzIoLWEueCxjLnkpKS54LCBmd3RyYW5zKHZlYzIoYy54LC1hLnkpKS55KS9hc3BlY3Q7Cgl2ZWMyIGhpID0gdmVjMihmd3RyYW5zKHZlYzIoK2EueCxjLnkpKS54LCBmd3RyYW5zKHZlYzIoYy54LCthLnkpKS55KS9hc3BlY3Q7CglyZXR1cm4gdmVjMygoaGkrbG8pKmFzcGVjdCowLjUsbWF4KGhpLngtbG8ueCxoaS55LWxvLnkpKTsKICAgICAgICB9Cgp2b2lkIG1haW4oKQp7Ci8vIFNUQVJUIG9mIHBhcmFtZXRlcnMKCi8vIGdhbW1hIG9mIHNpbXVsYXRlZCBDUlQKLy8JQ1JUZ2FtbWEgPSAxLjg7Ci8vIGdhbW1hIG9mIGRpc3BsYXkgbW9uaXRvciAodHlwaWNhbGx5IDIuMiBpcyBjb3JyZWN0KQovLwltb25pdG9yZ2FtbWEgPSAyLjI7Ci8vIG92ZXJzY2FuIChlLmcuIDEuMDIgZm9yIDIlIG92ZXJzY2FuKQoJb3ZlcnNjYW4gPSB2ZWMyKDEuMDAsMS4wMCk7Ci8vIGFzcGVjdCByYXRpbwoJYXNwZWN0ID0gdmVjMigxLjAsIDAuNzUpOwovLyBsZW5ndGhzIGFyZSBtZWFzdXJlZCBpbiB1bml0cyBvZiAoYXBwcm94aW1hdGVseSkgdGhlIHdpZHRoCi8vIG9mIHRoZSBtb25pdG9yIHNpbXVsYXRlZCBkaXN0YW5jZSBmcm9tIHZpZXdlciB0byBtb25pdG9yCi8vCWQgPSAyLjA7Ci8vIHJhZGl1cyBvZiBjdXJ2YXR1cmUKLy8JUiA9IDEuNTsKLy8gdGlsdCBhbmdsZSBpbiByYWRpYW5zCi8vIChiZWhhdmlvciBtaWdodCBiZSBhIGJpdCB3cm9uZyBpZiBib3RoIGNvbXBvbmVudHMgYXJlCi8vIG5vbnplcm8pCgljb25zdCB2ZWMyIGFuZ2xlID0gdmVjMigwLjAsMC4wKTsKLy8gc2l6ZSBvZiBjdXJ2ZWQgY29ybmVycwovLwljb3JuZXJzaXplID0gMC4wMzsKLy8gYm9yZGVyIHNtb290aG5lc3MgcGFyYW1ldGVyCi8vIGRlY3JlYXNlIGlmIGJvcmRlcnMgYXJlIHRvbyBhbGlhc2VkCi8vCWNvcm5lcnNtb290aCA9IDEwMDAuMDsKCi8vIEVORCBvZiBwYXJhbWV0ZXJzCgogICAgdmVjNCBfb0NvbG9yOwogICAgdmVjMiBfb3RleENvb3JkOwogICAgZ2xfUG9zaXRpb24gPSBWZXJ0ZXhDb29yZC54ICogTVZQTWF0cml4WzBdICsgVmVydGV4Q29vcmQueSAqIE1WUE1hdHJpeFsxXSArIFZlcnRleENvb3JkLnogKiBNVlBNYXRyaXhbMl0gKyBWZXJ0ZXhDb29yZC53ICogTVZQTWF0cml4WzNdOwogICAgX29Qb3NpdGlvbjEgPSBnbF9Qb3NpdGlvbjsKICAgIF9vQ29sb3IgPSBDT0xPUjsKICAgIF9vdGV4Q29vcmQgPSBUZXhDb29yZC54eSoxLjAwMDE7CiAgICBDT0wwID0gQ09MT1I7CiAgICBURVgwLnh5ID0gVGV4Q29vcmQueHkqMS4wMDAxOwoKLy8gUHJlY2FsY3VsYXRlIGEgYnVuY2ggb2YgdXNlZnVsIHZhbHVlcyB3ZSdsbCBuZWVkIGluIHRoZSBmcmFnbWVudAovLyBzaGFkZXIuCglzaW5hbmdsZSA9IHNpbih2ZWMyKHhfdGlsdCwgeV90aWx0KSkgKyB2ZWMyKDAuMDAxKTsvL3Npbih2ZWMyKG1heChhYnMoeF90aWx0KSwgMWUtMyksIG1heChhYnMoeV90aWx0KSwgMWUtMykpKTsKCWNvc2FuZ2xlID0gY29zKHZlYzIoeF90aWx0LCB5X3RpbHQpKSArIHZlYzIoMC4wMDEpOy8vY29zKHZlYzIobWF4KGFicyh4X3RpbHQpLCAxZS0zKSwgbWF4KGFicyh5X3RpbHQpLCAxZS0zKSkpOwoJc3RyZXRjaCA9IG1heHNjYWxlKCk7CgoJaWxmYWMgPSB2ZWMyKDEuMCxjbGFtcChmbG9vcihJbnB1dFNpemUueS8yMDAuMCksIDEuMCwgMi4wKSk7CgovLyBUaGUgc2l6ZSBvZiBvbmUgdGV4ZWwsIGluIHRleHR1cmUtY29vcmRpbmF0ZXMuCgl2ZWMyIHNoYXJwVGV4dHVyZVNpemUgPSB2ZWMyKFNIQVJQRVIgKiBUZXh0dXJlU2l6ZS54LCBUZXh0dXJlU2l6ZS55KTsKCW9uZSA9IGlsZmFjIC8gc2hhcnBUZXh0dXJlU2l6ZTsKCi8vIFJlc3VsdGluZyBYIHBpeGVsLWNvb3JkaW5hdGUgb2YgdGhlIHBpeGVsIHdlJ3JlIGRyYXdpbmcuCgltb2RfZmFjdG9yID0gVGV4Q29vcmQueCAqIFRleHR1cmVTaXplLnggKiBPdXRwdXRTaXplLnggLyBJbnB1dFNpemUueDsKCn0KCiNlbGlmIGRlZmluZWQoRlJBR01FTlQpCgojaWYgX19WRVJTSU9OX18gPj0gMTMwCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgaW4KI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlCm91dCB2ZWM0IEZyYWdDb2xvcjsKI2Vsc2UKI2RlZmluZSBDT01QQVRfVkFSWUlORyB2YXJ5aW5nCiNkZWZpbmUgRnJhZ0NvbG9yIGdsX0ZyYWdDb2xvcgojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUyRAojZW5kaWYKCiNpZmRlZiBHTF9FUwojaWZkZWYgR0xfRlJBR01FTlRfUFJFQ0lTSU9OX0hJR0gKcHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwojZWxzZQpwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKI2VuZGlmCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTiBtZWRpdW1wCiNlbHNlCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTgojZW5kaWYKCnN0cnVjdCBvdXRwdXRfZHVtbXkgewogICAgdmVjNCBfY29sb3I7Cn07Cgp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lRGlyZWN0aW9uOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lQ291bnQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIE91dHB1dFNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIFRleHR1cmVTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBJbnB1dFNpemU7CnVuaWZvcm0gc2FtcGxlcjJEIFRleHR1cmU7CkNPTVBBVF9WQVJZSU5HIHZlYzQgVEVYMDsKCi8vIENvbW1lbnQgdGhlIG5leHQgbGluZSB0byBkaXNhYmxlIGludGVycG9sYXRpb24gaW4gbGluZWFyIGdhbW1hIChhbmQKLy8gZ2FpbiBzcGVlZCkuCgkjZGVmaW5lIExJTkVBUl9QUk9DRVNTSU5HCgovLyBFbmFibGUgc2NyZWVuIGN1cnZhdHVyZS4KLy8gICAgICAgICNkZWZpbmUgQ1VSVkFUVVJFCgovLyBFbmFibGUgM3ggb3ZlcnNhbXBsaW5nIG9mIHRoZSBiZWFtIHByb2ZpbGUKICAgICAgICAjZGVmaW5lIE9WRVJTQU1QTEUKCi8vIFVzZSB0aGUgb2xkZXIsIHB1cmVseSBnYXVzc2lhbiBiZWFtIHByb2ZpbGUKICAgICAgICAvLyNkZWZpbmUgVVNFR0FVU1NJQU4KCi8vIE1hY3Jvcy4KI2RlZmluZSBGSVgoYykgbWF4KGFicyhjKSwgMWUtNSk7CiNkZWZpbmUgUEkgMy4xNDE1OTI2NTM1ODkKCiNpZmRlZiBMSU5FQVJfUFJPQ0VTU0lORwojICAgICAgIGRlZmluZSBURVgyRChjKSBwb3coQ09NUEFUX1RFWFRVUkUoVGV4dHVyZSwgKGMpKSwgdmVjNChDUlRnYW1tYSkpCiNlbHNlCiMgICAgICAgZGVmaW5lIFRFWDJEKGMpIENPTVBBVF9URVhUVVJFKFRleHR1cmUsIChjKSkKI2VuZGlmCgpDT01QQVRfVkFSWUlORyB2ZWMyIG9uZTsKQ09NUEFUX1ZBUllJTkcgZmxvYXQgbW9kX2ZhY3RvcjsKQ09NUEFUX1ZBUllJTkcgdmVjMiBpbGZhYzsKQ09NUEFUX1ZBUllJTkcgdmVjMiBvdmVyc2NhbjsKQ09NUEFUX1ZBUllJTkcgdmVjMiBhc3BlY3Q7CkNPTVBBVF9WQVJZSU5HIHZlYzMgc3RyZXRjaDsKQ09NUEFUX1ZBUllJTkcgdmVjMiBzaW5hbmdsZTsKQ09NUEFUX1ZBUllJTkcgdmVjMiBjb3NhbmdsZTsKCiNpZmRlZiBQQVJBTUVURVJfVU5JRk9STQp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgQ1JUZ2FtbWE7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBtb25pdG9yZ2FtbWE7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBkOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgQ1VSVkFUVVJFOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgUjsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IGNvcm5lcnNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBjb3JuZXJzbW9vdGg7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCB4X3RpbHQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCB5X3RpbHQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBvdmVyc2Nhbl94Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgb3ZlcnNjYW5feTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IERPVE1BU0s7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBTSEFSUEVSOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgc2NhbmxpbmVfd2VpZ2h0Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgbHVtOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgaW50ZXJsYWNlX2RldGVjdDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IFNBVFVSQVRJT047CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBJTlY7CiNlbmRpZgoKZmxvYXQgaW50ZXJzZWN0KHZlYzIgeHkpCiAgICAgICAgewoJZmxvYXQgQSA9IGRvdCh4eSx4eSkrZCpkOwoJZmxvYXQgQiA9IDIuMCooUiooZG90KHh5LHNpbmFuZ2xlKS1kKmNvc2FuZ2xlLngqY29zYW5nbGUueSktZCpkKTsKCWZsb2F0IEMgPSBkKmQgKyAyLjAqUipkKmNvc2FuZ2xlLngqY29zYW5nbGUueTsKCXJldHVybiAoLUItc3FydChCKkItNC4wKkEqQykpLygyLjAqQSk7CiAgICAgICAgfQoKdmVjMiBia3d0cmFucyh2ZWMyIHh5KQogICAgICAgIHsKCWZsb2F0IGMgPSBpbnRlcnNlY3QoeHkpOwoJdmVjMiBwb2ludCA9IHZlYzIoYykqeHk7Cglwb2ludCAtPSB2ZWMyKC1SKSpzaW5hbmdsZTsKCXBvaW50IC89IHZlYzIoUik7Cgl2ZWMyIHRhbmcgPSBzaW5hbmdsZS9jb3NhbmdsZTsKCXZlYzIgcG9jID0gcG9pbnQvY29zYW5nbGU7CglmbG9hdCBBID0gZG90KHRhbmcsdGFuZykrMS4wOwoJZmxvYXQgQiA9IC0yLjAqZG90KHBvYyx0YW5nKTsKCWZsb2F0IEMgPSBkb3QocG9jLHBvYyktMS4wOwoJZmxvYXQgYSA9ICgtQitzcXJ0KEIqQi00LjAqQSpDKSkvKDIuMCpBKTsKCXZlYzIgdXYgPSAocG9pbnQtYSpzaW5hbmdsZSkvY29zYW5nbGU7CglmbG9hdCByID0gRklYKFIqYWNvcyhhKSk7CglyZXR1cm4gdXYqci9zaW4oci9SKTsKICAgICAgICB9Cgp2ZWMyIHRyYW5zZm9ybSh2ZWMyIGNvb3JkKQogICAgICAgIHsKCWNvb3JkICo9IFRleHR1cmVTaXplIC8gSW5wdXRTaXplOwoJY29vcmQgPSAoY29vcmQtdmVjMigwLjUpKSphc3BlY3Qqc3RyZXRjaC56K3N0cmV0Y2gueHk7CglyZXR1cm4gKGJrd3RyYW5zKGNvb3JkKS92ZWMyKG92ZXJzY2FuX3ggLyAxMDAuMCwgb3ZlcnNjYW5feSAvIDEwMC4wKS9hc3BlY3QrdmVjMigwLjUpKSAqIElucHV0U2l6ZSAvIFRleHR1cmVTaXplOwogICAgICAgIH0KCmZsb2F0IGNvcm5lcih2ZWMyIGNvb3JkKQogICAgICAgIHsKCWNvb3JkICo9IFRleHR1cmVTaXplIC8gSW5wdXRTaXplOwoJY29vcmQgPSAoY29vcmQgLSB2ZWMyKDAuNSkpICogdmVjMihvdmVyc2Nhbl94IC8gMTAwLjAsIG92ZXJzY2FuX3kgLyAxMDAuMCkgKyB2ZWMyKDAuNSk7Cgljb29yZCA9IG1pbihjb29yZCwgdmVjMigxLjApLWNvb3JkKSAqIGFzcGVjdDsKCXZlYzIgY2Rpc3QgPSB2ZWMyKGNvcm5lcnNpemUpOwoJY29vcmQgPSAoY2Rpc3QgLSBtaW4oY29vcmQsY2Rpc3QpKTsKCWZsb2F0IGRpc3QgPSBzcXJ0KGRvdChjb29yZCxjb29yZCkpOwoJcmV0dXJuIGNsYW1wKChjZGlzdC54LWRpc3QpKmNvcm5lcnNtb290aCwwLjAsIDEuMCkqMS4wMDAxOwogICAgICAgIH0KCi8vIENhbGN1bGF0ZSB0aGUgaW5mbHVlbmNlIG9mIGEgc2NhbmxpbmUgb24gdGhlIGN1cnJlbnQgcGl4ZWwuCi8vCi8vICdkaXN0YW5jZScgaXMgdGhlIGRpc3RhbmNlIGluIHRleHR1cmUgY29vcmRpbmF0ZXMgZnJvbSB0aGUgY3VycmVudAovLyBwaXhlbCB0byB0aGUgc2NhbmxpbmUgaW4gcXVlc3Rpb24uCi8vICdjb2xvcicgaXMgdGhlIGNvbG91ciBvZiB0aGUgc2NhbmxpbmUgYXQgdGhlIGhvcml6b250YWwgbG9jYXRpb24gb2YKLy8gdGhlIGN1cnJlbnQgcGl4ZWwuCnZlYzQgc2NhbmxpbmVXZWlnaHRzKGZsb2F0IGRpc3RhbmNlLCB2ZWM0IGNvbG9yKQogICAgICAgIHsKCS8vICJ3aWQiIGNvbnRyb2xzIHRoZSB3aWR0aCBvZiB0aGUgc2NhbmxpbmUgYmVhbSwgZm9yIGVhY2ggUkdCCgkvLyBjaGFubmVsIFRoZSAid2VpZ2h0cyIgbGluZXMgYmFzaWNhbGx5IHNwZWNpZnkgdGhlIGZvcm11bGEKCS8vIHRoYXQgZ2l2ZXMgeW91IHRoZSBwcm9maWxlIG9mIHRoZSBiZWFtLCBpLmUuIHRoZSBpbnRlbnNpdHkgYXMKCS8vIGEgZnVuY3Rpb24gb2YgZGlzdGFuY2UgZnJvbSB0aGUgdmVydGljYWwgY2VudGVyIG9mIHRoZQoJLy8gc2NhbmxpbmUuIEluIHRoaXMgY2FzZSwgaXQgaXMgZ2F1c3NpYW4gaWYgd2lkdGg9MiwgYW5kCgkvLyBiZWNvbWVzIG5vbmdhdXNzaWFuIGZvciBsYXJnZXIgd2lkdGhzLiBJZGVhbGx5IHRoaXMgc2hvdWxkCgkvLyBiZSBub3JtYWxpemVkIHNvIHRoYXQgdGhlIGludGVncmFsIGFjcm9zcyB0aGUgYmVhbSBpcwoJLy8gaW5kZXBlbmRlbnQgb2YgaXRzIHdpZHRoLiBUaGF0IGlzLCBmb3IgYSBuYXJyb3dlciBiZWFtCgkvLyAid2VpZ2h0cyIgc2hvdWxkIGhhdmUgYSBoaWdoZXIgcGVhayBhdCB0aGUgY2VudGVyIG9mIHRoZQoJLy8gc2NhbmxpbmUgdGhhbiBmb3IgYSB3aWRlciBiZWFtLgojaWZkZWYgVVNFR0FVU1NJQU4KCXZlYzQgd2lkID0gMC4zICsgMC4xICogcG93KGNvbG9yLCB2ZWM0KDMuMCkpOwoJdmVjNCB3ZWlnaHRzID0gdmVjNChkaXN0YW5jZSAvIHdpZCk7CglyZXR1cm4gKGx1bSArIDAuNCkgKiBleHAoLXdlaWdodHMgKiB3ZWlnaHRzKSAvIHdpZDsKI2Vsc2UKCXZlYzQgd2lkID0gMi4wICsgMi4wICogcG93KGNvbG9yLCB2ZWM0KDQuMCkpOwoJdmVjNCB3ZWlnaHRzID0gdmVjNChkaXN0YW5jZSAvIHNjYW5saW5lX3dlaWdodCk7CglyZXR1cm4gKGx1bSArIDEuNCkgKiBleHAoLXBvdyh3ZWlnaHRzICogaW52ZXJzZXNxcnQoMC41ICogd2lkKSwgd2lkKSkgLyAoMC42ICsgMC4yICogd2lkKTsKI2VuZGlmCiAgICAgICAgfQoKdmVjMyBzYXR1cmF0aW9uICh2ZWMzIHRleHR1cmVDb2xvcikKewogICAgZmxvYXQgbHVtPWxlbmd0aCh0ZXh0dXJlQ29sb3IpKjAuNTc3NTsKCiAgICB2ZWMzIGx1bWluYW5jZVdlaWdodGluZyA9IHZlYzMoMC4zLDAuNiwwLjEpOwogICAgaWYgKGx1bTwwLjUpIGx1bWluYW5jZVdlaWdodGluZy5yZ2I9KGx1bWluYW5jZVdlaWdodGluZy5yZ2IqbHVtaW5hbmNlV2VpZ2h0aW5nLnJnYikrKGx1bWluYW5jZVdlaWdodGluZy5yZ2IqbHVtaW5hbmNlV2VpZ2h0aW5nLnJnYik7CgogICAgZmxvYXQgbHVtaW5hbmNlID0gZG90KHRleHR1cmVDb2xvciwgbHVtaW5hbmNlV2VpZ2h0aW5nKTsKICAgIHZlYzMgZ3JleVNjYWxlQ29sb3IgPSB2ZWMzKGx1bWluYW5jZSk7CgogICAgdmVjMyByZXMgPSB2ZWMzKG1peChncmV5U2NhbGVDb2xvciwgdGV4dHVyZUNvbG9yLCBTQVRVUkFUSU9OKSk7CiAgICByZXR1cm4gcmVzOwp9CgojZGVmaW5lIHB3ciB2ZWMzKDEuMC8oKC0wLjcqKDEuMC1zY2FubGluZV93ZWlnaHQpKzEuMCkqKC0wLjUqRE9UTUFTSysxLjApKS0xLjI1KQoKCi8vIFJldHVybnMgZ2FtbWEgY29ycmVjdGVkIG91dHB1dCwgY29tcGVuc2F0ZWQgZm9yIHNjYW5saW5lK21hc2sgZW1iZWRkZWQgZ2FtbWEKdmVjMyBpbnZfZ2FtbWEodmVjMyBjb2wsIHZlYzMgcG93ZXIpCnsKICAgIHZlYzMgY2lyICA9IGNvbC0xLjA7CiAgICAgICAgIGNpciAqPSBjaXI7CiAgICAgICAgIGNvbCAgPSBtaXgoc3FydChjb2wpLHNxcnQoMS4wLWNpcikscG93ZXIpOwogICAgcmV0dXJuIGNvbDsKfQoKdm9pZCBtYWluKCkKewovLyBIZXJlJ3MgYSBoZWxwZnVsIGRpYWdyYW0gdG8ga2VlcCBpbiBtaW5kIHdoaWxlIHRyeWluZyB0bwovLyB1bmRlcnN0YW5kIHRoZSBjb2RlOgovLwovLyAgfCAgICAgIHwgICAgICB8ICAgICAgfCAgICAgIHwKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyAgfCAgICAgIHwgICAgICB8ICAgICAgfCAgICAgIHwKLy8gIHwgIDAxICB8ICAxMSAgfCAgMjEgIHwgIDMxICB8IDwtLSBjdXJyZW50IHNjYW5saW5lCi8vICB8ICAgICAgfCBAICAgIHwgICAgICB8ICAgICAgfAovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vICB8ICAgICAgfCAgICAgIHwgICAgICB8ICAgICAgfAovLyAgfCAgMDIgIHwgIDEyICB8ICAyMiAgfCAgMzIgIHwgPC0tIG5leHQgc2NhbmxpbmUKLy8gIHwgICAgICB8ICAgICAgfCAgICAgIHwgICAgICB8Ci8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gIHwgICAgICB8ICAgICAgfCAgICAgIHwgICAgICB8Ci8vCi8vIEVhY2ggY2hhcmFjdGVyLWNlbGwgcmVwcmVzZW50cyBhIHBpeGVsIG9uIHRoZSBvdXRwdXQKLy8gc3VyZmFjZSwgIkAiIHJlcHJlc2VudHMgdGhlIGN1cnJlbnQgcGl4ZWwgKGFsd2F5cyBzb21ld2hlcmUKLy8gaW4gdGhlIGJvdHRvbSBoYWxmIG9mIHRoZSBjdXJyZW50IHNjYW4tbGluZSwgb3IgdGhlIHRvcC1oYWxmCi8vIG9mIHRoZSBuZXh0IHNjYW5saW5lKS4gVGhlIGdyaWQgb2YgbGluZXMgcmVwcmVzZW50cyB0aGUKLy8gZWRnZXMgb2YgdGhlIHRleGVscyBvZiB0aGUgdW5kZXJseWluZyB0ZXh0dXJlLgoKLy8gVGV4dHVyZSBjb29yZGluYXRlcyBvZiB0aGUgdGV4ZWwgY29udGFpbmluZyB0aGUgYWN0aXZlIHBpeGVsLgoJdmVjMiB4eSA9IChDVVJWQVRVUkUgPiAwLjUpID8gdHJhbnNmb3JtKFRFWDAueHkpIDogVEVYMC54eTsKCglmbG9hdCBjdmFsID0gY29ybmVyKHh5KTsKCi8vIE9mIGFsbCB0aGUgcGl4ZWxzIHRoYXQgYXJlIG1hcHBlZCBvbnRvIHRoZSB0ZXhlbCB3ZSBhcmUKLy8gY3VycmVudGx5IHJlbmRlcmluZywgd2hpY2ggcGl4ZWwgYXJlIHdlIGN1cnJlbnRseSByZW5kZXJpbmc/Cgl2ZWMyIGlsdmVjID0gdmVjMigwLjAsaWxmYWMueSAqIGludGVybGFjZV9kZXRlY3QgPiAxLjUgPyBtb2QoZmxvYXQoRnJhbWVDb3VudCksMi4wKSA6IDAuMCk7Cgl2ZWMyIHJhdGlvX3NjYWxlID0gKHh5ICogVGV4dHVyZVNpemUgLSB2ZWMyKDAuNSkgKyBpbHZlYykvaWxmYWM7CiNpZmRlZiBPVkVSU0FNUExFCglmbG9hdCBmaWx0ZXJfID0gSW5wdXRTaXplLnkvT3V0cHV0U2l6ZS55Oy8vZndpZHRoKHJhdGlvX3NjYWxlLnkpOwojZW5kaWYKCXZlYzIgdXZfcmF0aW8gPSBmcmFjdChyYXRpb19zY2FsZSk7CgovLyBTbmFwIHRvIHRoZSBjZW50ZXIgb2YgdGhlIHVuZGVybHlpbmcgdGV4ZWwuCgl4eSA9IChmbG9vcihyYXRpb19zY2FsZSkqaWxmYWMgKyB2ZWMyKDAuNSkgLSBpbHZlYykgLyBUZXh0dXJlU2l6ZTsKCi8vIENhbGN1bGF0ZSBMYW5jem9zIHNjYWxpbmcgY29lZmZpY2llbnRzIGRlc2NyaWJpbmcgdGhlIGVmZmVjdAovLyBvZiB2YXJpb3VzIG5laWdoYm91ciB0ZXhlbHMgaW4gYSBzY2FubGluZSBvbiB0aGUgY3VycmVudAovLyBwaXhlbC4KCXZlYzQgY29lZmZzID0gUEkgKiB2ZWM0KDEuMCArIHV2X3JhdGlvLngsIHV2X3JhdGlvLngsIDEuMCAtIHV2X3JhdGlvLngsIDIuMCAtIHV2X3JhdGlvLngpOwoKLy8gUHJldmVudCBkaXZpc2lvbiBieSB6ZXJvLgoJY29lZmZzID0gRklYKGNvZWZmcyk7CgovLyBMYW5jem9zMiBrZXJuZWwuCgljb2VmZnMgPSAyLjAgKiBzaW4oY29lZmZzKSAqIHNpbihjb2VmZnMgLyAyLjApIC8gKGNvZWZmcyAqIGNvZWZmcyk7CgovLyBOb3JtYWxpemUuCgljb2VmZnMgLz0gZG90KGNvZWZmcywgdmVjNCgxLjApKTsKCi8vIENhbGN1bGF0ZSB0aGUgZWZmZWN0aXZlIGNvbG91ciBvZiB0aGUgY3VycmVudCBhbmQgbmV4dAovLyBzY2FubGluZXMgYXQgdGhlIGhvcml6b250YWwgbG9jYXRpb24gb2YgdGhlIGN1cnJlbnQgcGl4ZWwsCi8vIHVzaW5nIHRoZSBMYW5jem9zIGNvZWZmaWNpZW50cyBhYm92ZS4KCXZlYzQgY29sICA9IGNsYW1wKG1hdDQoCiAgICAgICAgICAgICAgICAgICAgICAgIFRFWDJEKHh5ICsgdmVjMigtb25lLngsIDAuMCkpLAogICAgICAgICAgICAgICAgICAgICAgICBURVgyRCh4eSksCiAgICAgICAgICAgICAgICAgICAgICAgIFRFWDJEKHh5ICsgdmVjMihvbmUueCwgMC4wKSksCiAgICAgICAgICAgICAgICAgICAgICAgIFRFWDJEKHh5ICsgdmVjMigyLjAgKiBvbmUueCwgMC4wKSkpICogY29lZmZzLAogICAgICAgICAgICAgICAgICAgICAgICAwLjAsIDEuMCk7CiAgICAgICAgdmVjNCBjb2wyID0gY2xhbXAobWF0NCgKICAgICAgICAgICAgICAgICAgICAgICAgVEVYMkQoeHkgKyB2ZWMyKC1vbmUueCwgb25lLnkpKSwKICAgICAgICAgICAgICAgICAgICAgICAgVEVYMkQoeHkgKyB2ZWMyKDAuMCwgb25lLnkpKSwKICAgICAgICAgICAgICAgICAgICAgICAgVEVYMkQoeHkgKyBvbmUpLAogICAgICAgICAgICAgICAgICAgICAgICBURVgyRCh4eSArIHZlYzIoMi4wICogb25lLngsIG9uZS55KSkpICogY29lZmZzLAogICAgICAgICAgICAgICAgICAgICAgICAwLjAsIDEuMCk7CgojaWZuZGVmIExJTkVBUl9QUk9DRVNTSU5HCgljb2wgID0gcG93KGNvbCAsIHZlYzQoQ1JUZ2FtbWEpKTsKCWNvbDIgPSBwb3coY29sMiwgdmVjNChDUlRnYW1tYSkpOwojZW5kaWYKCi8vIENhbGN1bGF0ZSB0aGUgaW5mbHVlbmNlIG9mIHRoZSBjdXJyZW50IGFuZCBuZXh0IHNjYW5saW5lcyBvbgovLyB0aGUgY3VycmVudCBwaXhlbC4KCXZlYzQgd2VpZ2h0cyAgPSBzY2FubGluZVdlaWdodHModXZfcmF0aW8ueSwgY29sKTsKCXZlYzQgd2VpZ2h0czIgPSBzY2FubGluZVdlaWdodHMoMS4wIC0gdXZfcmF0aW8ueSwgY29sMik7CiNpZmRlZiBPVkVSU0FNUExFCgl1dl9yYXRpby55ID11dl9yYXRpby55KzEuMC8zLjAqZmlsdGVyXzsKCXdlaWdodHMgPSAod2VpZ2h0cytzY2FubGluZVdlaWdodHModXZfcmF0aW8ueSwgY29sKSkvMy4wOwoJd2VpZ2h0czI9KHdlaWdodHMyK3NjYW5saW5lV2VpZ2h0cyhhYnMoMS4wLXV2X3JhdGlvLnkpLCBjb2wyKSkvMy4wOwoJdXZfcmF0aW8ueSA9dXZfcmF0aW8ueS0yLjAvMy4wKmZpbHRlcl87Cgl3ZWlnaHRzPXdlaWdodHMrc2NhbmxpbmVXZWlnaHRzKGFicyh1dl9yYXRpby55KSwgY29sKS8zLjA7Cgl3ZWlnaHRzMj13ZWlnaHRzMitzY2FubGluZVdlaWdodHMoYWJzKDEuMC11dl9yYXRpby55KSwgY29sMikvMy4wOwojZW5kaWYKCgl2ZWMzIG11bF9yZXMgID0gKGNvbCAqIHdlaWdodHMgKyBjb2wyICogd2VpZ2h0czIpLnJnYiAqIHZlYzMoY3ZhbCk7CgovLyBkb3QtbWFzayBlbXVsYXRpb246Ci8vIE91dHB1dCBwaXhlbHMgYXJlIGFsdGVybmF0ZWx5IHRpbnRlZCBncmVlbiBhbmQgbWFnZW50YS4KdmVjMyBkb3RNYXNrV2VpZ2h0cyA9IG1peCgKCXZlYzMoMS4wLCAxLjAgLSBET1RNQVNLLCAxLjApLAoJdmVjMygxLjAgLSBET1RNQVNLLCAxLjAsIDEuMCAtIERPVE1BU0spLAoJZmxvb3IobW9kKG1vZF9mYWN0b3IsIDIuMCkpCiAgICAgICAgKTsKCgltdWxfcmVzICo9IGRvdE1hc2tXZWlnaHRzOwoKLy8gQ29udmVydCB0aGUgaW1hZ2UgZ2FtbWEgZm9yIGRpc3BsYXkgb24gb3VyIG91dHB1dCBkZXZpY2UuCmlmIChJTlYgPT0gMS4wKXsgbXVsX3JlcyA9IGludl9nYW1tYShtdWxfcmVzLHB3cik7fSAKCWVsc2UgbXVsX3JlcyA9IHBvdyhtdWxfcmVzLCB2ZWMzKDEuMC9tb25pdG9yZ2FtbWEpKTsKICAgICAgICAKICAgICAgICBtdWxfcmVzID0gc2F0dXJhdGlvbihtdWxfcmVzKTsKCgoKLy8gQ29sb3IgdGhlIHRleGVsLgogICAgb3V0cHV0X2R1bW15IF9PVVQ7CiAgICBfT1VULl9jb2xvciA9IHZlYzQobXVsX3JlcywgMS4wKTsKICAgIEZyYWdDb2xvciA9IF9PVVQuX2NvbG9yOwogICAgcmV0dXJuOwp9IAojZW5kaWYK"}]},"crt-mattias.glslp":{shader:{type:"text",value:"shaders = 1\n\nshader0 = crt-mattias.glsl\nfilter_linear0 = false"},resources:[{name:"crt-mattias.glsl",type:"base64",value:"Ly8gQ1JUIEVtdWxhdGlvbgovLyBieSBNYXR0aWFzCi8vIGh0dHBzOi8vd3d3LnNoYWRlcnRveS5jb20vdmlldy9sc0IzRFYKCiNwcmFnbWEgcGFyYW1ldGVyIENVUlZBVFVSRSAiQ3VydmF0dXJlIiAwLjUgMC4wIDEuMCAwLjA1CiNwcmFnbWEgcGFyYW1ldGVyIFNDQU5TUEVFRCAiU2NhbmxpbmUgQ3Jhd2wgU3BlZWQiIDEuMCAwLjAgMTAuMCAwLjUKCiNpZiBkZWZpbmVkKFZFUlRFWCkKCiNpZiBfX1ZFUlNJT05fXyA+PSAxMzAKI2RlZmluZSBDT01QQVRfVkFSWUlORyBvdXQKI2RlZmluZSBDT01QQVRfQVRUUklCVVRFIGluCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZQojZWxzZQojZGVmaW5lIENPTVBBVF9WQVJZSU5HIHZhcnlpbmcgCiNkZWZpbmUgQ09NUEFUX0FUVFJJQlVURSBhdHRyaWJ1dGUgCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZTJECiNlbmRpZgoKI2lmZGVmIEdMX0VTCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTiBtZWRpdW1wCiNlbHNlCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTgojZW5kaWYKCkNPTVBBVF9BVFRSSUJVVEUgdmVjNCBWZXJ0ZXhDb29yZDsKQ09NUEFUX0FUVFJJQlVURSB2ZWM0IENPTE9SOwpDT01QQVRfQVRUUklCVVRFIHZlYzQgVGV4Q29vcmQ7CkNPTVBBVF9WQVJZSU5HIHZlYzQgQ09MMDsKQ09NUEFUX1ZBUllJTkcgdmVjNCBURVgwOwovLyBvdXQgdmFyaWFibGVzIGdvIGhlcmUgYXMgQ09NUEFUX1ZBUllJTkcgd2hhdGV2ZXIKCnZlYzQgX29Qb3NpdGlvbjE7IAp1bmlmb3JtIG1hdDQgTVZQTWF0cml4Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lRGlyZWN0aW9uOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lQ291bnQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIE91dHB1dFNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIFRleHR1cmVTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBJbnB1dFNpemU7CgovLyBjb21wYXRpYmlsaXR5ICNkZWZpbmVzCiNkZWZpbmUgdlRleENvb3JkIFRFWDAueHkKI2RlZmluZSBTb3VyY2VTaXplIHZlYzQoVGV4dHVyZVNpemUsIDEuMCAvIFRleHR1cmVTaXplKSAvL2VpdGhlciBUZXh0dXJlU2l6ZSBvciBJbnB1dFNpemUKI2RlZmluZSBPdXRTaXplIHZlYzQoT3V0cHV0U2l6ZSwgMS4wIC8gT3V0cHV0U2l6ZSkKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gTVZQTWF0cml4ICogVmVydGV4Q29vcmQ7CiAgICBURVgwLnh5ID0gVGV4Q29vcmQueHk7Cn0KCiNlbGlmIGRlZmluZWQoRlJBR01FTlQpCgojaWZkZWYgR0xfRVMKI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdICnByZWNpc2lvbiBoaWdocCBmbG9hdDsKI2Vsc2UKcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CiNlbmRpZgojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04gbWVkaXVtcAojZWxzZQojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04KI2VuZGlmCgojaWYgX19WRVJTSU9OX18gPj0gMTMwCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgaW4KI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlCm91dCBDT01QQVRfUFJFQ0lTSU9OIHZlYzQgRnJhZ0NvbG9yOwojZWxzZQojZGVmaW5lIENPTVBBVF9WQVJZSU5HIHZhcnlpbmcKI2RlZmluZSBGcmFnQ29sb3IgZ2xfRnJhZ0NvbG9yCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZTJECiNlbmRpZgoKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZURpcmVjdGlvbjsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZUNvdW50Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBPdXRwdXRTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBUZXh0dXJlU2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgSW5wdXRTaXplOwp1bmlmb3JtIHNhbXBsZXIyRCBUZXh0dXJlOwpDT01QQVRfVkFSWUlORyB2ZWM0IFRFWDA7CgovLyBjb21wYXRpYmlsaXR5ICNkZWZpbmVzCiNkZWZpbmUgU291cmNlIFRleHR1cmUKI2RlZmluZSB2VGV4Q29vcmQgVEVYMC54eQoKI2RlZmluZSBTb3VyY2VTaXplIHZlYzQoVGV4dHVyZVNpemUsIDEuMCAvIFRleHR1cmVTaXplKSAvL2VpdGhlciBUZXh0dXJlU2l6ZSBvciBJbnB1dFNpemUKI2RlZmluZSBPdXRTaXplIHZlYzQoT3V0cHV0U2l6ZSwgMS4wIC8gT3V0cHV0U2l6ZSkKCiNpZmRlZiBQQVJBTUVURVJfVU5JRk9STQp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgQ1VSVkFUVVJFLCBTQ0FOU1BFRUQ7CiNlbHNlCiNkZWZpbmUgQ1VSVkFUVVJFIDAuNQojZGVmaW5lIFNDQU5TUEVFRCAxLjAKI2VuZGlmCgojZGVmaW5lIGlDaGFubmVsMCBUZXh0dXJlCiNkZWZpbmUgaVRpbWUgKGZsb2F0KEZyYW1lQ291bnQpIC8gNjAuMCkKI2RlZmluZSBpUmVzb2x1dGlvbiBPdXRwdXRTaXplLnh5CiNkZWZpbmUgZnJhZ0Nvb3JkIGdsX0ZyYWdDb29yZC54eQoKdmVjMyBzYW1wbGVfKCBzYW1wbGVyMkQgdGV4LCB2ZWMyIHRjICkKewoJdmVjMyBzID0gcG93KENPTVBBVF9URVhUVVJFKHRleCx0YykucmdiLCB2ZWMzKDIuMikpOwoJcmV0dXJuIHM7Cn0KCnZlYzMgYmx1cihzYW1wbGVyMkQgdGV4LCB2ZWMyIHRjLCBmbG9hdCBvZmZzKQp7Cgl2ZWM0IHhvZmZzID0gb2ZmcyAqIHZlYzQoLTIuMCwgLTEuMCwgMS4wLCAyLjApIC8gKGlSZXNvbHV0aW9uLnggKiBUZXh0dXJlU2l6ZS54IC8gSW5wdXRTaXplLngpOwoJdmVjNCB5b2ZmcyA9IG9mZnMgKiB2ZWM0KC0yLjAsIC0xLjAsIDEuMCwgMi4wKSAvIChpUmVzb2x1dGlvbi55ICogVGV4dHVyZVNpemUueSAvIElucHV0U2l6ZS55KTsKICAgdGMgPSB0YyAqIElucHV0U2l6ZSAvIFRleHR1cmVTaXplOwoJCgl2ZWMzIGNvbG9yID0gdmVjMygwLjAsIDAuMCwgMC4wKTsKCWNvbG9yICs9IHNhbXBsZV8odGV4LHRjICsgdmVjMih4b2Zmcy54LCB5b2Zmcy54KSkgKiAwLjAwMzY2OwoJY29sb3IgKz0gc2FtcGxlXyh0ZXgsdGMgKyB2ZWMyKHhvZmZzLnksIHlvZmZzLngpKSAqIDAuMDE0NjU7Cgljb2xvciArPSBzYW1wbGVfKHRleCx0YyArIHZlYzIoICAgIDAuMCwgeW9mZnMueCkpICogMC4wMjU2NDsKCWNvbG9yICs9IHNhbXBsZV8odGV4LHRjICsgdmVjMih4b2Zmcy56LCB5b2Zmcy54KSkgKiAwLjAxNDY1OwoJY29sb3IgKz0gc2FtcGxlXyh0ZXgsdGMgKyB2ZWMyKHhvZmZzLncsIHlvZmZzLngpKSAqIDAuMDAzNjY7CgkKCWNvbG9yICs9IHNhbXBsZV8odGV4LHRjICsgdmVjMih4b2Zmcy54LCB5b2Zmcy55KSkgKiAwLjAxNDY1OwoJY29sb3IgKz0gc2FtcGxlXyh0ZXgsdGMgKyB2ZWMyKHhvZmZzLnksIHlvZmZzLnkpKSAqIDAuMDU4NjE7Cgljb2xvciArPSBzYW1wbGVfKHRleCx0YyArIHZlYzIoICAgIDAuMCwgeW9mZnMueSkpICogMC4wOTUyNDsKCWNvbG9yICs9IHNhbXBsZV8odGV4LHRjICsgdmVjMih4b2Zmcy56LCB5b2Zmcy55KSkgKiAwLjA1ODYxOwoJY29sb3IgKz0gc2FtcGxlXyh0ZXgsdGMgKyB2ZWMyKHhvZmZzLncsIHlvZmZzLnkpKSAqIDAuMDE0NjU7CgkKCWNvbG9yICs9IHNhbXBsZV8odGV4LHRjICsgdmVjMih4b2Zmcy54LCAwLjApKSAqIDAuMDI1NjQ7Cgljb2xvciArPSBzYW1wbGVfKHRleCx0YyArIHZlYzIoeG9mZnMueSwgMC4wKSkgKiAwLjA5NTI0OwoJY29sb3IgKz0gc2FtcGxlXyh0ZXgsdGMgKyB2ZWMyKCAgICAwLjAsIDAuMCkpICogMC4xNTAxODsKCWNvbG9yICs9IHNhbXBsZV8odGV4LHRjICsgdmVjMih4b2Zmcy56LCAwLjApKSAqIDAuMDk1MjQ7Cgljb2xvciArPSBzYW1wbGVfKHRleCx0YyArIHZlYzIoeG9mZnMudywgMC4wKSkgKiAwLjAyNTY0OwoJCgljb2xvciArPSBzYW1wbGVfKHRleCx0YyArIHZlYzIoeG9mZnMueCwgeW9mZnMueikpICogMC4wMTQ2NTsKCWNvbG9yICs9IHNhbXBsZV8odGV4LHRjICsgdmVjMih4b2Zmcy55LCB5b2Zmcy56KSkgKiAwLjA1ODYxOwoJY29sb3IgKz0gc2FtcGxlXyh0ZXgsdGMgKyB2ZWMyKCAgICAwLjAsIHlvZmZzLnopKSAqIDAuMDk1MjQ7Cgljb2xvciArPSBzYW1wbGVfKHRleCx0YyArIHZlYzIoeG9mZnMueiwgeW9mZnMueikpICogMC4wNTg2MTsKCWNvbG9yICs9IHNhbXBsZV8odGV4LHRjICsgdmVjMih4b2Zmcy53LCB5b2Zmcy56KSkgKiAwLjAxNDY1OwoJCgljb2xvciArPSBzYW1wbGVfKHRleCx0YyArIHZlYzIoeG9mZnMueCwgeW9mZnMudykpICogMC4wMDM2NjsKCWNvbG9yICs9IHNhbXBsZV8odGV4LHRjICsgdmVjMih4b2Zmcy55LCB5b2Zmcy53KSkgKiAwLjAxNDY1OwoJY29sb3IgKz0gc2FtcGxlXyh0ZXgsdGMgKyB2ZWMyKCAgICAwLjAsIHlvZmZzLncpKSAqIDAuMDI1NjQ7Cgljb2xvciArPSBzYW1wbGVfKHRleCx0YyArIHZlYzIoeG9mZnMueiwgeW9mZnMudykpICogMC4wMTQ2NTsKCWNvbG9yICs9IHNhbXBsZV8odGV4LHRjICsgdmVjMih4b2Zmcy53LCB5b2Zmcy53KSkgKiAwLjAwMzY2OwoKCXJldHVybiBjb2xvcjsKfQoKLy9DYW5vbmljYWwgbm9pc2UgZnVuY3Rpb247IHJlcGxhY2VkIHRvIHByZXZlbnQgcHJlY2lzaW9uIGVycm9ycwovL2Zsb2F0IHJhbmQodmVjMiBjbyl7Ci8vICAgIHJldHVybiBmcmFjdChzaW4oZG90KGNvLnh5ICx2ZWMyKDEyLjk4OTgsNzguMjMzKSkpICogNDM3NTguNTQ1Myk7Ci8vfQoKZmxvYXQgcmFuZCh2ZWMyIGNvKQp7CiAgICBmbG9hdCBhID0gMTIuOTg5ODsKICAgIGZsb2F0IGIgPSA3OC4yMzM7CiAgICBmbG9hdCBjID0gNDM3NTguNTQ1MzsKICAgIGZsb2F0IGR0PSBkb3QoY28ueHkgLHZlYzIoYSxiKSk7CiAgICBmbG9hdCBzbj0gbW9kKGR0LDMuMTQpOwogICAgcmV0dXJuIGZyYWN0KHNpbihzbikgKiBjKTsKfQoKdmVjMiBjdXJ2ZSh2ZWMyIHV2KQp7Cgl1diA9ICh1diAtIDAuNSkgKiAyLjA7Cgl1diAqPSAxLjE7CQoJdXYueCAqPSAxLjAgKyBwb3coKGFicyh1di55KSAvIDUuMCksIDIuMCk7Cgl1di55ICo9IDEuMCArIHBvdygoYWJzKHV2LngpIC8gNC4wKSwgMi4wKTsKCXV2ICA9ICh1diAvIDIuMCkgKyAwLjU7Cgl1diA9ICB1diAqMC45MiArIDAuMDQ7CglyZXR1cm4gdXY7Cn0KCnZvaWQgbWFpbigpCnsKICAgIHZlYzIgcSA9ICh2VGV4Q29vcmQueHkgKiBUZXh0dXJlU2l6ZS54eSAvIElucHV0U2l6ZS54eSk7Ly9mcmFnQ29vcmQueHkgLyBpUmVzb2x1dGlvbi54eTsKICAgIHZlYzIgdXYgPSBxOwogICAgdXYgPSBtaXgoIHV2LCBjdXJ2ZSggdXYgKSwgQ1VSVkFUVVJFICkgKiBJbnB1dFNpemUueHkgLyBUZXh0dXJlU2l6ZS54eTsKICAgIHZlYzMgY29sOwoJZmxvYXQgeCA9ICBzaW4oMC4xKmlUaW1lK3V2LnkqMjEuMCkqc2luKDAuMjMqaVRpbWUrdXYueSoyOS4wKSpzaW4oMC4zKzAuMTEqaVRpbWUrdXYueSozMS4wKSowLjAwMTc7CglmbG9hdCBvID0yLjAqbW9kKGZyYWdDb29yZC55LDIuMCkvaVJlc29sdXRpb24ueDsKCXgrPW87CiAgIHV2ID0gdXYgKiBUZXh0dXJlU2l6ZSAvIElucHV0U2l6ZTsKICAgIGNvbC5yID0gMS4wKmJsdXIoaUNoYW5uZWwwLHZlYzIodXYueCswLjAwMDksdXYueSswLjAwMDkpLDEuMikueCswLjAwNTsKICAgIGNvbC5nID0gMS4wKmJsdXIoaUNoYW5uZWwwLHZlYzIodXYueCswLjAwMCx1di55LTAuMDAxNSksMS4yKS55KzAuMDA1OwogICAgY29sLmIgPSAxLjAqYmx1cihpQ2hhbm5lbDAsdmVjMih1di54LTAuMDAxNSx1di55KzAuMDAwKSwxLjIpLnorMC4wMDU7CiAgICBjb2wuciArPSAwLjIqYmx1cihpQ2hhbm5lbDAsdmVjMih1di54KzAuMDAwOSx1di55KzAuMDAwOSksMi4yNSkueC0wLjAwNTsKICAgIGNvbC5nICs9IDAuMipibHVyKGlDaGFubmVsMCx2ZWMyKHV2LngrMC4wMDAsdXYueS0wLjAwMTUpLDEuNzUpLnktMC4wMDU7CiAgICBjb2wuYiArPSAwLjIqYmx1cihpQ2hhbm5lbDAsdmVjMih1di54LTAuMDAxNSx1di55KzAuMDAwKSwxLjI1KS56LTAuMDA1OwogICAgZmxvYXQgZ2hzID0gMC4wNTsKCWNvbC5yICs9IGdocyooMS4wLTAuMjk5KSpibHVyKGlDaGFubmVsMCwwLjc1KnZlYzIoMC4wMSwgLTAuMDI3KSt2ZWMyKHV2LngrMC4wMDEsdXYueSswLjAwMSksNy4wKS54OwogICAgY29sLmcgKz0gZ2hzKigxLjAtMC41ODcpKmJsdXIoaUNoYW5uZWwwLDAuNzUqdmVjMigtMC4wMjIsIC0wLjAyKSt2ZWMyKHV2LngrMC4wMDAsdXYueS0wLjAwMiksNS4wKS55OwogICAgY29sLmIgKz0gZ2hzKigxLjAtMC4xMTQpKmJsdXIoaUNoYW5uZWwwLDAuNzUqdmVjMigtMC4wMiwgLTAuMCkrdmVjMih1di54LTAuMDAyLHV2LnkrMC4wMDApLDMuMCkuejsKICAgIAogICAgCgogICAgY29sID0gY2xhbXAoY29sKjAuNCswLjYqY29sKmNvbCoxLjAsMC4wLDEuMCk7CiAgICBmbG9hdCB2aWcgPSAoMC4wICsgMS4wKjE2LjAqdXYueCp1di55KigxLjAtdXYueCkqKDEuMC11di55KSk7Cgl2aWcgPSBwb3codmlnLDAuMyk7Cgljb2wgKj0gdmVjMyh2aWcpOwoKICAgIGNvbCAqPSB2ZWMzKDAuOTUsMS4wNSwwLjk1KTsKCWNvbCA9IG1peCggY29sLCBjb2wgKiBjb2wsIDAuMykgKiAzLjg7CgoJZmxvYXQgc2NhbnMgPSBjbGFtcCggMC4zNSswLjE1KnNpbigzLjUqKGlUaW1lICogU0NBTlNQRUVEKSt1di55KmlSZXNvbHV0aW9uLnkqMS41KSwgMC4wLCAxLjApOwoJCglmbG9hdCBzID0gcG93KHNjYW5zLDAuOSk7Cgljb2wgPSBjb2wqdmVjMyggcykgOwoKICAgIGNvbCAqPSAxLjArMC4wMDE1KnNpbigzMDAuMCppVGltZSk7CgkKCWNvbCo9MS4wLTAuMTUqdmVjMyhjbGFtcCgobW9kKGZyYWdDb29yZC54K28sIDIuMCktMS4wKSoyLjAsMC4wLDEuMCkpOwoJY29sICo9IHZlYzMoIDEuMCApIC0gMC4yNSp2ZWMzKCByYW5kKCB1diswLjAwMDEqaVRpbWUpLCAgcmFuZCggdXYrMC4wMDAxKmlUaW1lICsgMC4zICksICByYW5kKCB1diswLjAwMDEqaVRpbWUrIDAuNSApICApOwoJY29sID0gcG93KGNvbCwgdmVjMygwLjQ1KSk7CgoJaWYgKHV2LnggPCAwLjAgfHwgdXYueCA+IDEuMCkKCQljb2wgKj0gMC4wOwoJaWYgKHV2LnkgPCAwLjAgfHwgdXYueSA+IDEuMCkKCQljb2wgKj0gMC4wOwoJCgogICAgZmxvYXQgY29tcCA9IHNtb290aHN0ZXAoIDAuMSwgMC45LCBzaW4oaVRpbWUpICk7CgogICAgRnJhZ0NvbG9yID0gdmVjNChjb2wsMS4wKTsKfSAKI2VuZGlmCg=="}]},"crt-beam":{shader:{type:"text",value:'shaders = "1"\nfeedback_pass = "0"\nshader0 = "CRT-Beam.glsl"\nfilter_linear0 = "true"\nwrap_mode0 = "clamp_to_border"\nmipmap_input0 = "false"\nalias0 = ""\nfloat_framebuffer0 = "false"\nsrgb_framebuffer0 = "false"\n\n'},resources:[{name:"CRT-Beam.glsl",type:"base64",value:"LyoKCWNydC1iZWFtCglmb3IgYmVzdCByZXN1bHRzIHVzZSBpbnRlZ2VyIHNjYWxlIDV4IG9yIG1vcmUKKi8KCiNwcmFnbWEgcGFyYW1ldGVyIGJsdXIgIkhvcml6b250YWwgQmx1ci9CZWFtIHNoYXBlIiAwLjYgMC4wIDEuMCAwLjEKI3ByYWdtYSBwYXJhbWV0ZXIgU2NhbmxpbmUgIlNjYW5saW5lIHRoaWNrbmVzcyIgMC4yIDAuMCAxLjAgMC4wNQojcHJhZ21hIHBhcmFtZXRlciB3ZWlnaHRyICJTY2FubGluZSBSZWQgYnJpZ2h0bmVzcyIgMC44IDAuMCAxLjAgMC4wNQojcHJhZ21hIHBhcmFtZXRlciB3ZWlnaHRnICJTY2FubGluZSBHcmVlbiBicmlnaHRuZXNzIiAwLjggMC4wIDEuMCAwLjA1CiNwcmFnbWEgcGFyYW1ldGVyIHdlaWdodGIgIlNjYW5saW5lIEJsdWUgYnJpZ2h0bmVzcyIgMC44IDAuMCAxLjAgMC4wNQojcHJhZ21hIHBhcmFtZXRlciBib2d1c19tc2sgIiBbIE1BU0tTIF0gIiAwLjAgMC4wIDAuMCAwLjAKI3ByYWdtYSBwYXJhbWV0ZXIgbWFzayAiTWFzayAwOkNHV0csMS0yOkxvdHRlcywzLTQgR3JheSw1LTY6Q0dXRyBzbG90LDcgVkdBIiAzLjAgLTEuMCA3LjAgMS4wCiNwcmFnbWEgcGFyYW1ldGVyIG1za19zaXplICJNYXNrIHNpemUiIDEuMCAxLjAgMi4wIDEuMAojcHJhZ21hIHBhcmFtZXRlciBzY2FsZSAiVkdBIE1hc2sgVmVydGljYWwgU2NhbGUiIDIuMCAyLjAwIDEwLjAwIDEuMAojcHJhZ21hIHBhcmFtZXRlciBNYXNrRGFyayAiTG90dGVzIE1hc2sgRGFyayIgMC43IDAuMDAgMi4wMCAwLjEwCiNwcmFnbWEgcGFyYW1ldGVyIE1hc2tMaWdodCAiTG90dGVzIE1hc2sgTGlnaHQiIDEuMCAwLjAwIDIuMDAgMC4xMAojcHJhZ21hIHBhcmFtZXRlciBib2d1c19jb2wgIiBbIENPTE9SIF0gIiAwLjAgMC4wIDAuMCAwLjAKI3ByYWdtYSBwYXJhbWV0ZXIgc2F0ICJTYXR1cmF0aW9uIiAxLjAgMC4wMCAyLjAwIDAuMDUKI3ByYWdtYSBwYXJhbWV0ZXIgYnJpZ2h0ICJCb29zdCBicmlnaHQiIDEuMCAxLjAwIDIuMDAgMC4wNQojcHJhZ21hIHBhcmFtZXRlciBkYXJrICJCb29zdCBkYXJrIiAxLjQ1IDEuMDAgMi4wMCAwLjA1CiNwcmFnbWEgcGFyYW1ldGVyIGdsb3cgIkdsb3cgU3RyZW5ndGgiIDAuMDggMC4wIDAuNSAwLjAxCgoKI2RlZmluZSBwaSAzLjE0MTU5CgojaWZkZWYgR0xfRVMKI2RlZmluZSBDT01QQVRfUFJFQ0lTSU9OIG1lZGl1bXAKcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CiNlbHNlCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTgojZW5kaWYKCgp1bmlmb3JtIHZlYzIgVGV4dHVyZVNpemU7CnZhcnlpbmcgdmVjMiBURVgwOwp2YXJ5aW5nIHZlYzIgZnJhZ3BvczsKCiNpZiBkZWZpbmVkKFZFUlRFWCkKdW5pZm9ybSBtYXQ0IE1WUE1hdHJpeDsKYXR0cmlidXRlIHZlYzQgVmVydGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIFRleENvb3JkOwp1bmlmb3JtIHZlYzIgSW5wdXRTaXplOwp1bmlmb3JtIHZlYzIgT3V0cHV0U2l6ZTsKCnZvaWQgbWFpbigpCnsKCVRFWDAgPSBUZXhDb29yZCoxLjAwMDE7ICAgICAgICAgICAgICAgICAgICAKCWdsX1Bvc2l0aW9uID0gTVZQTWF0cml4ICogVmVydGV4Q29vcmQ7ICAKCWZyYWdwb3MgPSBURVgwLnh5Kk91dHB1dFNpemUueHkqVGV4dHVyZVNpemUueHkvSW5wdXRTaXplLnh5OyAgIAp9CgojZWxpZiBkZWZpbmVkKEZSQUdNRU5UKQoKdW5pZm9ybSBzYW1wbGVyMkQgVGV4dHVyZTsKdW5pZm9ybSB2ZWMyIE91dHB1dFNpemU7CnVuaWZvcm0gdmVjMiBJbnB1dFNpemU7CgojZGVmaW5lIHZUZXhDb29yZCBURVgwLnh5CiNkZWZpbmUgU291cmNlU2l6ZSB2ZWM0KFRleHR1cmVTaXplLCAxLjAgLyBUZXh0dXJlU2l6ZSkgLy9laXRoZXIgVGV4dHVyZVNpemUgb3IgSW5wdXRTaXplCiNkZWZpbmUgb3V0U2l6ZSB2ZWM0KE91dHB1dFNpemUueHksIDEuMC9PdXRwdXRTaXplLnh5LzQuMCkKI2RlZmluZSBGcmFnQ29sb3IgZ2xfRnJhZ0NvbG9yCiNkZWZpbmUgU291cmNlIFRleHR1cmUKCgojaWZkZWYgUEFSQU1FVEVSX1VOSUZPUk0KCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBibHVyOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgU2NhbmxpbmU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCB3ZWlnaHRyOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgd2VpZ2h0ZzsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IHdlaWdodGI7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBtYXNrOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgc2NhbGU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBtc2tfc2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IE1hc2tEYXJrOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgTWFza0xpZ2h0Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgYnJpZ2h0Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgZGFyazsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IHNhdDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IGdsb3c7CgojZWxzZQoKI2RlZmluZSBibHVyIDAuNgojZGVmaW5lIFNjYW5saW5lIDAuMgojZGVmaW5lIHdlaWdodHIgIDAuMgojZGVmaW5lIHdlaWdodGcgIDAuNgojZGVmaW5lIHdlaWdodGIgIDAuMQojZGVmaW5lIG1hc2sgICAgICA3LjAgICAKI2RlZmluZSBtc2tfc2l6ZSAgMS4wCiNkZWZpbmUgc2NhbGUgICAyLjAKI2RlZmluZSBNYXNrRGFyayAgMC41CiNkZWZpbmUgTWFza0xpZ2h0ICAxLjUKI2RlZmluZSBicmlnaHQgIDEuNQojZGVmaW5lIGRhcmsgIDEuMjUKI2RlZmluZSBnbG93ICAgICAgMC4wNSAgIAojZGVmaW5lIHNhdCAgICAgICAxLjAKCiNlbmRpZgoKdmVjNCBNYXNrICh2ZWMyIHApCnsJCQoJCXAgPSBmbG9vcihwL21za19zaXplKTsKCQlmbG9hdCBtZj1mcmFjdChwLngqMC41KTsKCQlmbG9hdCBtPU1hc2tEYXJrOwoJCXZlYzMgTWFzayA9IHZlYzMgKE1hc2tEYXJrKTsKCi8vIFBob3NwaG9yLgoJaWYgKG1hc2s9PTAuMCkKCXsKCQlpZiAobWYgPCAwLjUpIHJldHVybiB2ZWM0IChNYXNrTGlnaHQsbSxNYXNrTGlnaHQsMS4wKTsgCgkJZWxzZSByZXR1cm4gdmVjNCAobSxNYXNrTGlnaHQsbSwxLjApOwoJfQoKLy8gVmVyeSBjb21wcmVzc2VkIFRWIHN0eWxlIHNoYWRvdyBtYXNrLgoJZWxzZSBpZiAobWFzayA9PSAxLjApCgl7CgkJZmxvYXQgbGluZSA9IE1hc2tMaWdodDsKCQlmbG9hdCBvZGQgID0gMC4wOwoKCQlpZiAoZnJhY3QocC54LzYuMCkgPCAwLjUpCgkJCW9kZCA9IDEuMDsKCQlpZiAoZnJhY3QoKHAueSArIG9kZCkvMi4wKSA8IDAuNSkKCQkJbGluZSA9IE1hc2tEYXJrOwoKCQlwLnggPSBmcmFjdChwLngvMy4wKTsKICAgIAoJCWlmICAgICAgKHAueCA8IDAuMzMzKSBNYXNrLnIgPSBNYXNrTGlnaHQ7CgkJZWxzZSBpZiAocC54IDwgMC42NjYpIE1hc2suZyA9IE1hc2tMaWdodDsKCQllbHNlICAgICAgICAgICAgICAgICAgTWFzay5iID0gTWFza0xpZ2h0OwoJCQoJCU1hc2sqPWxpbmU7CgkJcmV0dXJuIHZlYzQgKE1hc2suciwgTWFzay5nLCBNYXNrLmIsMS4wKTsgIAoJfSAKCi8vIEFwZXJ0dXJlLWdyaWxsZS4KCWVsc2UgaWYgKG1hc2sgPT0gMi4wKQoJewoJCXAueCA9IGZyYWN0KHAueC8zLjApOwoKCQlpZiAgICAgIChwLnggPCAwLjMzMykgTWFzay5yID0gTWFza0xpZ2h0OwoJCWVsc2UgaWYgKHAueCA8IDAuNjY2KSBNYXNrLmcgPSBNYXNrTGlnaHQ7CgkJZWxzZSAgICAgICAgICAgICAgICAgIE1hc2suYiA9IE1hc2tMaWdodDsKCQlyZXR1cm4gdmVjNCAoTWFzay5yLCBNYXNrLmcsIE1hc2suYiwxLjApOyAgCgoJfSAKLy8gZ3JheQoJZWxzZSBpZiAobWFzaz09My4wKQoJewoJCQoJCWlmIChtZiA8IDAuNSkgcmV0dXJuIHZlYzQgKE1hc2tMaWdodCxNYXNrTGlnaHQsTWFza0xpZ2h0LDEuMCk7IAoJCWVsc2UgcmV0dXJuIHZlYzQgKG0sbSxtLDEuMCk7Cgl9Ci8vZ3JheSAzcHgKCWVsc2UgaWYgKG1hc2s9PTQuMCkKCXsKCQlmbG9hdCBtZj1mcmFjdChwLngqMC4zMzMzKTsKCQlpZiAobWYgPCAwLjY2NjYpIHJldHVybiB2ZWM0IChNYXNrTGlnaHQsTWFza0xpZ2h0LE1hc2tMaWdodCwxLjApOyAKCQllbHNlIHJldHVybiB2ZWM0IChtLG0sbSwxLjApOwoJfQovL2Nnd2cgc2xvdAoJZWxzZSBpZiAobWFzayA9PSA1LjApCgl7CgkJZmxvYXQgbGluZSA9IE1hc2tMaWdodDsKCQlmbG9hdCBvZGQgID0gMC4wOwoKCQlpZiAoZnJhY3QocC54LzQuMCkgPCAwLjUpCgkJCW9kZCA9IDEuMDsKCQlpZiAoZnJhY3QoKHAueSArIG9kZCkvMi4wKSA8IDAuNSkKCQkJbGluZSA9IE1hc2tEYXJrOwoKCQlwLnggPSBmcmFjdChwLngvMi4wKTsKICAgIAoJCWlmICAocC54IDwgMC41KSB7TWFzay5yID0gMS4wOyBNYXNrLmIgPSAxLjA7fQoJCWVsc2UgIE1hc2suZyA9IDEuMDsJCgkJTWFzayo9bGluZTsgIAoJCXJldHVybiB2ZWM0IChNYXNrLnIsIE1hc2suZywgTWFzay5iLDEuMCk7ICAKCgl9IAoKLy9jZ3dnIHNsb3QgMTQ0MHAKCWVsc2UgaWYgKG1hc2sgPT0gNi4wKQoJewoJCWZsb2F0IGxpbmUgPSBNYXNrTGlnaHQ7CgkJZmxvYXQgb2RkICA9IDAuMDsKCgkJaWYgKGZyYWN0KHAueC82LjApIDwgMC41KQoJCQlvZGQgPSAxLjA7CgkJaWYgKGZyYWN0KChwLnkgKyBvZGQpLzMuMCkgPCAwLjUpCgkJCWxpbmUgPSBNYXNrRGFyazsKCgkJcC54ID0gZnJhY3QocC54LzIuMCk7CiAgICAKCQlpZiAgKHAueCA8IDAuNSkge01hc2suciA9IE1hc2tMaWdodDsgTWFzay5iID0gTWFza0xpZ2h0O30KCQkJZWxzZSAge01hc2suZyA9IE1hc2tMaWdodDt9CQoJCQoJCU1hc2sqPWxpbmU7IAoJCXJldHVybiB2ZWM0IChNYXNrLnIsIE1hc2suZywgTWFzay5iLDEuMCk7ICAgCgl9IAoKLy9QQyBDUlQgVkdBIHN0eWxlIG1hc2sKCWVsc2UgaWYgKG1hc2sgPT0gNy4wKQoJewoJCWZsb2F0IGxpbmUgPSAxLjA7CgkJcC54ID0gZnJhY3QocC54LzIuMCk7CgoJCWlmIChmcmFjdChwLnkvc2NhbGUpIDwgMC41KQoJCQl7CgkJCQlpZiAgKHAueCA8IDAuNSkge01hc2suciA9IDEuMDsgTWFzay5iID0gMS4wO30KCQkJCWVsc2UgIHtNYXNrLmcgPSAxLjA7fQkKCQkJfQoJCWVsc2UKCQkJewoJCQkJaWYgIChwLnggPCAwLjUpIHtNYXNrLmcgPSAxLjA7fQkKCQkJCWVsc2UgICB7TWFzay5yID0gMS4wOyBNYXNrLmIgPSAxLjA7fQoJfQoJCU1hc2sqPWxpbmU7CgkJcmV0dXJuIHZlYzQgKE1hc2suciwgTWFzay5nLCBNYXNrLmIsMS4wKTsgICAKCgl9IAplbHNlIHJldHVybiB2ZWM0KDEuMCk7Cn0KdmVjMyBib29zdGVyICh2ZWMyIHBvcykKewoJdmVjMiBkeCA9IHZlYzIoU291cmNlU2l6ZS56LDAuMCk7Cgl2ZWMyIGR5ID0gdmVjMigwLjAsU291cmNlU2l6ZS53KTsKCgl2ZWM0IGMwMCA9IHRleHR1cmUyRChTb3VyY2UscG9zKTsKCXZlYzQgYzAxID0gdGV4dHVyZTJEKFNvdXJjZSxwb3MrZHgpOwoJdmVjNCBjMDIgPSB0ZXh0dXJlMkQoU291cmNlLHBvcytkeSk7Cgl2ZWM0IGMwMyA9IHRleHR1cmUyRChTb3VyY2UscG9zK2R4K2R5KTsKCgl2ZWM0IGdsID0gKGMwMCtjMDErYzAyK2MwMykvNC4wOyBnbCAqPWdsOwoJdmVjMyBnbDAgPSBnbC5yZ2I7CglyZXR1cm4gZ2wwKmdsb3c7Cn0KCnZvaWQgbWFpbigpCnsJCgl2ZWMyIHBvcyA9dlRleENvb3JkOwoJdmVjMiBPR0wyUG9zID0gcG9zKlRleHR1cmVTaXplOwoJdmVjMiBjZW50ID0gKGZsb29yKE9HTDJQb3MpKzAuNSkvVGV4dHVyZVNpemU7CglmbG9hdCB4Y29vcmQgPSBtaXgoY2VudC54LHZUZXhDb29yZC54LGJsdXIpOwoJdmVjMiBjb29yZHMgPSB2ZWMyKHhjb29yZCwgY2VudC55KTsKCgl2ZWMzIHJlcz0gdGV4dHVyZTJEKFNvdXJjZSwgY29vcmRzKS5yZ2I7CgoJZmxvYXQgbHVtID0gbWF4KG1heChyZXMucip3ZWlnaHRyLHJlcy5nKndlaWdodGcpLHJlcy5iKndlaWdodGIpOwoJZmxvYXQgZiA9IGZyYWN0KE9HTDJQb3MueSk7CgkKCXJlcyAqPSAxLjAtKGYtMC41KSooZi0wLjUpKjQ1LjAqKFNjYW5saW5lKigxLjAtbHVtKSk7CglyZXMgPSBjbGFtcChyZXMsMC4wLDEuMCk7CgkKCWZsb2F0IGwgPSBkb3QocmVzLHZlYzMoMC4zLDAuNiwwLjEpKTsKCXJlcyA9IG1peCh2ZWMzKGwpLCByZXMsIHNhdCk7CglyZXMgKz0gYm9vc3Rlcihjb29yZHMpOwoJdmVjNCByZXMwID0gdmVjNChyZXMsMS4wKTsgCglyZXMwICo9IE1hc2soZnJhZ3BvcyoxLjAwMDEpOwoJcmVzMCAqPSBtaXgoZGFyayxicmlnaHQsbCk7CgkKCUZyYWdDb2xvciA9IHJlczA7Cn0KI2VuZGlmCg=="}]},"crt-caligari":{shader:{type:"text",value:"shaders = 1\n\nshader0 = crt-caligari.glsl\nfilter_linear0 = false\n"},resources:[{name:"crt-caligari.glsl",type:"base64",value:"Ly8gUGFyYW1ldGVyIGxpbmVzIGdvIGhlcmU6Ci8vIDAuNSA9IHRoZSBzcG90IHN0YXlzIGluc2lkZSB0aGUgb3JpZ2luYWwgcGl4ZWwKLy8gMS4wID0gdGhlIHNwb3QgYmxlZWRzIHVwIHRvIHRoZSBjZW50ZXIgb2YgbmV4dCBwaXhlbAojcHJhZ21hIHBhcmFtZXRlciBTUE9UX1dJRFRIICJDUlRDYWxpZ2FyaSBTcG90IFdpZHRoIiAwLjkgMC41IDEuNSAwLjA1CiNwcmFnbWEgcGFyYW1ldGVyIFNQT1RfSEVJR0hUICJDUlRDYWxpZ2FyaSBTcG90IEhlaWdodCIgMC42NSAwLjUgMS41IDAuMDUKLy8gVXNlZCB0byBjb3VudGVyYWN0IHRoZSBkZXNhdHVyYXRpb24gZWZmZWN0IG9mIHdlaWdodGluZy4KI3ByYWdtYSBwYXJhbWV0ZXIgQ09MT1JfQk9PU1QgIkNSVENhbGlnYXJpIENvbG9yIEJvb3N0IiAxLjQ1IDEuMCAyLjAgMC4wNQovLyBDb25zdGFudHMgdXNlZCB3aXRoIGdhbW1hIGNvcnJlY3Rpb24uCiNwcmFnbWEgcGFyYW1ldGVyIElucHV0R2FtbWEgIkNSVENhbGlnYXJpIElucHV0IEdhbW1hIiAyLjQgMC4wIDUuMCAwLjEKI3ByYWdtYSBwYXJhbWV0ZXIgT3V0cHV0R2FtbWEgIkNSVENhbGlnYXJpIE91dHB1dCBHYW1tYSIgMi4yIDAuMCA1LjAgMC4xCgojaWYgZGVmaW5lZChWRVJURVgpCgojaWYgX19WRVJTSU9OX18gPj0gMTMwCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgb3V0CiNkZWZpbmUgQ09NUEFUX0FUVFJJQlVURSBpbgojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUKI2Vsc2UKI2RlZmluZSBDT01QQVRfVkFSWUlORyB2YXJ5aW5nIAojZGVmaW5lIENPTVBBVF9BVFRSSUJVVEUgYXR0cmlidXRlIAojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUyRAojZW5kaWYKCiNpZmRlZiBHTF9FUwojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04gbWVkaXVtcAojZWxzZQojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04KI2VuZGlmCgpDT01QQVRfQVRUUklCVVRFIHZlYzQgVmVydGV4Q29vcmQ7CkNPTVBBVF9BVFRSSUJVVEUgdmVjNCBDT0xPUjsKQ09NUEFUX0FUVFJJQlVURSB2ZWM0IFRleENvb3JkOwpDT01QQVRfVkFSWUlORyB2ZWM0IENPTDA7CkNPTVBBVF9WQVJZSU5HIHZlYzQgVEVYMDsKQ09NUEFUX1ZBUllJTkcgdmVjMiBvbmV4OwpDT01QQVRfVkFSWUlORyB2ZWMyIG9uZXk7Cgp2ZWM0IF9vUG9zaXRpb24xOyAKdW5pZm9ybSBtYXQ0IE1WUE1hdHJpeDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZURpcmVjdGlvbjsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZUNvdW50Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBPdXRwdXRTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBUZXh0dXJlU2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgSW5wdXRTaXplOwoKI2RlZmluZSBTb3VyY2VTaXplIHZlYzQoVGV4dHVyZVNpemUsIDEuMCAvIFRleHR1cmVTaXplKSAvL2VpdGhlciBUZXh0dXJlU2l6ZSBvciBJbnB1dFNpemUKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gTVZQTWF0cml4ICogVmVydGV4Q29vcmQ7CiAgICBDT0wwID0gQ09MT1I7CiAgICBURVgwLnh5ID0gVGV4Q29vcmQueHk7CiAgIG9uZXggPSB2ZWMyKFNvdXJjZVNpemUueiwgMC4wKTsKICAgb25leSA9IHZlYzIoMC4wLCBTb3VyY2VTaXplLncpOwp9CgojZWxpZiBkZWZpbmVkKEZSQUdNRU5UKQoKI2lmIF9fVkVSU0lPTl9fID49IDEzMAojZGVmaW5lIENPTVBBVF9WQVJZSU5HIGluCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZQpvdXQgdmVjNCBGcmFnQ29sb3I7CiNlbHNlCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgdmFyeWluZwojZGVmaW5lIEZyYWdDb2xvciBnbF9GcmFnQ29sb3IKI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlMkQKI2VuZGlmCgojaWZkZWYgR0xfRVMKI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdICnByZWNpc2lvbiBoaWdocCBmbG9hdDsKI2Vsc2UKcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CiNlbmRpZgojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04gbWVkaXVtcAojZWxzZQojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04KI2VuZGlmCgp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lRGlyZWN0aW9uOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lQ291bnQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIE91dHB1dFNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIFRleHR1cmVTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBJbnB1dFNpemU7CnVuaWZvcm0gc2FtcGxlcjJEIFRleHR1cmU7CkNPTVBBVF9WQVJZSU5HIHZlYzQgVEVYMDsKQ09NUEFUX1ZBUllJTkcgdmVjMiBvbmV4OwpDT01QQVRfVkFSWUlORyB2ZWMyIG9uZXk7CgovLyBjb21wYXRpYmlsaXR5ICNkZWZpbmVzCiNkZWZpbmUgU291cmNlIFRleHR1cmUKI2RlZmluZSB2VGV4Q29vcmQgVEVYMC54eQoKI2RlZmluZSBTb3VyY2VTaXplIHZlYzQoVGV4dHVyZVNpemUsIDEuMCAvIFRleHR1cmVTaXplKSAvL2VpdGhlciBUZXh0dXJlU2l6ZSBvciBJbnB1dFNpemUKI2RlZmluZSBPdXRwdXRTaXplIHZlYzQoT3V0cHV0U2l6ZSwgMS4wIC8gT3V0cHV0U2l6ZSkKCiNpZmRlZiBQQVJBTUVURVJfVU5JRk9STQovLyBBbGwgcGFyYW1ldGVyIGZsb2F0cyBuZWVkIHRvIGhhdmUgQ09NUEFUX1BSRUNJU0lPTiBpbiBmcm9udCBvZiB0aGVtCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBTUE9UX1dJRFRIOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgU1BPVF9IRUlHSFQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBDT0xPUl9CT09TVDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IElucHV0R2FtbWE7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBPdXRwdXRHYW1tYTsKI2Vsc2UKI2RlZmluZSBTUE9UX1dJRFRIIDAuOQojZGVmaW5lIFNQT1RfSEVJR0hUIDAuNjUKI2RlZmluZSBDT0xPUl9CT09TVCAxLjQ1CiNkZWZpbmUgSW5wdXRHYW1tYSAyLjQKI2RlZmluZSBPdXRwdXRHYW1tYSAyLjIKI2VuZGlmCgojZGVmaW5lIEdBTU1BX0lOKGNvbG9yKSAgICAgcG93KGNvbG9yLHZlYzQoSW5wdXRHYW1tYSkpCiNkZWZpbmUgR0FNTUFfT1VUKGNvbG9yKSAgICBwb3coY29sb3IsIHZlYzQoMS4wIC8gT3V0cHV0R2FtbWEpKQoKI2RlZmluZSBURVgyRChjb29yZHMpCUdBTU1BX0lOKCBDT01QQVRfVEVYVFVSRShTb3VyY2UsIGNvb3JkcykgKQoKLy8gTWFjcm8gZm9yIHdlaWdodHMgY29tcHV0aW5nCiNkZWZpbmUgV0VJR0hUKHcpIFwKICAgaWYodz4xLjApIHc9MS4wOyBcCncgPSAxLjAgLSB3ICogdzsgXAp3ID0gdyAqIHc7Cgp2b2lkIG1haW4oKQp7CiAgIHZlYzIgY29vcmRzID0gKCB2VGV4Q29vcmQgKiBTb3VyY2VTaXplLnh5ICk7CiAgIHZlYzIgcGl4ZWxfY2VudGVyID0gZmxvb3IoIGNvb3JkcyApICsgdmVjMigwLjUsIDAuNSk7CiAgIHZlYzIgdGV4dHVyZV9jb29yZHMgPSBwaXhlbF9jZW50ZXIgKiBTb3VyY2VTaXplLnp3OwoKICAgdmVjNCBjb2xvciA9IFRFWDJEKCB0ZXh0dXJlX2Nvb3JkcyApOwoKICAgZmxvYXQgZHggPSBjb29yZHMueCAtIHBpeGVsX2NlbnRlci54OwoKICAgZmxvYXQgaF93ZWlnaHRfMDAgPSBkeCAvIFNQT1RfV0lEVEg7CiAgIFdFSUdIVCggaF93ZWlnaHRfMDAgKTsKCiAgIGNvbG9yICo9IHZlYzQoIGhfd2VpZ2h0XzAwLCBoX3dlaWdodF8wMCwgaF93ZWlnaHRfMDAsIGhfd2VpZ2h0XzAwICApOwoKICAgLy8gZ2V0IGNsb3Nlc3QgaG9yaXpvbnRhbCBuZWlnaGJvdXIgdG8gYmxlbmQKICAgdmVjMiBjb29yZHMwMTsKICAgaWYgKGR4PjAuMCkgewogICAgICBjb29yZHMwMSA9IG9uZXg7CiAgICAgIGR4ID0gMS4wIC0gZHg7CiAgIH0gZWxzZSB7CiAgICAgIGNvb3JkczAxID0gLW9uZXg7CiAgICAgIGR4ID0gMS4wICsgZHg7CiAgIH0KICAgdmVjNCBjb2xvck5CID0gVEVYMkQoIHRleHR1cmVfY29vcmRzICsgY29vcmRzMDEgKTsKCiAgIGZsb2F0IGhfd2VpZ2h0XzAxID0gZHggLyBTUE9UX1dJRFRIOwogICBXRUlHSFQoIGhfd2VpZ2h0XzAxICk7CgogICBjb2xvciA9IGNvbG9yICsgY29sb3JOQiAqIHZlYzQoIGhfd2VpZ2h0XzAxICk7CgogICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgLy8gVmVydGljYWwgQmxlbmRpbmcKICAgZmxvYXQgZHkgPSBjb29yZHMueSAtIHBpeGVsX2NlbnRlci55OwogICBmbG9hdCB2X3dlaWdodF8wMCA9IGR5IC8gU1BPVF9IRUlHSFQ7CiAgIFdFSUdIVCggdl93ZWlnaHRfMDAgKTsKICAgY29sb3IgKj0gdmVjNCggdl93ZWlnaHRfMDAgKTsKCiAgIC8vIGdldCBjbG9zZXN0IHZlcnRpY2FsIG5laWdoYm91ciB0byBibGVuZAogICB2ZWMyIGNvb3JkczEwOwogICBpZiAoZHk+MC4wKSB7CiAgICAgIGNvb3JkczEwID0gb25leTsKICAgICAgZHkgPSAxLjAgLSBkeTsKICAgfSBlbHNlIHsKICAgICAgY29vcmRzMTAgPSAtb25leTsKICAgICAgZHkgPSAxLjAgKyBkeTsKICAgfQogICBjb2xvck5CID0gVEVYMkQoIHRleHR1cmVfY29vcmRzICsgY29vcmRzMTAgKTsKCiAgIGZsb2F0IHZfd2VpZ2h0XzEwID0gZHkgLyBTUE9UX0hFSUdIVDsKICAgV0VJR0hUKCB2X3dlaWdodF8xMCApOwoKICAgY29sb3IgPSBjb2xvciArIGNvbG9yTkIgKiB2ZWM0KCB2X3dlaWdodF8xMCAqIGhfd2VpZ2h0XzAwLCB2X3dlaWdodF8xMCAqIGhfd2VpZ2h0XzAwLCB2X3dlaWdodF8xMCAqIGhfd2VpZ2h0XzAwLCB2X3dlaWdodF8xMCAqIGhfd2VpZ2h0XzAwICk7CgogICBjb2xvck5CID0gVEVYMkQoICB0ZXh0dXJlX2Nvb3JkcyArIGNvb3JkczAxICsgY29vcmRzMTAgKTsKCiAgIGNvbG9yID0gY29sb3IgKyBjb2xvck5CICogdmVjNCggdl93ZWlnaHRfMTAgKiBoX3dlaWdodF8wMSwgdl93ZWlnaHRfMTAgKiBoX3dlaWdodF8wMSwgdl93ZWlnaHRfMTAgKiBoX3dlaWdodF8wMSwgdl93ZWlnaHRfMTAgKiBoX3dlaWdodF8wMSApOwoKICAgY29sb3IgKj0gdmVjNCggQ09MT1JfQk9PU1QgKTsKCiAgIEZyYWdDb2xvciA9IGNsYW1wKCBHQU1NQV9PVVQoY29sb3IpLCAwLjAsIDEuMCApOwp9IAojZW5kaWYK"}]},"crt-lottes":{shader:{type:"text",value:"shaders = 1\n\nshader0 = crt-lottes.glsl\nfilter_linear0 = false\n"},resources:[{name:"crt-lottes.glsl",type:"base64",value:"Ly8gUGFyYW1ldGVyIGxpbmVzIGdvIGhlcmU6CiNwcmFnbWEgcGFyYW1ldGVyIGhhcmRTY2FuICJoYXJkU2NhbiIgLTguMCAtMjAuMCAwLjAgMS4wCiNwcmFnbWEgcGFyYW1ldGVyIGhhcmRQaXggImhhcmRQaXgiIC0zLjAgLTIwLjAgMC4wIDEuMAojcHJhZ21hIHBhcmFtZXRlciB3YXJwWCAid2FycFgiIDAuMDMxIDAuMCAwLjEyNSAwLjAxCiNwcmFnbWEgcGFyYW1ldGVyIHdhcnBZICJ3YXJwWSIgMC4wNDEgMC4wIDAuMTI1IDAuMDEKI3ByYWdtYSBwYXJhbWV0ZXIgbWFza0RhcmsgIm1hc2tEYXJrIiAwLjUgMC4wIDIuMCAwLjEKI3ByYWdtYSBwYXJhbWV0ZXIgbWFza0xpZ2h0ICJtYXNrTGlnaHQiIDEuNSAwLjAgMi4wIDAuMQojcHJhZ21hIHBhcmFtZXRlciBzY2FsZUluTGluZWFyR2FtbWEgInNjYWxlSW5MaW5lYXJHYW1tYSIgMS4wIDAuMCAxLjAgMS4wCiNwcmFnbWEgcGFyYW1ldGVyIHNoYWRvd01hc2sgInNoYWRvd01hc2siIDMuMCAwLjAgNC4wIDEuMAojcHJhZ21hIHBhcmFtZXRlciBicmlnaHRCb29zdCAiYnJpZ2h0bmVzcyBib29zdCIgMS4wIDAuMCAyLjAgMC4wNQojcHJhZ21hIHBhcmFtZXRlciBoYXJkQmxvb21QaXggImJsb29tLXggc29mdCIgLTEuNSAtMi4wIC0wLjUgMC4xCiNwcmFnbWEgcGFyYW1ldGVyIGhhcmRCbG9vbVNjYW4gImJsb29tLXkgc29mdCIgLTIuMCAtNC4wIC0xLjAgMC4xCiNwcmFnbWEgcGFyYW1ldGVyIGJsb29tQW1vdW50ICJibG9vbSBhbW1vdW50IiAwLjE1IDAuMCAxLjAgMC4wNQojcHJhZ21hIHBhcmFtZXRlciBzaGFwZSAiZmlsdGVyIGtlcm5lbCBzaGFwZSIgMi4wIDAuMCAxMC4wIDAuMDUKCiNpZiBkZWZpbmVkKFZFUlRFWCkKCiNpZiBfX1ZFUlNJT05fXyA+PSAxMzAKI2RlZmluZSBDT01QQVRfVkFSWUlORyBvdXQKI2RlZmluZSBDT01QQVRfQVRUUklCVVRFIGluCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZQojZWxzZQojZGVmaW5lIENPTVBBVF9WQVJZSU5HIHZhcnlpbmcgCiNkZWZpbmUgQ09NUEFUX0FUVFJJQlVURSBhdHRyaWJ1dGUgCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZTJECiNlbmRpZgoKI2lmZGVmIEdMX0VTCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTiBtZWRpdW1wCiNlbHNlCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTgojZW5kaWYKCkNPTVBBVF9BVFRSSUJVVEUgdmVjNCBWZXJ0ZXhDb29yZDsKQ09NUEFUX0FUVFJJQlVURSB2ZWM0IENPTE9SOwpDT01QQVRfQVRUUklCVVRFIHZlYzQgVGV4Q29vcmQ7CkNPTVBBVF9WQVJZSU5HIHZlYzQgQ09MMDsKQ09NUEFUX1ZBUllJTkcgdmVjNCBURVgwOwoKdW5pZm9ybSBtYXQ0IE1WUE1hdHJpeDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZURpcmVjdGlvbjsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZUNvdW50Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBPdXRwdXRTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBUZXh0dXJlU2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgSW5wdXRTaXplOwoKLy8gdmVydGV4IGNvbXBhdGliaWxpdHkgI2RlZmluZXMKI2RlZmluZSB2VGV4Q29vcmQgVEVYMC54eQojZGVmaW5lIFNvdXJjZVNpemUgdmVjNChUZXh0dXJlU2l6ZSwgMS4wIC8gVGV4dHVyZVNpemUpIC8vZWl0aGVyIFRleHR1cmVTaXplIG9yIElucHV0U2l6ZQojZGVmaW5lIG91dHNpemUgdmVjNChPdXRwdXRTaXplLCAxLjAgLyBPdXRwdXRTaXplKQoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBNVlBNYXRyaXggKiBWZXJ0ZXhDb29yZDsKICAgIFRFWDAueHkgPSBUZXhDb29yZC54eTsKfQoKI2VsaWYgZGVmaW5lZChGUkFHTUVOVCkKCiNpZiBfX1ZFUlNJT05fXyA+PSAxMzAKI2RlZmluZSBDT01QQVRfVkFSWUlORyBpbgojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUKb3V0IHZlYzQgRnJhZ0NvbG9yOwojZWxzZQojZGVmaW5lIENPTVBBVF9WQVJZSU5HIHZhcnlpbmcKI2RlZmluZSBGcmFnQ29sb3IgZ2xfRnJhZ0NvbG9yCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZTJECiNlbmRpZgoKI2lmZGVmIEdMX0VTCiNpZmRlZiBHTF9GUkFHTUVOVF9QUkVDSVNJT05fSElHSApwcmVjaXNpb24gaGlnaHAgZmxvYXQ7CiNlbHNlCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwojZW5kaWYKI2RlZmluZSBDT01QQVRfUFJFQ0lTSU9OIG1lZGl1bXAKI2Vsc2UKI2RlZmluZSBDT01QQVRfUFJFQ0lTSU9OCiNlbmRpZgoKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZURpcmVjdGlvbjsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZUNvdW50Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBPdXRwdXRTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBUZXh0dXJlU2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgSW5wdXRTaXplOwp1bmlmb3JtIHNhbXBsZXIyRCBUZXh0dXJlOwpDT01QQVRfVkFSWUlORyB2ZWM0IFRFWDA7CgovLyBmcmFnbWVudCBjb21wYXRpYmlsaXR5ICNkZWZpbmVzCiNkZWZpbmUgU291cmNlIFRleHR1cmUKI2RlZmluZSB2VGV4Q29vcmQgVEVYMC54eQoKI2RlZmluZSBTb3VyY2VTaXplIHZlYzQoVGV4dHVyZVNpemUsIDEuMCAvIFRleHR1cmVTaXplKSAvL2VpdGhlciBUZXh0dXJlU2l6ZSBvciBJbnB1dFNpemUKI2RlZmluZSBvdXRzaXplIHZlYzQoT3V0cHV0U2l6ZSwgMS4wIC8gT3V0cHV0U2l6ZSkKCiNpZmRlZiBQQVJBTUVURVJfVU5JRk9STQovLyBBbGwgcGFyYW1ldGVyIGZsb2F0cyBuZWVkIHRvIGhhdmUgQ09NUEFUX1BSRUNJU0lPTiBpbiBmcm9udCBvZiB0aGVtCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBoYXJkU2NhbjsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IGhhcmRQaXg7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCB3YXJwWDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IHdhcnBZOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgbWFza0Rhcms7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBtYXNrTGlnaHQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBzY2FsZUluTGluZWFyR2FtbWE7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBzaGFkb3dNYXNrOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgYnJpZ2h0Qm9vc3Q7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBoYXJkQmxvb21QaXg7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBoYXJkQmxvb21TY2FuOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgYmxvb21BbW91bnQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBzaGFwZTsKI2Vsc2UKI2RlZmluZSBoYXJkU2NhbiAtOC4wCiNkZWZpbmUgaGFyZFBpeCAtMy4wCiNkZWZpbmUgd2FycFggMC4wMzEKI2RlZmluZSB3YXJwWSAwLjA0MQojZGVmaW5lIG1hc2tEYXJrIDAuNQojZGVmaW5lIG1hc2tMaWdodCAxLjUKI2RlZmluZSBzY2FsZUluTGluZWFyR2FtbWEgMS4wCiNkZWZpbmUgc2hhZG93TWFzayAzLjAKI2RlZmluZSBicmlnaHRCb29zdCAxLjAKI2RlZmluZSBoYXJkQmxvb21QaXggLTEuNQojZGVmaW5lIGhhcmRCbG9vbVNjYW4gLTIuMAojZGVmaW5lIGJsb29tQW1vdW50IDAuMTUKI2RlZmluZSBzaGFwZSAyLjAKI2VuZGlmCgovL1VuY29tbWVudCB0byByZWR1Y2UgaW5zdHJ1Y3Rpb25zIHdpdGggc2ltcGxlciBsaW5lYXJpemF0aW9uCi8vKGZpeGVzIEhEMzAwMCBTYW5keSBCcmlkZ2UgSUdQKQovLyNkZWZpbmUgU0lNUExFX0xJTkVBUl9HQU1NQQojZGVmaW5lIERPX0JMT09NCgovLyAtLS0tLS0tLS0tLS0tIC8vCgovLyBzUkdCIHRvIExpbmVhci4KLy8gQXNzdW1pbmcgdXNpbmcgc1JHQiB0eXBlZCB0ZXh0dXJlcyB0aGlzIHNob3VsZCBub3QgYmUgbmVlZGVkLgojaWZkZWYgU0lNUExFX0xJTkVBUl9HQU1NQQpmbG9hdCBUb0xpbmVhcjEoZmxvYXQgYykKewogICAgcmV0dXJuIGM7Cn0KdmVjMyBUb0xpbmVhcih2ZWMzIGMpCnsKICAgIHJldHVybiBjOwp9CnZlYzMgVG9TcmdiKHZlYzMgYykKewogICAgcmV0dXJuIHBvdyhjLCB2ZWMzKDEuMCAvIDIuMikpOwp9CiNlbHNlCmZsb2F0IFRvTGluZWFyMShmbG9hdCBjKQp7CiAgICBpZiAoc2NhbGVJbkxpbmVhckdhbW1hID09IDAuKSAKICAgICAgICByZXR1cm4gYzsKICAgIAogICAgcmV0dXJuKGM8PTAuMDQwNDUpID8gYy8xMi45MiA6IHBvdygoYyArIDAuMDU1KS8xLjA1NSwgMi40KTsKfQoKdmVjMyBUb0xpbmVhcih2ZWMzIGMpCnsKICAgIGlmIChzY2FsZUluTGluZWFyR2FtbWE9PTAuKSAKICAgICAgICByZXR1cm4gYzsKICAgIAogICAgcmV0dXJuIHZlYzMoVG9MaW5lYXIxKGMuciksIFRvTGluZWFyMShjLmcpLCBUb0xpbmVhcjEoYy5iKSk7Cn0KCi8vIExpbmVhciB0byBzUkdCLgovLyBBc3N1bWluZyB1c2luZyBzUkdCIHR5cGVkIHRleHR1cmVzIHRoaXMgc2hvdWxkIG5vdCBiZSBuZWVkZWQuCmZsb2F0IFRvU3JnYjEoZmxvYXQgYykKewogICAgaWYgKHNjYWxlSW5MaW5lYXJHYW1tYSA9PSAwLikgCiAgICAgICAgcmV0dXJuIGM7CiAgICAKICAgIHJldHVybihjPDAuMDAzMTMwOCA/IGMqMTIuOTIgOiAxLjA1NSpwb3coYywgMC40MTY2NikgLSAwLjA1NSk7Cn0KCnZlYzMgVG9TcmdiKHZlYzMgYykKewogICAgaWYgKHNjYWxlSW5MaW5lYXJHYW1tYSA9PSAwLikgCiAgICAgICAgcmV0dXJuIGM7CiAgICAKICAgIHJldHVybiB2ZWMzKFRvU3JnYjEoYy5yKSwgVG9TcmdiMShjLmcpLCBUb1NyZ2IxKGMuYikpOwp9CiNlbmRpZgoKLy8gTmVhcmVzdCBlbXVsYXRlZCBzYW1wbGUgZ2l2ZW4gZmxvYXRpbmcgcG9pbnQgcG9zaXRpb24gYW5kIHRleGVsIG9mZnNldC4KLy8gQWxzbyB6ZXJvJ3Mgb2ZmIHNjcmVlbi4KdmVjMyBGZXRjaCh2ZWMyIHBvcyx2ZWMyIG9mZil7CiAgcG9zPShmbG9vcihwb3MqU291cmNlU2l6ZS54eStvZmYpK3ZlYzIoMC41LDAuNSkpL1NvdXJjZVNpemUueHk7CiNpZmRlZiBTSU1QTEVfTElORUFSX0dBTU1BCiAgcmV0dXJuIFRvTGluZWFyKGJyaWdodEJvb3N0ICogcG93KENPTVBBVF9URVhUVVJFKFNvdXJjZSxwb3MueHkpLnJnYiwgdmVjMygyLjIpKSk7CiNlbHNlCiAgcmV0dXJuIFRvTGluZWFyKGJyaWdodEJvb3N0ICogQ09NUEFUX1RFWFRVUkUoU291cmNlLHBvcy54eSkucmdiKTsKI2VuZGlmCn0KCi8vIERpc3RhbmNlIGluIGVtdWxhdGVkIHBpeGVscyB0byBuZWFyZXN0IHRleGVsLgp2ZWMyIERpc3QodmVjMiBwb3MpCnsKICAgIHBvcyA9IHBvcypTb3VyY2VTaXplLnh5OwogICAgCiAgICByZXR1cm4gLSgocG9zIC0gZmxvb3IocG9zKSkgLSB2ZWMyKDAuNSkpOwp9CiAgICAKLy8gMUQgR2F1c3NpYW4uCmZsb2F0IEdhdXMoZmxvYXQgcG9zLCBmbG9hdCBzY2FsZSkKewogICAgcmV0dXJuIGV4cDIoc2NhbGUqcG93KGFicyhwb3MpLCBzaGFwZSkpOwp9CgovLyAzLXRhcCBHYXVzc2lhbiBmaWx0ZXIgYWxvbmcgaG9yeiBsaW5lLgp2ZWMzIEhvcnozKHZlYzIgcG9zLCBmbG9hdCBvZmYpCnsKICAgIHZlYzMgYiAgICA9IEZldGNoKHBvcywgdmVjMigtMS4wLCBvZmYpKTsKICAgIHZlYzMgYyAgICA9IEZldGNoKHBvcywgdmVjMiggMC4wLCBvZmYpKTsKICAgIHZlYzMgZCAgICA9IEZldGNoKHBvcywgdmVjMiggMS4wLCBvZmYpKTsKICAgIGZsb2F0IGRzdCA9IERpc3QocG9zKS54OwoKICAgIC8vIENvbnZlcnQgZGlzdGFuY2UgdG8gd2VpZ2h0LgogICAgZmxvYXQgc2NhbGUgPSBoYXJkUGl4OwogICAgZmxvYXQgd2IgPSBHYXVzKGRzdC0xLjAsc2NhbGUpOwogICAgZmxvYXQgd2MgPSBHYXVzKGRzdCswLjAsc2NhbGUpOwogICAgZmxvYXQgd2QgPSBHYXVzKGRzdCsxLjAsc2NhbGUpOwoKICAgIC8vIFJldHVybiBmaWx0ZXJlZCBzYW1wbGUuCiAgICByZXR1cm4gKGIqd2IrYyp3YytkKndkKS8od2Ird2Mrd2QpOwp9CgovLyA1LXRhcCBHYXVzc2lhbiBmaWx0ZXIgYWxvbmcgaG9yeiBsaW5lLgp2ZWMzIEhvcno1KHZlYzIgcG9zLGZsb2F0IG9mZil7CiAgICB2ZWMzIGEgPSBGZXRjaChwb3MsdmVjMigtMi4wLCBvZmYpKTsKICAgIHZlYzMgYiA9IEZldGNoKHBvcyx2ZWMyKC0xLjAsIG9mZikpOwogICAgdmVjMyBjID0gRmV0Y2gocG9zLHZlYzIoIDAuMCwgb2ZmKSk7CiAgICB2ZWMzIGQgPSBGZXRjaChwb3MsdmVjMiggMS4wLCBvZmYpKTsKICAgIHZlYzMgZSA9IEZldGNoKHBvcyx2ZWMyKCAyLjAsIG9mZikpOwogICAgCiAgICBmbG9hdCBkc3QgPSBEaXN0KHBvcykueDsKICAgIC8vIENvbnZlcnQgZGlzdGFuY2UgdG8gd2VpZ2h0LgogICAgZmxvYXQgc2NhbGUgPSBoYXJkUGl4OwogICAgZmxvYXQgd2EgPSBHYXVzKGRzdCAtIDIuMCwgc2NhbGUpOwogICAgZmxvYXQgd2IgPSBHYXVzKGRzdCAtIDEuMCwgc2NhbGUpOwogICAgZmxvYXQgd2MgPSBHYXVzKGRzdCArIDAuMCwgc2NhbGUpOwogICAgZmxvYXQgd2QgPSBHYXVzKGRzdCArIDEuMCwgc2NhbGUpOwogICAgZmxvYXQgd2UgPSBHYXVzKGRzdCArIDIuMCwgc2NhbGUpOwogICAgCiAgICAvLyBSZXR1cm4gZmlsdGVyZWQgc2FtcGxlLgogICAgcmV0dXJuIChhKndhK2Iqd2IrYyp3YytkKndkK2Uqd2UpLyh3YSt3Yit3Yyt3ZCt3ZSk7Cn0KICAKLy8gNy10YXAgR2F1c3NpYW4gZmlsdGVyIGFsb25nIGhvcnogbGluZS4KdmVjMyBIb3J6Nyh2ZWMyIHBvcyxmbG9hdCBvZmYpCnsKICAgIHZlYzMgYSA9IEZldGNoKHBvcywgdmVjMigtMy4wLCBvZmYpKTsKICAgIHZlYzMgYiA9IEZldGNoKHBvcywgdmVjMigtMi4wLCBvZmYpKTsKICAgIHZlYzMgYyA9IEZldGNoKHBvcywgdmVjMigtMS4wLCBvZmYpKTsKICAgIHZlYzMgZCA9IEZldGNoKHBvcywgdmVjMiggMC4wLCBvZmYpKTsKICAgIHZlYzMgZSA9IEZldGNoKHBvcywgdmVjMiggMS4wLCBvZmYpKTsKICAgIHZlYzMgZiA9IEZldGNoKHBvcywgdmVjMiggMi4wLCBvZmYpKTsKICAgIHZlYzMgZyA9IEZldGNoKHBvcywgdmVjMiggMy4wLCBvZmYpKTsKCiAgICBmbG9hdCBkc3QgPSBEaXN0KHBvcykueDsKICAgIC8vIENvbnZlcnQgZGlzdGFuY2UgdG8gd2VpZ2h0LgogICAgZmxvYXQgc2NhbGUgPSBoYXJkQmxvb21QaXg7CiAgICBmbG9hdCB3YSA9IEdhdXMoZHN0IC0gMy4wLCBzY2FsZSk7CiAgICBmbG9hdCB3YiA9IEdhdXMoZHN0IC0gMi4wLCBzY2FsZSk7CiAgICBmbG9hdCB3YyA9IEdhdXMoZHN0IC0gMS4wLCBzY2FsZSk7CiAgICBmbG9hdCB3ZCA9IEdhdXMoZHN0ICsgMC4wLCBzY2FsZSk7CiAgICBmbG9hdCB3ZSA9IEdhdXMoZHN0ICsgMS4wLCBzY2FsZSk7CiAgICBmbG9hdCB3ZiA9IEdhdXMoZHN0ICsgMi4wLCBzY2FsZSk7CiAgICBmbG9hdCB3ZyA9IEdhdXMoZHN0ICsgMy4wLCBzY2FsZSk7CgogICAgLy8gUmV0dXJuIGZpbHRlcmVkIHNhbXBsZS4KICAgIHJldHVybiAoYSp3YStiKndiK2Mqd2MrZCp3ZCtlKndlK2Yqd2YrZyp3ZykvKHdhK3diK3djK3dkK3dlK3dmK3dnKTsKfQogIAovLyBSZXR1cm4gc2NhbmxpbmUgd2VpZ2h0LgpmbG9hdCBTY2FuKHZlYzIgcG9zLCBmbG9hdCBvZmYpCnsKICAgIGZsb2F0IGRzdCA9IERpc3QocG9zKS55OwoKICAgIHJldHVybiBHYXVzKGRzdCArIG9mZiwgaGFyZFNjYW4pOwp9CiAgCi8vIFJldHVybiBzY2FubGluZSB3ZWlnaHQgZm9yIGJsb29tLgpmbG9hdCBCbG9vbVNjYW4odmVjMiBwb3MsIGZsb2F0IG9mZikKewogICAgZmxvYXQgZHN0ID0gRGlzdChwb3MpLnk7CiAgICAKICAgIHJldHVybiBHYXVzKGRzdCArIG9mZiwgaGFyZEJsb29tU2Nhbik7Cn0KCi8vIEFsbG93IG5lYXJlc3QgdGhyZWUgbGluZXMgdG8gZWZmZWN0IHBpeGVsLgp2ZWMzIFRyaSh2ZWMyIHBvcykKewogICAgdmVjMyBhID0gSG9yejMocG9zLC0xLjApOwogICAgdmVjMyBiID0gSG9yejUocG9zLCAwLjApOwogICAgdmVjMyBjID0gSG9yejMocG9zLCAxLjApOwogICAgCiAgICBmbG9hdCB3YSA9IFNjYW4ocG9zLC0xLjApOyAKICAgIGZsb2F0IHdiID0gU2Nhbihwb3MsIDAuMCk7CiAgICBmbG9hdCB3YyA9IFNjYW4ocG9zLCAxLjApOwogICAgCiAgICByZXR1cm4gYSp3YSArIGIqd2IgKyBjKndjOwp9CiAgCi8vIFNtYWxsIGJsb29tLgp2ZWMzIEJsb29tKHZlYzIgcG9zKQp7CiAgICB2ZWMzIGEgPSBIb3J6NShwb3MsLTIuMCk7CiAgICB2ZWMzIGIgPSBIb3J6Nyhwb3MsLTEuMCk7CiAgICB2ZWMzIGMgPSBIb3J6Nyhwb3MsIDAuMCk7CiAgICB2ZWMzIGQgPSBIb3J6Nyhwb3MsIDEuMCk7CiAgICB2ZWMzIGUgPSBIb3J6NShwb3MsIDIuMCk7CgogICAgZmxvYXQgd2EgPSBCbG9vbVNjYW4ocG9zLC0yLjApOwogICAgZmxvYXQgd2IgPSBCbG9vbVNjYW4ocG9zLC0xLjApOyAKICAgIGZsb2F0IHdjID0gQmxvb21TY2FuKHBvcywgMC4wKTsKICAgIGZsb2F0IHdkID0gQmxvb21TY2FuKHBvcywgMS4wKTsKICAgIGZsb2F0IHdlID0gQmxvb21TY2FuKHBvcywgMi4wKTsKCiAgICByZXR1cm4gYSp3YStiKndiK2Mqd2MrZCp3ZCtlKndlOwp9CiAgCi8vIERpc3RvcnRpb24gb2Ygc2NhbmxpbmVzLCBhbmQgZW5kIG9mIHNjcmVlbiBhbHBoYS4KdmVjMiBXYXJwKHZlYzIgcG9zKQp7CiAgICBwb3MgID0gcG9zKjIuMC0xLjA7ICAgIAogICAgcG9zICo9IHZlYzIoMS4wICsgKHBvcy55KnBvcy55KSp3YXJwWCwgMS4wICsgKHBvcy54KnBvcy54KSp3YXJwWSk7CiAgICAKICAgIHJldHVybiBwb3MqMC41ICsgMC41Owp9CiAgCi8vIFNoYWRvdyBtYXNrLgp2ZWMzIE1hc2sodmVjMiBwb3MpCnsKICAgIHZlYzMgbWFzayA9IHZlYzMobWFza0RhcmssIG1hc2tEYXJrLCBtYXNrRGFyayk7CiAgCiAgICAvLyBWZXJ5IGNvbXByZXNzZWQgVFYgc3R5bGUgc2hhZG93IG1hc2suCiAgICBpZiAoc2hhZG93TWFzayA9PSAxLjApIAogICAgewogICAgICAgIGZsb2F0IGxpbmUgPSBtYXNrTGlnaHQ7CiAgICAgICAgZmxvYXQgb2RkID0gMC4wOwogICAgICAgIAogICAgICAgIGlmIChmcmFjdChwb3MueCowLjE2NjY2NjY2NikgPCAwLjUpIG9kZCA9IDEuMDsKICAgICAgICBpZiAoZnJhY3QoKHBvcy55ICsgb2RkKSAqIDAuNSkgPCAwLjUpIGxpbmUgPSBtYXNrRGFyazsgIAogICAgICAgIAogICAgICAgIHBvcy54ID0gZnJhY3QocG9zLngqMC4zMzMzMzMzMzMpOwoKICAgICAgICBpZiAgICAgIChwb3MueCA8IDAuMzMzKSBtYXNrLnIgPSBtYXNrTGlnaHQ7CiAgICAgICAgZWxzZSBpZiAocG9zLnggPCAwLjY2NikgbWFzay5nID0gbWFza0xpZ2h0OwogICAgICAgIGVsc2UgICAgICAgICAgICAgICAgICAgIG1hc2suYiA9IG1hc2tMaWdodDsKICAgICAgICBtYXNrKj1saW5lOyAgCiAgICB9IAoKICAgIC8vIEFwZXJ0dXJlLWdyaWxsZS4KICAgIGVsc2UgaWYgKHNoYWRvd01hc2sgPT0gMi4wKSAKICAgIHsKICAgICAgICBwb3MueCA9IGZyYWN0KHBvcy54KjAuMzMzMzMzMzMzKTsKCiAgICAgICAgaWYgICAgICAocG9zLnggPCAwLjMzMykgbWFzay5yID0gbWFza0xpZ2h0OwogICAgICAgIGVsc2UgaWYgKHBvcy54IDwgMC42NjYpIG1hc2suZyA9IG1hc2tMaWdodDsKICAgICAgICBlbHNlICAgICAgICAgICAgICAgICAgICBtYXNrLmIgPSBtYXNrTGlnaHQ7CiAgICB9IAoKICAgIC8vIFN0cmV0Y2hlZCBWR0Egc3R5bGUgc2hhZG93IG1hc2sgKHNhbWUgYXMgcHJpb3Igc2hhZGVycykuCiAgICBlbHNlIGlmIChzaGFkb3dNYXNrID09IDMuMCkgCiAgICB7CiAgICAgICAgcG9zLnggKz0gcG9zLnkqMy4wOwogICAgICAgIHBvcy54ICA9IGZyYWN0KHBvcy54KjAuMTY2NjY2NjY2KTsKCiAgICAgICAgaWYgICAgICAocG9zLnggPCAwLjMzMykgbWFzay5yID0gbWFza0xpZ2h0OwogICAgICAgIGVsc2UgaWYgKHBvcy54IDwgMC42NjYpIG1hc2suZyA9IG1hc2tMaWdodDsKICAgICAgICBlbHNlICAgICAgICAgICAgICAgICAgICBtYXNrLmIgPSBtYXNrTGlnaHQ7CiAgICB9CgogICAgLy8gVkdBIHN0eWxlIHNoYWRvdyBtYXNrLgogICAgZWxzZSBpZiAoc2hhZG93TWFzayA9PSA0LjApIAogICAgewogICAgICAgIHBvcy54eSAgPSBmbG9vcihwb3MueHkqdmVjMigxLjAsIDAuNSkpOwogICAgICAgIHBvcy54ICArPSBwb3MueSozLjA7CiAgICAgICAgcG9zLnggICA9IGZyYWN0KHBvcy54KjAuMTY2NjY2NjY2KTsKCiAgICAgICAgaWYgICAgICAocG9zLnggPCAwLjMzMykgbWFzay5yID0gbWFza0xpZ2h0OwogICAgICAgIGVsc2UgaWYgKHBvcy54IDwgMC42NjYpIG1hc2suZyA9IG1hc2tMaWdodDsKICAgICAgICBlbHNlICAgICAgICAgICAgICAgICAgICBtYXNrLmIgPSBtYXNrTGlnaHQ7CiAgICB9CgogICAgcmV0dXJuIG1hc2s7Cn0KCnZvaWQgbWFpbigpCnsKICAgIHZlYzIgcG9zID0gV2FycChURVgwLnh5KihUZXh0dXJlU2l6ZS54eS9JbnB1dFNpemUueHkpKSooSW5wdXRTaXplLnh5L1RleHR1cmVTaXplLnh5KTsKICAgIHZlYzMgb3V0Q29sb3IgPSBUcmkocG9zKTsKCiNpZmRlZiBET19CTE9PTQogICAgLy9BZGQgQmxvb20KICAgIG91dENvbG9yLnJnYiArPSBCbG9vbShwb3MpKmJsb29tQW1vdW50OwojZW5kaWYKCiAgICBpZiAoc2hhZG93TWFzayA+IDAuMCkKICAgICAgICBvdXRDb2xvci5yZ2IgKj0gTWFzayhnbF9GcmFnQ29vcmQueHkgKiAxLjAwMDAwMSk7CiAgICAKI2lmZGVmIEdMX0VTICAgIC8qIFRPRE8vRklYTUUgLSBoYWNreSBjbGFtcCBmaXggKi8KICAgIHZlYzIgYm9yZGVydGVzdCA9IChwb3MpOwogICAgaWYgKCBib3JkZXJ0ZXN0LnggPiAwLjAwMDEgJiYgYm9yZGVydGVzdC54IDwgMC45OTk5ICYmIGJvcmRlcnRlc3QueSA+IDAuMDAwMSAmJiBib3JkZXJ0ZXN0LnkgPCAwLjk5OTkpCiAgICAgICAgb3V0Q29sb3IucmdiID0gb3V0Q29sb3IucmdiOwogICAgZWxzZQogICAgICAgIG91dENvbG9yLnJnYiA9IHZlYzMoMC4wKTsKI2VuZGlmCiAgICBGcmFnQ29sb3IgPSB2ZWM0KFRvU3JnYihvdXRDb2xvci5yZ2IpLCAxLjApOwp9IAojZW5kaWYK"}]},"crt-zfast":{shader:{type:"text",value:"shaders = 1\n\nshader0 = zfast_crt.glsl\nfilter_linear0 = true"},resources:[{name:"zfast_crt.glsl",type:"base64",value:"Ly9Gb3IgdGVzdGluZyBjb21waWxhdGlvbg0KLy8jZGVmaW5lIEZSQUdNRU5UDQovLyNkZWZpbmUgVkVSVEVYDQoNCi8vVGhpcyBjYW4ndCBiZSBhbiBvcHRpb24gd2l0aG91dCBzbG93aW5nIHRoZSBzaGFkZXIgZG93bg0KLy9Db21tZW50IHRoaXMgb3V0IGZvciBhIGNvYXJzZXIgMyBwaXhlbCBtYXNrLi4ud2hpY2ggaXMgY3VycmVudGx5IGJyb2tlbg0KLy9vbiBTTkVTIENsYXNzaWMgRWRpdGlvbiBkdWUgdG8gTWFsaSA0MDAgZ3B1IHByZWNpc2lvbg0KI2RlZmluZSBGSU5FTUFTSw0KLy9Tb21lIGRyaXZlcnMgZG9uJ3QgcmV0dXJuIGJsYWNrIHdpdGggdGV4dHVyZSBjb29yZGluYXRlcyBvdXQgb2YgYm91bmRzDQovL1NORVMgQ2xhc3NpYyBpcyB0b28gc2xvdyB0byBibGFjayB0aGVzZSBhcmVhcyBvdXQgd2hlbiB1c2luZyBmdWxsc2NyZWVuDQovL292ZXJsYXlzLiAgQnV0IHlvdSBjYW4gdW5jb21tZW50IHRoZSBiZWxvdyB0byBibGFjayB0aGVtIG91dCBpZiBuZWNlc3NhcnkNCi8vI2RlZmluZSBCTEFDS19PVVRfQk9SREVSDQoNCi8vIFBhcmFtZXRlciBsaW5lcyBnbyBoZXJlOg0KI3ByYWdtYSBwYXJhbWV0ZXIgQkxVUlNDQUxFWCAiQmx1ciBBbW91bnQgWC1BeGlzIiAwLjMwIDAuMCAxLjAgMC4wNQ0KI3ByYWdtYSBwYXJhbWV0ZXIgTE9XTFVNU0NBTiAiU2NhbmxpbmUgRGFya25lc3MgLSBMb3ciIDYuMCAwLjAgMTAuMCAwLjUNCiNwcmFnbWEgcGFyYW1ldGVyIEhJTFVNU0NBTiAiU2NhbmxpbmUgRGFya25lc3MgLSBIaWdoIiA4LjAgMC4wIDUwLjAgMS4wDQojcHJhZ21hIHBhcmFtZXRlciBCUklHSFRCT09TVCAiRGFyayBQaXhlbCBCcmlnaHRuZXNzIEJvb3N0IiAxLjI1IDAuNSAxLjUgMC4wNQ0KI3ByYWdtYSBwYXJhbWV0ZXIgTUFTS19EQVJLICJNYXNrIEVmZmVjdCBBbW91bnQiIDAuMjUgMC4wIDEuMCAwLjA1DQojcHJhZ21hIHBhcmFtZXRlciBNQVNLX0ZBREUgIk1hc2svU2NhbmxpbmUgRmFkZSIgMC44IDAuMCAxLjAgMC4wNQ0KDQojaWYgZGVmaW5lZChWRVJURVgpDQoNCiNpZiBfX1ZFUlNJT05fXyA+PSAxMzANCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgb3V0DQojZGVmaW5lIENPTVBBVF9BVFRSSUJVVEUgaW4NCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZQ0KI2Vsc2UNCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgdmFyeWluZyANCiNkZWZpbmUgQ09NUEFUX0FUVFJJQlVURSBhdHRyaWJ1dGUgDQojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUyRA0KI2VuZGlmDQoNCiNpZmRlZiBHTF9FUw0KI2RlZmluZSBDT01QQVRfUFJFQ0lTSU9OIG1lZGl1bXANCiNlbHNlDQojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04NCiNlbmRpZg0KDQpDT01QQVRfQVRUUklCVVRFIHZlYzQgVmVydGV4Q29vcmQ7DQpDT01QQVRfQVRUUklCVVRFIHZlYzQgQ09MT1I7DQpDT01QQVRfQVRUUklCVVRFIHZlYzQgVGV4Q29vcmQ7DQpDT01QQVRfVkFSWUlORyB2ZWM0IENPTDA7DQpDT01QQVRfVkFSWUlORyB2ZWM0IFRFWDA7DQpDT01QQVRfVkFSWUlORyBmbG9hdCBtYXNrRmFkZTsNCkNPTVBBVF9WQVJZSU5HIHZlYzIgaW52RGltczsNCg0KdmVjNCBfb1Bvc2l0aW9uMTsgDQp1bmlmb3JtIG1hdDQgTVZQTWF0cml4Ow0KdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZURpcmVjdGlvbjsNCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVDb3VudDsNCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIE91dHB1dFNpemU7DQp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBUZXh0dXJlU2l6ZTsNCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIElucHV0U2l6ZTsNCg0KLy8gY29tcGF0aWJpbGl0eSAjZGVmaW5lcw0KI2RlZmluZSB2VGV4Q29vcmQgVEVYMC54eQ0KI2RlZmluZSBTb3VyY2VTaXplIHZlYzQoVGV4dHVyZVNpemUsIDEuMCAvIFRleHR1cmVTaXplKSAvL2VpdGhlciBUZXh0dXJlU2l6ZSBvciBJbnB1dFNpemUNCiNkZWZpbmUgT3V0U2l6ZSB2ZWM0KE91dHB1dFNpemUsIDEuMCAvIE91dHB1dFNpemUpDQoNCiNpZmRlZiBQQVJBTUVURVJfVU5JRk9STQ0KLy8gQWxsIHBhcmFtZXRlciBmbG9hdHMgbmVlZCB0byBoYXZlIENPTVBBVF9QUkVDSVNJT04gaW4gZnJvbnQgb2YgdGhlbQ0KdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IEJMVVJTQ0FMRVg7DQovL3VuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBCTFVSU0NBTEVZOw0KdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IExPV0xVTVNDQU47DQp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgSElMVU1TQ0FOOw0KdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IEJSSUdIVEJPT1NUOw0KdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IE1BU0tfREFSSzsNCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBNQVNLX0ZBREU7DQojZWxzZQ0KI2RlZmluZSBCTFVSU0NBTEVYIDAuNDUNCi8vI2RlZmluZSBCTFVSU0NBTEVZIDAuMjANCiNkZWZpbmUgTE9XTFVNU0NBTiA1LjANCiNkZWZpbmUgSElMVU1TQ0FOIDEwLjANCiNkZWZpbmUgQlJJR0hUQk9PU1QgMS4yNQ0KI2RlZmluZSBNQVNLX0RBUksgMC4yNQ0KI2RlZmluZSBNQVNLX0ZBREUgMC44DQojZW5kaWYNCg0Kdm9pZCBtYWluKCkNCnsNCiAgICBnbF9Qb3NpdGlvbiA9IE1WUE1hdHJpeCAqIFZlcnRleENvb3JkOw0KCQ0KCVRFWDAueHkgPSBUZXhDb29yZC54eSoxLjAwMDE7DQoJbWFza0ZhZGUgPSAwLjMzMzMqTUFTS19GQURFOw0KCWludkRpbXMgPSAxLjAvVGV4dHVyZVNpemUueHk7DQp9DQoNCiNlbGlmIGRlZmluZWQoRlJBR01FTlQpDQoNCiNpZmRlZiBHTF9FUw0KI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdIDQpwcmVjaXNpb24gaGlnaHAgZmxvYXQ7DQojZWxzZQ0KcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7DQojZW5kaWYNCiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTiBtZWRpdW1wDQojZWxzZQ0KI2RlZmluZSBDT01QQVRfUFJFQ0lTSU9ODQojZW5kaWYNCg0KI2lmIF9fVkVSU0lPTl9fID49IDEzMA0KI2RlZmluZSBDT01QQVRfVkFSWUlORyBpbg0KI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlDQpvdXQgQ09NUEFUX1BSRUNJU0lPTiB2ZWM0IEZyYWdDb2xvcjsNCiNlbHNlDQojZGVmaW5lIENPTVBBVF9WQVJZSU5HIHZhcnlpbmcNCiNkZWZpbmUgRnJhZ0NvbG9yIGdsX0ZyYWdDb2xvcg0KI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlMkQNCiNlbmRpZg0KDQp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lRGlyZWN0aW9uOw0KdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZUNvdW50Ow0KdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgT3V0cHV0U2l6ZTsNCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIFRleHR1cmVTaXplOw0KdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgSW5wdXRTaXplOw0KdW5pZm9ybSBzYW1wbGVyMkQgVGV4dHVyZTsNCkNPTVBBVF9WQVJZSU5HIHZlYzQgVEVYMDsNCkNPTVBBVF9WQVJZSU5HIGZsb2F0IG1hc2tGYWRlOw0KQ09NUEFUX1ZBUllJTkcgdmVjMiBpbnZEaW1zOw0KDQovLyBjb21wYXRpYmlsaXR5ICNkZWZpbmVzDQojZGVmaW5lIFNvdXJjZSBUZXh0dXJlDQojZGVmaW5lIHZUZXhDb29yZCBURVgwLnh5DQojZGVmaW5lIHRleHR1cmUoYywgZCkgQ09NUEFUX1RFWFRVUkUoYywgZCkNCiNkZWZpbmUgU291cmNlU2l6ZSB2ZWM0KFRleHR1cmVTaXplLCAxLjAgLyBUZXh0dXJlU2l6ZSkgLy9laXRoZXIgVGV4dHVyZVNpemUgb3IgSW5wdXRTaXplDQojZGVmaW5lIE91dFNpemUgdmVjNChPdXRwdXRTaXplLCAxLjAgLyBPdXRwdXRTaXplKQ0KDQojaWZkZWYgUEFSQU1FVEVSX1VOSUZPUk0NCi8vIEFsbCBwYXJhbWV0ZXIgZmxvYXRzIG5lZWQgdG8gaGF2ZSBDT01QQVRfUFJFQ0lTSU9OIGluIGZyb250IG9mIHRoZW0NCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBCTFVSU0NBTEVYOw0KLy91bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgQkxVUlNDQUxFWTsNCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBMT1dMVU1TQ0FOOw0KdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGZsb2F0IEhJTFVNU0NBTjsNCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBCUklHSFRCT09TVDsNCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBNQVNLX0RBUks7DQp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgTUFTS19GQURFOw0KI2Vsc2UNCiNkZWZpbmUgQkxVUlNDQUxFWCAwLjQ1DQovLyNkZWZpbmUgQkxVUlNDQUxFWSAwLjIwDQojZGVmaW5lIExPV0xVTVNDQU4gNS4wDQojZGVmaW5lIEhJTFVNU0NBTiAxMC4wDQojZGVmaW5lIEJSSUdIVEJPT1NUIDEuMjUNCiNkZWZpbmUgTUFTS19EQVJLIDAuMjUNCiNkZWZpbmUgTUFTS19GQURFIDAuOA0KI2VuZGlmDQoNCnZvaWQgbWFpbigpDQp7DQoNCgkvL1RoaXMgaXMganVzdCBsaWtlICJRdWlsZXogU2NhbGluZyIgYnV0IHNoYXJwZXINCglDT01QQVRfUFJFQ0lTSU9OIHZlYzIgcCA9IHZUZXhDb29yZCAqIFRleHR1cmVTaXplOw0KCUNPTVBBVF9QUkVDSVNJT04gdmVjMiBpID0gZmxvb3IocCkgKyAwLjUwOw0KCUNPTVBBVF9QUkVDSVNJT04gdmVjMiBmID0gcCAtIGk7DQoJcCA9IChpICsgNC4wKmYqZipmKSppbnZEaW1zOw0KCXAueCA9IG1peCggcC54ICwgdlRleENvb3JkLngsIEJMVVJTQ0FMRVgpOw0KCUNPTVBBVF9QUkVDSVNJT04gZmxvYXQgWSA9IGYueSpmLnk7DQoJQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBZWSA9IFkqWTsNCiNkZWZpbmUgcmF0aW8gU291cmNlU2l6ZS54L0lucHV0U2l6ZS54CQ0KI2lmIGRlZmluZWQoRklORU1BU0spIA0KCUNPTVBBVF9QUkVDSVNJT04gZmxvYXQgd2hpY2htYXNrID0gZmxvb3IodlRleENvb3JkLngqT3V0cHV0U2l6ZS54KnJhdGlvKSotMC41Ow0KCUNPTVBBVF9QUkVDSVNJT04gZmxvYXQgbWFzayA9IDEuMCArIGZsb2F0KGZyYWN0KHdoaWNobWFzaykgPCAwLjUpICogLU1BU0tfREFSSzsNCiNlbHNlDQoJQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCB3aGljaG1hc2sgPSBmbG9vcih2VGV4Q29vcmQueCpPdXRwdXRTaXplLngqcmF0aW8pKi0wLjMzMzM7DQoJQ09NUEFUX1BSRUNJU0lPTiBmbG9hdCBtYXNrID0gMS4wICsgZmxvYXQoZnJhY3Qod2hpY2htYXNrKSA8IDAuMzMzMykgKiAtTUFTS19EQVJLOw0KI2VuZGlmDQoJQ09NUEFUX1BSRUNJU0lPTiB2ZWMzIGNvbG91ciA9IENPTVBBVF9URVhUVVJFKFNvdXJjZSwgcCkucmdiOw0KCQ0KCUNPTVBBVF9QUkVDSVNJT04gZmxvYXQgc2NhbkxpbmVXZWlnaHQgPSAoQlJJR0hUQk9PU1QgLSBMT1dMVU1TQ0FOKihZIC0gMi4wNSpZWSkpOw0KCUNPTVBBVF9QUkVDSVNJT04gZmxvYXQgc2NhbkxpbmVXZWlnaHRCID0gMS4wIC0gSElMVU1TQ0FOKihZWS0yLjgqWVkqWSk7CQ0KCQ0KI2lmIGRlZmluZWQoQkxBQ0tfT1VUX0JPUkRFUikNCgljb2xvdXIucmdiKj1mbG9hdCh0Yy54ID4gMC4wKSpmbG9hdCh0Yy55ID4gMC4wKTsgLy93aHkgZG9lc24ndCB0aGUgZHJpdmVyIGRvIHRoZSByaWdodCB0aGluZz8NCiNlbmRpZg0KDQoJRnJhZ0NvbG9yLnJnYmEgPSB2ZWM0KGNvbG91ci5yZ2IqbWl4KHNjYW5MaW5lV2VpZ2h0Km1hc2ssIHNjYW5MaW5lV2VpZ2h0QiwgZG90KGNvbG91ci5yZ2IsdmVjMyhtYXNrRmFkZSkpKSwxLjApOw0KCQ0KfSANCiNlbmRpZg0K"}]},"crt-yeetron":{shader:{type:"text",value:"shaders = 1\n\nshader0 = yeetron.glsl\nfilter_linear0 = false\n"},resources:[{name:"yeetron.glsl",type:"base64",value:"Ly8gcG9ydGVkIGZyb20gUmVTaGFkZQoKI2lmIGRlZmluZWQoVkVSVEVYKQoKI2lmIF9fVkVSU0lPTl9fID49IDEzMAojZGVmaW5lIENPTVBBVF9WQVJZSU5HIG91dAojZGVmaW5lIENPTVBBVF9BVFRSSUJVVEUgaW4KI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlCiNlbHNlCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgdmFyeWluZyAKI2RlZmluZSBDT01QQVRfQVRUUklCVVRFIGF0dHJpYnV0ZSAKI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlMkQKI2VuZGlmCgojaWZkZWYgR0xfRVMKI2RlZmluZSBDT01QQVRfUFJFQ0lTSU9OIG1lZGl1bXAKI2Vsc2UKI2RlZmluZSBDT01QQVRfUFJFQ0lTSU9OCiNlbmRpZgoKQ09NUEFUX0FUVFJJQlVURSB2ZWM0IFZlcnRleENvb3JkOwpDT01QQVRfQVRUUklCVVRFIHZlYzQgQ09MT1I7CkNPTVBBVF9BVFRSSUJVVEUgdmVjNCBUZXhDb29yZDsKQ09NUEFUX1ZBUllJTkcgdmVjNCBDT0wwOwpDT01QQVRfVkFSWUlORyB2ZWM0IFRFWDA7Cgp2ZWM0IF9vUG9zaXRpb24xOyAKdW5pZm9ybSBtYXQ0IE1WUE1hdHJpeDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZURpcmVjdGlvbjsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZUNvdW50Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBPdXRwdXRTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBUZXh0dXJlU2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgSW5wdXRTaXplOwoKLy8gY29tcGF0aWJpbGl0eSAjZGVmaW5lcwojZGVmaW5lIHZUZXhDb29yZCBURVgwLnh5CiNkZWZpbmUgU291cmNlU2l6ZSB2ZWM0KFRleHR1cmVTaXplLCAxLjAgLyBUZXh0dXJlU2l6ZSkgLy9laXRoZXIgVGV4dHVyZVNpemUgb3IgSW5wdXRTaXplCiNkZWZpbmUgT3V0U2l6ZSB2ZWM0KE91dHB1dFNpemUsIDEuMCAvIE91dHB1dFNpemUpCgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IE1WUE1hdHJpeCAqIFZlcnRleENvb3JkOwogICAgVEVYMC54eSA9IFRleENvb3JkLnh5Owp9CgojZWxpZiBkZWZpbmVkKEZSQUdNRU5UKQoKI2lmZGVmIEdMX0VTCiNpZmRlZiBHTF9GUkFHTUVOVF9QUkVDSVNJT05fSElHSApwcmVjaXNpb24gaGlnaHAgZmxvYXQ7CiNlbHNlCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwojZW5kaWYKI2RlZmluZSBDT01QQVRfUFJFQ0lTSU9OIG1lZGl1bXAKI2Vsc2UKI2RlZmluZSBDT01QQVRfUFJFQ0lTSU9OCiNlbmRpZgoKI2lmIF9fVkVSU0lPTl9fID49IDEzMAojZGVmaW5lIENPTVBBVF9WQVJZSU5HIGluCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZQpvdXQgQ09NUEFUX1BSRUNJU0lPTiB2ZWM0IEZyYWdDb2xvcjsKI2Vsc2UKI2RlZmluZSBDT01QQVRfVkFSWUlORyB2YXJ5aW5nCiNkZWZpbmUgRnJhZ0NvbG9yIGdsX0ZyYWdDb2xvcgojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUyRAojZW5kaWYKCnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVEaXJlY3Rpb247CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVDb3VudDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgT3V0cHV0U2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgVGV4dHVyZVNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIElucHV0U2l6ZTsKdW5pZm9ybSBzYW1wbGVyMkQgVGV4dHVyZTsKQ09NUEFUX1ZBUllJTkcgdmVjNCBURVgwOwoKLy8gY29tcGF0aWJpbGl0eSAjZGVmaW5lcwojZGVmaW5lIFNvdXJjZSBUZXh0dXJlCiNkZWZpbmUgdlRleENvb3JkIFRFWDAueHkKCiNkZWZpbmUgU291cmNlU2l6ZSB2ZWM0KFRleHR1cmVTaXplLCAxLjAgLyBUZXh0dXJlU2l6ZSkgLy9laXRoZXIgVGV4dHVyZVNpemUgb3IgSW5wdXRTaXplCiNkZWZpbmUgT3V0U2l6ZSB2ZWM0KE91dHB1dFNpemUsIDEuMCAvIE91dHB1dFNpemUpCgp2ZWM0IGNtcCh2ZWM0IHNyYzAsIHZlYzQgc3JjMSwgdmVjNCBzcmMyKSB7CglyZXR1cm4gdmVjNCgKCQlzcmMwLnggPj0gMC4wID8gc3JjMS54IDogc3JjMi54LAoJCXNyYzAueSA+PSAwLjAgPyBzcmMxLnkgOiBzcmMyLnksCgkJc3JjMC56ID49IDAuMCA/IHNyYzEueiA6IHNyYzIueiwKCQlzcmMwLncgPj0gMC4wID8gc3JjMS53IDogc3JjMi53CgkpOwp9CgojZGVmaW5lIHNhdHVyYXRlKGMpIGNsYW1wKGMsIDAuMCwgMS4wKQoKdm9pZCBtYWluKCkKewoJLy9EZWNsYXJlIHBhcmFtZXRlcnMKCS8vcGl4ZWxTaXplCgl2ZWM0IGMwID0gSW5wdXRTaXplLnh5eXk7CgkvL3RleHR1cmVTaXplCgl2ZWM0IGMxID0gU291cmNlU2l6ZTsKCS8vdmlld1NpemUKCXZlYzQgYzIgPSBPdXRTaXplOwogICAKCS8vRGVjbGFyZSBjb25zdGFudHMKCWNvbnN0IHZlYzQgYzMgPSB2ZWM0KDEuNSwgMC44MDAwMDAwMTIsIDEuMjUsIDAuNzUpOwoJY29uc3QgdmVjNCBjNCA9IHZlYzQoNi4yODMxODU0OCwgLTMuMTQxNTkyNzQsIDAuMjUsIC0wLjI1KTsKCWNvbnN0IHZlYzQgYzUgPSB2ZWM0KDEuLCAwLjUsIDcyMC4sIDMuKTsKCWNvbnN0IHZlYzQgYzYgPSB2ZWM0KDAuMTY2NjY2NjcyLCAtMC4zMzMwMDAwMDQsIC0wLjY2NjAwMDAwOSwgMC44OTk5OTk5NzYpOwoJY29uc3QgdmVjNCBjNyA9IHZlYzQoMC44OTk5OTk5NzYsIDEuMTAwMDAwMDIsIDAuLCAwLik7Cgljb25zdCB2ZWM0IGM4ID0gdmVjNCgtMC41LCAtMC4yNSwgMi4sIDAuNSk7CgoJLy9EZWNsYXJlIHJlZ2lzdGVycwoJdmVjNCByMCwgcjEsIHIyLCByMywgcjQsIHI1LCByNiwgcjcsIHI4LCByOTsKCgkvL0NvZGUgc3RhcnRzIGhlcmUKCXZlYzQgdjAgPSB2VGV4Q29vcmQueHl5eTsKCS8vZGNsXzJkIHMwCglyMC54ID0gMS4wIC8gYzAueDsKCXIwLnkgPSAxLjAgLyBjMC55OwoJcjAueHkgPSAocjAgKiBjMSkueHk7CglyMC54eSA9IChyMCAqIHYwKS54eTsKCXIwLnh5ID0gKHIwICogYzIpLnh5OwoJcjAuencgPSBmcmFjdChyMC54eXh5KS56dzsKCXIwLnh5ID0gKC1yMC56d3p3ICsgcjApLnh5OwoJcjAueHkgPSAocjAgKyBjOC53d3d3KS54eTsKCXIwLnggPSByMC55ICogYzUudyArIHIwLng7CglyMC54ID0gcjAueCAqIGM2Lng7CglyMC54ID0gZnJhY3QocjAueCk7CglyMC54eSA9IChyMC54eHh4ICsgYzYueXp6dykueHk7CglyMS55eiA9IChyMC55ID49IDAuMCA/IGM3Lnh4eXcgOiBjNy54eXh3KS55ejsKCXIxLnggPSBjNi53OwoJcjAueHl6ID0gKHIwLnggPj0gMC4wID8gcjEgOiBjNy55eHh3KS54eXo7CglyMS54eSA9IChjMSAqIHYwKS54eTsKCXIwLncgPSByMS55ICogYzgudyArIGM4Lnc7CglyMC53ID0gZnJhY3QocjAudyk7CglyMC53ID0gcjAudyAqIGM0LnggKyBjNC55OwoJcjIueSA9IHNpbihyMC53KTsKCXIxLnp3ID0gKGFicyhyMikueXl5eSArIGM0KS56dzsKCXIxLnogPSBjbGFtcChyMS56LCAwLjAsIDEuMCk7CglyMC53ID0gcjEudyA+PSAwLjAgPyByMS56IDogYzgudzsKCXIyID0gZnJhY3QocjEueHl4eSk7CglyMS54eSA9IChyMSArIC1yMi56d3p3KS54eTsKCXIyID0gcjIgKyBjOC54eHl5OwoJcjEuencgPSAocjEueHl4eSArIGM4Lnd3d3cpLnp3OwoJcjEuencgPSAodjAueHl4eSAqIC1jMS54eXh5ICsgcjEpLnp3OwoJcjEudyA9IHIxLncgKyByMS53OwoJcjEueiA9IHIxLnogKiBjOC53OwoJcjEueiA9IC1hYnMocjEpLnogKyBjMy54OwoJcjMueCA9IG1heChjMy55LCByMS56KTsKCXI0LnggPSBtaW4ocjMueCwgYzMueik7CglyMS56dyA9ICgtYWJzKHIxKS53d3d3ICsgYzMpLnp3OwoJcjEueiA9IGNsYW1wKHIxLnosIDAuMCwgMS4wKTsKCXIxLnogPSByMS53ID49IDAuMCA/IHIxLnogOiBjOC53OwoJcjQueSA9IHIwLncgKyByMS56OwoJcjAudyA9IHIwLncgKiByNC54OwoJcjEueiA9IHIxLnogKiByNC54OwoJcjMueHkgPSAocjQgKiBjNSkueHk7CglyMS53ID0gcjMueSAqIHIzLng7CglyMi56ID0gY21wKHIyLCByMi54eXh5LCBjOC55eXl5KS56OwoJcjMueHkgPSBtYXgoYzgueXl5eSwgLXIyLnp3encpLnh5OwoJcjIueHkgPSAocjIgKyByMykueHk7CglyMS54eSA9IChyMiAqIGM4Lnp6enogKyByMSkueHk7CglyMS54eSA9IChyMSArIGM4Lnd3d3cpLnh5OwoJcjIueCA9IDEuMCAvIGMxLng7CglyMi55ID0gMS4wIC8gYzEueTsKCXIxLnh5ID0gKHIxICogcjIpLnh5OwoJcjIgPSBDT01QQVRfVEVYVFVSRShTb3VyY2UsIHIxLnh5KTsKCXIzLnggPSByMC53ICogcjIueDsKCXIzLnl6ID0gKHIxLnh6d3cgKiByMikueXo7CglGcmFnQ29sb3IudyA9IHIyLnc7CglyMC54eXogPSAocjAgKiByMykueHl6OwoJcjEueiA9IGM1Lno7CglyMC53ID0gcjEueiArIC1jMi55OwoJRnJhZ0NvbG9yLnh5eiA9IChyMC53ID49IDAuMCA/IHIzIDogcjApLnh5ejsKfSAKI2VuZGlmCg=="}]},bicubic:{shader:{type:"text",value:"shaders = 1\n\nshader0 = bicubic.glsl\nfilter_linear0 = false"},resources:[{name:"bicubic.glsl",type:"base64",value:"Ly8gRGVmYXVsdCB0byBNaXRjaGVsLU5ldHJhdmFsaSBjb2VmZmljaWVudHMgZm9yIGJlc3QgcHN5Y2hvdmlzdWFsIHJlc3VsdAovLyBiaWN1YmljLXNoYXJwIGlzIEIgPSAwLjEgYW5kIEMgPSAwLjUKLy8gYmljdWJpYy1zaGFycGVyIGlzIEIgPSAwLjAgYW5kIEMgPSAwLjc1CiNwcmFnbWEgcGFyYW1ldGVyIEIgIkJpY3ViaWMgQ29lZmYgQiIgMC4zMyAwLjAgMS4wIDAuMDEKI3ByYWdtYSBwYXJhbWV0ZXIgQyAiQmljdWJpYyBDb2VmZiBDIiAwLjMzIDAuMCAxLjAgMC4wMQoKI2lmIGRlZmluZWQoVkVSVEVYKQoKI2lmIF9fVkVSU0lPTl9fID49IDEzMAojZGVmaW5lIENPTVBBVF9WQVJZSU5HIG91dAojZGVmaW5lIENPTVBBVF9BVFRSSUJVVEUgaW4KI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlCiNlbHNlCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgdmFyeWluZyAKI2RlZmluZSBDT01QQVRfQVRUUklCVVRFIGF0dHJpYnV0ZSAKI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlMkQKI2VuZGlmCgojaWZkZWYgR0xfRVMKI2RlZmluZSBDT01QQVRfUFJFQ0lTSU9OIG1lZGl1bXAKI2Vsc2UKI2RlZmluZSBDT01QQVRfUFJFQ0lTSU9OCiNlbmRpZgoKQ09NUEFUX0FUVFJJQlVURSB2ZWM0IFZlcnRleENvb3JkOwpDT01QQVRfQVRUUklCVVRFIHZlYzQgVGV4Q29vcmQ7CkNPTVBBVF9WQVJZSU5HIHZlYzQgVEVYMDsKCnVuaWZvcm0gbWF0NCBNVlBNYXRyaXg7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVEaXJlY3Rpb247CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVDb3VudDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgT3V0cHV0U2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgVGV4dHVyZVNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIElucHV0U2l6ZTsKCi8vIGNvbXBhdGliaWxpdHkgI2RlZmluZXMKI2RlZmluZSB2VGV4Q29vcmQgVEVYMC54eQojZGVmaW5lIFNvdXJjZVNpemUgdmVjNChUZXh0dXJlU2l6ZSwgMS4wIC8gVGV4dHVyZVNpemUpIC8vZWl0aGVyIFRleHR1cmVTaXplIG9yIElucHV0U2l6ZQojZGVmaW5lIE91dFNpemUgdmVjNChPdXRwdXRTaXplLCAxLjAgLyBPdXRwdXRTaXplKQoKdm9pZCBtYWluKCkKewogICBnbF9Qb3NpdGlvbiA9IE1WUE1hdHJpeCAqIFZlcnRleENvb3JkOwogICBURVgwLnh5ID0gVGV4Q29vcmQueHk7Cn0KCiNlbGlmIGRlZmluZWQoRlJBR01FTlQpCgojaWZkZWYgR0xfRVMKI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdICnByZWNpc2lvbiBoaWdocCBmbG9hdDsKI2Vsc2UKcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CiNlbmRpZgojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04gbWVkaXVtcAojZWxzZQojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04KI2VuZGlmCgojaWYgX19WRVJTSU9OX18gPj0gMTMwCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgaW4KI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlCm91dCBDT01QQVRfUFJFQ0lTSU9OIHZlYzQgRnJhZ0NvbG9yOwojZWxzZQojZGVmaW5lIENPTVBBVF9WQVJZSU5HIHZhcnlpbmcKI2RlZmluZSBGcmFnQ29sb3IgZ2xfRnJhZ0NvbG9yCiNkZWZpbmUgQ09NUEFUX1RFWFRVUkUgdGV4dHVyZTJECiNlbmRpZgoKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZURpcmVjdGlvbjsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIGludCBGcmFtZUNvdW50Owp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBPdXRwdXRTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBUZXh0dXJlU2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgSW5wdXRTaXplOwp1bmlmb3JtIHNhbXBsZXIyRCBUZXh0dXJlOwpDT01QQVRfVkFSWUlORyB2ZWM0IFRFWDA7CgovLyBjb21wYXRpYmlsaXR5ICNkZWZpbmVzCiNkZWZpbmUgU291cmNlIFRleHR1cmUKI2RlZmluZSB2VGV4Q29vcmQgVEVYMC54eQoKI2RlZmluZSBTb3VyY2VTaXplIHZlYzQoVGV4dHVyZVNpemUsIDEuMCAvIFRleHR1cmVTaXplKSAvL2VpdGhlciBUZXh0dXJlU2l6ZSBvciBJbnB1dFNpemUKI2RlZmluZSBPdXRTaXplIHZlYzQoT3V0cHV0U2l6ZSwgMS4wIC8gT3V0cHV0U2l6ZSkKCiNpZmRlZiBQQVJBTUVURVJfVU5JRk9STQp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gZmxvYXQgQiwgQzsKI2Vsc2UKI2RlZmluZSBCIDAuMzMzMwojZGVmaW5lIEMgMC4zMzMzCiNlbmRpZgoKZmxvYXQgd2VpZ2h0KGZsb2F0IHgpCnsKCWZsb2F0IGF4ID0gYWJzKHgpOwoKCWlmIChheCA8IDEuMCkKCXsKCQlyZXR1cm4KCQkJKAoJCQkgcG93KHgsIDIuMCkgKiAoKDEyLjAgLSA5LjAgKiBCIC0gNi4wICogQykgKiBheCArICgtMTguMCArIDEyLjAgKiBCICsgNi4wICogQykpICsKCQkJICg2LjAgLSAyLjAgKiBCKQoJCQkpIC8gNi4wOwoJfQoJZWxzZSBpZiAoKGF4ID49IDEuMCkgJiYgKGF4IDwgMi4wKSkKCXsKCQlyZXR1cm4KCQkJKAoJCQkgcG93KHgsIDIuMCkgKiAoKC1CIC0gNi4wICogQykgKiBheCArICg2LjAgKiBCICsgMzAuMCAqIEMpKSArCgkJCSAoLTEyLjAgKiBCIC0gNDguMCAqIEMpICogYXggKyAoOC4wICogQiArIDI0LjAgKiBDKQoJCQkpIC8gNi4wOwoJfQoJZWxzZQoJewoJCXJldHVybiAwLjA7Cgl9Cn0KCQp2ZWM0IHdlaWdodDQoZmxvYXQgeCkKewoJcmV0dXJuIHZlYzQoCgkJCXdlaWdodCh4IC0gMi4wKSwKCQkJd2VpZ2h0KHggLSAxLjApLAoJCQl3ZWlnaHQoeCksCgkJCXdlaWdodCh4ICsgMS4wKSk7Cn0KCnZlYzMgcGl4ZWwoZmxvYXQgeHBvcywgZmxvYXQgeXBvcywgc2FtcGxlcjJEIHRleCkKewoJcmV0dXJuIENPTVBBVF9URVhUVVJFKHRleCwgdmVjMih4cG9zLCB5cG9zKSkucmdiOwp9Cgp2ZWMzIGxpbmVfcnVuKGZsb2F0IHlwb3MsIHZlYzQgeHBvcywgdmVjNCBsaW5ldGFwcywgc2FtcGxlcjJEIHRleCkKewoJcmV0dXJuCgkJcGl4ZWwoeHBvcy5yLCB5cG9zLCB0ZXgpICogbGluZXRhcHMuciArCgkJcGl4ZWwoeHBvcy5nLCB5cG9zLCB0ZXgpICogbGluZXRhcHMuZyArCgkJcGl4ZWwoeHBvcy5iLCB5cG9zLCB0ZXgpICogbGluZXRhcHMuYiArCgkJcGl4ZWwoeHBvcy5hLCB5cG9zLCB0ZXgpICogbGluZXRhcHMuYTsKfQoKdm9pZCBtYWluKCkKewogICAgICAgIHZlYzIgc3RlcHh5ID0gdmVjMigxLjAvU291cmNlU2l6ZS54LCAxLjAvU291cmNlU2l6ZS55KTsKICAgICAgICB2ZWMyIHBvcyA9IHZUZXhDb29yZC54eSArIHN0ZXB4eSAqIDAuNTsKICAgICAgICB2ZWMyIGYgPSBmcmFjdChwb3MgLyBzdGVweHkpOwoJCQoJdmVjNCBsaW5ldGFwcyAgID0gd2VpZ2h0NCgxLjAgLSBmLngpOwoJdmVjNCBjb2x1bW50YXBzID0gd2VpZ2h0NCgxLjAgLSBmLnkpOwoKCS8vbWFrZSBzdXJlIGFsbCB0YXBzIGFkZGVkIHRvZ2V0aGVyIGlzIGV4YWN0bHkgMS4wLCBvdGhlcndpc2Ugc29tZSAodmVyeSBzbWFsbCkgZGlzdG9ydGlvbiBjYW4gb2NjdXIKCWxpbmV0YXBzIC89IGxpbmV0YXBzLnIgKyBsaW5ldGFwcy5nICsgbGluZXRhcHMuYiArIGxpbmV0YXBzLmE7Cgljb2x1bW50YXBzIC89IGNvbHVtbnRhcHMuciArIGNvbHVtbnRhcHMuZyArIGNvbHVtbnRhcHMuYiArIGNvbHVtbnRhcHMuYTsKCgl2ZWMyIHh5c3RhcnQgPSAoLTEuNSAtIGYpICogc3RlcHh5ICsgcG9zOwoJdmVjNCB4cG9zID0gdmVjNCh4eXN0YXJ0LngsIHh5c3RhcnQueCArIHN0ZXB4eS54LCB4eXN0YXJ0LnggKyBzdGVweHkueCAqIDIuMCwgeHlzdGFydC54ICsgc3RlcHh5LnggKiAzLjApOwoKCi8vIGZpbmFsIHN1bSBhbmQgd2VpZ2h0IG5vcm1hbGl6YXRpb24KICAgdmVjNCBmaW5hbCA9IHZlYzQobGluZV9ydW4oeHlzdGFydC55ICAgICAgICAgICAgICAgICAsIHhwb3MsIGxpbmV0YXBzLCBTb3VyY2UpICogY29sdW1udGFwcy5yICsKICAgICAgICAgICAgICAgICAgICAgIGxpbmVfcnVuKHh5c3RhcnQueSArIHN0ZXB4eS55ICAgICAgLCB4cG9zLCBsaW5ldGFwcywgU291cmNlKSAqIGNvbHVtbnRhcHMuZyArCiAgICAgICAgICAgICAgICAgICAgICBsaW5lX3J1bih4eXN0YXJ0LnkgKyBzdGVweHkueSAqIDIuMCwgeHBvcywgbGluZXRhcHMsIFNvdXJjZSkgKiBjb2x1bW50YXBzLmIgKwogICAgICAgICAgICAgICAgICAgICAgbGluZV9ydW4oeHlzdGFydC55ICsgc3RlcHh5LnkgKiAzLjAsIHhwb3MsIGxpbmV0YXBzLCBTb3VyY2UpICogY29sdW1udGFwcy5hLDEpOwoKICAgRnJhZ0NvbG9yID0gZmluYWw7Cn0gCiNlbmRpZgo=\n"}]},"mix-frames":{shader:{type:"text",value:'shaders = "1"\n\nshader0 = "mix_frames.glsl"\nfilter_linear0 = "false"\n'},resources:[{name:"mix_frames.glsl",type:"base64",value:"LyoKCW1peF9mcmFtZXMgLSBwZXJmb3JtcyA1MDo1MCBibGVuZGluZyBiZXR3ZWVuIHRoZSBjdXJyZW50IGFuZCBwcmV2aW91cwoJZnJhbWVzLgoJCglBdXRob3I6IGpkZ2xlYXZlcgoJCglUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdAoJdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUKCVNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikKCWFueSBsYXRlciB2ZXJzaW9uLgoqLwoKI2lmIGRlZmluZWQoVkVSVEVYKQoKI2lmIF9fVkVSU0lPTl9fID49IDEzMAojZGVmaW5lIENPTVBBVF9WQVJZSU5HIG91dAojZGVmaW5lIENPTVBBVF9BVFRSSUJVVEUgaW4KI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlCiNlbHNlCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgdmFyeWluZyAKI2RlZmluZSBDT01QQVRfQVRUUklCVVRFIGF0dHJpYnV0ZSAKI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlMkQKI2VuZGlmCgojaWZkZWYgR0xfRVMKI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdICiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTiBoaWdocAojZWxzZQojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04gbWVkaXVtcAojZW5kaWYKI2Vsc2UKI2RlZmluZSBDT01QQVRfUFJFQ0lTSU9OCiNlbmRpZgoKLyogQ09NUEFUSUJJTElUWQogICAtIEdMU0wgY29tcGlsZXJzCiovCgpDT01QQVRfQVRUUklCVVRFIENPTVBBVF9QUkVDSVNJT04gdmVjNCBWZXJ0ZXhDb29yZDsKQ09NUEFUX0FUVFJJQlVURSBDT01QQVRfUFJFQ0lTSU9OIHZlYzQgQ09MT1I7CkNPTVBBVF9BVFRSSUJVVEUgQ09NUEFUX1BSRUNJU0lPTiB2ZWM0IFRleENvb3JkOwpDT01QQVRfVkFSWUlORyBDT01QQVRfUFJFQ0lTSU9OIHZlYzQgQ09MMDsKQ09NUEFUX1ZBUllJTkcgQ09NUEFUX1BSRUNJU0lPTiB2ZWM0IFRFWDA7CgpDT01QQVRfUFJFQ0lTSU9OIHZlYzQgX29Qb3NpdGlvbjE7IAp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gbWF0NCBNVlBNYXRyaXg7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVEaXJlY3Rpb247CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiBpbnQgRnJhbWVDb3VudDsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgT3V0cHV0U2l6ZTsKdW5pZm9ybSBDT01QQVRfUFJFQ0lTSU9OIHZlYzIgVGV4dHVyZVNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIElucHV0U2l6ZTsKCnZvaWQgbWFpbigpCnsKCVRFWDAgPSBUZXhDb29yZCAqIDEuMDAwMTsKCWdsX1Bvc2l0aW9uID0gTVZQTWF0cml4ICogVmVydGV4Q29vcmQ7Cn0KCiNlbGlmIGRlZmluZWQoRlJBR01FTlQpCgojaWYgX19WRVJTSU9OX18gPj0gMTMwCiNkZWZpbmUgQ09NUEFUX1ZBUllJTkcgaW4KI2RlZmluZSBDT01QQVRfVEVYVFVSRSB0ZXh0dXJlCm91dCB2ZWM0IEZyYWdDb2xvcjsKI2Vsc2UKI2RlZmluZSBDT01QQVRfVkFSWUlORyB2YXJ5aW5nCiNkZWZpbmUgRnJhZ0NvbG9yIGdsX0ZyYWdDb2xvcgojZGVmaW5lIENPTVBBVF9URVhUVVJFIHRleHR1cmUyRAojZW5kaWYKCiNpZmRlZiBHTF9FUwojaWZkZWYgR0xfRlJBR01FTlRfUFJFQ0lTSU9OX0hJR0gKcHJlY2lzaW9uIGhpZ2hwIGZsb2F0OwojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04gaGlnaHAKI2Vsc2UKcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CiNkZWZpbmUgQ09NUEFUX1BSRUNJU0lPTiBtZWRpdW1wCiNlbmRpZgojZWxzZQojZGVmaW5lIENPTVBBVF9QUkVDSVNJT04KI2VuZGlmCgp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lRGlyZWN0aW9uOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gaW50IEZyYW1lQ291bnQ7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIE91dHB1dFNpemU7CnVuaWZvcm0gQ09NUEFUX1BSRUNJU0lPTiB2ZWMyIFRleHR1cmVTaXplOwp1bmlmb3JtIENPTVBBVF9QUkVDSVNJT04gdmVjMiBJbnB1dFNpemU7CnVuaWZvcm0gc2FtcGxlcjJEIFRleHR1cmU7CnVuaWZvcm0gc2FtcGxlcjJEIFByZXZUZXh0dXJlOwpDT01QQVRfVkFSWUlORyBDT01QQVRfUFJFQ0lTSU9OIHZlYzQgVEVYMDsKCnZvaWQgbWFpbigpCnsKCS8vIEdldCBjb2xvdXIgb2YgY3VycmVudCBwaXhlbAoJQ09NUEFUX1BSRUNJU0lPTiB2ZWMzIGNvbG91ciA9IENPTVBBVF9URVhUVVJFKFRleHR1cmUsIFRFWDAueHkpLnJnYjsKCQoJLy8gR2V0IGNvbG91ciBvZiBwcmV2aW91cyBwaXhlbAoJQ09NUEFUX1BSRUNJU0lPTiB2ZWMzIGNvbG91clByZXYgPSBDT01QQVRfVEVYVFVSRShQcmV2VGV4dHVyZSwgVEVYMC54eSkucmdiOwoJCgkvLyBNaXggY29sb3VycwoJY29sb3VyLnJnYiA9IG1peChjb2xvdXIucmdiLCBjb2xvdXJQcmV2LnJnYiwgMC41KTsKCQoJZ2xfRnJhZ0NvbG9yID0gdmVjNChjb2xvdXIucmdiLCAxLjApOwp9CiNlbmRpZgo="}]}},function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).io=t()}(this,(function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function i(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function n(t,i){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,i){if(t){if("string"==typeof t)return e(t,i);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,i):void 0}}(t))||i&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw s}}}}function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)({}).hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o.apply(null,arguments)}function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(a=function(){return!!e})()}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function c(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function u(e){var t="function"==typeof Map?new Map:void 0;return u=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return function(e,t,i){if(a())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return i&&l(o,i.prototype),o}(e,arguments,r(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),l(i,e)},u(e)}var g=Object.create(null);g.open="0",g.close="1",g.ping="2",g.pong="3",g.message="4",g.upgrade="5",g.noop="6";var h=Object.create(null);Object.keys(g).forEach((function(e){h[g[e]]=e}));var p,m={type:"error",data:"parser error"},f="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),b="function"==typeof ArrayBuffer,C=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},I=function(e,t,i){var n=e.type,o=e.data;return f&&o instanceof Blob?t?i(o):y(o,i):b&&(o instanceof ArrayBuffer||C(o))?t?i(o):y(new Blob([o]),i):i(g[n]+(o||""))},y=function(e,t){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];t("b"+(e||""))},i.readAsDataURL(e)};function v(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}for(var Z="undefined"==typeof Uint8Array?[]:new Uint8Array(256),S=0;S<64;S++)Z["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(S)]=S;var V,w="function"==typeof ArrayBuffer,B=function(e,t){if("string"!=typeof e)return{type:"message",data:E(e,t)};var i=e.charAt(0);return"b"===i?{type:"message",data:A(e.substring(1),t)}:h[i]?e.length>1?{type:h[i],data:e.substring(1)}:{type:h[i]}:m},A=function(e,t){if(w){var i=function(e){var t,i,n,o,r,s=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),d=new Uint8Array(c);for(t=0;t<a;t+=4)i=Z[e.charCodeAt(t)],n=Z[e.charCodeAt(t+1)],o=Z[e.charCodeAt(t+2)],r=Z[e.charCodeAt(t+3)],d[l++]=i<<2|n>>4,d[l++]=(15&n)<<4|o>>2,d[l++]=(3&o)<<6|63&r;return c}(e);return E(i,t)}return{base64:!0,data:e}},E=function(e,t){return"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer},U=String.fromCharCode(30);function N(e){return e.reduce((function(e,t){return e+t.length}),0)}function k(e,t){if(e[0].length===t)return e.shift();for(var i=new Uint8Array(t),n=0,o=0;o<t;o++)i[o]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),i}function M(e){if(e)return function(e){for(var t in M.prototype)e[t]=M.prototype[t];return e}(e)}M.prototype.on=M.prototype.addEventListener=function(e,t){return this.t=this.t||{},(this.t["$"+e]=this.t["$"+e]||[]).push(t),this},M.prototype.once=function(e,t){function i(){this.off(e,i),t.apply(this,arguments)}return i.fn=t,this.on(e,i),this},M.prototype.off=M.prototype.removeListener=M.prototype.removeAllListeners=M.prototype.removeEventListener=function(e,t){if(this.t=this.t||{},0==arguments.length)return this.t={},this;var i,n=this.t["$"+e];if(!n)return this;if(1==arguments.length)return delete this.t["$"+e],this;for(var o=0;o<n.length;o++)if((i=n[o])===t||i.fn===t){n.splice(o,1);break}return 0===n.length&&delete this.t["$"+e],this},M.prototype.emit=function(e){this.t=this.t||{};for(var t=new Array(arguments.length-1),i=this.t["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(i){n=0;for(var o=(i=i.slice(0)).length;n<o;++n)i[n].apply(this,t)}return this},M.prototype.emitReserved=M.prototype.emit,M.prototype.listeners=function(e){return this.t=this.t||{},this.t["$"+e]||[]},M.prototype.hasListeners=function(e){return!!this.listeners(e).length};var F="function"==typeof Promise&&"function"==typeof Promise.resolve?function(e){return Promise.resolve().then(e)}:function(e,t){return t(e,0)},T="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function R(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return i.reduce((function(t,i){return e.hasOwnProperty(i)&&(t[i]=e[i]),t}),{})}var W=T.setTimeout,G=T.clearTimeout;function x(e,t){t.useNativeTimers?(e.setTimeoutFn=W.bind(T),e.clearTimeoutFn=G.bind(T)):(e.setTimeoutFn=T.setTimeout.bind(T),e.clearTimeoutFn=T.clearTimeout.bind(T))}function L(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}var Q=function(e){function t(t,i,n){var o;return(o=e.call(this,t)||this).description=i,o.context=n,o.type="TransportError",o}return s(t,e),t}(u(Error)),X=function(e){function t(t){var i;return(i=e.call(this)||this).writable=!1,x(i,t),i.opts=t,i.query=t.query,i.socket=t.socket,i.supportsBinary=!t.forceBase64,i}s(t,e);var i=t.prototype;return i.onError=function(t,i,n){return e.prototype.emitReserved.call(this,"error",new Q(t,i,n)),this},i.open=function(){return this.readyState="opening",this.doOpen(),this},i.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},i.send=function(e){"open"===this.readyState&&this.write(e)},i.onOpen=function(){this.readyState="open",this.writable=!0,e.prototype.emitReserved.call(this,"open")},i.onData=function(e){var t=B(e,this.socket.binaryType);this.onPacket(t)},i.onPacket=function(t){e.prototype.emitReserved.call(this,"packet",t)},i.onClose=function(t){this.readyState="closed",e.prototype.emitReserved.call(this,"close",t)},i.pause=function(e){},i.createUri=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+"://"+this.i()+this.o()+this.opts.path+this.u(t)},i.i=function(){var e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"},i.o=function(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""},i.u=function(e){var t=function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&(t.length&&(t+="&"),t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t}(e);return t.length?"?"+t:""},t}(M),K=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).h=!1,t}s(t,e);var n=t.prototype;return n.doOpen=function(){this.v()},n.pause=function(e){var t=this;this.readyState="pausing";var i=function(){t.readyState="paused",e()};if(this.h||!this.writable){var n=0;this.h&&(n++,this.once("pollComplete",(function(){--n||i()}))),this.writable||(n++,this.once("drain",(function(){--n||i()})))}else i()},n.v=function(){this.h=!0,this.doPoll(),this.emitReserved("poll")},n.onData=function(e){var t=this;(function(e,t){for(var i=e.split(U),n=[],o=0;o<i.length;o++){var r=B(i[o],t);if(n.push(r),"error"===r.type)break}return n})(e,this.socket.binaryType).forEach((function(e){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose({description:"transport closed by the server"}),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.h=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.v())},n.doClose=function(){var e=this,t=function(){e.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)},n.write=function(e){var t=this;this.writable=!1,function(e,t){var i=e.length,n=new Array(i),o=0;e.forEach((function(e,r){I(e,!1,(function(e){n[r]=e,++o===i&&t(n.join(U))}))}))}(e,(function(e){t.doWrite(e,(function(){t.writable=!0,t.emitReserved("drain")}))}))},n.uri=function(){var e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=L()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)},i(t,[{key:"name",get:function(){return"polling"}}])}(X),j=!1;try{j="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}var D=j;function Y(){}var z=function(e){function t(t){var i;if(i=e.call(this,t)||this,"undefined"!=typeof location){var n="https:"===location.protocol,o=location.port;o||(o=n?"443":"80"),i.xd="undefined"!=typeof location&&t.hostname!==location.hostname||o!==t.port}return i}s(t,e);var i=t.prototype;return i.doWrite=function(e,t){var i=this,n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(function(e,t){i.onError("xhr post error",e,t)}))},i.doPoll=function(){var e=this,t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(function(t,i){e.onError("xhr poll error",t,i)})),this.pollXhr=t},t}(K),H=function(e){function t(t,i,n){var o;return(o=e.call(this)||this).createRequest=t,x(o,n),o.l=n,o.p=n.method||"GET",o.m=i,o.k=void 0!==n.data?n.data:null,o.A(),o}s(t,e);var i=t.prototype;return i.A=function(){var e,i=this,n=R(this.l,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this.l.xd;var o=this.j=this.createRequest(n);try{o.open(this.p,this.m,!0);try{if(this.l.extraHeaders)for(var r in o.setDisableHeaderCheck&&o.setDisableHeaderCheck(!0),this.l.extraHeaders)this.l.extraHeaders.hasOwnProperty(r)&&o.setRequestHeader(r,this.l.extraHeaders[r])}catch(e){}if("POST"===this.p)try{o.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{o.setRequestHeader("Accept","*/*")}catch(e){}null===(e=this.l.cookieJar)||void 0===e||e.addCookies(o),"withCredentials"in o&&(o.withCredentials=this.l.withCredentials),this.l.requestTimeout&&(o.timeout=this.l.requestTimeout),o.onreadystatechange=function(){var e;3===o.readyState&&(null===(e=i.l.cookieJar)||void 0===e||e.parseCookies(o.getResponseHeader("set-cookie"))),4===o.readyState&&(200===o.status||1223===o.status?i.O():i.setTimeoutFn((function(){i.B("number"==typeof o.status?o.status:0)}),0))},o.send(this.k)}catch(e){return void this.setTimeoutFn((function(){i.B(e)}),0)}"undefined"!=typeof document&&(this.S=t.requestsCount++,t.requests[this.S]=this)},i.B=function(e){this.emitReserved("error",e,this.j),this.N(!0)},i.N=function(e){if(void 0!==this.j&&null!==this.j){if(this.j.onreadystatechange=Y,e)try{this.j.abort()}catch(e){}"undefined"!=typeof document&&delete t.requests[this.S],this.j=null}},i.O=function(){var e=this.j.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.N())},i.abort=function(){this.N()},t}(M);function J(){for(var e in H.requests)H.requests.hasOwnProperty(e)&&H.requests[e].abort()}H.requestsCount=0,H.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",J):"function"==typeof addEventListener&&addEventListener("onpagehide"in T?"pagehide":"unload",J,!1));var _,O=(_=q({xdomain:!1}))&&null!==_.responseType,P=function(e){function t(t){var i;i=e.call(this,t)||this;var n=t&&t.forceBase64;return i.supportsBinary=O&&!n,i}return s(t,e),t.prototype.request=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(e,{xd:this.xd},this.opts),new H(q,this.uri(),e)},t}(z);function q(e){var t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||D))return new XMLHttpRequest}catch(e){}if(!t)try{return new(T[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}var $="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),ee=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var n=t.prototype;return n.doOpen=function(){var e=this.uri(),t=this.opts.protocols,i=$?{}:R(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,i)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()},n.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.opts.autoUnref&&e.ws.C.unref(),e.onOpen()},this.ws.onclose=function(t){return e.onClose({description:"websocket connection closed",context:t})},this.ws.onmessage=function(t){return e.onData(t.data)},this.ws.onerror=function(t){return e.onError("websocket error",t)}},n.write=function(e){var t=this;this.writable=!1;for(var i=function(){var i=e[n],o=n===e.length-1;I(i,t.supportsBinary,(function(e){try{t.doWrite(i,e)}catch(e){}o&&F((function(){t.writable=!0,t.emitReserved("drain")}),t.setTimeoutFn)}))},n=0;n<e.length;n++)i()},n.doClose=function(){void 0!==this.ws&&(this.ws.onerror=function(){},this.ws.close(),this.ws=null)},n.uri=function(){var e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=L()),this.supportsBinary||(t.b64=1),this.createUri(e,t)},i(t,[{key:"name",get:function(){return"websocket"}}])}(X),te=T.WebSocket||T.MozWebSocket,ie=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var i=t.prototype;return i.createSocket=function(e,t,i){return $?new te(e,t,i):t?new te(e,t):new te(e)},i.doWrite=function(e,t){this.ws.send(t)},t}(ee),ne=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var n=t.prototype;return n.doOpen=function(){var e=this;try{this.T=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this.T.closed.then((function(){e.onClose()})).catch((function(t){e.onError("webtransport error",t)})),this.T.ready.then((function(){e.T.createBidirectionalStream().then((function(t){var i=function(e,t){V||(V=new TextDecoder);var i=[],n=0,o=-1,r=!1;return new TransformStream({transform:function(s,a){for(i.push(s);;){if(0===n){if(N(i)<1)break;var l=k(i,1);r=!(128&~l[0]),o=127&l[0],n=o<126?3:126===o?1:2}else if(1===n){if(N(i)<2)break;var c=k(i,2);o=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(2===n){if(N(i)<8)break;var d=k(i,8),u=new DataView(d.buffer,d.byteOffset,d.length),g=u.getUint32(0);if(g>Math.pow(2,21)-1){a.enqueue(m);break}o=g*Math.pow(2,32)+u.getUint32(4),n=3}else{if(N(i)<o)break;var h=k(i,o);a.enqueue(B(r?h:V.decode(h),t)),n=0}if(0===o||o>e){a.enqueue(m);break}}}})}(Number.MAX_SAFE_INTEGER,e.socket.binaryType),n=t.readable.pipeThrough(i).getReader(),o=new TransformStream({transform:function(e,t){!function(e,t){f&&e.data instanceof Blob?e.data.arrayBuffer().then(v).then(t):b&&(e.data instanceof ArrayBuffer||C(e.data))?t(v(e.data)):I(e,!1,(function(e){p||(p=new TextEncoder),t(p.encode(e))}))}(e,(function(i){var n,o=i.length;if(o<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,o);else if(o<65536){n=new Uint8Array(3);var r=new DataView(n.buffer);r.setUint8(0,126),r.setUint16(1,o)}else{n=new Uint8Array(9);var s=new DataView(n.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(o))}e.data&&"string"!=typeof e.data&&(n[0]|=128),t.enqueue(n),t.enqueue(i)}))}});o.readable.pipeTo(t.writable),e.U=o.writable.getWriter(),function t(){n.read().then((function(i){var n=i.done,o=i.value;n||(e.onPacket(o),t())})).catch((function(e){}))}();var r={type:"open"};e.query.sid&&(r.data='{"sid":"'.concat(e.query.sid,'"}')),e.U.write(r).then((function(){return e.onOpen()}))}))}))},n.write=function(e){var t=this;this.writable=!1;for(var i=function(){var i=e[n],o=n===e.length-1;t.U.write(i).then((function(){o&&F((function(){t.writable=!0,t.emitReserved("drain")}),t.setTimeoutFn)}))},n=0;n<e.length;n++)i()},n.doClose=function(){var e;null===(e=this.T)||void 0===e||e.close()},i(t,[{key:"name",get:function(){return"webtransport"}}])}(X),oe={websocket:ie,webtransport:ne,polling:P},re=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,se=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ae(e){if(e.length>8e3)throw"URI too long";var t=e,i=e.indexOf("["),n=e.indexOf("]");-1!=i&&-1!=n&&(e=e.substring(0,i)+e.substring(i,n).replace(/:/g,";")+e.substring(n,e.length));for(var o,r,s=re.exec(e||""),a={},l=14;l--;)a[se[l]]=s[l]||"";return-1!=i&&-1!=n&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=function(e,t){var i=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||i.splice(0,1),"/"==t.slice(-1)&&i.splice(i.length-1,1),i}(0,a.path),a.queryKey=(o=a.query,r={},o.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,i){t&&(r[t]=i)})),r),a}var le="function"==typeof addEventListener&&"function"==typeof removeEventListener,ce=[];le&&addEventListener("offline",(function(){ce.forEach((function(e){return e()}))}),!1);var de=function(e){function t(t,i){var n;if((n=e.call(this)||this).binaryType="arraybuffer",n.writeBuffer=[],n.M=0,n.I=-1,n.R=-1,n.L=-1,n._=1/0,t&&"object"===d(t)&&(i=t,t=null),t){var r=ae(t);i.hostname=r.host,i.secure="https"===r.protocol||"wss"===r.protocol,i.port=r.port,r.query&&(i.query=r.query)}else i.host&&(i.hostname=ae(i.host).host);return x(n,i),n.secure=null!=i.secure?i.secure:"undefined"!=typeof location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=n.secure?"443":"80"),n.hostname=i.hostname||("undefined"!=typeof location?location.hostname:"localhost"),n.port=i.port||("undefined"!=typeof location&&location.port?location.port:n.secure?"443":"80"),n.transports=[],n.D={},i.transports.forEach((function(e){var t=e.prototype.name;n.transports.push(t),n.D[t]=e})),n.opts=o({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},i),n.opts.path=n.opts.path.replace(/\/$/,"")+(n.opts.addTrailingSlash?"/":""),"string"==typeof n.opts.query&&(n.opts.query=function(e){for(var t={},i=e.split("&"),n=0,o=i.length;n<o;n++){var r=i[n].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}(n.opts.query)),le&&(n.opts.closeOnBeforeunload&&(n.P=function(){n.transport&&(n.transport.removeAllListeners(),n.transport.close())},addEventListener("beforeunload",n.P,!1)),"localhost"!==n.hostname&&(n.$=function(){n.F("transport close",{description:"network connection lost"})},ce.push(n.$))),n.opts.withCredentials&&(n.V=void 0),n.q(),n}s(t,e);var i=t.prototype;return i.createTransport=function(e){var t=o({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);var i=o({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this.D[e](i)},i.q=function(){var e=this;if(0!==this.transports.length){var i=this.opts.rememberUpgrade&&t.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";var n=this.createTransport(i);n.open(),this.setTransport(n)}else this.setTimeoutFn((function(){e.emitReserved("error","No transports available")}),0)},i.setTransport=function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.X.bind(this)).on("packet",this.H.bind(this)).on("error",this.B.bind(this)).on("close",(function(e){return t.F("transport close",e)}))},i.onOpen=function(){this.readyState="open",t.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()},i.H=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.J("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this.K();break;case"error":var t=new Error("server error");t.code=e.data,this.B(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}},i.onHandshake=function(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.I=e.pingInterval,this.R=e.pingTimeout,this.L=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.K()},i.K=function(){var e=this;this.clearTimeoutFn(this.Y);var t=this.I+this.R;this._=Date.now()+t,this.Y=this.setTimeoutFn((function(){e.F("ping timeout")}),t),this.opts.autoUnref&&this.Y.unref()},i.X=function(){this.writeBuffer.splice(0,this.M),this.M=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()},i.flush=function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){var e=this.G();this.transport.send(e),this.M=e.length,this.emitReserved("flush")}},i.G=function(){if(!(this.L&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;for(var e,t=1,i=0;i<this.writeBuffer.length;i++){var n=this.writeBuffer[i].data;if(n&&(t+="string"==typeof(e=n)?function(e){for(var t=0,i=0,n=0,o=e.length;n<o;n++)(t=e.charCodeAt(n))<128?i+=1:t<2048?i+=2:t<55296||t>=57344?i+=3:(n++,i+=4);return i}(e):Math.ceil(1.33*(e.byteLength||e.size))),i>0&&t>this.L)return this.writeBuffer.slice(0,i);t+=2}return this.writeBuffer},i.W=function(){var e=this;if(!this._)return!0;var t=Date.now()>this._;return t&&(this._=0,F((function(){e.F("ping timeout")}),this.setTimeoutFn)),t},i.write=function(e,t,i){return this.J("message",e,t,i),this},i.send=function(e,t,i){return this.J("message",e,t,i),this},i.J=function(e,t,i,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof i&&(n=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState){(i=i||{}).compress=!1!==i.compress;var o={type:e,data:t,options:i};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush()}},i.close=function(){var e=this,t=function(){e.F("forced close"),e.transport.close()},i=function i(){e.off("upgrade",i),e.off("upgradeError",i),t()},n=function(){e.once("upgrade",i),e.once("upgradeError",i)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){e.upgrading?n():t()})):this.upgrading?n():t()),this},i.B=function(e){if(t.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this.q();this.emitReserved("error",e),this.F("transport error",e)},i.F=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this.Y),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),le&&(this.P&&removeEventListener("beforeunload",this.P,!1),this.$)){var i=ce.indexOf(this.$);-1!==i&&ce.splice(i,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.M=0}},t}(M);de.protocol=4;var ue=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).Z=[],t}s(t,e);var i=t.prototype;return i.onOpen=function(){if(e.prototype.onOpen.call(this),"open"===this.readyState&&this.opts.upgrade)for(var t=0;t<this.Z.length;t++)this.tt(this.Z[t])},i.tt=function(e){var t=this,i=this.createTransport(e),n=!1;de.priorWebsocketSuccess=!1;var o=function(){n||(i.send([{type:"ping",data:"probe"}]),i.once("packet",(function(e){if(!n)if("pong"===e.type&&"probe"===e.data){if(t.upgrading=!0,t.emitReserved("upgrading",i),!i)return;de.priorWebsocketSuccess="websocket"===i.name,t.transport.pause((function(){n||"closed"!==t.readyState&&(d(),t.setTransport(i),i.send([{type:"upgrade"}]),t.emitReserved("upgrade",i),i=null,t.upgrading=!1,t.flush())}))}else{var o=new Error("probe error");o.transport=i.name,t.emitReserved("upgradeError",o)}})))};function r(){n||(n=!0,d(),i.close(),i=null)}var s=function(e){var n=new Error("probe error: "+e);n.transport=i.name,r(),t.emitReserved("upgradeError",n)};function a(){s("transport closed")}function l(){s("socket closed")}function c(e){i&&e.name!==i.name&&r()}var d=function(){i.removeListener("open",o),i.removeListener("error",s),i.removeListener("close",a),t.off("close",l),t.off("upgrading",c)};i.once("open",o),i.once("error",s),i.once("close",a),this.once("close",l),this.once("upgrading",c),-1!==this.Z.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((function(){n||i.open()}),200):i.open()},i.onHandshake=function(t){this.Z=this.nt(t.upgrades),e.prototype.onHandshake.call(this,t)},i.nt=function(e){for(var t=[],i=0;i<e.length;i++)~this.transports.indexOf(e[i])&&t.push(e[i]);return t},t}(de),ge=function(e){function t(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="object"===d(t)?t:i;return(!n.transports||n.transports&&"string"==typeof n.transports[0])&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map((function(e){return oe[e]})).filter((function(e){return!!e}))),e.call(this,t,n)||this}return s(t,e),t}(ue);ge.protocol;var he="function"==typeof ArrayBuffer,pe=Object.prototype.toString,me="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===pe.call(Blob),fe="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===pe.call(File);function be(e){return he&&(e instanceof ArrayBuffer||function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}(e))||me&&e instanceof Blob||fe&&e instanceof File}function Ce(e,t){if(!e||"object"!==d(e))return!1;if(Array.isArray(e)){for(var i=0,n=e.length;i<n;i++)if(Ce(e[i]))return!0;return!1}if(be(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return Ce(e.toJSON(),!0);for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&Ce(e[o]))return!0;return!1}function Ie(e){var t=[],i=e.data,n=e;return n.data=ye(i,t),n.attachments=t.length,{packet:n,buffers:t}}function ye(e,t){if(!e)return e;if(be(e)){var i={_placeholder:!0,num:t.length};return t.push(e),i}if(Array.isArray(e)){for(var n=new Array(e.length),o=0;o<e.length;o++)n[o]=ye(e[o],t);return n}if("object"===d(e)&&!(e instanceof Date)){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=ye(e[s],t));return r}return e}function ve(e,t){return e.data=Ze(e.data,t),delete e.attachments,e}function Ze(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(var i=0;i<e.length;i++)e[i]=Ze(e[i],t);else if("object"===d(e))for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=Ze(e[n],t));return e}var Se,Ve=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Se||(Se={}));var we=function(){function e(e){this.replacer=e}var t=e.prototype;return t.encode=function(e){return e.type!==Se.EVENT&&e.type!==Se.ACK||!Ce(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===Se.EVENT?Se.BINARY_EVENT:Se.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})},t.encodeAsString=function(e){var t=""+e.type;return e.type!==Se.BINARY_EVENT&&e.type!==Se.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t},t.encodeAsBinary=function(e){var t=Ie(e),i=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(i),n},e}(),Be=function(e){function t(t){var i;return(i=e.call(this)||this).reviver=t,i}s(t,e);var i=t.prototype;return i.add=function(t){var i;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");var n=(i=this.decodeString(t)).type===Se.BINARY_EVENT;n||i.type===Se.BINARY_ACK?(i.type=n?Se.EVENT:Se.ACK,this.reconstructor=new Ae(i),0===i.attachments&&e.prototype.emitReserved.call(this,"decoded",i)):e.prototype.emitReserved.call(this,"decoded",i)}else{if(!be(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(i=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,e.prototype.emitReserved.call(this,"decoded",i))}},i.decodeString=function(e){var i=0,n={type:Number(e.charAt(0))};if(void 0===Se[n.type])throw new Error("unknown packet type "+n.type);if(n.type===Se.BINARY_EVENT||n.type===Se.BINARY_ACK){for(var o=i+1;"-"!==e.charAt(++i)&&i!=e.length;);var r=e.substring(o,i);if(r!=Number(r)||"-"!==e.charAt(i))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===e.charAt(i+1)){for(var s=i+1;++i&&","!==e.charAt(i)&&i!==e.length;);n.nsp=e.substring(s,i)}else n.nsp="/";var a=e.charAt(i+1);if(""!==a&&Number(a)==a){for(var l=i+1;++i;){var c=e.charAt(i);if(null==c||Number(c)!=c){--i;break}if(i===e.length)break}n.id=Number(e.substring(l,i+1))}if(e.charAt(++i)){var d=this.tryParse(e.substr(i));if(!t.isPayloadValid(n.type,d))throw new Error("invalid payload");n.data=d}return n},i.tryParse=function(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}},t.isPayloadValid=function(e,t){switch(e){case Se.CONNECT:return Ue(t);case Se.DISCONNECT:return void 0===t;case Se.CONNECT_ERROR:return"string"==typeof t||Ue(t);case Se.EVENT:case Se.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===Ve.indexOf(t[0]));case Se.ACK:case Se.BINARY_ACK:return Array.isArray(t)}},i.destroy=function(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)},t}(M),Ae=function(){function e(e){this.packet=e,this.buffers=[],this.reconPack=e}var t=e.prototype;return t.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=ve(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},t.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]},e}(),Ee=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function Ue(e){return"[object Object]"===Object.prototype.toString.call(e)}var Ne=Object.freeze({__proto__:null,protocol:5,get PacketType(){return Se},Encoder:we,Decoder:Be,isPacketValid:function(e){return"string"==typeof e.nsp&&(void 0===(t=e.id)||Ee(t))&&function(e,t){switch(e){case Se.CONNECT:return void 0===t||Ue(t);case Se.DISCONNECT:return void 0===t;case Se.EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===Ve.indexOf(t[0]));case Se.ACK:return Array.isArray(t);case Se.CONNECT_ERROR:return"string"==typeof t||Ue(t);default:return!1}}(e.type,e.data);var t}});function ke(e,t,i){return e.on(t,i),function(){e.off(t,i)}}var Me=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Fe=function(e){function t(t,i,n){var r;return(r=e.call(this)||this).connected=!1,r.recovered=!1,r.receiveBuffer=[],r.sendBuffer=[],r.it=[],r.rt=0,r.ids=0,r.acks={},r.flags={},r.io=t,r.nsp=i,n&&n.auth&&(r.auth=n.auth),r.l=o({},n),r.io.et&&r.open(),r}s(t,e);var r=t.prototype;return r.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[ke(e,"open",this.onopen.bind(this)),ke(e,"packet",this.onpacket.bind(this)),ke(e,"error",this.onerror.bind(this)),ke(e,"close",this.onclose.bind(this))]}},r.connect=function(){return this.connected||(this.subEvents(),this.io.ot||this.io.open(),"open"===this.io.st&&this.onopen()),this},r.open=function(){return this.connect()},r.send=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.unshift("message"),this.emit.apply(this,t),this},r.emit=function(e){var t,i,n;if(Me.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var o=arguments.length,r=new Array(o>1?o-1:0),s=1;s<o;s++)r[s-1]=arguments[s];if(r.unshift(e),this.l.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this.ut(r),this;var a={type:Se.EVENT,data:r,options:{}};if(a.options.compress=!1!==this.flags.compress,"function"==typeof r[r.length-1]){var l=this.ids++,c=r.pop();this.ht(l,c),a.id=l}var d=null===(i=null===(t=this.io.engine)||void 0===t?void 0:t.transport)||void 0===i?void 0:i.writable,u=this.connected&&!(null===(n=this.io.engine)||void 0===n?void 0:n.W());return this.flags.volatile&&!d||(u?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this},r.ht=function(e,t){var i,n=this,o=null!==(i=this.flags.timeout)&&void 0!==i?i:this.l.ackTimeout;if(void 0!==o){var r=this.io.setTimeoutFn((function(){delete n.acks[e];for(var i=0;i<n.sendBuffer.length;i++)n.sendBuffer[i].id===e&&n.sendBuffer.splice(i,1);t.call(n,new Error("operation has timed out"))}),o),s=function(){n.io.clearTimeoutFn(r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];t.apply(n,i)};s.withError=!0,this.acks[e]=s}else this.acks[e]=t},r.emitWithAck=function(e){for(var t=this,i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return new Promise((function(i,o){var r=function(e,t){return e?o(e):i(t)};r.withError=!0,n.push(r),t.emit.apply(t,[e].concat(n))}))},r.ut=function(e){var t,i=this;"function"==typeof e[e.length-1]&&(t=e.pop());var n={id:this.rt++,tryCount:0,pending:!1,args:e,flags:o({fromQueue:!0},this.flags)};e.push((function(e){if(n===i.it[0]){if(null!==e)n.tryCount>i.l.retries&&(i.it.shift(),t&&t(e));else if(i.it.shift(),t){for(var o=arguments.length,r=new Array(o>1?o-1:0),s=1;s<o;s++)r[s-1]=arguments[s];t.apply(void 0,[null].concat(r))}return n.pending=!1,i.ft()}})),this.it.push(n),this.ft()},r.ft=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.connected&&0!==this.it.length){var t=this.it[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}},r.packet=function(e){e.nsp=this.nsp,this.io.ct(e)},r.onopen=function(){var e=this;"function"==typeof this.auth?this.auth((function(t){e.vt(t)})):this.vt(this.auth)},r.vt=function(e){this.packet({type:Se.CONNECT,data:this.lt?o({pid:this.lt,offset:this.dt},e):e})},r.onerror=function(e){this.connected||this.emitReserved("connect_error",e)},r.onclose=function(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this.yt()},r.yt=function(){var e=this;Object.keys(this.acks).forEach((function(t){if(!e.sendBuffer.some((function(e){return String(e.id)===t}))){var i=e.acks[t];delete e.acks[t],i.withError&&i.call(e,new Error("socket has been disconnected"))}}))},r.onpacket=function(e){if(e.nsp===this.nsp)switch(e.type){case Se.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Se.EVENT:case Se.BINARY_EVENT:this.onevent(e);break;case Se.ACK:case Se.BINARY_ACK:this.onack(e);break;case Se.DISCONNECT:this.ondisconnect();break;case Se.CONNECT_ERROR:this.destroy();var t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}},r.onevent=function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))},r.emitEvent=function(t){if(this.bt&&this.bt.length){var i,o=n(this.bt.slice());try{for(o.s();!(i=o.n()).done;)i.value.apply(this,t)}catch(e){o.e(e)}finally{o.f()}}e.prototype.emit.apply(this,t),this.lt&&t.length&&"string"==typeof t[t.length-1]&&(this.dt=t[t.length-1])},r.ack=function(e){var t=this,i=!1;return function(){if(!i){i=!0;for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];t.packet({type:Se.ACK,id:e,data:o})}}},r.onack=function(e){var t=this.acks[e.id];"function"==typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))},r.onconnect=function(e,t){this.id=e,this.recovered=t&&this.lt===t,this.lt=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this.ft(!0)},r.emitBuffered=function(){var e=this;this.receiveBuffer.forEach((function(t){return e.emitEvent(t)})),this.receiveBuffer=[],this.sendBuffer.forEach((function(t){e.notifyOutgoingListeners(t),e.packet(t)})),this.sendBuffer=[]},r.ondisconnect=function(){this.destroy(),this.onclose("io server disconnect")},r.destroy=function(){this.subs&&(this.subs.forEach((function(e){return e()})),this.subs=void 0),this.io.wt(this)},r.disconnect=function(){return this.connected&&this.packet({type:Se.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.close=function(){return this.disconnect()},r.compress=function(e){return this.flags.compress=e,this},r.timeout=function(e){return this.flags.timeout=e,this},r.onAny=function(e){return this.bt=this.bt||[],this.bt.push(e),this},r.prependAny=function(e){return this.bt=this.bt||[],this.bt.unshift(e),this},r.offAny=function(e){if(!this.bt)return this;if(e){for(var t=this.bt,i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this.bt=[];return this},r.listenersAny=function(){return this.bt||[]},r.onAnyOutgoing=function(e){return this.gt=this.gt||[],this.gt.push(e),this},r.prependAnyOutgoing=function(e){return this.gt=this.gt||[],this.gt.unshift(e),this},r.offAnyOutgoing=function(e){if(!this.gt)return this;if(e){for(var t=this.gt,i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this.gt=[];return this},r.listenersAnyOutgoing=function(){return this.gt||[]},r.notifyOutgoingListeners=function(e){if(this.gt&&this.gt.length){var t,i=n(this.gt.slice());try{for(i.s();!(t=i.n()).done;)t.value.apply(this,e.data)}catch(e){i.e(e)}finally{i.f()}}},i(t,[{key:"disconnected",get:function(){return!this.connected}},{key:"active",get:function(){return!!this.subs}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}}])}(M);function Te(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Te.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),i=Math.floor(t*this.jitter*e);e=1&Math.floor(10*t)?e+i:e-i}return 0|Math.min(e,this.max)},Te.prototype.reset=function(){this.attempts=0},Te.prototype.setMin=function(e){this.ms=e},Te.prototype.setMax=function(e){this.max=e},Te.prototype.setJitter=function(e){this.jitter=e};var Re=function(e){function t(t,i){var n,o;(n=e.call(this)||this).nsps={},n.subs=[],t&&"object"===d(t)&&(i=t,t=void 0),(i=i||{}).path=i.path||"/socket.io",n.opts=i,x(n,i),n.reconnection(!1!==i.reconnection),n.reconnectionAttempts(i.reconnectionAttempts||1/0),n.reconnectionDelay(i.reconnectionDelay||1e3),n.reconnectionDelayMax(i.reconnectionDelayMax||5e3),n.randomizationFactor(null!==(o=i.randomizationFactor)&&void 0!==o?o:.5),n.backoff=new Te({min:n.reconnectionDelay(),max:n.reconnectionDelayMax(),jitter:n.randomizationFactor()}),n.timeout(null==i.timeout?2e4:i.timeout),n.st="closed",n.uri=t;var r=i.parser||Ne;return n.encoder=new r.Encoder,n.decoder=new r.Decoder,n.et=!1!==i.autoConnect,n.et&&n.open(),n}s(t,e);var i=t.prototype;return i.reconnection=function(e){return arguments.length?(this.kt=!!e,e||(this.skipReconnect=!0),this):this.kt},i.reconnectionAttempts=function(e){return void 0===e?this.At:(this.At=e,this)},i.reconnectionDelay=function(e){var t;return void 0===e?this.jt:(this.jt=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)},i.randomizationFactor=function(e){var t;return void 0===e?this.Et:(this.Et=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)},i.reconnectionDelayMax=function(e){var t;return void 0===e?this.Ot:(this.Ot=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)},i.timeout=function(e){return arguments.length?(this.Bt=e,this):this.Bt},i.maybeReconnectOnOpen=function(){!this.ot&&this.kt&&0===this.backoff.attempts&&this.reconnect()},i.open=function(e){var t=this;if(~this.st.indexOf("open"))return this;this.engine=new ge(this.uri,this.opts);var i=this.engine,n=this;this.st="opening",this.skipReconnect=!1;var o=ke(i,"open",(function(){n.onopen(),e&&e()})),r=function(i){t.cleanup(),t.st="closed",t.emitReserved("error",i),e?e(i):t.maybeReconnectOnOpen()},s=ke(i,"error",r);if(!1!==this.Bt){var a=this.Bt,l=this.setTimeoutFn((function(){o(),r(new Error("timeout")),i.close()}),a);this.opts.autoUnref&&l.unref(),this.subs.push((function(){t.clearTimeoutFn(l)}))}return this.subs.push(o),this.subs.push(s),this},i.connect=function(e){return this.open(e)},i.onopen=function(){this.cleanup(),this.st="open",this.emitReserved("open");var e=this.engine;this.subs.push(ke(e,"ping",this.onping.bind(this)),ke(e,"data",this.ondata.bind(this)),ke(e,"error",this.onerror.bind(this)),ke(e,"close",this.onclose.bind(this)),ke(this.decoder,"decoded",this.ondecoded.bind(this)))},i.onping=function(){this.emitReserved("ping")},i.ondata=function(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}},i.ondecoded=function(e){var t=this;F((function(){t.emitReserved("packet",e)}),this.setTimeoutFn)},i.onerror=function(e){this.emitReserved("error",e)},i.socket=function(e,t){var i=this.nsps[e];return i?this.et&&!i.active&&i.connect():(i=new Fe(this,e,t),this.nsps[e]=i),i},i.wt=function(e){for(var t=0,i=Object.keys(this.nsps);t<i.length;t++){var n=i[t];if(this.nsps[n].active)return}this.St()},i.ct=function(e){for(var t=this.encoder.encode(e),i=0;i<t.length;i++)this.engine.write(t[i],e.options)},i.cleanup=function(){this.subs.forEach((function(e){return e()})),this.subs.length=0,this.decoder.destroy()},i.St=function(){this.skipReconnect=!0,this.ot=!1,this.onclose("forced close")},i.disconnect=function(){return this.St()},i.onclose=function(e,t){var i;this.cleanup(),null===(i=this.engine)||void 0===i||i.close(),this.backoff.reset(),this.st="closed",this.emitReserved("close",e,t),this.kt&&!this.skipReconnect&&this.reconnect()},i.reconnect=function(){var e=this;if(this.ot||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this.At)this.backoff.reset(),this.emitReserved("reconnect_failed"),this.ot=!1;else{var i=this.backoff.duration();this.ot=!0;var n=this.setTimeoutFn((function(){t.skipReconnect||(e.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((function(i){i?(t.ot=!1,t.reconnect(),e.emitReserved("reconnect_error",i)):t.onreconnect()})))}),i);this.opts.autoUnref&&n.unref(),this.subs.push((function(){e.clearTimeoutFn(n)}))}},i.onreconnect=function(){var e=this.backoff.attempts;this.ot=!1,this.backoff.reset(),this.emitReserved("reconnect",e)},t}(M),We={};function Ge(e,t){"object"===d(e)&&(t=e,e=void 0);var i,n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,n=e;i=i||"undefined"!=typeof location&&location,null==e&&(e=i.protocol+"//"+i.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?i.protocol+e:i.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==i?i.protocol+"//"+e:"https://"+e),n=ae(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port+t,n.href=n.protocol+"://"+o+(i&&i.port===n.port?"":":"+n.port),n}(e,(t=t||{}).path||"/socket.io"),o=n.source,r=n.id,s=n.path,a=We[r]&&s in We[r].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?i=new Re(o,t):(We[r]||(We[r]=new Re(o,t)),i=We[r]),n.query&&!t.query&&(t.query=n.queryKey),i.socket(n.path,t)}return o(Ge,{Manager:Re,Socket:Fe,io:Ge,connect:Ge}),Ge}));class EJS_STORAGE{constructor(e,t){this.dbName=e,this.storeName=t}addFileToDB(e,t){(async()=>{if("?EJS_KEYS!"===e)return;let i=await this.get("?EJS_KEYS!");if(i||(i=[]),t)i.includes(e)||i.push(e);else{const t=i.indexOf(e);-1!==t&&i.splice(t,1)}this.put("?EJS_KEYS!",i)})()}get(e){return new Promise(((t,i)=>{if(!window.indexedDB)return t();let n=indexedDB.open(this.dbName,1);n.onerror=()=>t(),n.onsuccess=()=>{let i=n.result.transaction([this.storeName],"readwrite").objectStore(this.storeName).get(e);i.onsuccess=e=>{t(i.result)},i.onerror=()=>t()},n.onupgradeneeded=()=>{let e=n.result;e.objectStoreNames.contains(this.storeName)||e.createObjectStore(this.storeName)}}))}put(e,t){return new Promise(((i,n)=>{if(!window.indexedDB)return i();let o=indexedDB.open(this.dbName,1);o.onerror=()=>{},o.onsuccess=()=>{let n=o.result.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(t,e);n.onerror=()=>i(),n.onsuccess=()=>{this.addFileToDB(e,!0),i()}},o.onupgradeneeded=()=>{let e=o.result;e.objectStoreNames.contains(this.storeName)||e.createObjectStore(this.storeName)}}))}remove(e){return new Promise(((t,i)=>{if(!window.indexedDB)return t();let n=indexedDB.open(this.dbName,1);n.onerror=()=>{},n.onsuccess=()=>{let i=n.result.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(e);this.addFileToDB(e,!1),i.onsuccess=()=>t(),i.onerror=()=>{}},n.onupgradeneeded=()=>{let e=n.result;e.objectStoreNames.contains(this.storeName)||e.createObjectStore(this.storeName)}}))}getSizes(){return new Promise((async(e,t)=>{window.indexedDB||e({});const i=await this.get("?EJS_KEYS!");if(!i)return e({});let n={};for(let e=0;e<i.length;e++){const t=await this.get(i[e]);t&&t.data&&"number"==typeof t.data.byteLength&&(n[i[e]]=t.data.byteLength)}e(n)}))}}class EJS_DUMMYSTORAGE{constructor(){}addFileToDB(){return new Promise((e=>e()))}get(){return new Promise((e=>e()))}put(){return new Promise((e=>e()))}remove(){return new Promise((e=>e()))}getSizes(){return new Promise((e=>e({})))}}window.EJS_STORAGE=EJS_STORAGE,window.EJS_DUMMYSTORAGE=EJS_DUMMYSTORAGE,function(proxyWindow){with(proxyWindow.__MICRO_APP_WINDOW__)(function(e,t,i,n,o,r,s,a,l,c,d,u,g,h,p,m,f,b,C,I,y,v,Z,S,V,w,B,A,E,U,N,k,M,F,T,R,W,G,x){Atomics&&!Atomics.waitAsync&&(Atomics.waitAsync=!0);var L,Q=(L=void 0!==n?n.currentScript?.src:W,async function(i={}){var o,u,h=i,p=new Promise(((e,t)=>{o=e,u=t})),m="object"==typeof e,f="undefined"!=typeof WorkerGlobalScope,b="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node&&"renderer"!=process.type,C=[],I="./this.program",v=(e,t)=>{throw t};f&&(L=t.location.href);var w,A,k="";if(m||f){try{k=new URL(".",L).href}catch{}f&&(A=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),w=async e=>{var t=await fetch(e,{credentials:"same-origin"});if(t.ok)return t.arrayBuffer();throw new S(t.status+" : "+t.url)}}var M,F,T,G,x,Q,X,K,j,D,Y,z,H=N.log.bind(N),J=N.error.bind(N),_=!1;function O(e,t){e||ne(t)}function P(){var e=F.buffer;G=new Int8Array(e),Q=new Int16Array(e),h.HEAPU8=x=new Uint8Array(e),X=new Uint16Array(e),K=new Int32Array(e),j=new Uint32Array(e),D=new Float32Array(e),z=new Float64Array(e),Y=new BigInt64Array(e),new BigUint64Array(e)}var q,$=0,ee=null;function te(e){$++,h.monitorRunDependencies?.($)}function ie(e){if($--,h.monitorRunDependencies?.($),0==$&&ee){var t=ee;ee=null,t()}}function ne(e){h.onAbort?.(e),J(e="Aborted("+e+")"),_=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw u(t),t}function oe(){return e="fceumm_libretro.wasm",h.locateFile?h.locateFile(e,k):k+e;var e}async function re(e){if(!M)try{var t=await w(e);return new Uint8Array(t)}catch{}return function(e){if(e==q&&M)return new Uint8Array(M);if(A)return A(e);throw"both async and sync fetching of the wasm failed"}(e)}async function se(e,t,i){if(!e&&"function"==typeof WebAssembly.instantiateStreaming)try{var n=fetch(t,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(n,i)}catch(e){J(`wasm streaming compile failed: ${e}`),J("falling back to ArrayBuffer instantiation")}return async function(e,t){try{var i=await re(e);return await WebAssembly.instantiate(i,t)}catch(e){J(`failed to asynchronously prepare wasm: ${e}`),ne(e)}}(t,i)}class ae{name="ExitStatus";constructor(e){this.message=`Program terminated with exit(${e})`,this.status=e}}var le=e=>{for(;e.length>0;)e.shift()(h)},ce=[],de=e=>ce.push(e),ue=[],ge=e=>ue.push(e),he=!0,pe=e=>Gc(e),me=()=>Lc(),fe={canvasWidth:0,canvasHeight:0,sentinelPromise:null,command_queue:[],command_reply_queue:[]};function be(){Ac(BigInt(U.memory.usedJSHeapSize||0),BigInt(U.memory.jsHeapSizeLimit||0)),setTimeout(be,5e3)}function Ce(e){Bc(!0,d.isFinite(e.target.dischargingTime)?e.target.dischargingTime:2147483647,e.target.level,e.target.charging)}var Ie=async function(t,i){var n=600,o=450;await new Promise((e=>setTimeout(e,0))),e.resizeTo(n,o),await new Promise((e=>setTimeout(e,50)));var r=fe.canvasWidth,s=fe.canvasHeight;e.resizeTo(700,550),await new Promise((e=>setTimeout(e,50)));var a=100*(t-r)/(fe.canvasWidth-r)+n,l=100*(i-s)/(fe.canvasHeight-s)+o;e.resizeTo(c.round(a),c.round(l))};async function ye(e){if(e&&!fe.sentinelPromise&&R?.wakeLock?.request)try{fe.sentinelPromise=R.wakeLock.request("screen")}catch(e){}else if(!e&&fe.sentinelPromise){try{(await fe.sentinelPromise).release()}catch(e){}fe.sentinelPromise=null}}Ie.isAsync=!0,ye.isAsync=!0;var ve="undefined"!=typeof TextDecoder?new TextDecoder:W,Ze=(e,t=0,i=NaN)=>{for(var n=t+i,o=t;e[o]&&!(o>=n);)++o;if(o-t>16&&e.buffer&&ve)return ve.decode(e.subarray(t,o));for(var r="";t<o;){var s=e[t++];if(128&s){var l=63&e[t++];if(192!=(224&s)){var c=63&e[t++];if((s=224==(240&s)?(15&s)<<12|l<<6|c:(7&s)<<18|l<<12|c<<6|63&e[t++])<65536)r+=a.fromCharCode(s);else{var d=s-65536;r+=a.fromCharCode(55296|d>>10,56320|1023&d)}}else r+=a.fromCharCode((31&s)<<6|l)}else r+=a.fromCharCode(s)}return r},Se=(e,t)=>e?Ze(x,e,t):"",Ve=e=>{(Ve=e=>crypto.getRandomValues(e))(e)},we={isAbs:e=>"/"===e.charAt(0),splitPath:e=>/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1),normalizeArray:(e,t)=>{for(var i=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),i++):i&&(e.splice(n,1),i--)}if(t)for(;i;i--)e.unshift("..");return e},normalize:e=>{var t=we.isAbs(e),i="/"===e.slice(-1);return(e=we.normalizeArray(e.split("/").filter((e=>!!e)),!t).join("/"))||t||(e="."),e&&i&&(e+="/"),(t?"/":"")+e},dirname:e=>{var t=we.splitPath(e),i=t[0],n=t[1];return i||n?(n&&(n=n.slice(0,-1)),i+n):"."},basename:e=>e&&e.match(/([^\/]+|\/)\/*$/)[1],join:(...e)=>we.normalize(e.join("/")),join2:(e,t)=>we.normalize(e+"/"+t)},Be={resolve:(...e)=>{for(var t="",i=!1,n=e.length-1;n>=-1&&!i;n--){var o=n>=0?e[n]:Le.cwd();if("string"!=typeof o)throw new V("Arguments to path.resolve must be strings");if(!o)return"";t=o+"/"+t,i=we.isAbs(o)}return(i?"/":"")+(t=we.normalizeArray(t.split("/").filter((e=>!!e)),!i).join("/"))||"."},relative:(e,t)=>{function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=Be.resolve(e).slice(1),t=Be.resolve(t).slice(1);for(var n=i(e.split("/")),o=i(t.split("/")),r=c.min(n.length,o.length),s=r,a=0;a<r;a++)if(n[a]!==o[a]){s=a;break}var l=[];for(a=s;a<n.length;a++)l.push("..");return(l=l.concat(o.slice(s))).join("/")}},Ae=[],Ee=e=>{for(var t=0,i=0;i<e.length;++i){var n=e.charCodeAt(i);n<=127?t++:n<=2047?t+=2:n>=55296&&n<=57343?(t+=4,++i):t+=3}return t},Ue=(e,t,i,n)=>{if(!(n>0))return 0;for(var o=i,r=i+n-1,s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++s)),a<=127){if(i>=r)break;t[i++]=a}else if(a<=2047){if(i+1>=r)break;t[i++]=192|a>>6,t[i++]=128|63&a}else if(a<=65535){if(i+2>=r)break;t[i++]=224|a>>12,t[i++]=128|a>>6&63,t[i++]=128|63&a}else{if(i+3>=r)break;t[i++]=240|a>>18,t[i++]=128|a>>12&63,t[i++]=128|a>>6&63,t[i++]=128|63&a}}return t[i]=0,i-o},Ne=(e,t,i)=>{var n=i>0?i:Ee(e)+1,o=new r(n),s=Ue(e,o,0,o.length);return t&&(o.length=s),o},ke={ttys:[],init(){},shutdown(){},register(e,t){ke.ttys[e]={input:[],output:[],ops:t},Le.registerDevice(e,ke.stream_ops)},stream_ops:{open(e){var t=ke.ttys[e.node.rdev];if(!t)throw new Le.ErrnoError(43);e.tty=t,e.seekable=!1},close(e){e.tty.ops.fsync(e.tty)},fsync(e){e.tty.ops.fsync(e.tty)},read(e,t,i,n,o){if(!e.tty||!e.tty.ops.get_char)throw new Le.ErrnoError(60);for(var r=0,s=0;s<n;s++){var a;try{a=e.tty.ops.get_char(e.tty)}catch(e){throw new Le.ErrnoError(29)}if(a===W&&0===r)throw new Le.ErrnoError(6);if(null===a||a===W)break;r++,t[i+s]=a}return r&&(e.node.atime=g.now()),r},write(e,t,i,n,o){if(!e.tty||!e.tty.ops.put_char)throw new Le.ErrnoError(60);try{for(var r=0;r<n;r++)e.tty.ops.put_char(e.tty,t[i+r])}catch(e){throw new Le.ErrnoError(29)}return n&&(e.node.mtime=e.node.ctime=g.now()),r}},default_tty_ops:{get_char:t=>(()=>{if(!Ae.length){var t=null;if(void 0!==e&&"function"==typeof e.prompt&&null!==(t=e.prompt("Input: "))&&(t+="\n"),!t)return null;Ae=Ne(t,!0)}return Ae.shift()})(),put_char(e,t){null===t||10===t?(H(Ze(e.output)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output?.length>0&&(H(Ze(e.output)),e.output=[])},ioctl_tcgets:e=>({c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}),ioctl_tcsets:(e,t,i)=>0,ioctl_tiocgwinsz:e=>[24,80]},default_tty1_ops:{put_char(e,t){null===t||10===t?(J(Ze(e.output)),e.output=[]):0!=t&&e.output.push(t)},fsync(e){e.output?.length>0&&(J(Ze(e.output)),e.output=[])}}},Me=e=>{ne()},Fe={ops_table:null,mount:e=>Fe.createNode(null,"/",16895,0),createNode(e,t,i,n){if(Le.isBlkdev(i)||Le.isFIFO(i))throw new Le.ErrnoError(63);Fe.ops_table||={dir:{node:{getattr:Fe.node_ops.getattr,setattr:Fe.node_ops.setattr,lookup:Fe.node_ops.lookup,mknod:Fe.node_ops.mknod,rename:Fe.node_ops.rename,unlink:Fe.node_ops.unlink,rmdir:Fe.node_ops.rmdir,readdir:Fe.node_ops.readdir,symlink:Fe.node_ops.symlink},stream:{llseek:Fe.stream_ops.llseek}},file:{node:{getattr:Fe.node_ops.getattr,setattr:Fe.node_ops.setattr},stream:{llseek:Fe.stream_ops.llseek,read:Fe.stream_ops.read,write:Fe.stream_ops.write,mmap:Fe.stream_ops.mmap,msync:Fe.stream_ops.msync}},link:{node:{getattr:Fe.node_ops.getattr,setattr:Fe.node_ops.setattr,readlink:Fe.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Fe.node_ops.getattr,setattr:Fe.node_ops.setattr},stream:Le.chrdev_stream_ops}};var o=Le.createNode(e,t,i,n);return Le.isDir(o.mode)?(o.node_ops=Fe.ops_table.dir.node,o.stream_ops=Fe.ops_table.dir.stream,o.contents={}):Le.isFile(o.mode)?(o.node_ops=Fe.ops_table.file.node,o.stream_ops=Fe.ops_table.file.stream,o.usedBytes=0,o.contents=null):Le.isLink(o.mode)?(o.node_ops=Fe.ops_table.link.node,o.stream_ops=Fe.ops_table.link.stream):Le.isChrdev(o.mode)&&(o.node_ops=Fe.ops_table.chrdev.node,o.stream_ops=Fe.ops_table.chrdev.stream),o.atime=o.mtime=o.ctime=g.now(),e&&(e.contents[t]=o,e.atime=e.mtime=e.ctime=o.atime),o},getFileDataAsTypedArray:e=>e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0),expandFileStorage(e,t){var i=e.contents?e.contents.length:0;if(!(i>=t)){t=c.max(t,i*(i<1048576?2:1.125)>>>0),0!=i&&(t=c.max(t,256));var n=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage(e,t){if(e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var i=e.contents;e.contents=new Uint8Array(t),i&&e.contents.set(i.subarray(0,c.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr(e){var t={};return t.dev=Le.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,Le.isDir(e.mode)?t.size=4096:Le.isFile(e.mode)?t.size=e.usedBytes:Le.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new g(e.atime),t.mtime=new g(e.mtime),t.ctime=new g(e.ctime),t.blksize=4096,t.blocks=c.ceil(t.size/t.blksize),t},setattr(e,t){for(const i of["mode","atime","mtime","ctime"])null!=t[i]&&(e[i]=t[i]);t.size!==W&&Fe.resizeFileStorage(e,t.size)},lookup(e,t){throw Fe.doesNotExistError},mknod:(e,t,i,n)=>Fe.createNode(e,t,i,n),rename(e,t,i){var n;try{n=Le.lookupNode(t,i)}catch(e){}if(n){if(Le.isDir(e.mode))for(var o in n.contents)throw new Le.ErrnoError(55);Le.hashRemoveNode(n)}delete e.parent.contents[e.name],t.contents[i]=e,e.name=i,t.ctime=t.mtime=e.parent.ctime=e.parent.mtime=g.now()},unlink(e,t){delete e.contents[t],e.ctime=e.mtime=g.now()},rmdir(e,t){var i=Le.lookupNode(e,t);for(var n in i.contents)throw new Le.ErrnoError(55);delete e.contents[t],e.ctime=e.mtime=g.now()},readdir:e=>[".","..",...s.keys(e.contents)],symlink(e,t,i){var n=Fe.createNode(e,t,41471,0);return n.link=i,n},readlink(e){if(!Le.isLink(e.mode))throw new Le.ErrnoError(28);return e.link}},stream_ops:{read(e,t,i,n,o){var r=e.node.contents;if(o>=e.node.usedBytes)return 0;var s=c.min(e.node.usedBytes-o,n);if(s>8&&r.subarray)t.set(r.subarray(o,o+s),i);else for(var a=0;a<s;a++)t[i+a]=r[o+a];return s},write(e,t,i,n,o,r){if(t.buffer===G.buffer&&(r=!1),!n)return 0;var s=e.node;if(s.mtime=s.ctime=g.now(),t.subarray&&(!s.contents||s.contents.subarray)){if(r)return s.contents=t.subarray(i,i+n),s.usedBytes=n,n;if(0===s.usedBytes&&0===o)return s.contents=t.slice(i,i+n),s.usedBytes=n,n;if(o+n<=s.usedBytes)return s.contents.set(t.subarray(i,i+n),o),n}if(Fe.expandFileStorage(s,o+n),s.contents.subarray&&t.subarray)s.contents.set(t.subarray(i,i+n),o);else for(var a=0;a<n;a++)s.contents[o+a]=t[i+a];return s.usedBytes=c.max(s.usedBytes,o+n),n},llseek(e,t,i){var n=t;if(1===i?n+=e.position:2===i&&Le.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new Le.ErrnoError(28);return n},mmap(e,t,i,n,o){if(!Le.isFile(e.node.mode))throw new Le.ErrnoError(43);var s,a,l=e.node.contents;if(2&o||!l||l.buffer!==G.buffer){if(a=!0,!(s=Me()))throw new Le.ErrnoError(48);l&&((i>0||i+t<l.length)&&(l=l.subarray?l.subarray(i,i+t):r.prototype.slice.call(l,i,i+t)),G.set(l,s))}else a=!1,s=l.byteOffset;return{ptr:s,allocated:a}},msync:(e,t,i,n,o)=>(Fe.stream_ops.write(e,t,0,n,i,!1),0)}},Te=async e=>{var t=await w(e);return new Uint8Array(t)};Te.isAsync=!0;var Re,We=[],Ge=(e,t)=>{var i=0;return e&&(i|=365),t&&(i|=146),i},xe={dbs:{},indexedDB:()=>{if("undefined"!=typeof indexedDB)return indexedDB;var t=null;return"object"==typeof e&&(t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB),t},DB_VERSION:21,DB_STORE_NAME:"FILE_DATA",queuePersist:e=>{function t(){"again"===e.idbPersistState?i():e.idbPersistState=0}function i(){e.idbPersistState="idb",xe.syncfs(e,!1,t)}e.idbPersistState?"idb"===e.idbPersistState&&(e.idbPersistState="again"):e.idbPersistState=setTimeout(i,0)},mount:e=>{var t=Fe.mount(e);if(e?.opts?.autoPersist){t.idbPersistState=0;var i=t.node_ops;t.node_ops={...t.node_ops},t.node_ops.mknod=(e,n,o,r)=>{var s=i.mknod(e,n,o,r);return s.node_ops=t.node_ops,s.idbfs_mount=t.mount,s.memfs_stream_ops=s.stream_ops,s.stream_ops={...s.stream_ops},s.stream_ops.write=(e,t,i,n,o,r)=>(e.node.isModified=!0,s.memfs_stream_ops.write(e,t,i,n,o,r)),s.stream_ops.close=e=>{var t=e.node;if(t.isModified&&(xe.queuePersist(t.idbfs_mount),t.isModified=!1),t.memfs_stream_ops.close)return t.memfs_stream_ops.close(e)},s},t.node_ops.mkdir=(...e)=>(xe.queuePersist(t.mount),i.mkdir(...e)),t.node_ops.rmdir=(...e)=>(xe.queuePersist(t.mount),i.rmdir(...e)),t.node_ops.symlink=(...e)=>(xe.queuePersist(t.mount),i.symlink(...e)),t.node_ops.unlink=(...e)=>(xe.queuePersist(t.mount),i.unlink(...e)),t.node_ops.rename=(...e)=>(xe.queuePersist(t.mount),i.rename(...e))}return t},syncfs:(e,t,i)=>{xe.getLocalSet(e,((n,o)=>{if(n)return i(n);xe.getRemoteSet(e,((e,n)=>{if(e)return i(e);var r=t?n:o,s=t?o:n;xe.reconcile(r,s,i)}))}))},quit:()=>{s.values(xe.dbs).forEach((e=>e.close())),xe.dbs={}},getDB:(e,t)=>{var i,n=xe.dbs[e];if(n)return t(null,n);try{i=xe.indexedDB().open(e,xe.DB_VERSION)}catch(e){return t(e)}if(!i)return t("Unable to connect to IndexedDB");i.onupgradeneeded=e=>{var t,i=e.target.result,n=e.target.transaction;(t=i.objectStoreNames.contains(xe.DB_STORE_NAME)?n.objectStore(xe.DB_STORE_NAME):i.createObjectStore(xe.DB_STORE_NAME)).indexNames.contains("timestamp")||t.createIndex("timestamp","timestamp",{unique:!1})},i.onsuccess=()=>{n=i.result,xe.dbs[e]=n,t(null,n)},i.onerror=e=>{t(e.target.error),e.preventDefault()}},getLocalSet:(e,t)=>{var i={};function n(e){return"."!==e&&".."!==e}function o(e){return t=>we.join2(e,t)}for(var r=Le.readdir(e.mountpoint).filter(n).map(o(e.mountpoint));r.length;){var s,a=r.pop();try{s=Le.stat(a)}catch(e){return t(e)}Le.isDir(s.mode)&&r.push(...Le.readdir(a).filter(n).map(o(a))),i[a]={timestamp:s.mtime}}return t(null,{type:"local",entries:i})},getRemoteSet:(e,t)=>{var i={};xe.getDB(e.mountpoint,((e,n)=>{if(e)return t(e);try{var o=n.transaction([xe.DB_STORE_NAME],"readonly");o.onerror=e=>{t(e.target.error),e.preventDefault()},o.objectStore(xe.DB_STORE_NAME).index("timestamp").openKeyCursor().onsuccess=e=>{var o=e.target.result;if(!o)return t(null,{type:"remote",db:n,entries:i});i[o.primaryKey]={timestamp:o.key},o.continue()}}catch(e){return t(e)}}))},loadLocalEntry:(e,t)=>{var i,n;try{n=Le.lookupPath(e).node,i=Le.stat(e)}catch(e){return t(e)}return Le.isDir(i.mode)?t(null,{timestamp:i.mtime,mode:i.mode}):Le.isFile(i.mode)?(n.contents=Fe.getFileDataAsTypedArray(n),t(null,{timestamp:i.mtime,mode:i.mode,contents:n.contents})):t(new S("node type not supported"))},storeLocalEntry:(e,t,i)=>{try{if(Le.isDir(t.mode))Le.mkdirTree(e,t.mode);else{if(!Le.isFile(t.mode))return i(new S("node type not supported"));Le.writeFile(e,t.contents,{canOwn:!0})}Le.chmod(e,t.mode),Le.utime(e,t.timestamp,t.timestamp)}catch(e){return i(e)}i(null)},removeLocalEntry:(e,t)=>{try{var i=Le.stat(e);Le.isDir(i.mode)?Le.rmdir(e):Le.isFile(i.mode)&&Le.unlink(e)}catch(e){return t(e)}t(null)},loadRemoteEntry:(e,t,i)=>{var n=e.get(t);n.onsuccess=e=>i(null,e.target.result),n.onerror=e=>{i(e.target.error),e.preventDefault()}},storeRemoteEntry:(e,t,i,n)=>{try{var o=e.put(i,t)}catch(e){return void n(e)}o.onsuccess=e=>n(),o.onerror=e=>{n(e.target.error),e.preventDefault()}},removeRemoteEntry:(e,t,i)=>{var n=e.delete(t);n.onsuccess=e=>i(),n.onerror=e=>{i(e.target.error),e.preventDefault()}},reconcile:(e,t,i)=>{var n=0,o=[];s.keys(e.entries).forEach((i=>{var r=e.entries[i],s=t.entries[i];s&&r.timestamp.getTime()==s.timestamp.getTime()||(o.push(i),n++)}));var r=[];if(s.keys(t.entries).forEach((t=>{e.entries[t]||(r.push(t),n++)})),!n)return i(null);var a=!1,l=("remote"===e.type?e.db:t.db).transaction([xe.DB_STORE_NAME],"readwrite"),c=l.objectStore(xe.DB_STORE_NAME);function d(e){if(e&&!a)return a=!0,i(e)}l.onerror=l.onabort=e=>{d(e.target.error),e.preventDefault()},l.oncomplete=e=>{a||i(null)},o.sort().forEach((e=>{"local"===t.type?xe.loadRemoteEntry(c,e,((t,i)=>{if(t)return d(t);xe.storeLocalEntry(e,i,d)})):xe.loadLocalEntry(e,((t,i)=>{if(t)return d(t);xe.storeRemoteEntry(c,e,i,d)}))})),r.sort().reverse().forEach((e=>{"local"===t.type?xe.removeLocalEntry(e,d):xe.removeRemoteEntry(c,e,d)}))}},Le={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,filesystems:null,syncFSRequests:0,readFiles:{},ErrnoError:class{name="ErrnoError";constructor(e){this.errno=e}},FSStream:class{shared={};get object(){return this.node}set object(e){this.node=e}get isRead(){return 1!=(2097155&this.flags)}get isWrite(){return!!(2097155&this.flags)}get isAppend(){return 1024&this.flags}get flags(){return this.shared.flags}set flags(e){this.shared.flags=e}get position(){return this.shared.position}set position(e){this.shared.position=e}},FSNode:class{node_ops={};stream_ops={};readMode=365;writeMode=146;mounted=null;constructor(e,t,i,n){e||(e=this),this.parent=e,this.mount=e.mount,this.id=Le.nextInode++,this.name=t,this.mode=i,this.rdev=n,this.atime=this.mtime=this.ctime=g.now()}get read(){return(this.mode&this.readMode)===this.readMode}set read(e){e?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(e){e?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return Le.isDir(this.mode)}get isDevice(){return Le.isChrdev(this.mode)}},lookupPath(e,t={}){if(!e)throw new Le.ErrnoError(44);t.follow_mount??=!0,we.isAbs(e)||(e=Le.cwd()+"/"+e);e:for(var i=0;i<40;i++){for(var n=e.split("/").filter((e=>!!e)),o=Le.root,r="/",s=0;s<n.length;s++){var a=s===n.length-1;if(a&&t.parent)break;if("."!==n[s])if(".."!==n[s]){r=we.join2(r,n[s]);try{o=Le.lookupNode(o,n[s])}catch(e){if(44===e?.errno&&a&&t.noent_okay)return{path:r};throw e}if(!Le.isMountpoint(o)||a&&!t.follow_mount||(o=o.mounted.root),Le.isLink(o.mode)&&(!a||t.follow)){if(!o.node_ops.readlink)throw new Le.ErrnoError(52);var l=o.node_ops.readlink(o);we.isAbs(l)||(l=we.dirname(r)+"/"+l),e=l+"/"+n.slice(s+1).join("/");continue e}}else{if(r=we.dirname(r),Le.isRoot(o)){e=r+"/"+n.slice(s+1).join("/");continue e}o=o.parent}}return{path:r,node:o}}throw new Le.ErrnoError(32)},getPath(e){for(var t;;){if(Le.isRoot(e)){var i=e.mount.mountpoint;return t?"/"!==i[i.length-1]?`${i}/${t}`:i+t:i}t=t?`${e.name}/${t}`:e.name,e=e.parent}},hashName(e,t){for(var i=0,n=0;n<t.length;n++)i=(i<<5)-i+t.charCodeAt(n)|0;return(e+i>>>0)%Le.nameTable.length},hashAddNode(e){var t=Le.hashName(e.parent.id,e.name);e.name_next=Le.nameTable[t],Le.nameTable[t]=e},hashRemoveNode(e){var t=Le.hashName(e.parent.id,e.name);if(Le.nameTable[t]===e)Le.nameTable[t]=e.name_next;else for(var i=Le.nameTable[t];i;){if(i.name_next===e){i.name_next=e.name_next;break}i=i.name_next}},lookupNode(e,t){var i=Le.mayLookup(e);if(i)throw new Le.ErrnoError(i);for(var n=Le.hashName(e.id,t),o=Le.nameTable[n];o;o=o.name_next){var r=o.name;if(o.parent.id===e.id&&r===t)return o}return Le.lookup(e,t)},createNode(e,t,i,n){var o=new Le.FSNode(e,t,i,n);return Le.hashAddNode(o),o},destroyNode(e){Le.hashRemoveNode(e)},isRoot:e=>e===e.parent,isMountpoint:e=>!!e.mounted,isFile:e=>32768==(61440&e),isDir:e=>16384==(61440&e),isLink:e=>40960==(61440&e),isChrdev:e=>8192==(61440&e),isBlkdev:e=>24576==(61440&e),isFIFO:e=>4096==(61440&e),isSocket:e=>!(49152&~e),flagsToPermissionString(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:(e,t)=>Le.ignorePermissions||(!t.includes("r")||292&e.mode)&&(!t.includes("w")||146&e.mode)&&(!t.includes("x")||73&e.mode)?0:2,mayLookup(e){if(!Le.isDir(e.mode))return 54;var t=Le.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate(e,t){if(!Le.isDir(e.mode))return 54;try{return Le.lookupNode(e,t),20}catch(e){}return Le.nodePermissions(e,"wx")},mayDelete(e,t,i){var n;try{n=Le.lookupNode(e,t)}catch(e){return e.errno}var o=Le.nodePermissions(e,"wx");if(o)return o;if(i){if(!Le.isDir(n.mode))return 54;if(Le.isRoot(n)||Le.getPath(n)===Le.cwd())return 10}else if(Le.isDir(n.mode))return 31;return 0},mayOpen:(e,t)=>e?Le.isLink(e.mode)?32:Le.isDir(e.mode)&&("r"!==Le.flagsToPermissionString(t)||576&t)?31:Le.nodePermissions(e,Le.flagsToPermissionString(t)):44,checkOpExists(e,t){if(!e)throw new Le.ErrnoError(t);return e},MAX_OPEN_FDS:4096,nextfd(){for(var e=0;e<=Le.MAX_OPEN_FDS;e++)if(!Le.streams[e])return e;throw new Le.ErrnoError(33)},getStreamChecked(e){var t=Le.getStream(e);if(!t)throw new Le.ErrnoError(8);return t},getStream:e=>Le.streams[e],createStream:(e,t=-1)=>(e=s.assign(new Le.FSStream,e),-1==t&&(t=Le.nextfd()),e.fd=t,Le.streams[t]=e,e),closeStream(e){Le.streams[e]=null},dupStream(e,t=-1){var i=Le.createStream(e,t);return i.stream_ops?.dup?.(i),i},doSetAttr(e,t,i){var n=e?.stream_ops.setattr,o=n?e:t;n??=t.node_ops.setattr,Le.checkOpExists(n,63),n(o,i)},chrdev_stream_ops:{open(e){var t=Le.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open?.(e)},llseek(){throw new Le.ErrnoError(70)}},major:e=>e>>8,minor:e=>255&e,makedev:(e,t)=>e<<8|t,registerDevice(e,t){Le.devices[e]={stream_ops:t}},getDevice:e=>Le.devices[e],getMounts(e){for(var t=[],i=[e];i.length;){var n=i.pop();t.push(n),i.push(...n.mounts)}return t},syncfs(e,t){"function"==typeof e&&(t=e,e=!1),Le.syncFSRequests++,Le.syncFSRequests>1&&J(`warning: ${Le.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var i=Le.getMounts(Le.root.mount),n=0;function o(e){return Le.syncFSRequests--,t(e)}function r(e){if(e)return r.errored?void 0:(r.errored=!0,o(e));++n>=i.length&&o(null)}i.forEach((t=>{if(!t.type.syncfs)return r(null);t.type.syncfs(t,e,r)}))},mount(e,t,i){var n,o="/"===i,r=!i;if(o&&Le.root)throw new Le.ErrnoError(10);if(!o&&!r){var s=Le.lookupPath(i,{follow_mount:!1});if(i=s.path,n=s.node,Le.isMountpoint(n))throw new Le.ErrnoError(10);if(!Le.isDir(n.mode))throw new Le.ErrnoError(54)}var a={type:e,opts:t,mountpoint:i,mounts:[]},l=e.mount(a);return l.mount=a,a.root=l,o?Le.root=l:n&&(n.mounted=a,n.mount&&n.mount.mounts.push(a)),l},unmount(e){var t=Le.lookupPath(e,{follow_mount:!1});if(!Le.isMountpoint(t.node))throw new Le.ErrnoError(28);var i=t.node,n=i.mounted,o=Le.getMounts(n);s.keys(Le.nameTable).forEach((e=>{for(var t=Le.nameTable[e];t;){var i=t.name_next;o.includes(t.mount)&&Le.destroyNode(t),t=i}})),i.mounted=null;var r=i.mount.mounts.indexOf(n);i.mount.mounts.splice(r,1)},lookup:(e,t)=>e.node_ops.lookup(e,t),mknod(e,t,i){var n=Le.lookupPath(e,{parent:!0}).node,o=we.basename(e);if(!o)throw new Le.ErrnoError(28);if("."===o||".."===o)throw new Le.ErrnoError(20);var r=Le.mayCreate(n,o);if(r)throw new Le.ErrnoError(r);if(!n.node_ops.mknod)throw new Le.ErrnoError(63);return n.node_ops.mknod(n,o,t,i)},statfs:e=>Le.statfsNode(Le.lookupPath(e,{follow:!0}).node),statfsStream:e=>Le.statfsNode(e.node),statfsNode(e){var t={bsize:4096,frsize:4096,blocks:1e6,bfree:5e5,bavail:5e5,files:Le.nextInode,ffree:Le.nextInode-1,fsid:42,flags:2,namelen:255};return e.node_ops.statfs&&s.assign(t,e.node_ops.statfs(e.mount.opts.root)),t},create:(e,t=438)=>(t&=4095,t|=32768,Le.mknod(e,t,0)),mkdir:(e,t=511)=>(t&=1023,t|=16384,Le.mknod(e,t,0)),mkdirTree(e,t){var i=e.split("/"),n="";for(var o of i)if(o){(n||we.isAbs(e))&&(n+="/"),n+=o;try{Le.mkdir(n,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:(e,t,i)=>(void 0===i&&(i=t,t=438),t|=8192,Le.mknod(e,t,i)),symlink(e,t){if(!Be.resolve(e))throw new Le.ErrnoError(44);var i=Le.lookupPath(t,{parent:!0}).node;if(!i)throw new Le.ErrnoError(44);var n=we.basename(t),o=Le.mayCreate(i,n);if(o)throw new Le.ErrnoError(o);if(!i.node_ops.symlink)throw new Le.ErrnoError(63);return i.node_ops.symlink(i,n,e)},rename(e,t){var i,n,o=we.dirname(e),r=we.dirname(t),s=we.basename(e),a=we.basename(t);if(i=Le.lookupPath(e,{parent:!0}).node,n=Le.lookupPath(t,{parent:!0}).node,!i||!n)throw new Le.ErrnoError(44);if(i.mount!==n.mount)throw new Le.ErrnoError(75);var l,c=Le.lookupNode(i,s),d=Be.relative(e,r);if("."!==d.charAt(0))throw new Le.ErrnoError(28);if("."!==(d=Be.relative(t,o)).charAt(0))throw new Le.ErrnoError(55);try{l=Le.lookupNode(n,a)}catch(e){}if(c!==l){var u=Le.isDir(c.mode),g=Le.mayDelete(i,s,u);if(g)throw new Le.ErrnoError(g);if(g=l?Le.mayDelete(n,a,u):Le.mayCreate(n,a))throw new Le.ErrnoError(g);if(!i.node_ops.rename)throw new Le.ErrnoError(63);if(Le.isMountpoint(c)||l&&Le.isMountpoint(l))throw new Le.ErrnoError(10);if(n!==i&&(g=Le.nodePermissions(i,"w")))throw new Le.ErrnoError(g);Le.hashRemoveNode(c);try{i.node_ops.rename(c,n,a),c.parent=n}catch(e){throw e}finally{Le.hashAddNode(c)}}},rmdir(e){var t=Le.lookupPath(e,{parent:!0}).node,i=we.basename(e),n=Le.lookupNode(t,i),o=Le.mayDelete(t,i,!0);if(o)throw new Le.ErrnoError(o);if(!t.node_ops.rmdir)throw new Le.ErrnoError(63);if(Le.isMountpoint(n))throw new Le.ErrnoError(10);t.node_ops.rmdir(t,i),Le.destroyNode(n)},readdir(e){var t=Le.lookupPath(e,{follow:!0}).node;return Le.checkOpExists(t.node_ops.readdir,54)(t)},unlink(e){var t=Le.lookupPath(e,{parent:!0}).node;if(!t)throw new Le.ErrnoError(44);var i=we.basename(e),n=Le.lookupNode(t,i),o=Le.mayDelete(t,i,!1);if(o)throw new Le.ErrnoError(o);if(!t.node_ops.unlink)throw new Le.ErrnoError(63);if(Le.isMountpoint(n))throw new Le.ErrnoError(10);t.node_ops.unlink(t,i),Le.destroyNode(n)},readlink(e){var t=Le.lookupPath(e).node;if(!t)throw new Le.ErrnoError(44);if(!t.node_ops.readlink)throw new Le.ErrnoError(28);return t.node_ops.readlink(t)},stat(e,t){var i=Le.lookupPath(e,{follow:!t}).node;return Le.checkOpExists(i.node_ops.getattr,63)(i)},fstat(e){var t=Le.getStreamChecked(e),i=t.node,n=t.stream_ops.getattr,o=n?t:i;return n??=i.node_ops.getattr,Le.checkOpExists(n,63),n(o)},lstat:e=>Le.stat(e,!0),doChmod(e,t,i,n){Le.doSetAttr(e,t,{mode:4095&i|-4096&t.mode,ctime:g.now(),dontFollow:n})},chmod(e,t,i){var n;n="string"==typeof e?Le.lookupPath(e,{follow:!i}).node:e,Le.doChmod(null,n,t,i)},lchmod(e,t){Le.chmod(e,t,!0)},fchmod(e,t){var i=Le.getStreamChecked(e);Le.doChmod(i,i.node,t,!1)},doChown(e,t,i){Le.doSetAttr(e,t,{timestamp:g.now(),dontFollow:i})},chown(e,t,i,n){var o;o="string"==typeof e?Le.lookupPath(e,{follow:!n}).node:e,Le.doChown(null,o,n)},lchown(e,t,i){Le.chown(e,t,i,!0)},fchown(e,t,i){var n=Le.getStreamChecked(e);Le.doChown(n,n.node,!1)},doTruncate(e,t,i){if(Le.isDir(t.mode))throw new Le.ErrnoError(31);if(!Le.isFile(t.mode))throw new Le.ErrnoError(28);var n=Le.nodePermissions(t,"w");if(n)throw new Le.ErrnoError(n);Le.doSetAttr(e,t,{size:i,timestamp:g.now()})},truncate(e,t){if(t<0)throw new Le.ErrnoError(28);var i;i="string"==typeof e?Le.lookupPath(e,{follow:!0}).node:e,Le.doTruncate(null,i,t)},ftruncate(e,t){var i=Le.getStreamChecked(e);if(t<0||!(2097155&i.flags))throw new Le.ErrnoError(28);Le.doTruncate(i,i.node,t)},utime(e,t,i){var n=Le.lookupPath(e,{follow:!0}).node;Le.checkOpExists(n.node_ops.setattr,63)(n,{atime:t,mtime:i})},open(e,t,i=438){if(""===e)throw new Le.ErrnoError(44);var n,o;if(i=64&(t="string"==typeof t?(e=>{var t={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[e];if(void 0===t)throw new S(`Unknown file open mode: ${e}`);return t})(t):t)?4095&i|32768:0,"object"==typeof e)n=e;else{o=e.endsWith("/");var r=Le.lookupPath(e,{follow:!(131072&t),noent_okay:!0});n=r.node,e=r.path}var s=!1;if(64&t)if(n){if(128&t)throw new Le.ErrnoError(20)}else{if(o)throw new Le.ErrnoError(31);n=Le.mknod(e,511|i,0),s=!0}if(!n)throw new Le.ErrnoError(44);if(Le.isChrdev(n.mode)&&(t&=-513),65536&t&&!Le.isDir(n.mode))throw new Le.ErrnoError(54);if(!s){var a=Le.mayOpen(n,t);if(a)throw new Le.ErrnoError(a)}512&t&&!s&&Le.truncate(n,0),t&=-131713;var l=Le.createStream({node:n,path:Le.getPath(n),flags:t,seekable:!0,position:0,stream_ops:n.stream_ops,ungotten:[],error:!1});return l.stream_ops.open&&l.stream_ops.open(l),s&&Le.chmod(n,511&i),!h.logReadFiles||1&t||e in Le.readFiles||(Le.readFiles[e]=1),l},close(e){if(Le.isClosed(e))throw new Le.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{Le.closeStream(e.fd)}e.fd=null},isClosed:e=>null===e.fd,llseek(e,t,i){if(Le.isClosed(e))throw new Le.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new Le.ErrnoError(70);if(0!=i&&1!=i&&2!=i)throw new Le.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,i),e.ungotten=[],e.position},read(e,t,i,n,o){if(n<0||o<0)throw new Le.ErrnoError(28);if(Le.isClosed(e))throw new Le.ErrnoError(8);if(1==(2097155&e.flags))throw new Le.ErrnoError(8);if(Le.isDir(e.node.mode))throw new Le.ErrnoError(31);if(!e.stream_ops.read)throw new Le.ErrnoError(28);var r=void 0!==o;if(r){if(!e.seekable)throw new Le.ErrnoError(70)}else o=e.position;var s=e.stream_ops.read(e,t,i,n,o);return r||(e.position+=s),s},write(e,t,i,n,o,r){if(n<0||o<0)throw new Le.ErrnoError(28);if(Le.isClosed(e))throw new Le.ErrnoError(8);if(!(2097155&e.flags))throw new Le.ErrnoError(8);if(Le.isDir(e.node.mode))throw new Le.ErrnoError(31);if(!e.stream_ops.write)throw new Le.ErrnoError(28);e.seekable&&1024&e.flags&&Le.llseek(e,0,2);var s=void 0!==o;if(s){if(!e.seekable)throw new Le.ErrnoError(70)}else o=e.position;var a=e.stream_ops.write(e,t,i,n,o,r);return s||(e.position+=a),a},mmap(e,t,i,n,o){if(2&n&&!(2&o)&&2!=(2097155&e.flags))throw new Le.ErrnoError(2);if(1==(2097155&e.flags))throw new Le.ErrnoError(2);if(!e.stream_ops.mmap)throw new Le.ErrnoError(43);if(!t)throw new Le.ErrnoError(28);return e.stream_ops.mmap(e,t,i,n,o)},msync:(e,t,i,n,o)=>e.stream_ops.msync?e.stream_ops.msync(e,t,i,n,o):0,ioctl(e,t,i){if(!e.stream_ops.ioctl)throw new Le.ErrnoError(59);return e.stream_ops.ioctl(e,t,i)},readFile(e,t={}){if(t.flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new S(`Invalid encoding type "${t.encoding}"`);var i,n=Le.open(e,t.flags),o=Le.stat(e).size,r=new Uint8Array(o);return Le.read(n,r,0,o,0),"utf8"===t.encoding?i=Ze(r):"binary"===t.encoding&&(i=r),Le.close(n),i},writeFile(e,t,i={}){i.flags=i.flags||577;var n=Le.open(e,i.flags,i.mode);if("string"==typeof t){var o=new Uint8Array(Ee(t)+1),r=Ue(t,o,0,o.length);Le.write(n,o,0,r,W,i.canOwn)}else{if(!ArrayBuffer.isView(t))throw new S("Unsupported data type");Le.write(n,t,0,t.byteLength,W,i.canOwn)}Le.close(n)},cwd:()=>Le.currentPath,chdir(e){var t=Le.lookupPath(e,{follow:!0});if(null===t.node)throw new Le.ErrnoError(44);if(!Le.isDir(t.node.mode))throw new Le.ErrnoError(54);var i=Le.nodePermissions(t.node,"x");if(i)throw new Le.ErrnoError(i);Le.currentPath=t.path},createDefaultDirectories(){Le.mkdir("/tmp"),Le.mkdir("/home"),Le.mkdir("/home/web_user")},createDefaultDevices(){Le.mkdir("/dev"),Le.registerDevice(Le.makedev(1,3),{read:()=>0,write:(e,t,i,n,o)=>n,llseek:()=>0}),Le.mkdev("/dev/null",Le.makedev(1,3)),ke.register(Le.makedev(5,0),ke.default_tty_ops),ke.register(Le.makedev(6,0),ke.default_tty1_ops),Le.mkdev("/dev/tty",Le.makedev(5,0)),Le.mkdev("/dev/tty1",Le.makedev(6,0));var e=new Uint8Array(1024),t=0,i=()=>(0===t&&(Ve(e),t=e.byteLength),e[--t]);Le.createDevice("/dev","random",i),Le.createDevice("/dev","urandom",i),Le.mkdir("/dev/shm"),Le.mkdir("/dev/shm/tmp")},createSpecialDirectories(){Le.mkdir("/proc");var e=Le.mkdir("/proc/self");Le.mkdir("/proc/self/fd"),Le.mount({mount(){var t=Le.createNode(e,"fd",16895,73);return t.stream_ops={llseek:Fe.stream_ops.llseek},t.node_ops={lookup(e,t){var i=+t,n=Le.getStreamChecked(i),o={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>n.path},id:i+1};return o.parent=o,o},readdir:()=>r.from(Le.streams.entries()).filter((([e,t])=>t)).map((([e,t])=>e.toString()))},t}},{},"/proc/self/fd")},createStandardStreams(e,t,i){e?Le.createDevice("/dev","stdin",e):Le.symlink("/dev/tty","/dev/stdin"),t?Le.createDevice("/dev","stdout",null,t):Le.symlink("/dev/tty","/dev/stdout"),i?Le.createDevice("/dev","stderr",null,i):Le.symlink("/dev/tty1","/dev/stderr"),Le.open("/dev/stdin",0),Le.open("/dev/stdout",1),Le.open("/dev/stderr",1)},staticInit(){Le.nameTable=new r(4096),Le.mount(Fe,{},"/"),Le.createDefaultDirectories(),Le.createDefaultDevices(),Le.createSpecialDirectories(),Le.filesystems={MEMFS:Fe,IDBFS:xe}},init(e,t,i){Le.initialized=!0,e??=h.stdin,t??=h.stdout,i??=h.stderr,Le.createStandardStreams(e,t,i)},quit(){for(var e of(Le.initialized=!1,Le.streams))e&&Le.close(e)},findObject(e,t){var i=Le.analyzePath(e,t);return i.exists?i.object:null},analyzePath(e,t){try{e=(n=Le.lookupPath(e,{follow:!t})).path}catch(e){}var i={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=Le.lookupPath(e,{parent:!0});i.parentExists=!0,i.parentPath=n.path,i.parentObject=n.node,i.name=we.basename(e),n=Le.lookupPath(e,{follow:!t}),i.exists=!0,i.path=n.path,i.object=n.node,i.name=n.node.name,i.isRoot="/"===n.path}catch(e){i.error=e.errno}return i},createPath(e,t,i,n){e="string"==typeof e?e:Le.getPath(e);for(var o=t.split("/").reverse();o.length;){var r=o.pop();if(r){var s=we.join2(e,r);try{Le.mkdir(s)}catch(e){if(20!=e.errno)throw e}e=s}}return s},createFile(e,t,i,n,o){var r=we.join2("string"==typeof e?e:Le.getPath(e),t),s=Ge(n,o);return Le.create(r,s)},createDataFile(e,t,i,n,o,s){var a=t;e&&(e="string"==typeof e?e:Le.getPath(e),a=t?we.join2(e,t):e);var l=Ge(n,o),c=Le.create(a,l);if(i){if("string"==typeof i){for(var d=new r(i.length),u=0,g=i.length;u<g;++u)d[u]=i.charCodeAt(u);i=d}Le.chmod(c,146|l);var h=Le.open(c,577);Le.write(h,i,0,i.length,0,s),Le.close(h),Le.chmod(c,l)}},createDevice(e,t,i,n){var o=we.join2("string"==typeof e?e:Le.getPath(e),t),r=Ge(!!i,!!n);Le.createDevice.major??=64;var s=Le.makedev(Le.createDevice.major++,0);return Le.registerDevice(s,{open(e){e.seekable=!1},close(e){n?.buffer?.length&&n(10)},read(e,t,n,o,r){for(var s=0,a=0;a<o;a++){var l;try{l=i()}catch(e){throw new Le.ErrnoError(29)}if(l===W&&0===s)throw new Le.ErrnoError(6);if(null===l||l===W)break;s++,t[n+a]=l}return s&&(e.node.atime=g.now()),s},write(e,t,i,o,r){for(var s=0;s<o;s++)try{n(t[i+s])}catch(e){throw new Le.ErrnoError(29)}return o&&(e.node.mtime=e.node.ctime=g.now()),s}}),Le.mkdev(o,r,s)},forceLoadFile(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new S("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{e.contents=A(e.url),e.usedBytes=e.contents.length}catch(e){throw new Le.ErrnoError(29)}},createLazyFile(e,t,i,n,o){class r{lengthKnown=!1;chunks=[];get(e){if(e>this.length-1||e<0)return W;var t=e%this.chunkSize,i=e/this.chunkSize|0;return this.getter(i)[t]}setDataGetter(e){this.getter=e}cacheLength(){var e=new XMLHttpRequest;if(e.open("HEAD",i,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new S("Couldn't load "+i+". Status: "+e.status);var t,n=d(e.getResponseHeader("Content-length")),o=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,r=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,s=1048576;o||(s=n);var a=this;a.setDataGetter((e=>{var t=e*s,o=(e+1)*s-1;if(o=c.min(o,n-1),void 0===a.chunks[e]&&(a.chunks[e]=((e,t)=>{if(e>t)throw new S("invalid range ("+e+", "+t+") or no bytes requested!");if(t>n-1)throw new S("only "+n+" bytes available! programmer error!");var o=new XMLHttpRequest;if(o.open("GET",i,!1),n!==s&&o.setRequestHeader("Range","bytes="+e+"-"+t),o.responseType="arraybuffer",o.overrideMimeType&&o.overrideMimeType("text/plain; charset=x-user-defined"),o.send(null),!(o.status>=200&&o.status<300||304===o.status))throw new S("Couldn't load "+i+". Status: "+o.status);return o.response!==W?new Uint8Array(o.response||[]):Ne(o.responseText||"",!0)})(t,o)),void 0===a.chunks[e])throw new S("doXHR failed!");return a.chunks[e]})),!r&&n||(s=n=1,n=this.getter(0).length,s=n,H("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=s,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if("undefined"!=typeof XMLHttpRequest){if(!f)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var a={isDevice:!1,contents:new r}}else a={isDevice:!1,url:i};var l=Le.createFile(e,t,a,n,o);a.contents?l.contents=a.contents:a.url&&(l.contents=null,l.url=a.url),s.defineProperties(l,{usedBytes:{get:function(){return this.contents.length}}});var u={};function g(e,t,i,n,o){var r=e.node.contents;if(o>=r.length)return 0;var s=c.min(r.length-o,n);if(r.slice)for(var a=0;a<s;a++)t[i+a]=r[o+a];else for(a=0;a<s;a++)t[i+a]=r.get(o+a);return s}return s.keys(l.stream_ops).forEach((e=>{var t=l.stream_ops[e];u[e]=(...e)=>(Le.forceLoadFile(l),t(...e))})),u.read=(e,t,i,n,o)=>(Le.forceLoadFile(l),g(e,t,i,n,o)),u.mmap=(e,t,i,n,o)=>{Le.forceLoadFile(l);var r=Me();if(!r)throw new Le.ErrnoError(48);return g(e,G,r,t,i),{ptr:r,allocated:!0}},l.stream_ops=u,l}},Qe={websocketArgs:{},callbacks:{},on(e,t){Qe.callbacks[e]=t},emit(e,t){Qe.callbacks[e]?.(t)},mount:e=>(Qe.websocketArgs=h.websocket||{},(h.websocket??={}).on=Qe.on,Le.createNode(null,"/",16895,0)),createSocket(e,t,i){if(1==(t&=-526337)&&i&&6!=i)throw new Le.ErrnoError(66);var n={family:e,type:t,protocol:i,server:null,error:null,peers:{},pending:[],recv_queue:[],sock_ops:Qe.websocket_sock_ops},o=Qe.nextname(),r=Le.createNode(Qe.root,o,49152,0);r.sock=n;var s=Le.createStream({path:o,node:r,flags:2,seekable:!1,stream_ops:Qe.stream_ops});return n.stream=s,n},getSocket(e){var t=Le.getStream(e);return t&&Le.isSocket(t.node.mode)?t.node.sock:null},stream_ops:{poll(e){var t=e.node.sock;return t.sock_ops.poll(t)},ioctl(e,t,i){var n=e.node.sock;return n.sock_ops.ioctl(n,t,i)},read(e,t,i,n,o){var r=e.node.sock,s=r.sock_ops.recvmsg(r,n);return s?(t.set(s.buffer,i),s.buffer.length):0},write(e,t,i,n,o){var r=e.node.sock;return r.sock_ops.sendmsg(r,t,i,n)},close(e){var t=e.node.sock;t.sock_ops.close(t)}},nextname:()=>(Qe.nextname.current||(Qe.nextname.current=0),`socket[${Qe.nextname.current++}]`),websocket_sock_ops:{createPeer(e,t,i){var n;if("object"==typeof t&&(n=t,t=null,i=null),n)if(n._socket)t=n._socket.remoteAddress,i=n._socket.remotePort;else{var o=/ws[s]?:\/\/([^:]+):(\d+)/.exec(n.url);if(!o)throw new S("WebSocket URL must be in the format ws(s)://address:port");t=o[1],i=E(o[2],10)}else try{var r="ws://".replace("#","//"),s="binary",a=W;if(Qe.websocketArgs.url&&(r=Qe.websocketArgs.url),Qe.websocketArgs.subprotocol?s=Qe.websocketArgs.subprotocol:null===Qe.websocketArgs.subprotocol&&(s="null"),"ws://"===r||"wss://"===r){var l=t.split("/");r=r+l[0]+":"+i+"/"+l.slice(1).join("/")}"null"!==s&&(a=s=s.replace(/^ +| +$/g,"").split(/ *, */)),(n=new WebSocket(r,a)).binaryType="arraybuffer"}catch(e){throw new Le.ErrnoError(23)}var c={addr:t,port:i,socket:n,msg_send_queue:[]};return Qe.websocket_sock_ops.addPeer(e,c),Qe.websocket_sock_ops.handlePeerEvents(e,c),2===e.type&&void 0!==e.sport&&c.msg_send_queue.push(new Uint8Array([255,255,255,255,"p".charCodeAt(0),"o".charCodeAt(0),"r".charCodeAt(0),"t".charCodeAt(0),(65280&e.sport)>>8,255&e.sport])),c},getPeer:(e,t,i)=>e.peers[t+":"+i],addPeer(e,t){e.peers[t.addr+":"+t.port]=t},removePeer(e,t){delete e.peers[t.addr+":"+t.port]},handlePeerEvents(e,t){var i=!0,n=function(){e.connecting=!1,Qe.emit("open",e.stream.fd);try{for(var i=t.msg_send_queue.shift();i;)t.socket.send(i),i=t.msg_send_queue.shift()}catch(e){t.socket.close()}};function o(n){if("string"==typeof n)n=(new TextEncoder).encode(n);else{if(O(n.byteLength!==W),0==n.byteLength)return;n=new Uint8Array(n)}var o=i;if(i=!1,o&&10===n.length&&255===n[0]&&255===n[1]&&255===n[2]&&255===n[3]&&n[4]==="p".charCodeAt(0)&&n[5]==="o".charCodeAt(0)&&n[6]==="r".charCodeAt(0)&&n[7]==="t".charCodeAt(0)){var r=n[8]<<8|n[9];return Qe.websocket_sock_ops.removePeer(e,t),t.port=r,void Qe.websocket_sock_ops.addPeer(e,t)}e.recv_queue.push({addr:t.addr,port:t.port,data:n}),Qe.emit("message",e.stream.fd)}b?(t.socket.on("open",n),t.socket.on("message",(function(e,t){t&&o(new Uint8Array(e).buffer)})),t.socket.on("close",(function(){Qe.emit("close",e.stream.fd)})),t.socket.on("error",(function(t){e.error=14,Qe.emit("error",[e.stream.fd,e.error,"ECONNREFUSED: Connection refused"])}))):(t.socket.onopen=n,t.socket.onclose=function(){Qe.emit("close",e.stream.fd)},t.socket.onmessage=function(e){o(e.data)},t.socket.onerror=function(t){e.error=14,Qe.emit("error",[e.stream.fd,e.error,"ECONNREFUSED: Connection refused"])})},poll(e){if(1===e.type&&e.server)return e.pending.length?65:0;var t=0,i=1===e.type?Qe.websocket_sock_ops.getPeer(e,e.daddr,e.dport):null;return(e.recv_queue.length||!i||i&&i.socket.readyState===i.socket.CLOSING||i&&i.socket.readyState===i.socket.CLOSED)&&(t|=65),(!i||i&&i.socket.readyState===i.socket.OPEN)&&(t|=4),(i&&i.socket.readyState===i.socket.CLOSING||i&&i.socket.readyState===i.socket.CLOSED)&&(e.connecting?t|=4:t|=16),t},ioctl(e,t,i){if(21531===t){var n=0;return e.recv_queue.length&&(n=e.recv_queue[0].data.length),K[i>>2]=n,0}return 28},close(e){if(e.server){try{e.server.close()}catch(e){}e.server=null}for(var t of s.values(e.peers)){try{t.socket.close()}catch(e){}Qe.websocket_sock_ops.removePeer(e,t)}return 0},bind(e,t,i){if(void 0!==e.saddr||void 0!==e.sport)throw new Le.ErrnoError(28);if(e.saddr=t,e.sport=i,2===e.type){e.server&&(e.server.close(),e.server=null);try{e.sock_ops.listen(e,0)}catch(e){if("ErrnoError"!==e.name)throw e;if(138!==e.errno)throw e}}},connect(e,t,i){if(e.server)throw new Le.ErrnoError(138);if(void 0!==e.daddr&&void 0!==e.dport){var n=Qe.websocket_sock_ops.getPeer(e,e.daddr,e.dport);if(n)throw n.socket.readyState===n.socket.CONNECTING?new Le.ErrnoError(7):new Le.ErrnoError(30)}var o=Qe.websocket_sock_ops.createPeer(e,t,i);e.daddr=o.addr,e.dport=o.port,e.connecting=!0},listen(e,t){if(!b)throw new Le.ErrnoError(138)},accept(e){if(!e.server||!e.pending.length)throw new Le.ErrnoError(28);var t=e.pending.shift();return t.stream.flags=e.stream.flags,t},getname(e,t){var i,n;if(t){if(e.daddr===W||e.dport===W)throw new Le.ErrnoError(53);i=e.daddr,n=e.dport}else i=e.saddr||0,n=e.sport||0;return{addr:i,port:n}},sendmsg(e,t,i,n,o,r){if(2===e.type){if(o!==W&&r!==W||(o=e.daddr,r=e.dport),o===W||r===W)throw new Le.ErrnoError(17)}else o=e.daddr,r=e.dport;var s=Qe.websocket_sock_ops.getPeer(e,o,r);if(1===e.type&&(!s||s.socket.readyState===s.socket.CLOSING||s.socket.readyState===s.socket.CLOSED))throw new Le.ErrnoError(53);ArrayBuffer.isView(t)&&(i+=t.byteOffset,t=t.buffer);var a=t.slice(i,i+n);if(!s||s.socket.readyState!==s.socket.OPEN)return 2===e.type&&(s&&s.socket.readyState!==s.socket.CLOSING&&s.socket.readyState!==s.socket.CLOSED||(s=Qe.websocket_sock_ops.createPeer(e,o,r))),s.msg_send_queue.push(a),n;try{return s.socket.send(a),n}catch(e){throw new Le.ErrnoError(28)}},recvmsg(e,t){if(1===e.type&&e.server)throw new Le.ErrnoError(53);var i=e.recv_queue.shift();if(!i){if(1===e.type){var n=Qe.websocket_sock_ops.getPeer(e,e.daddr,e.dport);if(!n)throw new Le.ErrnoError(53);if(n.socket.readyState===n.socket.CLOSING||n.socket.readyState===n.socket.CLOSED)return null;throw new Le.ErrnoError(6)}throw new Le.ErrnoError(6)}var o=i.data.byteLength||i.data.length,r=i.data.byteOffset||0,s=i.data.buffer||i.data,a=c.min(t,o),l={buffer:new Uint8Array(s,r,a),addr:i.addr,port:i.port};if(1===e.type&&a<o){var d=o-a;i.data=new Uint8Array(s,r+a,d),e.recv_queue.unshift(i)}return l}}},Xe=e=>{var t=Qe.getSocket(e);if(!t)throw new Le.ErrnoError(8);return t},Ke=e=>{for(var t=e.split("."),i=0;i<4;i++){var n=d(t[i]);if(B(n))return null;t[i]=n}return(t[0]|t[1]<<8|t[2]<<16|t[3]<<24)>>>0},je=e=>{var t,i,n,o,r=[];if(!/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i.test(e))return null;if("::"===e)return[0,0,0,0,0,0,0,0];for((e=e.startsWith("::")?e.replace("::","Z:"):e.replace("::",":Z:")).indexOf(".")>0?((t=(e=e.replace(new Z("[.]","g"),":")).split(":"))[t.length-4]=d(t[t.length-4])+256*d(t[t.length-3]),t[t.length-3]=d(t[t.length-2])+256*d(t[t.length-1]),t=t.slice(0,t.length-2)):t=e.split(":"),n=0,o=0,i=0;i<t.length;i++)if("string"==typeof t[i])if("Z"===t[i]){for(o=0;o<8-t.length+1;o++)r[i+o]=0;n=o-1}else r[i+n]=Fc(E(t[i],16));else r[i+n]=t[i];return[r[1]<<16|r[0],r[3]<<16|r[2],r[5]<<16|r[4],r[7]<<16|r[6]]},De=(e,t)=>x.fill(0,e,e+t),Ye=(e,t,i,n,o)=>{switch(t){case 2:i=Ke(i),De(e,16),o&&(K[o>>2]=16),Q[e>>1]=t,K[e+4>>2]=i,Q[e+2>>1]=Fc(n);break;case 10:i=je(i),De(e,28),o&&(K[o>>2]=28),K[e>>2]=t,K[e+8>>2]=i[0],K[e+12>>2]=i[1],K[e+16>>2]=i[2],K[e+20>>2]=i[3],Q[e+2>>1]=Fc(n);break;default:return 5}return 0},ze={address_map:{id:1,addrs:{},names:{}},lookup_name(e){var t,i=Ke(e);if(null!==i)return e;if(null!==(i=je(e)))return e;if(ze.address_map.addrs[e])t=ze.address_map.addrs[e];else{var n=ze.address_map.id++;O(n<65535,"exceeded max address mappings of 65535"),t="172.29."+(255&n)+"."+(65280&n),ze.address_map.names[t]=e,ze.address_map.addrs[e]=t}return t},lookup_addr:e=>ze.address_map.names[e]?ze.address_map.names[e]:null},He=e=>(255&e)+"."+(e>>8&255)+"."+(e>>16&255)+"."+(e>>24&255),Je=e=>{var t="",i=0,n=0,o=0,r=0,s=0,a=0,l=[65535&e[0],e[0]>>16,65535&e[1],e[1]>>16,65535&e[2],e[2]>>16,65535&e[3],e[3]>>16],c=!0,u="";for(a=0;a<5;a++)if(0!==l[a]){c=!1;break}if(c){if(u=He(l[6]|l[7]<<16),-1===l[5])return t="::ffff:",t+=u;if(0===l[5])return t="::","0.0.0.0"===u&&(u=""),"0.0.0.1"===u&&(u="1"),t+=u}for(i=0;i<8;i++)0===l[i]&&(i-o>1&&(s=0),o=i,s++),s>n&&(r=i-(n=s)+1);for(i=0;i<8;i++)n>1&&0===l[i]&&i>=r&&i<r+n?i===r&&(t+=":",0===r&&(t+=":")):(t+=d(Tc(65535&l[i])).toString(16),t+=i<7?":":"");return t},_e=(e,t)=>{var i,n=Q[e>>1],o=Tc(X[e+2>>1]);switch(n){case 2:if(16!==t)return{errno:28};i=K[e+4>>2],i=He(i);break;case 10:if(28!==t)return{errno:28};i=[K[e+8>>2],K[e+12>>2],K[e+16>>2],K[e+20>>2]],i=Je(i);break;default:return{errno:5}}return{family:n,addr:i,port:o}},Oe=(e,t)=>{var i=_e(e,t);if(i.errno)throw new Le.ErrnoError(i.errno);return i.addr=ze.lookup_addr(i.addr)||i.addr,i},Pe=()=>{var e=K[+$e.varargs>>2];return $e.varargs+=4,e},qe=Pe,$e={DEFAULT_POLLMASK:5,calculateAt(e,t,i){if(we.isAbs(t))return t;var n;if(n=-100===e?Le.cwd():$e.getStreamFromFD(e).path,0==t.length){if(!i)throw new Le.ErrnoError(44);return n}return n+"/"+t},writeStat(e,t){K[e>>2]=t.dev,K[e+4>>2]=t.mode,j[e+8>>2]=t.nlink,K[e+12>>2]=t.uid,K[e+16>>2]=t.gid,K[e+20>>2]=t.rdev,Y[e+24>>3]=BigInt(t.size),K[e+32>>2]=4096,K[e+36>>2]=t.blocks;var i=t.atime.getTime(),n=t.mtime.getTime(),o=t.ctime.getTime();return Y[e+40>>3]=BigInt(c.floor(i/1e3)),j[e+48>>2]=i%1e3*1e3*1e3,Y[e+56>>3]=BigInt(c.floor(n/1e3)),j[e+64>>2]=n%1e3*1e3*1e3,Y[e+72>>3]=BigInt(c.floor(o/1e3)),j[e+80>>2]=o%1e3*1e3*1e3,Y[e+88>>3]=BigInt(t.ino),0},writeStatFs(e,t){K[e+4>>2]=t.bsize,K[e+40>>2]=t.bsize,K[e+8>>2]=t.blocks,K[e+12>>2]=t.bfree,K[e+16>>2]=t.bavail,K[e+20>>2]=t.files,K[e+24>>2]=t.ffree,K[e+28>>2]=t.fsid,K[e+44>>2]=t.flags,K[e+36>>2]=t.namelen},doMsync(e,t,i,n,o){if(!Le.isFile(t.node.mode))throw new Le.ErrnoError(43);if(2&n)return 0;var r=x.slice(e,e+i);Le.msync(t,r,o,i,n)},getStreamFromFD:e=>Le.getStreamChecked(e),varargs:W,getStr:e=>Se(e)},et=e=>e<-9007199254740992||e>9007199254740992?NaN:d(e),tt=(e,t,i)=>Ue(e,x,t,i),it=[0,31,60,91,121,152,182,213,244,274,305,335],nt=[0,31,59,90,120,151,181,212,243,273,304,334],ot=e=>{var t;return((t=e.getFullYear())%4!=0||t%100==0&&t%400!=0?nt:it)[e.getMonth()]+e.getDate()-1},rt=(e,t)=>{if(mt.timingMode=e,mt.timingValue=t,!mt.func)return 1;if(mt.running||(mt.running=!0),0==e)mt.scheduler=function(){var e=0|c.max(0,mt.tickStartTime+t-st());setTimeout(mt.runner,e)},mt.method="timeout";else if(1==e)mt.scheduler=function(){mt.requestAnimationFrame(mt.runner)},mt.method="rAF";else if(2==e){if(void 0===mt.setImmediate){var i=[],n="setimmediate";addEventListener("message",(e=>{e.data!==n&&e.data.target!==n||(e.stopPropagation(),i.shift()())}),!0),mt.setImmediate=e=>{i.push(e),f?(h.setImmediates??=[],h.setImmediates.push(e),postMessage({target:n})):postMessage(n,"*")}}mt.scheduler=function(){mt.setImmediate(mt.runner)},mt.method="immediate"}return 0},st=()=>U.now(),at=0,lt=()=>he||at>0,ct=(e,t)=>{var i;T=e,T=i=e,lt()||(h.onExit?.(i),_=!0),v(0,new ae(i))},dt=ct,ut=e=>{if(e instanceof ae||"unwind"==e)return T;v(0,e)},gt=()=>{if(!lt())try{dt(T)}catch(e){ut(e)}},ht=(e,t,i,n,o)=>{mt.func=e,mt.arg=n;var r=mt.currentlyRunningMainloop;function s(){return!(r<mt.currentlyRunningMainloop&&(gt(),1))}if(mt.running=!1,mt.runner=function(){if(!_)if(mt.queue.length>0){g.now();var t=mt.queue.shift();if(t.func(t.arg),mt.remainingBlockers){var i=mt.remainingBlockers,n=i%1==0?i-1:c.floor(i);t.counted?mt.remainingBlockers=n:(n+=.5,mt.remainingBlockers=(8*i+n)/9)}if(mt.updateStatus(),!s())return;setTimeout(mt.runner,0)}else s()&&(mt.currentFrameNumber=mt.currentFrameNumber+1|0,1==mt.timingMode&&mt.timingValue>1&&mt.currentFrameNumber%mt.timingValue!=0?mt.scheduler():(0==mt.timingMode&&(mt.tickStartTime=st()),mt.runIter(e),s()&&mt.scheduler()))},o||(t>0?rt(0,1e3/t):rt(1,1),mt.scheduler()),i)throw"unwind"},pt=e=>{if(!_)try{e(),gt()}catch(e){ut(e)}},mt={running:!1,scheduler:null,method:"",currentlyRunningMainloop:0,func:null,arg:0,timingMode:0,timingValue:0,currentFrameNumber:0,queue:[],preMainLoop:[],postMainLoop:[],pause(){mt.scheduler=null,mt.currentlyRunningMainloop++},resume(){mt.currentlyRunningMainloop++;var e=mt.timingMode,t=mt.timingValue,i=mt.func;mt.func=null,ht(i,0,!1,mt.arg,!0),rt(e,t),mt.scheduler()},updateStatus(){if(h.setStatus){var e=h.statusMessage||"Please wait...",t=mt.remainingBlockers??0,i=mt.expectedBlockers??0;t?t<i?h.setStatus("{message} ({expected - remaining}/{expected})"):h.setStatus(e):h.setStatus("")}},init(){h.preMainLoop&&mt.preMainLoop.push(h.preMainLoop),h.postMainLoop&&mt.postMainLoop.push(h.postMainLoop)},runIter(e){if(!_){for(var t of mt.preMainLoop)if(!1===t())return;for(var i of(pt(e),mt.postMainLoop))i()}},nextRAF:0,fakeRequestAnimationFrame(e){var t=g.now();if(0===mt.nextRAF)mt.nextRAF=t+1e3/60;else for(;t+2>=mt.nextRAF;)mt.nextRAF+=1e3/60;var i=c.max(mt.nextRAF-t,0);setTimeout(e,i)},requestAnimationFrame(e){"function"!=typeof requestAnimationFrame?(0,mt.fakeRequestAnimationFrame)(e):requestAnimationFrame(e)}},ft={QUEUE_INTERVAL:25,QUEUE_LOOKAHEAD:.1,DEVICE_NAME:"Emscripten OpenAL",CAPTURE_DEVICE_NAME:"Emscripten OpenAL capture",ALC_EXTENSIONS:{ALC_SOFT_pause_device:!0,ALC_SOFT_HRTF:!0},AL_EXTENSIONS:{AL_EXT_float32:!0,AL_SOFT_loop_points:!0,AL_SOFT_source_length:!0,AL_EXT_source_distance_model:!0,AL_SOFT_source_spatialize:!0},_alcErr:0,alcErr:0,deviceRefCounts:{},alcStringCache:{},paused:!1,stringCache:{},contexts:{},currentCtx:null,buffers:{0:{id:0,refCount:0,audioBuf:null,frequency:0,bytesPerSample:2,channels:1,length:0}},paramArray:[],_nextId:1,newId:()=>ft.freeIds.length>0?ft.freeIds.pop():ft._nextId++,freeIds:[],scheduleContextAudio:e=>{if(1!==mt.timingMode||"visible"==n.visibilityState)for(var t in e.sources)ft.scheduleSourceAudio(e.sources[t])},scheduleSourceAudio:(e,t)=>{if((1!==mt.timingMode||"visible"==n.visibilityState)&&4114===e.state){for(var i=ft.updateSourceTime(e),o=e.bufStartTime,r=e.bufOffset,s=e.bufsProcessed,a=0;a<e.audioQueue.length;a++)o=(h=e.audioQueue[a])._startTime+h._duration,r=0,s+=h._skipCount+1;t||(t=ft.QUEUE_LOOKAHEAD);for(var l=i+t,u=0;o<l;){if(s>=e.bufQueue.length){if(!e.looping)break;s%=e.bufQueue.length}var g=e.bufQueue[s%e.bufQueue.length];if(0===g.length){if(++u===e.bufQueue.length)break}else{var h;(h=e.context.audioCtx.createBufferSource()).buffer=g.audioBuf,h.playbackRate.value=e.playbackRate,(g.audioBuf._loopStart||g.audioBuf._loopEnd)&&(h.loopStart=g.audioBuf._loopStart,h.loopEnd=g.audioBuf._loopEnd);var p=0;4136===e.type&&e.looping?(p=d.POSITIVE_INFINITY,h.loop=!0,g.audioBuf._loopStart&&(h.loopStart=g.audioBuf._loopStart),g.audioBuf._loopEnd&&(h.loopEnd=g.audioBuf._loopEnd)):p=(g.audioBuf.duration-r)/e.playbackRate,h._startOffset=r,h._duration=p,h._skipCount=u,u=0,h.connect(e.gain),void 0!==h.start?(o=c.max(o,e.context.audioCtx.currentTime),h.start(o,r)):void 0!==h.noteOn&&(o=c.max(o,e.context.audioCtx.currentTime),h.noteOn(o)),h._startTime=o,e.audioQueue.push(h),o+=p}r=0,s++}}},updateSourceTime:e=>{var t=e.context.audioCtx.currentTime;if(4114!==e.state)return t;isFinite(e.bufStartTime)||(e.bufStartTime=t-e.bufOffset/e.playbackRate,e.bufOffset=0);for(var i=0;e.audioQueue.length;){var n=e.audioQueue[0];if(e.bufsProcessed+=n._skipCount,t<(i=n._startTime+n._duration))break;e.audioQueue.shift(),e.bufStartTime=i,e.bufOffset=0,e.bufsProcessed++}if(e.bufsProcessed>=e.bufQueue.length&&!e.looping)ft.setSourceState(e,4116);else if(4136===e.type&&e.looping)if(0===(d=e.bufQueue[0]).length)e.bufOffset=0;else{var o=(t-e.bufStartTime)*e.playbackRate,r=d.audioBuf._loopStart||0,s=d.audioBuf._loopEnd||d.audioBuf.duration;s<=r&&(s=d.audioBuf.duration),e.bufOffset=o<s?o:r+(o-r)%(s-r)}else if(e.audioQueue[0])e.bufOffset=(t-e.audioQueue[0]._startTime)*e.playbackRate;else{if(4136!==e.type&&e.looping){var a=ft.sourceDuration(e)/e.playbackRate;a>0&&(e.bufStartTime+=c.floor((t-e.bufStartTime)/a)*a)}for(var l=0;l<e.bufQueue.length;l++){if(e.bufsProcessed>=e.bufQueue.length){if(!e.looping){ft.setSourceState(e,4116);break}e.bufsProcessed%=e.bufQueue.length}var d;if((d=e.bufQueue[e.bufsProcessed]).length>0){if(t<(i=e.bufStartTime+d.audioBuf.duration/e.playbackRate)){e.bufOffset=(t-e.bufStartTime)*e.playbackRate;break}e.bufStartTime=i}e.bufOffset=0,e.bufsProcessed++}}return t},cancelPendingSourceAudio:e=>{ft.updateSourceTime(e);for(var t=1;t<e.audioQueue.length;t++)e.audioQueue[t].stop();e.audioQueue.length>1&&(e.audioQueue.length=1)},stopSourceAudio:e=>{for(var t=0;t<e.audioQueue.length;t++)e.audioQueue[t].stop();e.audioQueue.length=0},setSourceState:(e,t)=>{4114===t?(4114!==e.state&&4116!=e.state||(e.bufsProcessed=0,e.bufOffset=0),ft.stopSourceAudio(e),e.state=4114,e.bufStartTime=d.NEGATIVE_INFINITY,ft.scheduleSourceAudio(e)):4115===t?4114===e.state&&(ft.updateSourceTime(e),ft.stopSourceAudio(e),e.state=4115):4116===t?4113!==e.state&&(e.state=4116,e.bufsProcessed=e.bufQueue.length,e.bufStartTime=d.NEGATIVE_INFINITY,e.bufOffset=0,ft.stopSourceAudio(e)):4113===t&&4113!==e.state&&(e.state=4113,e.bufsProcessed=0,e.bufStartTime=d.NEGATIVE_INFINITY,e.bufOffset=0,ft.stopSourceAudio(e))},initSourcePanner:e=>{if(4144!==e.type){for(var t=ft.buffers[0],i=0;i<e.bufQueue.length;i++)if(0!==e.bufQueue[i].id){t=e.bufQueue[i];break}if(1===e.spatialize||2===e.spatialize&&1===t.channels){if(e.panner)return;e.panner=e.context.audioCtx.createPanner(),ft.updateSourceGlobal(e),ft.updateSourceSpace(e),e.panner.connect(e.context.gain),e.gain.disconnect(),e.gain.connect(e.panner)}else{if(!e.panner)return;e.panner.disconnect(),e.gain.disconnect(),e.gain.connect(e.context.gain),e.panner=null}}},updateContextGlobal:e=>{for(var t in e.sources)ft.updateSourceGlobal(e.sources[t])},updateSourceGlobal:e=>{var t=e.panner;if(t)switch(t.refDistance=e.refDistance,t.maxDistance=e.maxDistance,t.rolloffFactor=e.rolloffFactor,t.panningModel=e.context.hrtf?"HRTF":"equalpower",e.context.sourceDistanceModel?e.distanceModel:e.context.distanceModel){case 0:t.distanceModel="inverse",t.refDistance=340282e33;break;case 53249:case 53250:t.distanceModel="inverse";break;case 53251:case 53252:t.distanceModel="linear";break;case 53253:case 53254:t.distanceModel="exponential"}},updateListenerSpace:e=>{var t=e.audioCtx.listener;for(var i in t.positionX?(t.positionX.value=e.listener.position[0],t.positionY.value=e.listener.position[1],t.positionZ.value=e.listener.position[2]):t.setPosition(e.listener.position[0],e.listener.position[1],e.listener.position[2]),t.forwardX?(t.forwardX.value=e.listener.direction[0],t.forwardY.value=e.listener.direction[1],t.forwardZ.value=e.listener.direction[2],t.upX.value=e.listener.up[0],t.upY.value=e.listener.up[1],t.upZ.value=e.listener.up[2]):t.setOrientation(e.listener.direction[0],e.listener.direction[1],e.listener.direction[2],e.listener.up[0],e.listener.up[1],e.listener.up[2]),e.sources)ft.updateSourceSpace(e.sources[i])},updateSourceSpace:e=>{if(e.panner){var t=e.panner,i=e.position[0],n=e.position[1],o=e.position[2],r=e.direction[0],s=e.direction[1],a=e.direction[2],l=e.context.listener,u=l.position[0],g=l.position[1],h=l.position[2];if(e.relative){var p=-l.direction[0],m=-l.direction[1],f=-l.direction[2],b=l.up[0],C=l.up[1],I=l.up[2],y=(e,t,i)=>{var n=c.sqrt(e*e+t*t+i*i);return n<d.EPSILON?0:1/n},v=y(p,m,f);p*=v,m*=v,f*=v;var Z=(C*=v=y(b,C,I))*f-(I*=v)*m,S=I*p-(b*=v)*f,V=b*m-C*p,w=r,B=s,A=a;r=w*(Z*=v=y(Z,S,V))+B*(b=m*(V*=v)-f*(S*=v))+A*p,s=w*S+B*(C=f*Z-p*V)+A*m,a=w*V+B*(I=p*S-m*Z)+A*f,i=(w=i)*Z+(B=n)*b+(A=o)*p,n=w*S+B*C+A*m,o=w*V+B*I+A*f,i+=u,n+=g,o+=h}t.positionX?(i!=t.positionX.value&&(t.positionX.value=i),n!=t.positionY.value&&(t.positionY.value=n),o!=t.positionZ.value&&(t.positionZ.value=o)):t.setPosition(i,n,o),t.orientationX?(r!=t.orientationX.value&&(t.orientationX.value=r),s!=t.orientationY.value&&(t.orientationY.value=s),a!=t.orientationZ.value&&(t.orientationZ.value=a)):t.setOrientation(r,s,a);var E=e.dopplerShift,U=e.velocity[0],N=e.velocity[1],k=e.velocity[2],M=l.velocity[0],F=l.velocity[1],T=l.velocity[2];if(i===u&&n===g&&o===h||U===M&&N===F&&k===T)e.dopplerShift=1;else{var R=e.context.speedOfSound,W=e.context.dopplerFactor,G=u-i,x=g-n,L=h-o,Q=c.sqrt(G*G+x*x+L*L),X=(G*M+x*F+L*T)/Q,K=(G*U+x*N+L*k)/Q;X=c.min(X,R/W),K=c.min(K,R/W),e.dopplerShift=(R-W*X)/(R-W*K)}e.dopplerShift!==E&&ft.updateSourceRate(e)}},updateSourceRate:e=>{if(4114===e.state){ft.cancelPendingSourceAudio(e);var t,i=e.audioQueue[0];if(!i)return;t=4136===e.type&&e.looping?d.POSITIVE_INFINITY:(i.buffer.duration-i._startOffset)/e.playbackRate,i._duration=t,i.playbackRate.value=e.playbackRate,ft.scheduleSourceAudio(e)}},sourceDuration:e=>{for(var t=0,i=0;i<e.bufQueue.length;i++){var n=e.bufQueue[i].audioBuf;t+=n?n.duration:0}return t},sourceTell:e=>{ft.updateSourceTime(e);for(var t=0,i=0;i<e.bufsProcessed;i++)e.bufQueue[i].audioBuf&&(t+=e.bufQueue[i].audioBuf.duration);return t+=e.bufOffset},sourceSeek:(e,t)=>{var i=4114==e.state;if(i&&ft.setSourceState(e,4113),null!==e.bufQueue[e.bufsProcessed].audioBuf){for(e.bufsProcessed=0;t>e.bufQueue[e.bufsProcessed].audioBuf.duration;)t-=e.bufQueue[e.bufsProcessed].audioBuf.duration,e.bufsProcessed++;e.bufOffset=t}i&&ft.setSourceState(e,4114)},getGlobalParam:(e,t)=>{if(!ft.currentCtx)return null;switch(t){case 49152:return ft.currentCtx.dopplerFactor;case 49155:return ft.currentCtx.speedOfSound;case 53248:return ft.currentCtx.distanceModel;default:return ft.currentCtx.err=40962,null}},setGlobalParam:(e,t,i)=>{if(ft.currentCtx)switch(t){case 49152:if(!d.isFinite(i)||i<0)return void(ft.currentCtx.err=40963);ft.currentCtx.dopplerFactor=i,ft.updateListenerSpace(ft.currentCtx);break;case 49155:if(!d.isFinite(i)||i<=0)return void(ft.currentCtx.err=40963);ft.currentCtx.speedOfSound=i,ft.updateListenerSpace(ft.currentCtx);break;case 53248:switch(i){case 0:case 53249:case 53250:case 53251:case 53252:case 53253:case 53254:ft.currentCtx.distanceModel=i,ft.updateContextGlobal(ft.currentCtx);break;default:return void(ft.currentCtx.err=40963)}break;default:return void(ft.currentCtx.err=40962)}},getListenerParam:(e,t)=>{if(!ft.currentCtx)return null;switch(t){case 4100:return ft.currentCtx.listener.position;case 4102:return ft.currentCtx.listener.velocity;case 4111:return ft.currentCtx.listener.direction.concat(ft.currentCtx.listener.up);case 4106:return ft.currentCtx.gain.gain.value;default:return ft.currentCtx.err=40962,null}},setListenerParam:(e,t,i)=>{if(ft.currentCtx)if(null!==i){var n=ft.currentCtx.listener;switch(t){case 4100:if(!d.isFinite(i[0])||!d.isFinite(i[1])||!d.isFinite(i[2]))return void(ft.currentCtx.err=40963);n.position[0]=i[0],n.position[1]=i[1],n.position[2]=i[2],ft.updateListenerSpace(ft.currentCtx);break;case 4102:if(!d.isFinite(i[0])||!d.isFinite(i[1])||!d.isFinite(i[2]))return void(ft.currentCtx.err=40963);n.velocity[0]=i[0],n.velocity[1]=i[1],n.velocity[2]=i[2],ft.updateListenerSpace(ft.currentCtx);break;case 4106:if(!d.isFinite(i)||i<0)return void(ft.currentCtx.err=40963);ft.currentCtx.gain.gain.value=i;break;case 4111:if(!(d.isFinite(i[0])&&d.isFinite(i[1])&&d.isFinite(i[2])&&d.isFinite(i[3])&&d.isFinite(i[4])&&d.isFinite(i[5])))return void(ft.currentCtx.err=40963);n.direction[0]=i[0],n.direction[1]=i[1],n.direction[2]=i[2],n.up[0]=i[3],n.up[1]=i[4],n.up[2]=i[5],ft.updateListenerSpace(ft.currentCtx);break;default:return void(ft.currentCtx.err=40962)}}else ft.currentCtx.err=40962},getBufferParam:(e,t,i)=>{if(ft.currentCtx){var n=ft.buffers[t];if(n&&0!==t)switch(i){case 8193:return n.frequency;case 8194:return 8*n.bytesPerSample;case 8195:return n.channels;case 8196:return n.length*n.bytesPerSample*n.channels;case 8213:return 0===n.length?[0,0]:[(n.audioBuf._loopStart||0)*n.frequency,(n.audioBuf._loopEnd||n.length)*n.frequency];default:return ft.currentCtx.err=40962,null}else ft.currentCtx.err=40961}},setBufferParam:(e,t,i,n)=>{if(ft.currentCtx){var o=ft.buffers[t];if(o&&0!==t)if(null!==n)switch(i){case 8196:if(0!==n)return void(ft.currentCtx.err=40963);break;case 8213:if(n[0]<0||n[0]>o.length||n[1]<0||n[1]>o.Length||n[0]>=n[1])return void(ft.currentCtx.err=40963);if(o.refCount>0)return void(ft.currentCtx.err=40964);o.audioBuf&&(o.audioBuf._loopStart=n[0]/o.frequency,o.audioBuf._loopEnd=n[1]/o.frequency);break;default:return void(ft.currentCtx.err=40962)}else ft.currentCtx.err=40962;else ft.currentCtx.err=40961}},getSourceParam:(e,t,i)=>{if(!ft.currentCtx)return null;var n=ft.currentCtx.sources[t];if(!n)return ft.currentCtx.err=40961,null;switch(i){case 514:return n.relative;case 4097:return n.coneInnerAngle;case 4098:return n.coneOuterAngle;case 4099:return n.pitch;case 4100:return n.position;case 4101:return n.direction;case 4102:return n.velocity;case 4103:return n.looping;case 4105:return 4136===n.type?n.bufQueue[0].id:0;case 4106:return n.gain.gain.value;case 4109:return n.minGain;case 4110:return n.maxGain;case 4112:return n.state;case 4117:return 1===n.bufQueue.length&&0===n.bufQueue[0].id?0:n.bufQueue.length;case 4118:return 1===n.bufQueue.length&&0===n.bufQueue[0].id||n.looping?0:n.bufsProcessed;case 4128:return n.refDistance;case 4129:return n.rolloffFactor;case 4130:return n.coneOuterGain;case 4131:return n.maxDistance;case 4132:return ft.sourceTell(n);case 4133:return(o=ft.sourceTell(n))>0&&(o*=n.bufQueue[0].frequency),o;case 4134:var o;return(o=ft.sourceTell(n))>0&&(o*=n.bufQueue[0].frequency*n.bufQueue[0].bytesPerSample),o;case 4135:return n.type;case 4628:return n.spatialize;case 8201:for(var r=0,s=0,a=0;a<n.bufQueue.length;a++)r+=n.bufQueue[a].length,0!==n.bufQueue[a].id&&(s=n.bufQueue[a].bytesPerSample*n.bufQueue[a].channels);return r*s;case 8202:for(r=0,a=0;a<n.bufQueue.length;a++)r+=n.bufQueue[a].length;return r;case 8203:return ft.sourceDuration(n);case 53248:return n.distanceModel;default:return ft.currentCtx.err=40962,null}},setSourceParam:(e,t,i,n)=>{if(ft.currentCtx){var o=ft.currentCtx.sources[t];if(o)if(null!==n)switch(i){case 514:if(1===n)o.relative=!0,ft.updateSourceSpace(o);else{if(0!==n)return void(ft.currentCtx.err=40963);o.relative=!1,ft.updateSourceSpace(o)}break;case 4097:if(!d.isFinite(n))return void(ft.currentCtx.err=40963);o.coneInnerAngle=n,o.panner&&(o.panner.coneInnerAngle=n%360);break;case 4098:if(!d.isFinite(n))return void(ft.currentCtx.err=40963);o.coneOuterAngle=n,o.panner&&(o.panner.coneOuterAngle=n%360);break;case 4099:if(!d.isFinite(n)||n<=0)return void(ft.currentCtx.err=40963);if(o.pitch===n)break;o.pitch=n,ft.updateSourceRate(o);break;case 4100:if(!d.isFinite(n[0])||!d.isFinite(n[1])||!d.isFinite(n[2]))return void(ft.currentCtx.err=40963);o.position[0]=n[0],o.position[1]=n[1],o.position[2]=n[2],ft.updateSourceSpace(o);break;case 4101:if(!d.isFinite(n[0])||!d.isFinite(n[1])||!d.isFinite(n[2]))return void(ft.currentCtx.err=40963);o.direction[0]=n[0],o.direction[1]=n[1],o.direction[2]=n[2],ft.updateSourceSpace(o);break;case 4102:if(!d.isFinite(n[0])||!d.isFinite(n[1])||!d.isFinite(n[2]))return void(ft.currentCtx.err=40963);o.velocity[0]=n[0],o.velocity[1]=n[1],o.velocity[2]=n[2],ft.updateSourceSpace(o);break;case 4103:if(1===n)o.looping=!0,ft.updateSourceTime(o),4136===o.type&&o.audioQueue.length>0&&((r=o.audioQueue[0]).loop=!0,r._duration=d.POSITIVE_INFINITY);else{if(0!==n)return void(ft.currentCtx.err=40963);o.looping=!1;var r,s=ft.updateSourceTime(o);4136===o.type&&o.audioQueue.length>0&&((r=o.audioQueue[0]).loop=!1,r._duration=o.bufQueue[0].audioBuf.duration/o.playbackRate,r._startTime=s-o.bufOffset/o.playbackRate)}break;case 4105:if(4114===o.state||4115===o.state)return void(ft.currentCtx.err=40964);if(0===n){for(var a in o.bufQueue)o.bufQueue[a].refCount--;o.bufQueue.length=1,o.bufQueue[0]=ft.buffers[0],o.bufsProcessed=0,o.type=4144}else{if(!(p=ft.buffers[n]))return void(ft.currentCtx.err=40963);for(var a in o.bufQueue)o.bufQueue[a].refCount--;o.bufQueue.length=0,p.refCount++,o.bufQueue=[p],o.bufsProcessed=0,o.type=4136}ft.initSourcePanner(o),ft.scheduleSourceAudio(o);break;case 4106:if(!d.isFinite(n)||n<0)return void(ft.currentCtx.err=40963);o.gain.gain.value=n;break;case 4109:if(!d.isFinite(n)||n<0||n>c.min(o.maxGain,1))return void(ft.currentCtx.err=40963);o.minGain=n;break;case 4110:if(!d.isFinite(n)||n<c.max(0,o.minGain)||n>1)return void(ft.currentCtx.err=40963);o.maxGain=n;break;case 4128:if(!d.isFinite(n)||n<0)return void(ft.currentCtx.err=40963);o.refDistance=n,o.panner&&(o.panner.refDistance=n);break;case 4129:if(!d.isFinite(n)||n<0)return void(ft.currentCtx.err=40963);o.rolloffFactor=n,o.panner&&(o.panner.rolloffFactor=n);break;case 4130:if(!d.isFinite(n)||n<0||n>1)return void(ft.currentCtx.err=40963);o.coneOuterGain=n,o.panner&&(o.panner.coneOuterGain=n);break;case 4131:if(!d.isFinite(n)||n<0)return void(ft.currentCtx.err=40963);o.maxDistance=n,o.panner&&(o.panner.maxDistance=n);break;case 4132:if(n<0||n>ft.sourceDuration(o))return void(ft.currentCtx.err=40963);ft.sourceSeek(o,n);break;case 4133:if((g=ft.sourceDuration(o))>0){var l;for(var u in o.bufQueue)if(u){l=o.bufQueue[u].frequency;break}n/=l}if(n<0||n>g)return void(ft.currentCtx.err=40963);ft.sourceSeek(o,n);break;case 4134:var g;if((g=ft.sourceDuration(o))>0){var h;for(var u in o.bufQueue)if(u){var p;h=(p=o.bufQueue[u]).frequency*p.bytesPerSample*p.channels;break}n/=h}if(n<0||n>g)return void(ft.currentCtx.err=40963);ft.sourceSeek(o,n);break;case 4628:if(0!==n&&1!==n&&2!==n)return void(ft.currentCtx.err=40963);o.spatialize=n,ft.initSourcePanner(o);break;case 8201:case 8202:case 8203:ft.currentCtx.err=40964;break;case 53248:switch(n){case 0:case 53249:case 53250:case 53251:case 53252:case 53253:case 53254:o.distanceModel=n,ft.currentCtx.sourceDistanceModel&&ft.updateContextGlobal(ft.currentCtx);break;default:return void(ft.currentCtx.err=40963)}break;default:return void(ft.currentCtx.err=40962)}else ft.currentCtx.err=40962;else ft.currentCtx.err=40961}},captures:{},sharedCaptureAudioCtx:null,requireValidCaptureDevice:(e,t)=>{if(0===e)return ft.alcErr=40961,null;var i=ft.captures[e];return i?i.mediaStreamError?(ft.alcErr=40961,null):i:(ft.alcErr=40961,null)}},bt=(e,t,i)=>{switch(t){case 514:case 4097:case 4098:case 4103:case 4105:case 4128:case 4129:case 4131:case 4132:case 4133:case 4134:case 4628:case 8201:case 8202:case 53248:ft.setSourceParam("alSourcei",e,t,i);break;default:ft.setSourceParam("alSourcei",e,t,null)}},Ct=()=>g.now(),It=[],yt=(e,t)=>{var i;for(It.length=0;i=x[e++];){var n=105!=i;t+=(n&=112!=i)&&t%8?4:0,It.push(112==i?j[t>>2]:106==i?Y[t>>3]:105==i?K[t>>2]:z[t>>3]),t+=n?8:4}return It},vt=(e,t,i)=>{var n=yt(t,i);return Ic[e](...n)},Zt=(e,t)=>setTimeout((()=>{pt(e)}),t),St={wgetRequests:{},nextWgetRequestHandle:0,getNextWgetRequestHandle(){var e=St.nextWgetRequestHandle;return St.nextWgetRequestHandle++,e}},Vt={memcpy(e,t,i){G.set(G.subarray(t,t+i),e)},removeAllEventListeners(){for(;Vt.eventHandlers.length;)Vt._removeHandler(Vt.eventHandlers.length-1);Vt.deferredCalls=[]},inEventHandler:0,deferredCalls:[],deferCall(e,t,i){function n(e,t){if(e.length!=t.length)return!1;for(var i in e)if(e[i]!=t[i])return!1;return!0}for(var o of Vt.deferredCalls)if(o.targetFunction==e&&n(o.argsList,i))return;Vt.deferredCalls.push({targetFunction:e,precedence:t,argsList:i}),Vt.deferredCalls.sort(((e,t)=>e.precedence<t.precedence))},removeDeferredCalls(e){Vt.deferredCalls=Vt.deferredCalls.filter((t=>t.targetFunction!=e))},canPerformEventHandlerRequests:()=>R.userActivation?R.userActivation.isActive:Vt.inEventHandler&&Vt.currentEventHandler.allowsDeferredCalls,runDeferredCalls(){if(Vt.canPerformEventHandlerRequests()){var e=Vt.deferredCalls;for(var t of(Vt.deferredCalls=[],e))t.targetFunction(...t.argsList)}},eventHandlers:[],removeAllHandlersOnTarget:(e,t)=>{for(var i=0;i<Vt.eventHandlers.length;++i)Vt.eventHandlers[i].target!=e||t&&t!=Vt.eventHandlers[i].eventTypeString||Vt._removeHandler(i--)},_removeHandler(e){var t=Vt.eventHandlers[e];t.target.removeEventListener(t.eventTypeString,t.eventListenerFunc,t.useCapture),Vt.eventHandlers.splice(e,1)},registerOrRemoveHandler(e){if(!e.target)return-4;if(e.callbackfunc)e.eventListenerFunc=function(t){++Vt.inEventHandler,Vt.currentEventHandler=e,Vt.runDeferredCalls(),e.handlerFunc(t),Vt.runDeferredCalls(),--Vt.inEventHandler},e.target.addEventListener(e.eventTypeString,e.eventListenerFunc,e.useCapture),Vt.eventHandlers.push(e);else for(var t=0;t<Vt.eventHandlers.length;++t)Vt.eventHandlers[t].target==e.target&&Vt.eventHandlers[t].eventTypeString==e.eventTypeString&&Vt._removeHandler(t--);return 0},getNodeNameForTarget:t=>t?t==e?"#window":t==screen?"#screen":t?.nodeName||"":"",fullscreenEnabled:()=>n.fullscreenEnabled||n.webkitFullscreenEnabled},wt=[0,void 0!==n?n:0,void 0!==e?e:0],Bt=e=>{var t;return e=(t=e)>2?Se(t):t,wt[e]||(void 0!==n?n.querySelector(e):null)},At=Bt,Et=e=>xc(e),Ut=e=>{var t=Ee(e)+1,i=Et(t);return tt(e,i,t),i},Nt=e=>{var t=me(),i=Et(8),n=i+4,o=(((e,t,i)=>{var n=At(e);if(!n)return-4;K[t>>2]=n.width,K[i>>2]=n.height})(Ut(e.id),i,n),[K[i>>2],K[n>>2]]);return pe(t),o},kt=(e,t,i)=>{var n=At(e);return n?(n.width=t,n.height=i,0):-4},Mt=(e,t,i)=>{if(e.controlTransferredOffscreen){var n=me(),o=Ut(e.id);kt(o,t,i),pe(n)}else e.width=t,e.height=i},Ft={},Tt=(e,t,i)=>{e.style.paddingLeft=e.style.paddingRight=i+"px",e.style.paddingTop=e.style.paddingBottom=t+"px"},Rt=e=>wt.indexOf(e)<0?e.getBoundingClientRect():{left:0,top:0},Wt=(e,t)=>{var i=(e=>{var t=Nt(e),i=t[0],o=t[1],r=e.style.width,s=e.style.height,a=e.style.backgroundColor,l=n.body.style.backgroundColor,c=e.style.paddingLeft,d=e.style.paddingRight,u=e.style.paddingTop,g=e.style.paddingBottom,h=e.style.marginLeft,p=e.style.marginRight,m=e.style.marginTop,f=e.style.marginBottom,b=n.body.style.margin,C=n.documentElement.style.overflow,I=n.body.scroll,y=e.style.imageRendering;function v(){var t;n.fullscreenElement||n.webkitFullscreenElement||(n.removeEventListener("fullscreenchange",v),n.removeEventListener("webkitfullscreenchange",v),Mt(e,i,o),e.style.width=r,e.style.height=s,e.style.backgroundColor=a,l||(n.body.style.backgroundColor="white"),n.body.style.backgroundColor=l,e.style.paddingLeft=c,e.style.paddingRight=d,e.style.paddingTop=u,e.style.paddingBottom=g,e.style.marginLeft=h,e.style.marginRight=p,e.style.marginTop=m,e.style.marginBottom=f,n.body.style.margin=b,n.documentElement.style.overflow=C,n.body.scroll=I,e.style.imageRendering=y,e.GLctxObject&&e.GLctxObject.GLctx.viewport(0,0,i,o),Ft.canvasResizedCallback&&(t=Ft.canvasResizedCallbackUserData,Yc(Ft.canvasResizedCallback,37,0,t)))}return n.addEventListener("fullscreenchange",v),n.addEventListener("webkitfullscreenchange",v),v})(e),o=t.softFullscreen?innerWidth:screen.width,r=t.softFullscreen?innerHeight:screen.height,s=Rt(e),a=s.width,l=s.height,c=Nt(e),d=c[0],u=c[1];if(3==t.scaleMode)Tt(e,(r-l)/2,(o-a)/2),o=a,r=l;else if(2==t.scaleMode)if(o*u<d*r){var g=u*o/d;Tt(e,(r-g)/2,0),r=g}else{var h=d*r/u;Tt(e,0,(o-h)/2),o=h}e.style.backgroundColor||="black",n.body.style.backgroundColor||="black",e.style.width=o+"px",e.style.height=r+"px",1==t.filteringMode&&(e.style.imageRendering="optimizeSpeed",e.style.imageRendering="-moz-crisp-edges",e.style.imageRendering="-o-crisp-edges",e.style.imageRendering="-webkit-optimize-contrast",e.style.imageRendering="optimize-contrast",e.style.imageRendering="crisp-edges",e.style.imageRendering="pixelated");var p=2==t.canvasResolutionScaleMode?devicePixelRatio:1;if(0!=t.canvasResolutionScaleMode){var m=o*p|0,f=r*p|0;Mt(e,m,f),e.GLctxObject&&e.GLctxObject.GLctx.viewport(0,0,m,f)}return i},Gt=(e,t)=>{if(0==t.scaleMode&&0==t.canvasResolutionScaleMode||Wt(e,t),e.requestFullscreen)e.requestFullscreen();else{if(!e.webkitRequestFullscreen)return Vt.fullscreenEnabled()?-3:-1;e.webkitRequestFullscreen(y.ALLOW_KEYBOARD_INPUT)}var i;return Ft=t,t.canvasResizedCallback&&(i=t.canvasResizedCallbackUserData,Yc(t.canvasResizedCallback,37,0,i)),0},xt=e=>e.requestPointerLock?(e.requestPointerLock(),0):n.body.requestPointerLock?-3:-1,Lt=e=>{var t=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_disjoint_timer_query","EXT_frag_depth","EXT_shader_texture_lod","EXT_sRGB","OES_element_index_uint","OES_fbo_render_mipmap","OES_standard_derivatives","OES_texture_float","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_depth_texture","WEBGL_draw_buffers","EXT_color_buffer_float","EXT_conservative_depth","EXT_disjoint_timer_query_webgl2","EXT_texture_norm16","NV_shader_noperspective_interpolation","WEBGL_clip_cull_distance","EXT_clip_control","EXT_color_buffer_half_float","EXT_depth_clamp","EXT_float_blend","EXT_polygon_offset_clamp","EXT_texture_compression_bptc","EXT_texture_compression_rgtc","EXT_texture_filter_anisotropic","KHR_parallel_shader_compile","OES_texture_float_linear","WEBGL_blend_func_extended","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context","WEBGL_multi_draw","WEBGL_polygon_mode"];return(e.getSupportedExtensions()||[]).filter((e=>t.includes(e)))},Qt={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],shaders:[],vaos:[],contexts:[],offscreenCanvases:{},queries:[],samplers:[],transformFeedbacks:[],syncs:[],byteSizeByTypeRoot:5120,byteSizeByType:[1,1,2,2,4,4,4,2,3,4,8],stringCache:{},stringiCache:{},unpackAlignment:4,unpackRowLength:0,recordError:e=>{Qt.lastError||(Qt.lastError=e)},getNewId:e=>{for(var t=Qt.counter++,i=e.length;i<t;i++)e[i]=null;for(;e[t];)t=Qt.counter++;return t},genObject:(e,t,i,n)=>{for(var o=0;o<e;o++){var r=Re[i](),s=r&&Qt.getNewId(n);r?(r.name=s,n[s]=r):Qt.recordError(1282),K[t+4*o>>2]=s}},MAX_TEMP_BUFFER_SIZE:2097152,numTempVertexBuffersPerSize:64,log2ceilLookup:e=>32-c.clz32(0===e?0:e-1),generateTempBuffers:(e,t)=>{var i=Qt.log2ceilLookup(Qt.MAX_TEMP_BUFFER_SIZE);t.tempVertexBufferCounters1=[],t.tempVertexBufferCounters2=[],t.tempVertexBufferCounters1.length=t.tempVertexBufferCounters2.length=i+1,t.tempVertexBuffers1=[],t.tempVertexBuffers2=[],t.tempVertexBuffers1.length=t.tempVertexBuffers2.length=i+1,t.tempIndexBuffers=[],t.tempIndexBuffers.length=i+1;for(var n=0;n<=i;++n){t.tempIndexBuffers[n]=null,t.tempVertexBufferCounters1[n]=t.tempVertexBufferCounters2[n]=0;var o=Qt.numTempVertexBuffersPerSize;t.tempVertexBuffers1[n]=[],t.tempVertexBuffers2[n]=[];var r=t.tempVertexBuffers1[n],s=t.tempVertexBuffers2[n];r.length=s.length=o;for(var a=0;a<o;++a)r[a]=s[a]=null}if(e){t.tempQuadIndexBuffer=Re.createBuffer(),t.GLctx.bindBuffer(34963,t.tempQuadIndexBuffer);for(var l=Qt.MAX_TEMP_BUFFER_SIZE>>1,c=new Uint16Array(l),d=(n=0,0);c[n++]=d,!(n>=l||(c[n++]=d+1,n>=l)||(c[n++]=d+2,n>=l)||(c[n++]=d,n>=l)||(c[n++]=d+2,n>=l)||(c[n++]=d+3,n>=l));)d+=4;t.GLctx.bufferData(34963,c,35044),t.GLctx.bindBuffer(34963,null)}},getTempVertexBuffer:e=>{var t=Qt.log2ceilLookup(e),i=Qt.currentContext.tempVertexBuffers1[t],n=Qt.currentContext.tempVertexBufferCounters1[t];Qt.currentContext.tempVertexBufferCounters1[t]=Qt.currentContext.tempVertexBufferCounters1[t]+1&Qt.numTempVertexBuffersPerSize-1;var o=i[n];if(o)return o;var r=Re.getParameter(34964);return i[n]=Re.createBuffer(),Re.bindBuffer(34962,i[n]),Re.bufferData(34962,1<<t,35048),Re.bindBuffer(34962,r),i[n]},getTempIndexBuffer:e=>{var t=Qt.log2ceilLookup(e),i=Qt.currentContext.tempIndexBuffers[t];if(i)return i;var n=Re.getParameter(34965);return Qt.currentContext.tempIndexBuffers[t]=Re.createBuffer(),Re.bindBuffer(34963,Qt.currentContext.tempIndexBuffers[t]),Re.bufferData(34963,1<<t,35048),Re.bindBuffer(34963,n),Qt.currentContext.tempIndexBuffers[t]},newRenderingFrameStarted:()=>{if(Qt.currentContext){var e=Qt.currentContext.tempVertexBuffers1;Qt.currentContext.tempVertexBuffers1=Qt.currentContext.tempVertexBuffers2,Qt.currentContext.tempVertexBuffers2=e,e=Qt.currentContext.tempVertexBufferCounters1,Qt.currentContext.tempVertexBufferCounters1=Qt.currentContext.tempVertexBufferCounters2,Qt.currentContext.tempVertexBufferCounters2=e;for(var t=Qt.log2ceilLookup(Qt.MAX_TEMP_BUFFER_SIZE),i=0;i<=t;++i)Qt.currentContext.tempVertexBufferCounters1[i]=0}},getSource:(e,t,i,n)=>{for(var o="",r=0;r<t;++r){var s=n?j[n+4*r>>2]:W;o+=Se(j[i+4*r>>2],s)}return o},calcBufLength:(e,t,i,n)=>i>0?n*i:e*Qt.byteSizeByType[t-Qt.byteSizeByTypeRoot]*n,usedTempBuffers:[],preDrawHandleClientVertexAttribBindings:e=>{Qt.resetBufferBinding=!1;for(var t=0;t<Qt.currentContext.maxVertexAttribs;++t){var i=Qt.currentContext.clientBuffers[t];if(i.clientside&&i.enabled){Qt.resetBufferBinding=!0;var n=Qt.calcBufLength(i.size,i.type,i.stride,e),o=Qt.getTempVertexBuffer(n);Re.bindBuffer(34962,o),Re.bufferSubData(34962,0,x.subarray(i.ptr,i.ptr+n)),i.vertexAttribPointerAdaptor.call(Re,t,i.size,i.type,i.normalized,i.stride,0)}}},postDrawHandleClientVertexAttribBindings:()=>{Qt.resetBufferBinding&&Re.bindBuffer(34962,Qt.buffers[Re.currentArrayBufferBinding])},createContext:(e,t)=>{e.getContextSafariWebGL2Fixed||(e.getContextSafariWebGL2Fixed=e.getContext,e.getContext=function(t,i){var n=e.getContextSafariWebGL2Fixed(t,i);return"webgl"==t==n instanceof WebGLRenderingContext?n:null});var i=t.majorVersion>1?e.getContext("webgl2",t):e.getContext("webgl",t);return i?Qt.registerContext(i,t):0},registerContext:(e,t)=>{var i=Qt.getNewId(Qt.contexts),n={handle:i,attributes:t,version:t.majorVersion,GLctx:e};e.canvas&&(e.canvas.GLctxObject=n),Qt.contexts[i]=n,(void 0===t.enableExtensionsByDefault||t.enableExtensionsByDefault)&&Qt.initExtensions(n),n.maxVertexAttribs=n.GLctx.getParameter(34921),n.clientBuffers=[];for(var o=0;o<n.maxVertexAttribs;o++)n.clientBuffers[o]={enabled:!1,clientside:!1,size:0,type:0,normalized:0,stride:0,ptr:0,vertexAttribPointerAdaptor:null};return Qt.generateTempBuffers(!1,n),i},makeContextCurrent:e=>(Qt.currentContext=Qt.contexts[e],h.ctx=Re=Qt.currentContext?.GLctx,!(e&&!Re)),getContext:e=>Qt.contexts[e],deleteContext:e=>{Qt.currentContext===Qt.contexts[e]&&(Qt.currentContext=null),"object"==typeof Vt&&Vt.removeAllHandlersOnTarget(Qt.contexts[e].GLctx.canvas),Qt.contexts[e]?.GLctx.canvas&&(Qt.contexts[e].GLctx.canvas.GLctxObject=W),Qt.contexts[e]=null},initExtensions:e=>{if(e||=Qt.currentContext,!e.initExtensionsDone){e.initExtensionsDone=!0;var t,i=e.GLctx;(t=i).multiDrawWebgl=t.getExtension("WEBGL_multi_draw"),(e=>{e.extPolygonOffsetClamp=e.getExtension("EXT_polygon_offset_clamp")})(i),(e=>{e.extClipControl=e.getExtension("EXT_clip_control")})(i),(e=>{e.webglPolygonMode=e.getExtension("WEBGL_polygon_mode")})(i),(e=>{var t=e.getExtension("ANGLE_instanced_arrays");t&&(e.vertexAttribDivisor=(e,i)=>t.vertexAttribDivisorANGLE(e,i),e.drawArraysInstanced=(e,i,n,o)=>t.drawArraysInstancedANGLE(e,i,n,o),e.drawElementsInstanced=(e,i,n,o,r)=>t.drawElementsInstancedANGLE(e,i,n,o,r))})(i),(e=>{var t=e.getExtension("OES_vertex_array_object");t&&(e.createVertexArray=()=>t.createVertexArrayOES(),e.deleteVertexArray=e=>t.deleteVertexArrayOES(e),e.bindVertexArray=e=>t.bindVertexArrayOES(e),e.isVertexArray=e=>t.isVertexArrayOES(e))})(i),(e=>{var t=e.getExtension("WEBGL_draw_buffers");t&&(e.drawBuffers=(e,i)=>t.drawBuffersWEBGL(e,i))})(i),(e=>{e.dibvbi=e.getExtension("WEBGL_draw_instanced_base_vertex_base_instance")})(i),(e=>{e.mdibvbi=e.getExtension("WEBGL_multi_draw_instanced_base_vertex_base_instance")})(i),e.version>=2&&(i.disjointTimerQueryExt=i.getExtension("EXT_disjoint_timer_query_webgl2")),(e.version<2||!i.disjointTimerQueryExt)&&(i.disjointTimerQueryExt=i.getExtension("EXT_disjoint_timer_query")),Lt(i).forEach((e=>{e.includes("lose_context")||e.includes("debug")||i.getExtension(e)}))}}},Xt=e=>Re.activeTexture(e),Kt=Xt,jt=(e,t)=>{Re.attachShader(Qt.programs[e],Qt.shaders[t])},Dt=jt,Yt=(e,t)=>{Re.beginQuery(e,Qt.queries[t])},zt=(e,t)=>{Re.disjointTimerQueryExt.beginQueryEXT(e,Qt.queries[t])},Ht=e=>Re.beginTransformFeedback(e),Jt=(e,t,i)=>{Re.bindAttribLocation(Qt.programs[e],t,Se(i))},_t=(e,t)=>{if(t&&!Qt.buffers[t]){var i=Re.createBuffer();i.name=t,Qt.buffers[t]=i}34962==e?Re.currentArrayBufferBinding=t:34963==e&&(Re.currentElementArrayBufferBinding=t),35051==e?Re.currentPixelPackBufferBinding=t:35052==e&&(Re.currentPixelUnpackBufferBinding=t),Re.bindBuffer(e,Qt.buffers[t])},Ot=_t,Pt=(e,t,i)=>{Re.bindBufferBase(e,t,Qt.buffers[i])},qt=(e,t,i,n,o)=>{Re.bindBufferRange(e,t,Qt.buffers[i],n,o)},$t=(e,t)=>{Re.bindFramebuffer(e,Qt.framebuffers[t])},ei=$t,ti=(e,t)=>{Re.bindRenderbuffer(e,Qt.renderbuffers[t])},ii=ti,ni=(e,t)=>{Re.bindSampler(e,Qt.samplers[t])},oi=(e,t)=>{Re.bindTexture(e,Qt.textures[t])},ri=oi,si=(e,t)=>{Re.bindTransformFeedback(e,Qt.transformFeedbacks[t])},ai=e=>{Re.bindVertexArray(Qt.vaos[e]);var t=Re.getParameter(34965);Re.currentElementArrayBufferBinding=t?0|t.name:0},li=ai,ci=ai,di=ci,ui=(e,t,i,n)=>Re.blendColor(e,t,i,n),gi=e=>Re.blendEquation(e),hi=gi,pi=(e,t)=>Re.blendEquationSeparate(e,t),mi=(e,t)=>Re.blendFunc(e,t),fi=mi,bi=(e,t,i,n)=>Re.blendFuncSeparate(e,t,i,n),Ci=(e,t,i,n,o,r,s,a,l,c)=>Re.blitFramebuffer(e,t,i,n,o,r,s,a,l,c),Ii=(e,t,i,n)=>{Qt.currentContext.version>=2?i&&t?Re.bufferData(e,x,n,i,t):Re.bufferData(e,t,n):Re.bufferData(e,i?x.subarray(i,i+t):t,n)},yi=Ii,vi=(e,t,i,n)=>{Qt.currentContext.version>=2?i&&Re.bufferSubData(e,t,x,n,i):Re.bufferSubData(e,t,x.subarray(n,n+i))},Zi=e=>Re.checkFramebufferStatus(e),Si=Zi,Vi=e=>Re.clear(e),wi=Vi,Bi=(e,t,i,n)=>Re.clearBufferfi(e,t,i,n),Ai=(e,t,i)=>{Re.clearBufferfv(e,t,D,i>>2)},Ei=(e,t,i)=>{Re.clearBufferiv(e,t,K,i>>2)},Ui=(e,t,i)=>{Re.clearBufferuiv(e,t,j,i>>2)},Ni=(e,t,i,n)=>Re.clearColor(e,t,i,n),ki=Ni,Mi=e=>Re.clearDepth(e),Fi=e=>Re.clearStencil(e),Ti=(e,t,i)=>(i=d(i),Re.clientWaitSync(Qt.syncs[e],t,i)),Ri=(e,t)=>{Re.extClipControl.clipControlEXT(e,t)},Wi=(e,t,i,n)=>{Re.colorMask(!!e,!!t,!!i,!!n)},Gi=e=>{Re.compileShader(Qt.shaders[e])},xi=Gi,Li=(e,t,i,n,o,r,s,a)=>{if(Qt.currentContext.version>=2)return Re.currentPixelUnpackBufferBinding||!s?void Re.compressedTexImage2D(e,t,i,n,o,r,s,a):void Re.compressedTexImage2D(e,t,i,n,o,r,x,a,s);Re.compressedTexImage2D(e,t,i,n,o,r,x.subarray(a,a+s))},Qi=(e,t,i,n,o,r,s,a,l)=>{Re.currentPixelUnpackBufferBinding?Re.compressedTexImage3D(e,t,i,n,o,r,s,a,l):Re.compressedTexImage3D(e,t,i,n,o,r,s,x,l,a)},Xi=(e,t,i,n,o,r,s,a,l)=>{if(Qt.currentContext.version>=2)return Re.currentPixelUnpackBufferBinding||!a?void Re.compressedTexSubImage2D(e,t,i,n,o,r,s,a,l):void Re.compressedTexSubImage2D(e,t,i,n,o,r,s,x,l,a);Re.compressedTexSubImage2D(e,t,i,n,o,r,s,x.subarray(l,l+a))},Ki=(e,t,i,n,o,r,s,a,l,c,d)=>{Re.currentPixelUnpackBufferBinding?Re.compressedTexSubImage3D(e,t,i,n,o,r,s,a,l,c,d):Re.compressedTexSubImage3D(e,t,i,n,o,r,s,a,l,x,d,c)},ji=(e,t,i,n,o)=>Re.copyBufferSubData(e,t,i,n,o),Di=(e,t,i,n,o,r,s,a)=>Re.copyTexImage2D(e,t,i,n,o,r,s,a),Yi=(e,t,i,n,o,r,s,a)=>Re.copyTexSubImage2D(e,t,i,n,o,r,s,a),zi=(e,t,i,n,o,r,s,a,l)=>Re.copyTexSubImage3D(e,t,i,n,o,r,s,a,l),Hi=()=>{var e=Qt.getNewId(Qt.programs),t=Re.createProgram();return t.name=e,t.maxUniformLength=t.maxAttributeLength=t.maxUniformBlockNameLength=0,t.uniformIdCounter=1,Qt.programs[e]=t,e},Ji=Hi,_i=e=>{var t=Qt.getNewId(Qt.shaders);return Qt.shaders[t]=Re.createShader(e),t},Oi=_i,Pi=e=>Re.cullFace(e),qi=(e,t)=>{for(var i=0;i<e;i++){var n=K[t+4*i>>2],o=Qt.buffers[n];o&&(Re.deleteBuffer(o),o.name=0,Qt.buffers[n]=null,n==Re.currentArrayBufferBinding&&(Re.currentArrayBufferBinding=0),n==Re.currentElementArrayBufferBinding&&(Re.currentElementArrayBufferBinding=0),n==Re.currentPixelPackBufferBinding&&(Re.currentPixelPackBufferBinding=0),n==Re.currentPixelUnpackBufferBinding&&(Re.currentPixelUnpackBufferBinding=0))}},$i=qi,en=(e,t)=>{for(var i=0;i<e;++i){var n=K[t+4*i>>2],o=Qt.framebuffers[n];o&&(Re.deleteFramebuffer(o),o.name=0,Qt.framebuffers[n]=null)}},tn=en,nn=e=>{if(e){var t=Qt.programs[e];t?(Re.deleteProgram(t),t.name=0,Qt.programs[e]=null):Qt.recordError(1281)}},on=nn,rn=(e,t)=>{for(var i=0;i<e;i++){var n=K[t+4*i>>2],o=Qt.queries[n];o&&(Re.deleteQuery(o),Qt.queries[n]=null)}},sn=(e,t)=>{for(var i=0;i<e;i++){var n=K[t+4*i>>2],o=Qt.queries[n];o&&(Re.disjointTimerQueryExt.deleteQueryEXT(o),Qt.queries[n]=null)}},an=(e,t)=>{for(var i=0;i<e;i++){var n=K[t+4*i>>2],o=Qt.renderbuffers[n];o&&(Re.deleteRenderbuffer(o),o.name=0,Qt.renderbuffers[n]=null)}},ln=an,cn=(e,t)=>{for(var i=0;i<e;i++){var n=K[t+4*i>>2],o=Qt.samplers[n];o&&(Re.deleteSampler(o),o.name=0,Qt.samplers[n]=null)}},dn=e=>{if(e){var t=Qt.shaders[e];t?(Re.deleteShader(t),Qt.shaders[e]=null):Qt.recordError(1281)}},un=dn,gn=e=>{if(e){var t=Qt.syncs[e];t?(Re.deleteSync(t),t.name=0,Qt.syncs[e]=null):Qt.recordError(1281)}},hn=(e,t)=>{for(var i=0;i<e;i++){var n=K[t+4*i>>2],o=Qt.textures[n];o&&(Re.deleteTexture(o),o.name=0,Qt.textures[n]=null)}},pn=hn,mn=(e,t)=>{for(var i=0;i<e;i++){var n=K[t+4*i>>2],o=Qt.transformFeedbacks[n];o&&(Re.deleteTransformFeedback(o),o.name=0,Qt.transformFeedbacks[n]=null)}},fn=(e,t)=>{for(var i=0;i<e;i++){var n=K[t+4*i>>2];Re.deleteVertexArray(Qt.vaos[n]),Qt.vaos[n]=null}},bn=fn,Cn=fn,In=Cn,yn=e=>Re.depthFunc(e),vn=e=>{Re.depthMask(!!e)},Zn=(e,t)=>Re.depthRange(e,t),Sn=(e,t)=>{Re.detachShader(Qt.programs[e],Qt.shaders[t])},Vn=e=>Re.disable(e),wn=Vn,Bn=e=>{Qt.currentContext.clientBuffers[e].enabled=!1,Re.disableVertexAttribArray(e)},An=Bn,En=(e,t,i)=>{Qt.preDrawHandleClientVertexAttribBindings(t+i),Re.drawArrays(e,t,i),Qt.postDrawHandleClientVertexAttribBindings()},Un=En,Nn=(e,t,i,n)=>{Re.drawArraysInstanced(e,t,i,n)},kn=Nn,Mn=Nn,Fn=Mn,Tn=Nn,Rn=Tn,Wn=Nn,Gn=Wn,xn=Nn,Ln=xn,Qn=[],Xn=(e,t)=>{for(var i=Qn[e],n=0;n<e;n++)i[n]=K[t+4*n>>2];Re.drawBuffers(i)},Kn=Xn,jn=Xn,Dn=jn,Yn=Xn,zn=Yn,Hn=(e,t,i,n)=>{var o,r=0;if(!Re.currentElementArrayBufferBinding){var s=Qt.calcBufLength(1,i,0,t);if(o=Qt.getTempIndexBuffer(s),Re.bindBuffer(34963,o),Re.bufferSubData(34963,0,x.subarray(n,n+s)),t>0)for(var a=0;a<Qt.currentContext.maxVertexAttribs;++a){var l=Qt.currentContext.clientBuffers[a];if(l.clientside&&l.enabled){let e;switch(i){case 5121:e=Uint8Array;break;case 5123:e=Uint16Array;break;default:return void Qt.recordError(1282)}r=new e(x.buffer,n,t).reduce(((e,t)=>c.max(e,t)))+1;break}}n=0}Qt.preDrawHandleClientVertexAttribBindings(r),Re.drawElements(e,t,i,n),Qt.postDrawHandleClientVertexAttribBindings(t),Re.currentElementArrayBufferBinding||Re.bindBuffer(34963,null)},Jn=Hn,_n=(e,t,i,n,o)=>{Re.drawElementsInstanced(e,t,i,n,o)},On=_n,Pn=_n,qn=Pn,$n=_n,eo=$n,to=_n,io=to,no=_n,oo=no,ro=(e,t,i,n,o,r)=>{Hn(e,n,o,r)},so=e=>Re.enable(e),ao=so,lo=e=>{Qt.currentContext.clientBuffers[e].enabled=!0,Re.enableVertexAttribArray(e)},co=lo,uo=e=>Re.endQuery(e),go=e=>{Re.disjointTimerQueryExt.endQueryEXT(e)},ho=()=>Re.endTransformFeedback(),po=(e,t)=>{var i=Re.fenceSync(e,t);if(i){var n=Qt.getNewId(Qt.syncs);return i.name=n,Qt.syncs[n]=i,n}return 0},mo=()=>Re.finish(),fo=()=>Re.flush(),bo=(e,t,i,n)=>{Re.framebufferRenderbuffer(e,t,i,Qt.renderbuffers[n])},Co=bo,Io=(e,t,i,n,o)=>{Re.framebufferTexture2D(e,t,i,Qt.textures[n],o)},yo=Io,vo=(e,t,i,n,o)=>{Re.framebufferTextureLayer(e,t,Qt.textures[i],n,o)},Zo=e=>Re.frontFace(e),So=(e,t)=>{Qt.genObject(e,t,"createBuffer",Qt.buffers)},Vo=So,wo=(e,t)=>{Qt.genObject(e,t,"createFramebuffer",Qt.framebuffers)},Bo=wo,Ao=(e,t)=>{Qt.genObject(e,t,"createQuery",Qt.queries)},Eo=(e,t)=>{for(var i=0;i<e;i++){var n=Re.disjointTimerQueryExt.createQueryEXT();if(!n){for(Qt.recordError(1282);i<e;)K[t+4*i++>>2]=0;return}var o=Qt.getNewId(Qt.queries);n.name=o,Qt.queries[o]=n,K[t+4*i>>2]=o}},Uo=(e,t)=>{Qt.genObject(e,t,"createRenderbuffer",Qt.renderbuffers)},No=Uo,ko=(e,t)=>{Qt.genObject(e,t,"createSampler",Qt.samplers)},Mo=(e,t)=>{Qt.genObject(e,t,"createTexture",Qt.textures)},Fo=Mo,To=(e,t)=>{Qt.genObject(e,t,"createTransformFeedback",Qt.transformFeedbacks)},Ro=(e,t)=>{Qt.genObject(e,t,"createVertexArray",Qt.vaos)},Wo=Ro,Go=Ro,xo=Go,Lo=e=>Re.generateMipmap(e),Qo=Lo,Xo=(e,t,i,n,o,r,s,a)=>{t=Qt.programs[t];var l=Re[e](t,i);if(l){var c=a&&tt(l.name,a,n);o&&(K[o>>2]=c),r&&(K[r>>2]=l.size),s&&(K[s>>2]=l.type)}},Ko=(e,t,i,n,o,r,s)=>Xo("getActiveAttrib",e,t,i,n,o,r,s),jo=(e,t,i,n,o,r,s)=>Xo("getActiveUniform",e,t,i,n,o,r,s),Do=(e,t,i,n,o)=>{e=Qt.programs[e];var r=Re.getActiveUniformBlockName(e,t);if(r)if(o&&i>0){var s=tt(r,o,i);n&&(K[n>>2]=s)}else n&&(K[n>>2]=0)},Yo=(e,t,i,n)=>{if(n)if(e=Qt.programs[e],35393!=i){var o=Re.getActiveUniformBlockParameter(e,t,i);if(null!==o)if(35395==i)for(var r=0;r<o.length;r++)K[n+4*r>>2]=o[r];else K[n>>2]=o}else{var s=Re.getActiveUniformBlockName(e,t);K[n>>2]=s.length+1}else Qt.recordError(1281)},zo=(e,t,i,n,o)=>{if(o)if(t>0&&0==i)Qt.recordError(1281);else{e=Qt.programs[e];for(var r=[],s=0;s<t;s++)r.push(K[i+4*s>>2]);var a=Re.getActiveUniforms(e,r,n);if(a){var l=a.length;for(s=0;s<l;s++)K[o+4*s>>2]=a[s]}}else Qt.recordError(1281)},Ho=(e,t,i,n)=>{var o=Re.getAttachedShaders(Qt.programs[e]),r=o.length;r>t&&(r=t),K[i>>2]=r;for(var s=0;s<r;++s){var a=Qt.shaders.indexOf(o[s]);K[n+4*s>>2]=a}},Jo=(e,t)=>Re.getAttribLocation(Qt.programs[e],Se(t)),_o=Jo,Oo=(e,t)=>{j[e>>2]=t;var i=j[e>>2];j[e+4>>2]=(t-i)/4294967296},Po=()=>{var e=Lt(Re);return e=e.concat(e.map((e=>"GL_"+e)))},qo=(e,t,i)=>{if(t){var n=W;switch(e){case 36346:n=1;break;case 36344:return void(0!=i&&1!=i&&Qt.recordError(1280));case 34814:case 36345:n=0;break;case 34466:var o=Re.getParameter(34467);n=o?o.length:0;break;case 33309:if(Qt.currentContext.version<2)return void Qt.recordError(1282);n=Po().length;break;case 33307:case 33308:if(Qt.currentContext.version<2)return void Qt.recordError(1280);n=33307==e?3:0}if(n===W){var s=Re.getParameter(e);switch(typeof s){case"number":n=s;break;case"boolean":n=s?1:0;break;case"string":return void Qt.recordError(1280);case"object":if(null===s)switch(e){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 36662:case 36663:case 35053:case 35055:case 36010:case 35097:case 35869:case 32874:case 36389:case 35983:case 35368:case 34068:n=0;break;default:return void Qt.recordError(1280)}else{if(s instanceof Float32Array||s instanceof Uint32Array||s instanceof Int32Array||s instanceof r){for(var a=0;a<s.length;++a)switch(i){case 0:K[t+4*a>>2]=s[a];break;case 2:D[t+4*a>>2]=s[a];break;case 4:G[t+a]=s[a]?1:0}return}try{n=0|s.name}catch(t){return Qt.recordError(1280),void J(`GL_INVALID_ENUM in glGet${i}v: Unknown object returned from WebGL getParameter(${e})! (error: ${t})`)}}break;default:return Qt.recordError(1280),void J(`GL_INVALID_ENUM in glGet${i}v: Native code calling glGet${i}v(${e}) and it returns ${s} of type ${typeof s}!`)}}switch(i){case 1:Oo(t,n);break;case 0:K[t>>2]=n;break;case 2:D[t>>2]=n;break;case 4:G[t]=n?1:0}}else Qt.recordError(1281)},$o=(e,t)=>qo(e,t,4),er=(e,t,i)=>{i?Oo(i,Re.getBufferParameter(e,t)):Qt.recordError(1281)},tr=(e,t,i)=>{i?K[i>>2]=Re.getBufferParameter(e,t):Qt.recordError(1281)},ir=()=>{var e=Re.getError()||Qt.lastError;return Qt.lastError=0,e},nr=ir,or=(e,t)=>qo(e,t,2),rr=(e,t)=>Re.getFragDataLocation(Qt.programs[e],Se(t)),sr=(e,t,i,n)=>{var o=Re.getFramebufferAttachmentParameter(e,t,i);(o instanceof WebGLRenderbuffer||o instanceof WebGLTexture)&&(o=0|o.name),K[n>>2]=o},ar=(e,t,i,n)=>{if(i){var o,r=Re.getIndexedParameter(e,t);switch(typeof r){case"boolean":o=r?1:0;break;case"number":o=r;break;case"object":if(null===r)switch(e){case 35983:case 35368:o=0;break;default:return void Qt.recordError(1280)}else{if(!(r instanceof WebGLBuffer))return void Qt.recordError(1280);o=0|r.name}break;default:return void Qt.recordError(1280)}switch(n){case 1:Oo(i,o);break;case 0:K[i>>2]=o;break;case 2:D[i>>2]=o;break;case 4:G[i]=o?1:0;break;default:throw"internal emscriptenWebGLGetIndexed() error, bad type: "+n}}else Qt.recordError(1281)},lr=(e,t,i)=>ar(e,t,i,1),cr=(e,t)=>{qo(e,t,1)},dr=(e,t,i)=>ar(e,t,i,0),ur=(e,t)=>qo(e,t,0),gr=ur,hr=(e,t,i,n,o)=>{if(n<0)Qt.recordError(1281);else if(o){var r=Re.getInternalformatParameter(e,t,i);if(null!==r)for(var s=0;s<r.length&&s<n;++s)K[o+4*s>>2]=r[s]}else Qt.recordError(1281)},pr=(e,t,i,n,o)=>{Qt.recordError(1282)},mr=(e,t,i,n)=>{var o=Re.getProgramInfoLog(Qt.programs[e]);null===o&&(o="(unknown error)");var r=t>0&&n?tt(o,n,t):0;i&&(K[i>>2]=r)},fr=mr,br=(e,t,i)=>{if(i)if(e>=Qt.counter)Qt.recordError(1281);else if(e=Qt.programs[e],35716==t){var n=Re.getProgramInfoLog(e);null===n&&(n="(unknown error)"),K[i>>2]=n.length+1}else if(35719==t){if(!e.maxUniformLength)for(var o=Re.getProgramParameter(e,35718),r=0;r<o;++r)e.maxUniformLength=c.max(e.maxUniformLength,Re.getActiveUniform(e,r).name.length+1);K[i>>2]=e.maxUniformLength}else if(35722==t){if(!e.maxAttributeLength){var s=Re.getProgramParameter(e,35721);for(r=0;r<s;++r)e.maxAttributeLength=c.max(e.maxAttributeLength,Re.getActiveAttrib(e,r).name.length+1)}K[i>>2]=e.maxAttributeLength}else if(35381==t){if(!e.maxUniformBlockNameLength){var a=Re.getProgramParameter(e,35382);for(r=0;r<a;++r)e.maxUniformBlockNameLength=c.max(e.maxUniformBlockNameLength,Re.getActiveUniformBlockName(e,r).length+1)}K[i>>2]=e.maxUniformBlockNameLength}else K[i>>2]=Re.getProgramParameter(e,t);else Qt.recordError(1281)},Cr=br,Ir=(e,t,i)=>{if(i){var n,o=Qt.queries[e];n=Qt.currentContext.version<2?Re.disjointTimerQueryExt.getQueryObjectEXT(o,t):Re.getQueryParameter(o,t),Oo(i,"boolean"==typeof n?n?1:0:n)}else Qt.recordError(1281)},yr=Ir,vr=(e,t,i)=>{if(i){var n,o=Qt.queries[e],r=Re.disjointTimerQueryExt.getQueryObjectEXT(o,t);n="boolean"==typeof r?r?1:0:r,K[i>>2]=n}else Qt.recordError(1281)},Zr=vr,Sr=Ir,Vr=Sr,wr=(e,t,i)=>{if(i){var n,o=Qt.queries[e],r=Re.getQueryParameter(o,t);n="boolean"==typeof r?r?1:0:r,K[i>>2]=n}else Qt.recordError(1281)},Br=vr,Ar=Br,Er=(e,t,i)=>{i?K[i>>2]=Re.getQuery(e,t):Qt.recordError(1281)},Ur=(e,t,i)=>{i?K[i>>2]=Re.disjointTimerQueryExt.getQueryEXT(e,t):Qt.recordError(1281)},Nr=(e,t,i)=>{i?K[i>>2]=Re.getRenderbufferParameter(e,t):Qt.recordError(1281)},kr=(e,t,i)=>{i?D[i>>2]=Re.getSamplerParameter(Qt.samplers[e],t):Qt.recordError(1281)},Mr=(e,t,i)=>{i?K[i>>2]=Re.getSamplerParameter(Qt.samplers[e],t):Qt.recordError(1281)},Fr=(e,t,i,n)=>{var o=Re.getShaderInfoLog(Qt.shaders[e]);null===o&&(o="(unknown error)");var r=t>0&&n?tt(o,n,t):0;i&&(K[i>>2]=r)},Tr=Fr,Rr=(e,t,i,n)=>{var o=Re.getShaderPrecisionFormat(e,t);K[i>>2]=o.rangeMin,K[i+4>>2]=o.rangeMax,K[n>>2]=o.precision},Wr=(e,t,i,n)=>{var o=Re.getShaderSource(Qt.shaders[e]);if(o){var r=t>0&&n?tt(o,n,t):0;i&&(K[i>>2]=r)}},Gr=(e,t,i)=>{if(i)if(35716==t){var n=Re.getShaderInfoLog(Qt.shaders[e]);null===n&&(n="(unknown error)");var o=n?n.length+1:0;K[i>>2]=o}else if(35720==t){var r=Re.getShaderSource(Qt.shaders[e]),s=r?r.length+1:0;K[i>>2]=s}else K[i>>2]=Re.getShaderParameter(Qt.shaders[e],t);else Qt.recordError(1281)},xr=Gr,Lr=e=>{var t=Ee(e)+1,i=Sc(t);return i&&tt(e,i,t),i},Qr=e=>{var t=Qt.stringCache[e];if(!t){switch(e){case 7939:t=Lr(Po().join(" "));break;case 7936:case 7937:case 37445:case 37446:var i=Re.getParameter(e);i||Qt.recordError(1280),t=i?Lr(i):0;break;case 7938:var n=Re.getParameter(7938),o=`OpenGL ES 2.0 (${n})`;Qt.currentContext.version>=2&&(o=`OpenGL ES 3.0 (${n})`),t=Lr(o);break;case 35724:var r=Re.getParameter(35724),s=r.match(/^WebGL GLSL ES ([0-9]\.[0-9][0-9]?)(?:$| .*)/);null!==s&&(3==s[1].length&&(s[1]=s[1]+"0"),r=`OpenGL ES GLSL ES ${s[1]} (${r})`),t=Lr(r);break;default:Qt.recordError(1280)}Qt.stringCache[e]=t}return t},Xr=Qr,Kr=(e,t)=>{if(Qt.currentContext.version<2)return Qt.recordError(1282),0;var i=Qt.stringiCache[e];if(i)return t<0||t>=i.length?(Qt.recordError(1281),0):i[t];if(7939===e){var n=Po().map(Lr);return i=Qt.stringiCache[e]=n,t<0||t>=i.length?(Qt.recordError(1281),0):i[t]}return Qt.recordError(1280),0},jr=(e,t,i,n,o)=>{if(i<0)Qt.recordError(1281);else if(o){var r=Re.getSyncParameter(Qt.syncs[e],t);null!==r&&(K[o>>2]=r,n&&(K[n>>2]=1))}else Qt.recordError(1281)},Dr=(e,t,i)=>{i?D[i>>2]=Re.getTexParameter(e,t):Qt.recordError(1281)},Yr=(e,t,i)=>{i?K[i>>2]=Re.getTexParameter(e,t):Qt.recordError(1281)},zr=(e,t,i,n,o,r,s)=>{e=Qt.programs[e];var a=Re.getTransformFeedbackVarying(e,t);if(a){if(s&&i>0){var l=tt(a.name,s,i);n&&(K[n>>2]=l)}else n&&(K[n>>2]=0);o&&(K[o>>2]=a.size),r&&(K[r>>2]=a.type)}},Hr=(e,t)=>Re.getUniformBlockIndex(Qt.programs[e],Se(t)),Jr=(e,t,i,n)=>{if(n)if(t>0&&(0==i||0==n))Qt.recordError(1281);else{e=Qt.programs[e];for(var o=[],r=0;r<t;r++)o.push(Se(K[i+4*r>>2]));var s=Re.getUniformIndices(e,o);if(s){var a=s.length;for(r=0;r<a;r++)K[n+4*r>>2]=s[r]}}else Qt.recordError(1281)},_r=e=>"]"==e.slice(-1)&&e.lastIndexOf("["),Or=e=>{var t,i,n=e.uniformLocsById,o=e.uniformSizeAndIdsByName;if(!n){e.uniformLocsById=n={},e.uniformArrayNamesById={};var r=Re.getProgramParameter(e,35718);for(t=0;t<r;++t){var s=Re.getActiveUniform(e,t),a=s.name,l=s.size,c=_r(a),d=c>0?a.slice(0,c):a,u=e.uniformIdCounter;for(e.uniformIdCounter+=l,o[d]=[l,u],i=0;i<l;++i)n[u]=i,e.uniformArrayNamesById[u++]=d}}},Pr=(e,t)=>{if(t=Se(t),e=Qt.programs[e]){Or(e);var i=e.uniformLocsById,n=0,o=t,r=_r(t);r>0&&(a=t.slice(r+1),n=E(a)>>>0,o=t.slice(0,r));var s=e.uniformSizeAndIdsByName[o];if(s&&n<s[0]&&(i[n+=s[1]]=i[n]||Re.getUniformLocation(e,t)))return n}else Qt.recordError(1281);var a;return-1},qr=Pr,$r=e=>{var t=Re.currentProgram;if(t){var i=t.uniformLocsById[e];return"number"==typeof i&&(t.uniformLocsById[e]=i=Re.getUniformLocation(t,t.uniformArrayNamesById[e]+(i>0?`[${i}]`:""))),i}Qt.recordError(1282)},es=(e,t,i,n)=>{if(i){e=Qt.programs[e],Or(e);var o=Re.getUniform(e,$r(t));if("number"==typeof o||"boolean"==typeof o)switch(n){case 0:K[i>>2]=o;break;case 2:D[i>>2]=o}else for(var r=0;r<o.length;r++)switch(n){case 0:K[i+4*r>>2]=o[r];break;case 2:D[i+4*r>>2]=o[r]}}else Qt.recordError(1281)},ts=(e,t,i)=>{es(e,t,i,2)},is=(e,t,i)=>{es(e,t,i,0)},ns=(e,t,i)=>es(e,t,i,0),os=(e,t,i,n)=>{if(i){Qt.currentContext.clientBuffers[e].enabled&&J("glGetVertexAttrib*v on client-side array: not supported, bad data returned");var o=Re.getVertexAttrib(e,t);if(34975==t)K[i>>2]=o&&o.name;else if("number"==typeof o||"boolean"==typeof o)switch(n){case 0:K[i>>2]=o;break;case 2:D[i>>2]=o;break;case 5:K[i>>2]=c.fround(o)}else for(var r=0;r<o.length;r++)switch(n){case 0:K[i+4*r>>2]=o[r];break;case 2:D[i+4*r>>2]=o[r];break;case 5:K[i+4*r>>2]=c.fround(o[r])}}else Qt.recordError(1281)},rs=(e,t,i)=>{os(e,t,i,0)},ss=rs,as=rs,ls=as,cs=(e,t,i)=>{i?(Qt.currentContext.clientBuffers[e].enabled&&J("glGetVertexAttribPointer on client-side array: not supported, bad data returned"),K[i>>2]=Re.getVertexAttribOffset(e,t)):Qt.recordError(1281)},ds=(e,t,i)=>{os(e,t,i,2)},us=(e,t,i)=>{os(e,t,i,5)},gs=(e,t)=>Re.hint(e,t),hs=(e,t,i)=>{for(var n=Qn[t],o=0;o<t;o++)n[o]=K[i+4*o>>2];Re.invalidateFramebuffer(e,n)},ps=(e,t,i,n,o,r,s)=>{for(var a=Qn[t],l=0;l<t;l++)a[l]=K[i+4*l>>2];Re.invalidateSubFramebuffer(e,a,n,o,r,s)},ms=e=>{var t=Qt.buffers[e];return t?Re.isBuffer(t):0},fs=e=>Re.isEnabled(e),bs=e=>{var t=Qt.framebuffers[e];return t?Re.isFramebuffer(t):0},Cs=e=>(e=Qt.programs[e])?Re.isProgram(e):0,Is=Cs,ys=e=>{var t=Qt.queries[e];return t?Re.isQuery(t):0},vs=e=>{var t=Qt.queries[e];return t?Re.disjointTimerQueryExt.isQueryEXT(t):0},Zs=e=>{var t=Qt.renderbuffers[e];return t?Re.isRenderbuffer(t):0},Ss=e=>{var t=Qt.samplers[e];return t?Re.isSampler(t):0},Vs=e=>{var t=Qt.shaders[e];return t?Re.isShader(t):0},ws=e=>Re.isSync(Qt.syncs[e]),Bs=e=>{var t=Qt.textures[e];return t?Re.isTexture(t):0},As=e=>Re.isTransformFeedback(Qt.transformFeedbacks[e]),Es=e=>{var t=Qt.vaos[e];return t?Re.isVertexArray(t):0},Us=Es,Ns=Es,ks=Ns,Ms=e=>Re.lineWidth(e),Fs=e=>{e=Qt.programs[e],Re.linkProgram(e),e.uniformLocsById=0,e.uniformSizeAndIdsByName={}},Ts=Fs,Rs=()=>Re.pauseTransformFeedback(),Ws=(e,t)=>{3317==e?Qt.unpackAlignment=t:3314==e&&(Qt.unpackRowLength=t),Re.pixelStorei(e,t)},Gs=Ws,xs=(e,t)=>{Re.webglPolygonMode.polygonModeWEBGL(e,t)},Ls=(e,t)=>Re.polygonOffset(e,t),Qs=(e,t,i)=>{Re.extPolygonOffsetClamp.polygonOffsetClampEXT(e,t,i)},Xs=(e,t,i,n)=>{Qt.recordError(1280)},Ks=(e,t,i)=>{Qt.recordError(1280)},js=(e,t)=>{Re.disjointTimerQueryExt.queryCounterEXT(Qt.queries[e],t)},Ds=e=>Re.readBuffer(e),Ys=e=>0==(e-=5120)?G:1==e?x:2==e?Q:4==e?K:6==e?D:5==e||28922==e||28520==e||30779==e||30782==e?j:X,zs=(e,t)=>e>>>31-c.clz32(t.BYTES_PER_ELEMENT),Hs=(e,t,i,n,o,r)=>{var s=Ys(e),a=(e=>({5:3,6:4,8:2,29502:3,29504:4,26917:2,26918:2,29846:3,29847:4}[e-6402]||1))(t)*s.BYTES_PER_ELEMENT,l=((e,t,i)=>{var n,o,r=(Qt.unpackRowLength||e)*i;return t*(n=r,o=Qt.unpackAlignment,n+o-1&-o)})(i,n,a);return s.subarray(zs(o,s),zs(o+l,s))},Js=(e,t,i,n,o,r,s)=>{if(Qt.currentContext.version>=2){if(Re.currentPixelPackBufferBinding)return void Re.readPixels(e,t,i,n,o,r,s);var a=Ys(r),l=zs(s,a);Re.readPixels(e,t,i,n,o,r,a,l)}else{var c=Hs(r,o,i,n,s);c?Re.readPixels(e,t,i,n,o,r,c):Qt.recordError(1280)}},_s=Js,Os=()=>{},Ps=(e,t,i,n)=>Re.renderbufferStorage(e,t,i,n),qs=Ps,$s=(e,t,i,n,o)=>Re.renderbufferStorageMultisample(e,t,i,n,o),ea=()=>Re.resumeTransformFeedback(),ta=(e,t)=>{Re.sampleCoverage(e,!!t)},ia=(e,t,i)=>{Re.samplerParameterf(Qt.samplers[e],t,i)},na=(e,t,i)=>{var n=D[i>>2];Re.samplerParameterf(Qt.samplers[e],t,n)},oa=(e,t,i)=>{Re.samplerParameteri(Qt.samplers[e],t,i)},ra=(e,t,i)=>{var n=K[i>>2];Re.samplerParameteri(Qt.samplers[e],t,n)},sa=(e,t,i,n)=>Re.scissor(e,t,i,n),aa=sa,la=(e,t,i,n,o)=>{Qt.recordError(1280)},ca=(e,t,i,n)=>{var o=Qt.getSource(e,t,i,n);Re.shaderSource(Qt.shaders[e],o)},da=ca,ua=(e,t,i)=>Re.stencilFunc(e,t,i),ga=(e,t,i,n)=>Re.stencilFuncSeparate(e,t,i,n),ha=e=>Re.stencilMask(e),pa=(e,t)=>Re.stencilMaskSeparate(e,t),ma=(e,t,i)=>Re.stencilOp(e,t,i),fa=(e,t,i,n)=>Re.stencilOpSeparate(e,t,i,n),ba=(e,t,i,n,o,r,s,a,l)=>{if(Qt.currentContext.version>=2){if(Re.currentPixelUnpackBufferBinding)return void Re.texImage2D(e,t,i,n,o,r,s,a,l);if(l){var c=Ys(a),d=zs(l,c);return void Re.texImage2D(e,t,i,n,o,r,s,a,c,d)}}var u=l?Hs(a,s,n,o,l):null;Re.texImage2D(e,t,i,n,o,r,s,a,u)},Ca=ba,Ia=(e,t,i,n,o,r,s,a,l,c)=>{if(Re.currentPixelUnpackBufferBinding)Re.texImage3D(e,t,i,n,o,r,s,a,l,c);else if(c){var d=Ys(l);Re.texImage3D(e,t,i,n,o,r,s,a,l,d,zs(c,d))}else Re.texImage3D(e,t,i,n,o,r,s,a,l,null)},ya=(e,t,i)=>Re.texParameterf(e,t,i),va=(e,t,i)=>{var n=D[i>>2];Re.texParameterf(e,t,n)},Za=(e,t,i)=>Re.texParameteri(e,t,i),Sa=Za,Va=(e,t,i)=>{var n=K[i>>2];Re.texParameteri(e,t,n)},wa=(e,t,i,n,o)=>Re.texStorage2D(e,t,i,n,o),Ba=(e,t,i,n,o,r)=>Re.texStorage3D(e,t,i,n,o,r),Aa=(e,t,i,n,o,r,s,a,l)=>{if(Qt.currentContext.version>=2){if(Re.currentPixelUnpackBufferBinding)return void Re.texSubImage2D(e,t,i,n,o,r,s,a,l);if(l){var c=Ys(a);return void Re.texSubImage2D(e,t,i,n,o,r,s,a,c,zs(l,c))}}var d=l?Hs(a,s,o,r,l):null;Re.texSubImage2D(e,t,i,n,o,r,s,a,d)},Ea=Aa,Ua=(e,t,i,n,o,r,s,a,l,c,d)=>{if(Re.currentPixelUnpackBufferBinding)Re.texSubImage3D(e,t,i,n,o,r,s,a,l,c,d);else if(d){var u=Ys(c);Re.texSubImage3D(e,t,i,n,o,r,s,a,l,c,u,zs(d,u))}else Re.texSubImage3D(e,t,i,n,o,r,s,a,l,c,null)},Na=(e,t,i,n)=>{e=Qt.programs[e];for(var o=[],r=0;r<t;r++)o.push(Se(K[i+4*r>>2]));Re.transformFeedbackVaryings(e,o,n)},ka=(e,t)=>{Re.uniform1f($r(e),t)},Ma=ka,Fa=[],Ta=(e,t,i)=>{if(Qt.currentContext.version>=2)t&&Re.uniform1fv($r(e),D,i>>2,t);else{if(t<=288)for(var n=Fa[t],o=0;o<t;++o)n[o]=D[i+4*o>>2];else n=D.subarray(i>>2,i+4*t>>2);Re.uniform1fv($r(e),n)}},Ra=Ta,Wa=(e,t)=>{Re.uniform1i($r(e),t)},Ga=Wa,xa=[],La=(e,t,i)=>{if(Qt.currentContext.version>=2)t&&Re.uniform1iv($r(e),K,i>>2,t);else{if(t<=288)for(var n=xa[t],o=0;o<t;++o)n[o]=K[i+4*o>>2];else n=K.subarray(i>>2,i+4*t>>2);Re.uniform1iv($r(e),n)}},Qa=(e,t)=>{Re.uniform1ui($r(e),t)},Xa=(e,t,i)=>{t&&Re.uniform1uiv($r(e),j,i>>2,t)},Ka=(e,t,i)=>{Re.uniform2f($r(e),t,i)},ja=Ka,Da=(e,t,i)=>{if(Qt.currentContext.version>=2)t&&Re.uniform2fv($r(e),D,i>>2,2*t);else{if(t<=144)for(var n=Fa[t*=2],o=0;o<t;o+=2)n[o]=D[i+4*o>>2],n[o+1]=D[i+(4*o+4)>>2];else n=D.subarray(i>>2,i+8*t>>2);Re.uniform2fv($r(e),n)}},Ya=Da,za=(e,t,i)=>{Re.uniform2i($r(e),t,i)},Ha=(e,t,i)=>{if(Qt.currentContext.version>=2)t&&Re.uniform2iv($r(e),K,i>>2,2*t);else{if(t<=144)for(var n=xa[t*=2],o=0;o<t;o+=2)n[o]=K[i+4*o>>2],n[o+1]=K[i+(4*o+4)>>2];else n=K.subarray(i>>2,i+8*t>>2);Re.uniform2iv($r(e),n)}},Ja=(e,t,i)=>{Re.uniform2ui($r(e),t,i)},_a=(e,t,i)=>{t&&Re.uniform2uiv($r(e),j,i>>2,2*t)},Oa=(e,t,i,n)=>{Re.uniform3f($r(e),t,i,n)},Pa=Oa,qa=(e,t,i)=>{if(Qt.currentContext.version>=2)t&&Re.uniform3fv($r(e),D,i>>2,3*t);else{if(t<=96)for(var n=Fa[t*=3],o=0;o<t;o+=3)n[o]=D[i+4*o>>2],n[o+1]=D[i+(4*o+4)>>2],n[o+2]=D[i+(4*o+8)>>2];else n=D.subarray(i>>2,i+12*t>>2);Re.uniform3fv($r(e),n)}},$a=qa,el=(e,t,i,n)=>{Re.uniform3i($r(e),t,i,n)},tl=(e,t,i)=>{if(Qt.currentContext.version>=2)t&&Re.uniform3iv($r(e),K,i>>2,3*t);else{if(t<=96)for(var n=xa[t*=3],o=0;o<t;o+=3)n[o]=K[i+4*o>>2],n[o+1]=K[i+(4*o+4)>>2],n[o+2]=K[i+(4*o+8)>>2];else n=K.subarray(i>>2,i+12*t>>2);Re.uniform3iv($r(e),n)}},il=(e,t,i,n)=>{Re.uniform3ui($r(e),t,i,n)},nl=(e,t,i)=>{t&&Re.uniform3uiv($r(e),j,i>>2,3*t)},ol=(e,t,i,n,o)=>{Re.uniform4f($r(e),t,i,n,o)},rl=ol,sl=(e,t,i)=>{if(Qt.currentContext.version>=2)t&&Re.uniform4fv($r(e),D,i>>2,4*t);else{if(t<=72){var n=Fa[4*t],o=D;i>>=2,t*=4;for(var r=0;r<t;r+=4){var s=i+r;n[r]=o[s],n[r+1]=o[s+1],n[r+2]=o[s+2],n[r+3]=o[s+3]}}else n=D.subarray(i>>2,i+16*t>>2);Re.uniform4fv($r(e),n)}},al=sl,ll=(e,t,i,n,o)=>{Re.uniform4i($r(e),t,i,n,o)},cl=(e,t,i)=>{if(Qt.currentContext.version>=2)t&&Re.uniform4iv($r(e),K,i>>2,4*t);else{if(t<=72)for(var n=xa[t*=4],o=0;o<t;o+=4)n[o]=K[i+4*o>>2],n[o+1]=K[i+(4*o+4)>>2],n[o+2]=K[i+(4*o+8)>>2],n[o+3]=K[i+(4*o+12)>>2];else n=K.subarray(i>>2,i+16*t>>2);Re.uniform4iv($r(e),n)}},dl=(e,t,i,n,o)=>{Re.uniform4ui($r(e),t,i,n,o)},ul=(e,t,i)=>{t&&Re.uniform4uiv($r(e),j,i>>2,4*t)},gl=(e,t,i)=>{e=Qt.programs[e],Re.uniformBlockBinding(e,t,i)},hl=(e,t,i,n)=>{if(Qt.currentContext.version>=2)t&&Re.uniformMatrix2fv($r(e),!!i,D,n>>2,4*t);else{if(t<=72)for(var o=Fa[t*=4],r=0;r<t;r+=4)o[r]=D[n+4*r>>2],o[r+1]=D[n+(4*r+4)>>2],o[r+2]=D[n+(4*r+8)>>2],o[r+3]=D[n+(4*r+12)>>2];else o=D.subarray(n>>2,n+16*t>>2);Re.uniformMatrix2fv($r(e),!!i,o)}},pl=(e,t,i,n)=>{t&&Re.uniformMatrix2x3fv($r(e),!!i,D,n>>2,6*t)},ml=(e,t,i,n)=>{t&&Re.uniformMatrix2x4fv($r(e),!!i,D,n>>2,8*t)},fl=(e,t,i,n)=>{if(Qt.currentContext.version>=2)t&&Re.uniformMatrix3fv($r(e),!!i,D,n>>2,9*t);else{if(t<=32)for(var o=Fa[t*=9],r=0;r<t;r+=9)o[r]=D[n+4*r>>2],o[r+1]=D[n+(4*r+4)>>2],o[r+2]=D[n+(4*r+8)>>2],o[r+3]=D[n+(4*r+12)>>2],o[r+4]=D[n+(4*r+16)>>2],o[r+5]=D[n+(4*r+20)>>2],o[r+6]=D[n+(4*r+24)>>2],o[r+7]=D[n+(4*r+28)>>2],o[r+8]=D[n+(4*r+32)>>2];else o=D.subarray(n>>2,n+36*t>>2);Re.uniformMatrix3fv($r(e),!!i,o)}},bl=(e,t,i,n)=>{t&&Re.uniformMatrix3x2fv($r(e),!!i,D,n>>2,6*t)},Cl=(e,t,i,n)=>{t&&Re.uniformMatrix3x4fv($r(e),!!i,D,n>>2,12*t)},Il=(e,t,i,n)=>{if(Qt.currentContext.version>=2)t&&Re.uniformMatrix4fv($r(e),!!i,D,n>>2,16*t);else{if(t<=18){var o=Fa[16*t],r=D;n>>=2,t*=16;for(var s=0;s<t;s+=16){var a=n+s;o[s]=r[a],o[s+1]=r[a+1],o[s+2]=r[a+2],o[s+3]=r[a+3],o[s+4]=r[a+4],o[s+5]=r[a+5],o[s+6]=r[a+6],o[s+7]=r[a+7],o[s+8]=r[a+8],o[s+9]=r[a+9],o[s+10]=r[a+10],o[s+11]=r[a+11],o[s+12]=r[a+12],o[s+13]=r[a+13],o[s+14]=r[a+14],o[s+15]=r[a+15]}}else o=D.subarray(n>>2,n+64*t>>2);Re.uniformMatrix4fv($r(e),!!i,o)}},yl=Il,vl=(e,t,i,n)=>{t&&Re.uniformMatrix4x2fv($r(e),!!i,D,n>>2,8*t)},Zl=(e,t,i,n)=>{t&&Re.uniformMatrix4x3fv($r(e),!!i,D,n>>2,12*t)},Sl=e=>{e=Qt.programs[e],Re.useProgram(e),Re.currentProgram=e},Vl=Sl,wl=e=>{Re.validateProgram(Qt.programs[e])},Bl=(e,t)=>Re.vertexAttrib1f(e,t),Al=(e,t)=>{Re.vertexAttrib1f(e,D[t>>2])},El=(e,t,i)=>Re.vertexAttrib2f(e,t,i),Ul=(e,t)=>{Re.vertexAttrib2f(e,D[t>>2],D[t+4>>2])},Nl=(e,t,i,n)=>Re.vertexAttrib3f(e,t,i,n),kl=(e,t)=>{Re.vertexAttrib3f(e,D[t>>2],D[t+4>>2],D[t+8>>2])},Ml=(e,t,i,n,o)=>Re.vertexAttrib4f(e,t,i,n,o),Fl=(e,t)=>{Re.vertexAttrib4f(e,D[t>>2],D[t+4>>2],D[t+8>>2],D[t+12>>2])},Tl=(e,t)=>{Re.vertexAttribDivisor(e,t)},Rl=Tl,Wl=Tl,Gl=Tl,xl=Tl,Ll=Tl,Ql=(e,t,i,n,o)=>Re.vertexAttribI4i(e,t,i,n,o),Xl=(e,t)=>{Re.vertexAttribI4i(e,K[t>>2],K[t+4>>2],K[t+8>>2],K[t+12>>2])},Kl=(e,t,i,n,o)=>Re.vertexAttribI4ui(e,t,i,n,o),jl=(e,t)=>{Re.vertexAttribI4ui(e,j[t>>2],j[t+4>>2],j[t+8>>2],j[t+12>>2])},Dl=(e,t,i,n,o)=>{Re.vertexAttribIPointer(e,t,i,n,o)},Yl=(e,t,i,n,o,r)=>{var s=Qt.currentContext.clientBuffers[e];if(!Re.currentArrayBufferBinding)return s.size=t,s.type=i,s.normalized=n,s.stride=o,s.ptr=r,s.clientside=!0,void(s.vertexAttribPointerAdaptor=function(e,t,i,n,o,r){this.vertexAttribPointer(e,t,i,n,o,r)});s.clientside=!1,Re.vertexAttribPointer(e,t,i,!!n,o,r)},zl=Yl,Hl=(e,t,i,n)=>Re.viewport(e,t,i,n),Jl=Hl,_l=(e,t,i)=>{i=d(i),Re.waitSync(Qt.syncs[e],t,i)},Ol=e=>{var t=(e-F.buffer.byteLength+65535)/65536|0;try{return F.grow(t),P(),1}catch(e){}},Pl=(e,t,i,n,o,r,s)=>{Vt.deviceMotionEvent||=Sc(80);var a={target:Bt(e),eventTypeString:r,callbackfunc:n,handlerFunc:(e=event)=>{var i,r;((e,t)=>{var i=t.acceleration,n=t.accelerationIncludingGravity,o=t.rotationRate;i=i||{},n=n||{},o=o||{},z[e>>3]=i.x,z[e+8>>3]=i.y,z[e+16>>3]=i.z,z[e+24>>3]=n.x,z[e+32>>3]=n.y,z[e+40>>3]=n.z,z[e+48>>3]=o.alpha,z[e+56>>3]=o.beta,z[e+64>>3]=o.gamma})(Vt.deviceMotionEvent,e),i=o,r=Vt.deviceMotionEvent,Yc(n,i,r,t)&&e.preventDefault()},useCapture:i};return Vt.registerOrRemoveHandler(a)},ql=(e,t,i,n,o,r,s)=>{Vt.keyEvent||=Sc(160);var a={target:Bt(e),eventTypeString:r,callbackfunc:n,handlerFunc:e=>{var i=Vt.keyEvent;z[i>>3]=e.timeStamp;var r=i>>2;K[r+2]=e.location,G[i+12]=e.ctrlKey,G[i+13]=e.shiftKey,G[i+14]=e.altKey,G[i+15]=e.metaKey,G[i+16]=e.repeat,K[r+5]=e.charCode,K[r+6]=e.keyCode,K[r+7]=e.which,tt(e.key||"",i+32,32),tt(e.code||"",i+64,32),tt(e.char||"",i+96,32),tt(e.locale||"",i+128,32),Yc(n,o,i,t)&&e.preventDefault()},useCapture:i};return Vt.registerOrRemoveHandler(a)},$l=(e,t,i)=>{z[e>>3]=t.timeStamp;var n=e>>2;K[n+2]=t.screenX,K[n+3]=t.screenY,K[n+4]=t.clientX,K[n+5]=t.clientY,G[e+24]=t.ctrlKey,G[e+25]=t.shiftKey,G[e+26]=t.altKey,G[e+27]=t.metaKey,Q[2*n+14]=t.button,Q[2*n+15]=t.buttons,K[n+8]=t.movementX,K[n+9]=t.movementY;var o=Rt(i);K[n+10]=t.clientX-(0|o.left),K[n+11]=t.clientY-(0|o.top)},ec=(e,t,i,n,o,r,s)=>{Vt.mouseEvent||=Sc(64);var a={target:e=Bt(e),allowsDeferredCalls:"mousemove"!=r&&"mouseenter"!=r&&"mouseleave"!=r,eventTypeString:r,callbackfunc:n,handlerFunc:(i=event)=>{var r,s;$l(Vt.mouseEvent,i,e),r=o,s=Vt.mouseEvent,Yc(n,r,s,t)&&i.preventDefault()},useCapture:i};return Vt.registerOrRemoveHandler(a)},tc=(e,t,i,o,r,s,a)=>{Vt.pointerlockChangeEvent||=Sc(257);var l={target:e,eventTypeString:s,callbackfunc:o,handlerFunc:(e=event)=>{var i=Vt.pointerlockChangeEvent;(e=>{var t=n.pointerLockElement||n.mozPointerLockElement||n.webkitPointerLockElement||n.msPointerLockElement,i=!!t;G[e]=i;var o=Vt.getNodeNameForTarget(t),r=t?.id||"";tt(o,e+1,128),tt(r,e+129,128)})(i),Yc(o,r,i,t)&&e.preventDefault()},useCapture:i};return Vt.registerOrRemoveHandler(l)},ic=(e,t,i,n,o,r,a)=>{Vt.touchEvent||=Sc(1552);var l={target:e=Bt(e),allowsDeferredCalls:"touchstart"==r||"touchend"==r,eventTypeString:r,callbackfunc:n,handlerFunc:i=>{var r={},a=i.touches;for(let e of a)e.isChanged=e.onTarget=0,r[e.identifier]=e;for(let e of i.changedTouches)e.isChanged=1,r[e.identifier]=e;for(let e of i.targetTouches)r[e.identifier].onTarget=1;var l=Vt.touchEvent;z[l>>3]=i.timeStamp,G[l+12]=i.ctrlKey,G[l+13]=i.shiftKey,G[l+14]=i.altKey,G[l+15]=i.metaKey;var c=l+16,d=Rt(e),u=0;for(let e of s.values(r)){var g=c>>2;if(K[g+0]=e.identifier,K[g+1]=e.screenX,K[g+2]=e.screenY,K[g+3]=e.clientX,K[g+4]=e.clientY,K[g+5]=e.pageX,K[g+6]=e.pageY,G[c+28]=e.isChanged,G[c+29]=e.onTarget,K[g+8]=e.clientX-(0|d.left),K[g+9]=e.clientY-(0|d.top),c+=48,++u>31)break}K[l+8>>2]=u,Yc(n,o,l,t)&&i.preventDefault()},useCapture:i};return Vt.registerOrRemoveHandler(l)},nc=e=>dc.handleSleep((t=>Zt(t,e)));nc.isAsync=!0;var oc,rc=["default","low-power","high-performance"],sc=(e,t)=>{var i=t>>2,n=K[i+2],o={alpha:!!G[t+0],depth:!!G[t+1],stencil:!!G[t+2],antialias:!!G[t+3],premultipliedAlpha:!!G[t+4],preserveDrawingBuffer:!!G[t+5],powerPreference:rc[n],failIfMajorPerformanceCaveat:!!G[t+12],majorVersion:K[i+4],minorVersion:K[i+5],enableExtensionsByDefault:G[t+24],explicitSwapControl:G[t+25],proxyContextToMainThread:K[i+7],renderViaOffscreenBackBuffer:G[t+32]},r=At(e);return r?o.explicitSwapControl?0:Qt.createContext(r,o):0},ac={},lc=()=>{if(!lc.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof R&&R.languages&&R.languages[0]||"C").replace("-","_")+".UTF-8",_:I||"./this.program"};for(var t in ac)ac[t]===W?delete e[t]:e[t]=ac[t];var i=[];for(var t in e)i.push(`${t}=${e[t]}`);lc.strings=i}return lc.strings},cc=e=>{try{return e()}catch(e){ne(e)}},dc={instrumentWasmImports(e){var t=/^(invoke_.*|__asyncjs__.*)$/;for(let[i,n]of s.entries(e))"function"==typeof n&&(n.isAsync||t.test(i))},instrumentWasmExports(e){var t={};for(let[i,n]of s.entries(e))t[i]="function"==typeof n?(...e)=>{dc.exportCallStack.push(i);try{return n(...e)}finally{_||(dc.exportCallStack.pop(),dc.maybeStopUnwind())}}:n;return t},State:{Normal:0,Unwinding:1,Rewinding:2,Disabled:3},state:0,StackSize:8192,currData:null,handleSleepReturnValue:0,exportCallStack:[],callStackNameToId:{},callStackIdToName:{},callStackId:0,asyncPromiseHandlers:null,sleepCallbacks:[],getCallStackId(e){var t=dc.callStackNameToId[e];return t===W&&(t=dc.callStackId++,dc.callStackNameToId[e]=t,dc.callStackIdToName[t]=e),t},maybeStopUnwind(){dc.currData&&dc.state===dc.State.Unwinding&&0===dc.exportCallStack.length&&(dc.state=dc.State.Normal,cc($c),"undefined"!=typeof Fibers&&Fibers.trampoline())},whenDone:()=>new Promise(((e,t)=>{dc.asyncPromiseHandlers={resolve:e,reject:t}})),allocateData(){var e=Sc(12+dc.StackSize);return dc.setDataHeader(e,e+12,dc.StackSize),dc.setDataRewindFunc(e),e},setDataHeader(e,t,i){j[e>>2]=t,j[e+4>>2]=t+i},setDataRewindFunc(e){var t=dc.exportCallStack[0],i=dc.getCallStackId(t);K[e+8>>2]=i},getDataRewindFuncName(e){var t=K[e+8>>2];return dc.callStackIdToName[t]},getDataRewindFunc:e=>vc[e],doRewind(e){var t=dc.getDataRewindFuncName(e);return dc.getDataRewindFunc(t)()},handleSleep(e){if(!_){if(dc.state===dc.State.Normal){var t=!1,i=!1;e(((e=0)=>{if(!_&&(dc.handleSleepReturnValue=e,t=!0,i)){dc.state=dc.State.Rewinding,cc((()=>ed(dc.currData))),void 0!==mt&&mt.func&&mt.resume();var n,o=!1;try{n=dc.doRewind(dc.currData)}catch(e){n=e,o=!0}var r=!1;if(!dc.currData){var s=dc.asyncPromiseHandlers;s&&(dc.asyncPromiseHandlers=null,(o?s.reject:s.resolve)(n),r=!0)}if(o&&!r)throw n}})),i=!0,t||(dc.state=dc.State.Unwinding,dc.currData=dc.allocateData(),void 0!==mt&&mt.func&&mt.pause(),cc((()=>qc(dc.currData))))}else dc.state===dc.State.Rewinding?(dc.state=dc.State.Normal,cc(td),Zc(dc.currData),dc.currData=null,dc.sleepCallbacks.forEach(pt)):ne(`invalid state: ${dc.state}`);return dc.handleSleepReturnValue}},handleAsync:e=>dc.handleSleep((t=>{e().then(t)}))},uc={useWebGL:!1,isFullscreen:!1,pointerLock:!1,moduleContextCreatedCallbacks:[],workers:[],preloadedImages:{},preloadedAudios:{},getCanvas:()=>h.canvas,init(){if(!uc.initted){uc.initted=!0;var e={canHandle:function(e){return!h.noImageDecoding&&/\.(jpg|jpeg|png|bmp|webp)$/i.test(e)},handle:function(e,t,i,o){var r=new Blob([e],{type:uc.getMimetype(t)});r.size!==e.length&&(r=new Blob([new Uint8Array(e).buffer],{type:uc.getMimetype(t)}));var s=URL.createObjectURL(r),a=new Image;a.onload=()=>{var o=n.createElement("canvas");o.width=a.width,o.height=a.height,o.getContext("2d").drawImage(a,0,0),uc.preloadedImages[t]=o,URL.revokeObjectURL(s),i?.(e)},a.onerror=e=>{J(`Image ${s} could not be decoded`),o?.()},a.src=s}};We.push(e);var t={canHandle:function(e){return!h.noAudioDecoding&&e.slice(-4)in{".ogg":1,".wav":1,".mp3":1}},handle:function(e,t,i,n){var o=!1;function r(n){o||(o=!0,uc.preloadedAudios[t]=n,i?.(e))}var s=new Blob([e],{type:uc.getMimetype(t)}),a=URL.createObjectURL(s),l=new Audio;l.addEventListener("canplaythrough",(()=>r(l)),!1),l.onerror=function(i){o||(J(`warning: browser could not fully decode audio ${t}, trying slower base64 approach`),l.src="data:audio/x-"+t.slice(-3)+";base64,"+function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="",n=0,o=0,r=0;r<e.length;r++)for(n=n<<8|e[r],o+=8;o>=6;){var s=n>>o-6&63;o-=6,i+=t[s]}return 2==o?(i+=t[(3&n)<<4],i+="=="):4==o&&(i+=t[(15&n)<<2],i+="="),i}(e),r(l))},l.src=a,Zt((()=>{r(l)}),1e4)}};We.push(t);var i=uc.getCanvas();i&&(i.requestPointerLock=i.requestPointerLock||i.mozRequestPointerLock||i.webkitRequestPointerLock||i.msRequestPointerLock||(()=>{}),i.exitPointerLock=n.exitPointerLock||n.mozExitPointerLock||n.webkitExitPointerLock||n.msExitPointerLock||(()=>{}),i.exitPointerLock=i.exitPointerLock.bind(n),n.addEventListener("pointerlockchange",o,!1),n.addEventListener("mozpointerlockchange",o,!1),n.addEventListener("webkitpointerlockchange",o,!1),n.addEventListener("mspointerlockchange",o,!1),h.elementPointerLock&&i.addEventListener("click",(e=>{!uc.pointerLock&&uc.getCanvas().requestPointerLock&&(uc.getCanvas().requestPointerLock(),e.preventDefault())}),!1))}function o(){var e=uc.getCanvas();uc.pointerLock=n.pointerLockElement===e||n.mozPointerLockElement===e||n.webkitPointerLockElement===e||n.msPointerLockElement===e}},createContext(e,t,i,n){if(t&&h.ctx&&e==uc.getCanvas())return h.ctx;var o,r;if(t){var s={antialias:!1,alpha:!1,majorVersion:"undefined"!=typeof WebGL2RenderingContext?2:1};if(n)for(var a in n)s[a]=n[a];void 0!==Qt&&(r=Qt.createContext(e,s))&&(o=Qt.getContext(r).GLctx)}else o=e.getContext("2d");return o?(i&&(h.ctx=o,t&&Qt.makeContextCurrent(r),uc.useWebGL=t,uc.moduleContextCreatedCallbacks.forEach((e=>e())),uc.init()),o):null},fullscreenHandlersInstalled:!1,lockPointer:W,resizeCanvas:W,requestFullscreen(e,t){uc.lockPointer=e,uc.resizeCanvas=t,void 0===uc.lockPointer&&(uc.lockPointer=!0),void 0===uc.resizeCanvas&&(uc.resizeCanvas=!1);var i=uc.getCanvas();function o(){uc.isFullscreen=!1;var e=i.parentNode;(n.fullscreenElement||n.mozFullScreenElement||n.msFullscreenElement||n.webkitFullscreenElement||n.webkitCurrentFullScreenElement)===e?(i.exitFullscreen=uc.exitFullscreen,uc.lockPointer&&i.requestPointerLock(),uc.isFullscreen=!0,uc.resizeCanvas?uc.setFullscreenCanvasSize():uc.updateCanvasDimensions(i)):(e.parentNode.insertBefore(i,e),e.parentNode.removeChild(e),uc.resizeCanvas?uc.setWindowedCanvasSize():uc.updateCanvasDimensions(i)),h.onFullScreen?.(uc.isFullscreen),h.onFullscreen?.(uc.isFullscreen)}uc.fullscreenHandlersInstalled||(uc.fullscreenHandlersInstalled=!0,n.addEventListener("fullscreenchange",o,!1),n.addEventListener("mozfullscreenchange",o,!1),n.addEventListener("webkitfullscreenchange",o,!1),n.addEventListener("MSFullscreenChange",o,!1));var r=n.createElement("div");i.parentNode.insertBefore(r,i),r.appendChild(i),r.requestFullscreen=r.requestFullscreen||r.mozRequestFullScreen||r.msRequestFullscreen||(r.webkitRequestFullscreen?()=>r.webkitRequestFullscreen(y.ALLOW_KEYBOARD_INPUT):null)||(r.webkitRequestFullScreen?()=>r.webkitRequestFullScreen(y.ALLOW_KEYBOARD_INPUT):null),r.requestFullscreen()},exitFullscreen:()=>!!uc.isFullscreen&&((n.exitFullscreen||n.cancelFullScreen||n.mozCancelFullScreen||n.msExitFullscreen||n.webkitCancelFullScreen||(()=>{})).apply(n,[]),!0),safeSetTimeout:(e,t)=>Zt(e,t),getMimetype:e=>({jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.slice(e.lastIndexOf(".")+1)]),getUserMedia(t){e.getUserMedia||=R.getUserMedia||R.mozGetUserMedia,e.getUserMedia(t)},getMovementX:e=>e.movementX||e.mozMovementX||e.webkitMovementX||0,getMovementY:e=>e.movementY||e.mozMovementY||e.webkitMovementY||0,getMouseWheelDelta(e){var t=0;switch(e.type){case"DOMMouseScroll":t=e.detail/3;break;case"mousewheel":t=e.wheelDelta/120;break;case"wheel":switch(t=e.deltaY,e.deltaMode){case 0:t/=100;break;case 1:t/=3;break;case 2:t*=80;break;default:throw"unrecognized mouse wheel delta mode: "+e.deltaMode}break;default:throw"unrecognized mouse wheel event: "+e.type}return t},mouseX:0,mouseY:0,mouseMovementX:0,mouseMovementY:0,touches:{},lastTouches:{},calculateMouseCoords(t,i){var n=uc.getCanvas(),o=n.getBoundingClientRect(),r=void 0!==e.scrollX?e.scrollX:e.pageXOffset,s=void 0!==e.scrollY?e.scrollY:e.pageYOffset,a=t-(r+o.left),l=i-(s+o.top);return{x:a*=n.width/o.width,y:l*=n.height/o.height}},setMouseCoords(e,t){const{x:i,y:n}=uc.calculateMouseCoords(e,t);uc.mouseMovementX=i-uc.mouseX,uc.mouseMovementY=n-uc.mouseY,uc.mouseX=i,uc.mouseY=n},calculateMouseEvent(e){if(uc.pointerLock)"mousemove"!=e.type&&"mozMovementX"in e?uc.mouseMovementX=uc.mouseMovementY=0:(uc.mouseMovementX=uc.getMovementX(e),uc.mouseMovementY=uc.getMovementY(e)),uc.mouseX+=uc.mouseMovementX,uc.mouseY+=uc.mouseMovementY;else{if("touchstart"===e.type||"touchend"===e.type||"touchmove"===e.type){var t=e.touch;if(t===W)return;var i=uc.calculateMouseCoords(t.pageX,t.pageY);if("touchstart"===e.type)uc.lastTouches[t.identifier]=i,uc.touches[t.identifier]=i;else if("touchend"===e.type||"touchmove"===e.type){var n=uc.touches[t.identifier];n||=i,uc.lastTouches[t.identifier]=n,uc.touches[t.identifier]=i}return}uc.setMouseCoords(e.pageX,e.pageY)}},resizeListeners:[],updateResizeListeners(){var e=uc.getCanvas();uc.resizeListeners.forEach((t=>t(e.width,e.height)))},setCanvasSize(e,t,i){var n=uc.getCanvas();uc.updateCanvasDimensions(n,e,t),i||uc.updateResizeListeners()},windowedWidth:0,windowedHeight:0,setFullscreenCanvasSize(){if("undefined"!=typeof SDL){var e=j[SDL.screen>>2];e|=8388608,K[SDL.screen>>2]=e}uc.updateCanvasDimensions(uc.getCanvas()),uc.updateResizeListeners()},setWindowedCanvasSize(){if("undefined"!=typeof SDL){var e=j[SDL.screen>>2];e&=-8388609,K[SDL.screen>>2]=e}uc.updateCanvasDimensions(uc.getCanvas()),uc.updateResizeListeners()},updateCanvasDimensions(e,t,i){t&&i?(e.widthNative=t,e.heightNative=i):(t=e.widthNative,i=e.heightNative);var o=t,r=i;if(h.forcedAspectRatio>0&&(o/r<h.forcedAspectRatio?o=c.round(r*h.forcedAspectRatio):r=c.round(o/h.forcedAspectRatio)),(n.fullscreenElement||n.mozFullScreenElement||n.msFullscreenElement||n.webkitFullscreenElement||n.webkitCurrentFullScreenElement)===e.parentNode&&"undefined"!=typeof screen){var s=c.min(screen.width/o,screen.height/r);o=c.round(o*s),r=c.round(r*s)}uc.resizeCanvas?(e.width!=o&&(e.width=o),e.height!=r&&(e.height=r),void 0!==e.style&&(e.style.removeProperty("width"),e.style.removeProperty("height"))):(e.width!=t&&(e.width=t),e.height!=i&&(e.height=i),void 0!==e.style&&(o!=t||r!=i?(e.style.setProperty("width",o+"px","important"),e.style.setProperty("height",r+"px","important")):(e.style.removeProperty("width"),e.style.removeProperty("height"))))}},gc=e=>h["_"+e],hc=(e,t,i,n,o)=>{var r={string:e=>{var t=0;return null!==e&&e!==W&&0!==e&&(t=Ut(e)),t},array:e=>{var t,i,n=Et(e.length);return t=e,i=n,G.set(t,i),n}},s=gc(e),a=[],c=0;if(n)for(var d=0;d<n.length;d++){var u=r[i[d]];u?(0===c&&(c=me()),a[d]=u(n[d])):a[d]=n[d]}var g=dc.currData,h=s(...a);function p(e){return at-=1,0!==c&&pe(c),function(e){return"string"===t?Se(e):"boolean"===t?l(e):e}(e)}var m=o?.async;return at+=1,dc.currData!=g?dc.whenDone().then(p):(h=p(h),m?Promise.resolve(h):h)};function pc(e){fe.command_queue.push(e),kc()}function mc(){return fe.command_reply_queue.shift()}Le.createPreloadedFile=(e,t,i,n,o,r,s,a,l,c)=>{var d=t?Be.resolve(we.join2(e,t)):e;function u(i){function u(i){c?.(),a||((...e)=>{Le.createDataFile(...e)})(e,t,i,n,o,l),r?.(),ie()}((e,t,i,n)=>{void 0!==uc&&uc.init();var o=!1;return We.forEach((r=>{o||r.canHandle(t)&&(r.handle(e,t,i,n),o=!0)})),o})(i,d,u,(()=>{s?.(),ie()}))||u(i)}te(),"string"==typeof i?Te(i).then(u,s):u(i)},Le.staticInit(),Fe.doesNotExistError=new Le.ErrnoError(44),Fe.doesNotExistError.stack="<generic error, no stack>",h.requestAnimationFrame=mt.requestAnimationFrame,h.pauseMainLoop=mt.pause,h.resumeMainLoop=mt.resume,mt.init(),oc=()=>Qt.newRenderingFrameStarted(),void 0!==mt&&mt.preMainLoop.push(oc);for(let e=0;e<32;++e)Qn.push(new r(e));for(var fc=new Float32Array(288),bc=0;bc<=288;++bc)Fa[bc]=fc.subarray(0,bc);var Cc=new Int32Array(288);for(bc=0;bc<=288;++bc)xa[bc]=Cc.subarray(0,bc);h.requestFullscreen=uc.requestFullscreen,h.setCanvasSize=uc.setCanvasSize,h.getUserMedia=uc.getUserMedia,h.createContext=uc.createContext,h.noExitRuntime&&(he=h.noExitRuntime),h.preloadPlugins&&(We=h.preloadPlugins),h.print&&(H=h.print),h.printErr&&(J=h.printErr),h.wasmBinary&&(M=h.wasmBinary),h.arguments&&(C=h.arguments),h.thisProgram&&(I=h.thisProgram),h.callMain=id,h.abort=ne,h.ENV=ac,h.ERRNO_CODES={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135},h.cwrap=(e,t,i,n)=>{var o=!i||i.every((e=>"number"===e||"boolean"===e));return"string"!==t&&o&&!n?gc(e):(...o)=>hc(e,t,i,o,n)},h.getValue=function(e,t="i8"){switch(t.endsWith("*")&&(t="*"),t){case"i1":case"i8":return G[e];case"i16":return Q[e>>1];case"i32":return K[e>>2];case"i64":return Y[e>>3];case"float":return D[e>>2];case"double":return z[e>>3];case"*":return j[e>>2];default:ne(`invalid type for getValue: ${t}`)}},h.PATH=we,h.UTF8ToString=Se,h.stringToNewUTF8=Lr,h.Browser=uc,h.FS=Le,h.AL=ft,h.EmscriptenSendCommand=pc,h.EmscriptenReceiveCommandReply=mc,h.EmscriptenSendCommand=pc,h.EmscriptenReceiveCommandReply=mc;var Ic={1410376:()=>{try{return Lr(h.getSavExt())}catch(e){return Lr(".srm")}},1410477:e=>{h.callbacks&&"function"==typeof h.callbacks.setupCoreSettingFile&&h.callbacks.setupCoreSettingFile("/home/web_user/retroarch/userdata/config/"+Se(e)+"/"+Se(e)+".opt")},1410707:(e,t)=>{var i=Se(e,t);fe.command_reply_queue.push(i)},1410786:(e,t,i)=>{var n=fe.command_queue.shift(),o=Ee(n);return o>i?(N.error("[CMD] Command too long, skipping",n),0):(tt(n,t,i),0==fe.command_queue.length&&function(e,t,i="i8"){switch(i.endsWith("*")&&(i="*"),i){case"i1":case"i8":G[e]=t;break;case"i16":Q[e>>1]=t;break;case"i32":K[e>>2]=t;break;case"i64":Y[e>>3]=BigInt(t);break;case"float":D[e>>2]=t;break;case"double":z[e>>3]=t;break;case"*":j[e>>2]=t;break;default:ne(`invalid type for setValue: ${i}`)}}(e,0,"i8"),o)},1411089:e=>{e?h.canvas.style.removeProperty("cursor"):h.canvas.style.setProperty("cursor","none")},1411211:()=>{wt["!canvas"]=h.canvas,wt["!parent"]=h.parent},1411309:()=>Atomics?.waitAsync?.toString().includes("[native code]"),1411378:e=>{var t=e?"fullscreenEnter":"fullscreenExit";return h[t]?(h[t](),1):0}},yc={Na:function(){h.canvas.addEventListener("webglcontextlost",(function(e){e.preventDefault(),Uc()})),h.canvas.addEventListener("webglcontextrestored",(function(){Nc()}))},lb:function(){var e=R?.userAgent?.toLowerCase?.();if(!e)return 0;var t=1+["chrom","firefox","safari"].findIndex((t=>e.includes(t))),i=1+[/windows/,/linux|cros|android/,/iphone|ipad/,/mac os/].findIndex((t=>t.test(e)));return t|i<<16},Pa:function(){U.memory&&be()},Qa:function(){R.getBattery&&R.getBattery().then((function(e){e.addEventListener("chargingchange",Ce),e.addEventListener("levelchange",Ce),Ce({target:e})}))},ub:function(e,t){Ie(e,t)},Cb:function(e){ye(e)},ab:function(t){if(fe.observer)return fe.observer.unobserve(h.canvas),void fe.observer.observe(h.canvas);fe.observer=new ResizeObserver((function(i){var n,o,r=i.find((e=>e.target==h.canvas));r&&(r.devicePixelContentBoxSize?(n=r.devicePixelContentBoxSize[0].inlineSize,o=r.devicePixelContentBoxSize[0].blockSize):(n=c.round(r.contentRect.width*e.devicePixelRatio),o=c.round(r.contentRect.height*e.devicePixelRatio)),fe.canvasWidth=n,fe.canvasHeight=o,z[t>>3]=e.devicePixelRatio,Vc(n,o,t))})),fe.observer.observe(h.canvas),e.addEventListener("resize",(function(){fe.observer.unobserve(h.canvas),fe.observer.observe(h.canvas)}),!1)},Oa:function(){n.addEventListener("fullscreenchange",(function(){Ec(!!n.fullscreenElement)}),!1)},Ra:function(){n.addEventListener("visibilitychange",(function(){wc("hidden"==n.visibilityState)}),!1)},x:(e,t,i,n)=>ne(`Assertion failed: ${Se(e)}, at: `+[t?Se(t):"unknown filename",i,n?Se(n):"unknown function"]),Za:function(e,t,i,n,o,r){try{var s=Xe(e),a=s.sock_ops.accept(s);return t&&Ye(t,a.family,ze.lookup_name(a.daddr),a.dport,i),a.stream.fd}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},Ya:function(e,t,i,n,o,r){try{var s=Xe(e),a=Oe(t,i);return s.sock_ops.bind(s,a.addr,a.port),0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},Xa:function(e,t,i,n,o,r){try{var s=Xe(e),a=Oe(t,i);return s.sock_ops.connect(s,a.addr,a.port),0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},j:function(e,t,i){$e.varargs=i;try{var n=$e.getStreamFromFD(e);switch(t){case 0:if((o=Pe())<0)return-28;for(;Le.streams[o];)o++;return Le.dupStream(n,o).fd;case 1:case 2:case 13:case 14:return 0;case 3:return n.flags;case 4:var o=Pe();return n.flags|=o,0;case 12:return o=qe(),Q[o+0>>1]=2,0}return-28}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},sb:function(e,t){t=et(t);try{return B(t)?61:(Le.ftruncate(e,t),0)}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},rb:function(e,t){try{if(0===t)return-28;var i=Le.cwd(),n=Ee(i)+1;return t<n?-68:(tt(i,e,t),n)}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},hb:function(e,t,i){try{var n=$e.getStreamFromFD(e);n.getdents||=Le.readdir(n.path);for(var o=280,r=0,s=Le.llseek(n,0,1),a=c.floor(s/o),l=c.min(n.getdents.length,a+c.floor(i/o)),d=a;d<l;d++){var u,g,h=n.getdents[d];if("."===h)u=n.node.id,g=4;else if(".."===h)u=Le.lookupPath(n.path,{parent:!0}).node.id,g=4;else{var p;try{p=Le.lookupNode(n.node,h)}catch(e){if(28===e?.errno)continue;throw e}u=p.id,g=Le.isChrdev(p.mode)?2:Le.isDir(p.mode)?4:Le.isLink(p.mode)?10:8}Y[t+r>>3]=BigInt(u),Y[t+r+8>>3]=BigInt((d+1)*o),Q[t+r+16>>1]=280,G[t+r+18]=g,tt(h,t+r+19,256),r+=o}return Le.llseek(n,d*o,0),r}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},Wa:function(e,t,i,n,o,r){try{var s=Xe(e);return Ye(t,s.family,ze.lookup_name(s.saddr||"0.0.0.0"),s.sport,i),0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},Va:function(e,t,i,n,o,r){try{var s=Xe(e);return 1===t&&4===i?(K[n>>2]=s.error,K[o>>2]=4,s.error=null,0):-50}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},tb:function(e,t,i){$e.varargs=i;try{var n=$e.getStreamFromFD(e);switch(t){case 21509:case 21510:case 21511:case 21512:case 21524:case 21515:return n.tty?0:-59;case 21505:if(!n.tty)return-59;if(n.tty.ops.ioctl_tcgets){var o=n.tty.ops.ioctl_tcgets(n),r=qe();K[r>>2]=o.c_iflag||0,K[r+4>>2]=o.c_oflag||0,K[r+8>>2]=o.c_cflag||0,K[r+12>>2]=o.c_lflag||0;for(var s=0;s<32;s++)G[r+s+17]=o.c_cc[s]||0;return 0}return 0;case 21506:case 21507:case 21508:if(!n.tty)return-59;if(n.tty.ops.ioctl_tcsets){r=qe();var a=K[r>>2],l=K[r+4>>2],c=K[r+8>>2],d=K[r+12>>2],u=[];for(s=0;s<32;s++)u.push(G[r+s+17]);return n.tty.ops.ioctl_tcsets(n.tty,t,{c_iflag:a,c_oflag:l,c_cflag:c,c_lflag:d,c_cc:u})}return 0;case 21519:return n.tty?(r=qe(),K[r>>2]=0,0):-59;case 21520:return n.tty?-28:-59;case 21531:return r=qe(),Le.ioctl(n,t,r);case 21523:if(!n.tty)return-59;if(n.tty.ops.ioctl_tiocgwinsz){var g=n.tty.ops.ioctl_tiocgwinsz(n.tty);r=qe(),Q[r>>1]=g[0],Q[r+2>>1]=g[1]}return 0;default:return-28}}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},Ua:function(e,t){try{var i=Xe(e);return i.sock_ops.listen(i,t),0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},nb:function(e,t,i){try{return t=$e.getStr(t),t=$e.calculateAt(e,t),Le.mkdir(t,i,0),0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},ia:function(e,t,i,n){$e.varargs=n;try{t=$e.getStr(t),t=$e.calculateAt(e,t);var o=n?Pe():0;return Le.open(t,i,o).fd}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},ib:function(e,t,i){try{for(var n=0,o=0;o<t;o++){var r=e+8*o,s=K[r>>2],a=Q[r+4>>1],l=32,c=Le.getStream(s);c&&(l=$e.DEFAULT_POLLMASK,c.stream_ops.poll&&(l=c.stream_ops.poll(c,-1))),(l&=24|a)&&n++,Q[r+6>>1]=l}return n}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},gb:function(e,t,i,n){try{if(t=$e.getStr(t),t=$e.calculateAt(e,t),n<=0)return-28;var o=Le.readlink(t),r=c.min(n,Ee(o)),s=G[i+r];return tt(o,i,n+1),G[i+r]=s,r}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},Ta:function(e,t,i,n,o,r){try{var s=Xe(e),a=s.sock_ops.recvmsg(s,i);return a?(o&&Ye(o,s.family,ze.lookup_name(a.addr),a.port,r),x.set(a.buffer,t),a.buffer.byteLength):0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},db:function(e,t,i,n){try{return t=$e.getStr(t),n=$e.getStr(n),t=$e.calculateAt(e,t),n=$e.calculateAt(i,n),Le.rename(t,n),0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},eb:function(e){try{return e=$e.getStr(e),Le.rmdir(e),0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},Sa:function(e,t,i,n,o,r){try{var s=Xe(e);if(!o)return Le.write(s.stream,G,t,i);var a=Oe(o,r);return s.sock_ops.sendmsg(s,G,t,i,a.addr,a.port)}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},ga:function(e,t,i){try{return Qe.createSocket(e,t,i).stream.fd}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},cb:function(e,t){try{return e=$e.getStr(e),$e.writeStat(t,Le.stat(e))}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},fb:function(e,t,i){try{return t=$e.getStr(t),t=$e.calculateAt(e,t),0===i?Le.unlink(t):512===i?Le.rmdir(t):ne("Invalid flags passed to unlinkat"),0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return-e.errno}},xb:()=>ne(""),_a:()=>{throw Infinity},jb:function(e,t){e=et(e);var i=new g(1e3*e);K[t>>2]=i.getSeconds(),K[t+4>>2]=i.getMinutes(),K[t+8>>2]=i.getHours(),K[t+12>>2]=i.getDate(),K[t+16>>2]=i.getMonth(),K[t+20>>2]=i.getFullYear()-1900,K[t+24>>2]=i.getDay();var n=0|ot(i);K[t+28>>2]=n,K[t+36>>2]=-60*i.getTimezoneOffset();var o=new g(i.getFullYear(),0,1),r=new g(i.getFullYear(),6,1).getTimezoneOffset(),s=o.getTimezoneOffset(),a=0|(r!=s&&i.getTimezoneOffset()==c.min(s,r));K[t+32>>2]=a},kb:function(e){var t=(()=>{var t=new g(K[e+20>>2]+1900,K[e+16>>2],K[e+12>>2],K[e+8>>2],K[e+4>>2],K[e>>2],0),i=K[e+32>>2],n=t.getTimezoneOffset(),o=new g(t.getFullYear(),0,1),r=new g(t.getFullYear(),6,1).getTimezoneOffset(),s=o.getTimezoneOffset(),a=c.min(s,r);if(i<0)K[e+32>>2]=d(r!=s&&a==n);else if(i>0!=(a==n)){var l=c.max(s,r),u=i>0?a:l;t.setTime(t.getTime()+6e4*(u-n))}K[e+24>>2]=t.getDay();var h=0|ot(t);K[e+28>>2]=h,K[e>>2]=t.getSeconds(),K[e+4>>2]=t.getMinutes(),K[e+8>>2]=t.getHours(),K[e+12>>2]=t.getDate(),K[e+16>>2]=t.getMonth(),K[e+20>>2]=t.getYear();var p=t.getTime();return B(p)?-1:p/1e3})();return BigInt(t)},mb:(e,t,i,n)=>{var o=(new g).getFullYear(),r=new g(o,0,1),s=new g(o,6,1),l=r.getTimezoneOffset(),u=s.getTimezoneOffset(),h=c.max(l,u);j[e>>2]=60*h,K[t>>2]=d(l!=u);var p=e=>{var t=e>=0?"-":"+",i=c.abs(e);return`UTC${t}${a(c.floor(i/60)).padStart(2,"0")}${a(i%60).padStart(2,"0")}`},m=p(l),f=p(u);u<l?(tt(m,i,17),tt(f,n,17)):(tt(m,n,17),tt(f,i,17))},Ha:(e,t,i,n,o)=>{if(ft.currentCtx){var r=ft.buffers[e];if(r)if(o<=0)ft.currentCtx.err=40963;else{var s=null;try{switch(t){case 4352:if(n>0)for(var a=(s=ft.currentCtx.audioCtx.createBuffer(1,n,o)).getChannelData(0),l=0;l<n;++l)a[l]=.0078125*x[i++]-1;r.bytesPerSample=1,r.channels=1,r.length=n;break;case 4353:if(n>0)for(a=(s=ft.currentCtx.audioCtx.createBuffer(1,n>>1,o)).getChannelData(0),i>>=1,l=0;l<n>>1;++l)a[l]=30517578125e-15*Q[i++];r.bytesPerSample=2,r.channels=1,r.length=n>>1;break;case 4354:if(n>0){a=(s=ft.currentCtx.audioCtx.createBuffer(2,n>>1,o)).getChannelData(0);var c=s.getChannelData(1);for(l=0;l<n>>1;++l)a[l]=.0078125*x[i++]-1,c[l]=.0078125*x[i++]-1}r.bytesPerSample=1,r.channels=2,r.length=n>>1;break;case 4355:if(n>0)for(a=(s=ft.currentCtx.audioCtx.createBuffer(2,n>>2,o)).getChannelData(0),c=s.getChannelData(1),i>>=1,l=0;l<n>>2;++l)a[l]=30517578125e-15*Q[i++],c[l]=30517578125e-15*Q[i++];r.bytesPerSample=2,r.channels=2,r.length=n>>2;break;case 65552:if(n>0)for(a=(s=ft.currentCtx.audioCtx.createBuffer(1,n>>2,o)).getChannelData(0),i>>=2,l=0;l<n>>2;++l)a[l]=D[i++];r.bytesPerSample=4,r.channels=1,r.length=n>>2;break;case 65553:if(n>0)for(a=(s=ft.currentCtx.audioCtx.createBuffer(2,n>>3,o)).getChannelData(0),c=s.getChannelData(1),i>>=2,l=0;l<n>>3;++l)a[l]=D[i++],c[l]=D[i++];r.bytesPerSample=4,r.channels=2,r.length=n>>3;break;default:return void(ft.currentCtx.err=40963)}r.frequency=o,r.audioBuf=s}catch(e){return void(ft.currentCtx.err=40963)}}else ft.currentCtx.err=40963}},Ca:(e,t)=>{if(ft.currentCtx){for(var i=0;i<e;++i)if(0!==(n=K[t+4*i>>2])){if(!ft.buffers[n])return void(ft.currentCtx.err=40961);if(ft.buffers[n].refCount)return void(ft.currentCtx.err=40964)}for(i=0;i<e;++i){var n;0!==(n=K[t+4*i>>2])&&(ft.deviceRefCounts[ft.buffers[n].deviceId]--,delete ft.buffers[n],ft.freeIds.push(n))}}},Da:(e,t)=>{if(ft.currentCtx){for(var i=0;i<e;++i){var n=K[t+4*i>>2];if(!ft.currentCtx.sources[n])return void(ft.currentCtx.err=40961)}for(i=0;i<e;++i)n=K[t+4*i>>2],ft.setSourceState(ft.currentCtx.sources[n],4116),bt(n,4105,0),delete ft.currentCtx.sources[n],ft.freeIds.push(n)}},Ia:(e,t)=>{if(ft.currentCtx)for(var i=0;i<e;++i){var n={deviceId:ft.currentCtx.deviceId,id:ft.newId(),refCount:0,audioBuf:null,frequency:0,bytesPerSample:2,channels:1,length:0};ft.deviceRefCounts[n.deviceId]++,ft.buffers[n.id]=n,K[t+4*i>>2]=n.id}},Ja:(e,t)=>{if(ft.currentCtx)for(var i=0;i<e;++i){var n=ft.currentCtx.audioCtx.createGain();n.connect(ft.currentCtx.gain);var o={context:ft.currentCtx,id:ft.newId(),type:4144,state:4113,bufQueue:[ft.buffers[0]],audioQueue:[],looping:!1,pitch:1,dopplerShift:1,gain:n,minGain:0,maxGain:1,panner:null,bufsProcessed:0,bufStartTime:d.NEGATIVE_INFINITY,bufOffset:0,relative:!1,refDistance:1,maxDistance:340282e33,rolloffFactor:1,position:[0,0,0],velocity:[0,0,0],direction:[0,0,0],coneOuterGain:0,coneInnerAngle:360,coneOuterAngle:360,distanceModel:53250,spatialize:2,get playbackRate(){return this.pitch*this.dopplerShift}};ft.currentCtx.sources[o.id]=o,K[t+4*i>>2]=o.id}},da:()=>{if(!ft.currentCtx)return 40964;var e=ft.currentCtx.err;return ft.currentCtx.err=0,e},O:(e,t,i)=>{var n=ft.getSourceParam("alGetSourcei",e,t);if(null!==n)if(i)switch(t){case 514:case 4097:case 4098:case 4103:case 4105:case 4112:case 4117:case 4118:case 4128:case 4129:case 4131:case 4132:case 4133:case 4134:case 4135:case 4628:case 8201:case 8202:case 53248:K[i>>2]=n;break;default:return void(ft.currentCtx.err=40962)}else ft.currentCtx.err=40963},Fa:e=>{if(ft.currentCtx){var t=ft.currentCtx.sources[e];t?ft.setSourceState(t,4114):ft.currentCtx.err=40961}},Ga:(e,t,i)=>{if(ft.currentCtx){var n=ft.currentCtx.sources[e];if(n)if(4136!==n.type){if(0!==t){var o=ft.buffers[0];for(var r of n.bufQueue)if(0!==r.id){o=r;break}for(var s=0;s<t;++s){var a=K[i+4*s>>2];if(!(r=ft.buffers[a]))return void(ft.currentCtx.err=40961);0===o.id||r.frequency===o.frequency&&r.bytesPerSample===o.bytesPerSample&&r.channels===o.channels||(ft.currentCtx.err=40964)}for(1===n.bufQueue.length&&0===n.bufQueue[0].id&&(n.bufQueue.length=0),n.type=4137,s=0;s<t;++s)a=K[i+4*s>>2],(r=ft.buffers[a]).refCount++,n.bufQueue.push(r);n.looping&&ft.cancelPendingSourceAudio(n),ft.initSourcePanner(n),ft.scheduleSourceAudio(n)}}else ft.currentCtx.err=40964;else ft.currentCtx.err=40961}},Ea:e=>{if(ft.currentCtx){var t=ft.currentCtx.sources[e];t?ft.setSourceState(t,4116):ft.currentCtx.err=40961}},ea:(e,t,i)=>{if(ft.currentCtx){var n=ft.currentCtx.sources[e];if(n){if(t>(1===n.bufQueue.length&&0===n.bufQueue[0].id?0:n.bufsProcessed))ft.currentCtx.err=40963;else if(0!==t){for(var o=0;o<t;o++){var r=n.bufQueue.shift();r.refCount--,K[i+4*o>>2]=r.id,n.bufsProcessed--}0===n.bufQueue.length&&n.bufQueue.push(ft.buffers[0]),ft.initSourcePanner(n),ft.scheduleSourceAudio(n)}}else ft.currentCtx.err=40961}},Aa:e=>!(e in ft.deviceRefCounts)||ft.deviceRefCounts[e]>0?0:(delete ft.deviceRefCounts[e],ft.freeIds.push(e),1),Ka:(t,i)=>{if(!(t in ft.deviceRefCounts))return ft.alcErr=40961,0;var o=null,r=[],s=null;if(i>>=2)for(var a=0,l=0;a=K[i++],r.push(a),0!==a;)switch(l=K[i++],r.push(l),a){case 4103:o||(o={}),o.sampleRate=l;break;case 4112:case 4113:break;case 6546:switch(l){case 0:s=!1;break;case 1:s=!0;break;case 2:break;default:return ft.alcErr=40964,0}break;case 6550:if(0!==l)return ft.alcErr=40964,0;break;default:return ft.alcErr=40964,0}var c=e.AudioContext||e.webkitAudioContext,d=null;try{d=o?new c(o):new c}catch(e){return"NotSupportedError"===e.name?ft.alcErr=40964:ft.alcErr=40961,0}((e,t)=>{t||(t=[n,n.getElementById("canvas")]),["keydown","mousedown","touchstart"].forEach((i=>{t.forEach((t=>{t&&((e,t,i)=>{e.addEventListener(t,i,{once:!0})})(t,i,(()=>{"suspended"===e.state&&e.resume()}))}))}))})(d),void 0===d.createGain&&(d.createGain=d.createGainNode);var u=d.createGain();u.connect(d.destination);var g={deviceId:t,id:ft.newId(),attrs:r,audioCtx:d,listener:{position:[0,0,0],velocity:[0,0,0],direction:[0,0,0],up:[0,0,0]},sources:[],interval:setInterval((()=>ft.scheduleContextAudio(g)),ft.QUEUE_INTERVAL),gain:u,distanceModel:53250,speedOfSound:343.3,dopplerFactor:1,sourceDistanceModel:!1,hrtf:s||!1,_err:0,get err(){return this._err},set err(e){0!==this._err&&0!==e||(this._err=e)}};if(ft.deviceRefCounts[t]++,ft.contexts[g.id]=g,null!==s)for(var h in ft.contexts){var p=ft.contexts[h];p.deviceId===t&&(p.hrtf=s,ft.updateContextGlobal(p))}return g.id},Ba:e=>{var t=ft.contexts[e];ft.currentCtx!==t?(ft.contexts[e].interval&&clearInterval(ft.contexts[e].interval),ft.deviceRefCounts[t.deviceId]--,delete ft.contexts[e],ft.freeIds.push(e)):ft.alcErr=40962},fa:e=>(ft.currentCtx=0===e?null:ft.contexts[e],1),La:e=>{if(e&&Se(e)!==ft.DEVICE_NAME)return 0;if("undefined"!=typeof AudioContext||"undefined"!=typeof webkitAudioContext){var t=ft.newId();return ft.deviceRefCounts[t]=0,t}return 0},wb:function(e,t,i){if(t=et(t),!((n=e)>=0&&n<=3))return 28;var n,o;o=0===e?Ct():st();var r=c.round(1e3*o*1e3);return Y[i>>3]=BigInt(r),0},X:(e,t,i)=>vt(e,t,i),Q:(e,t,i)=>((e,t,i)=>{var n=yt(t,i);return Ic[e](...n)})(e,t,i),Eg:(e,t,i)=>vt(e,t,i),rc:(e,t,i)=>{var n=()=>Hc(e,t);i>=0?Zt(n,i):(e=>{mt.requestAnimationFrame((()=>{pt(e)}))})(n)},_g:(e,t,i,n,o,r,s,a)=>{var l=Se(e),c=Se(t),d=Se(i),u=new XMLHttpRequest;u.open(c,l,!0),u.responseType="arraybuffer";var g=St.getNextWgetRequestHandle();function h(){if(s){var e=me(),t=0;u.statusText&&(t=Ut(u.statusText)),i=g,o=n,r=u.status,Xc(s,i,o,r,t),pe(e)}var i,o,r}return u.onload=e=>{if(u.status>=200&&u.status<300||0===u.status&&"http"!=l.slice(0,4).toLowerCase()){var t=new Uint8Array(u.response),i=Sc(t.length);x.set(t,i),r&&(s=g,a=n,c=i,d=t.length,Xc(r,s,a,c,d)),o&&Zc(i)}else h();var s,a,c,d;delete St.wgetRequests[g]},u.onerror=e=>{h(),delete St.wgetRequests[g]},u.onprogress=e=>{var t,i,o,r;a&&(t=g,i=n,o=e.loaded,r=e.lengthComputable||e.lengthComputable===W?e.total:0,Xc(a,t,i,o,r))},u.onabort=e=>{delete St.wgetRequests[g]},"POST"==c?(u.setRequestHeader("Content-type","application/x-www-form-urlencoded"),u.send(d)):u.send(null),St.wgetRequests[g]=u,g},vb:Ct,Nb:()=>{if(!Vt.fullscreenEnabled())return-1;Vt.removeDeferredCalls(Gt);var e=wt[1];if(e.exitFullscreen)e.fullscreenElement&&e.exitFullscreen();else{if(!e.webkitExitFullscreen)return-1;e.webkitFullscreenElement&&e.webkitExitFullscreen()}return 0},qd:()=>(Vt.removeDeferredCalls(xt),n.exitPointerLock?(n.exitPointerLock(),0):-1),sh:e=>{he=!1,at=0,dt(e)},bb:()=>2147483648,Fg:Kt,Dg:Dt,sd:Yt,Wg:zt,Zc:Ht,Cg:Jt,Bg:Ot,Wc:Pt,Xc:qt,Ag:ei,zg:ii,ac:ni,yg:ri,Tb:si,cd:li,Ng:di,xg:ui,wg:hi,vg:pi,ug:fi,tg:bi,gd:Ci,sg:yi,rg:vi,qg:Si,pg:wi,yc:Bi,zc:Ai,Bc:Ei,Ac:Ui,og:ki,ng:Mi,mg:Fi,jc:Ti,Jd:Ri,lg:Wi,kg:xi,ig:Li,xd:Qi,hg:Xi,wd:Ki,wc:ji,gg:Di,fg:Yi,yd:zi,eg:Ji,dg:Oi,cg:Pi,bg:$i,ag:tn,$f:on,ud:rn,Yg:sn,Zf:ln,cc:cn,Yf:un,kc:gn,Xf:pn,Sb:mn,bd:bn,Mg:In,Wf:yn,Vf:vn,Uf:Zn,Tf:Sn,Sf:wn,Rf:An,Qf:Un,oc:kn,Ig:Fn,Ab:Rn,Gd:Gn,Bb:Ln,nd:Kn,Ed:Dn,Jg:zn,Nf:Jn,nc:On,Hg:qn,yb:eo,zb:io,Fd:oo,Cd:ro,Mf:ao,Lf:co,rd:uo,Vg:go,Yc:ho,mc:po,Kf:mo,Jf:fo,If:Co,Hf:yo,dd:vo,Gf:Zo,Ff:Vo,Cf:Bo,vd:Ao,Zg:Eo,Bf:No,dc:ko,Af:Fo,Rb:To,ad:Wo,Lg:xo,Ef:Qo,zf:Ko,yf:jo,qc:Do,sc:Yo,uc:zo,xf:Ho,wf:_o,vf:$o,ec:er,uf:tr,tf:nr,rf:or,Lc:rr,qf:sr,fc:lr,hc:cr,_c:dr,pf:gr,Fb:hr,Mb:pr,nf:fr,of:Cr,Qg:yr,Sg:Zr,Og:Vr,od:wr,Rg:Ar,pd:Er,Tg:Ur,mf:Nr,Vb:kr,Wb:Mr,kf:Tr,jf:Rr,hf:Wr,lf:xr,ff:Xr,xc:Kr,gc:jr,ef:Dr,df:Yr,Uc:zr,tc:Hr,vc:Jr,af:qr,cf:ts,bf:is,Mc:ns,Sc:ss,Rc:ls,Ze:cs,$e:ds,_e:us,Ye:gs,Jb:hs,Ib:ps,We:ms,Ve:fs,Ue:bs,Te:Is,td:ys,Xg:vs,Se:Zs,bc:Ss,Re:Vs,lc:ws,Qe:Bs,Qb:As,$c:Us,Kg:ks,Pe:Ms,Oe:Ts,Pb:Rs,Ne:Gs,Id:xs,Le:Ls,Kd:Qs,Lb:Xs,Kb:Ks,Ug:js,Dd:Ds,Ke:_s,Je:Os,Ie:qs,ed:$s,Ob:ea,He:ta,Zb:ia,Xb:na,$b:oa,_b:ra,Ge:aa,Fe:la,Ee:da,De:ua,Ce:ga,Ae:ha,ze:pa,ye:ma,xe:fa,we:Ca,Ad:Ia,ve:ya,ue:va,te:Sa,se:Va,Hb:wa,Gb:Ba,re:Ea,zd:Ua,Vc:Na,pe:Ma,oe:Ra,ne:Ga,me:La,Kc:Qa,Gc:Xa,le:ja,ke:Ya,je:za,ie:Ha,Jc:Ja,Fc:_a,he:Pa,ge:$a,ee:el,de:tl,Ic:il,Ec:nl,ce:rl,be:al,ae:ll,$d:cl,Hc:dl,Dc:ul,pc:gl,_d:hl,md:pl,kd:ml,Zd:fl,ld:bl,id:Cl,Yd:yl,jd:vl,hd:Zl,Xd:Vl,Vd:wl,Ud:Bl,Td:Al,Sd:El,Rd:Ul,Qd:Nl,Pd:kl,Od:Ml,Nd:Fl,Ub:Rl,Gg:Wl,Db:Gl,Hd:xl,Eb:Ll,Qc:Ql,Oc:Xl,Pc:Kl,Nc:jl,Tc:Dl,Md:zl,Ld:Jl,ic:_l,fd:()=>Vt.removeAllEventListeners(),th:()=>mt.pause(),Yb:(e,t)=>((e,t)=>Vt.fullscreenEnabled()?(e=Bt(e))?e.requestFullscreen||e.webkitRequestFullscreen?Vt.canPerformEventHandlerRequests()?Gt(e,t):t.deferUntilInEventHandler?(Vt.deferCall(Gt,1,[e,t]),1):-2:-3:-4:-1)(e,{scaleMode:0,canvasResolutionScaleMode:0,filteringMode:0,deferUntilInEventHandler:t,canvasResizedCallbackTargetThread:2}),Bd:(e,t)=>(e=Bt(e))?e.requestPointerLock?Vt.canPerformEventHandlerRequests()?xt(e):t?(Vt.deferCall(xt,2,[e]),1):-2:-1:-4,$a:e=>{var t,i,n=x.length,o=2147483648;if((e>>>=0)>o)return!1;for(var r=1;r<=4;r*=2){var s=n*(1+.2/r);s=c.min(s,e+100663296);var a=c.min(o,(t=c.max(e,s),i=65536,c.ceil(t/i)*i));if(Ol(a))return!0}return!1},Pf:()=>mt.resume(),Cc:kt,ja:(e,t,i,n)=>Pl(2,e,t,i,17,"devicemotion"),jg:(e,t,i,n,o)=>ql(e,t,i,n,2,"keydown"),Of:(e,t,i,n,o)=>ql(e,t,i,n,1,"keypress"),_f:(e,t,i,n,o)=>ql(e,t,i,n,3,"keyup"),Ma:(e,t,i)=>{ht((()=>Qc(e)),t,i)},I:rt,Df:(e,t,i,n,o)=>ec(e,t,i,n,5,"mousedown"),gf:(e,t,i,n,o)=>ec(e,t,i,n,8,"mousemove"),sf:(e,t,i,n,o)=>ec(e,t,i,n,6,"mouseup"),Wd:(e,t,i,o,r)=>n&&n.body&&(n.body.requestPointerLock||n.body.mozRequestPointerLock||n.body.webkitRequestPointerLock||n.body.msRequestPointerLock)?(e=Bt(e))?(tc(e,t,i,o,20,"mozpointerlockchange"),tc(e,t,i,o,20,"webkitpointerlockchange"),tc(e,t,i,o,20,"mspointerlockchange"),tc(e,t,i,o,20,"pointerlockchange")):-4:-1,fe:(e,t,i,n,o)=>ic(e,t,i,n,25,"touchcancel"),Be:(e,t,i,n,o)=>ic(e,t,i,n,23,"touchend"),qe:(e,t,i,n,o)=>ic(e,t,i,n,24,"touchmove"),Me:(e,t,i,n,o)=>ic(e,t,i,n,22,"touchstart"),Xe:(e,t,i,n,o)=>(e=Bt(e))?void 0!==e.onwheel?((e,t,i,n,o,r)=>{Vt.wheelEvent||=Sc(96);var s={target:e,allowsDeferredCalls:!0,eventTypeString:r,callbackfunc:n,handlerFunc:(i=event)=>{var r=Vt.wheelEvent;$l(r,i,e),z[r+64>>3]=i.deltaX,z[r+72>>3]=i.deltaY,z[r+80>>3]=i.deltaZ,K[r+88>>2]=i.deltaMode,Yc(n,o,r,t)&&i.preventDefault()},useCapture:i};return Vt.registerOrRemoveHandler(s)})(e,t,i,n,9,"wheel"):-1:-4,P:nc,rh:sc,xa:e=>{Qt.currentContext==e&&(Qt.currentContext=0),Qt.deleteContext(e)},qh:(e,t,i)=>{var n=Qt.getContext(e);return n&&n.GLctx&&t&&i?(K[t>>2]=n.GLctx.drawingBufferWidth,K[i>>2]=n.GLctx.drawingBufferHeight,0):-5},wa:e=>Qt.makeContextCurrent(e)?0:-5,pb:(e,t)=>{var i=0,n=0;for(var o of lc()){var r=t+i;j[e+n>>2]=r,i+=tt(o,r,Infinity)+1,n+=4}return 0},qb:(e,t)=>{var i=lc();j[e>>2]=i.length;var n=0;for(var o of i)n+=Ee(o)+1;return j[t>>2]=n,0},$:dt,H:function(e){try{var t=$e.getStreamFromFD(e);return Le.close(t),0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return e.errno}},ha:function(e,t,i,n){try{var o=((e,t,i,n)=>{for(var o=0,r=0;r<i;r++){var s=j[t>>2],a=j[t+4>>2];t+=8;var l=Le.read(e,G,s,a,n);if(l<0)return-1;if(o+=l,l<a)break;void 0!==n&&(n+=l)}return o})($e.getStreamFromFD(e),t,i);return j[n>>2]=o,0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return e.errno}},ob:function(e,t,i,n){t=et(t);try{if(B(t))return 61;var o=$e.getStreamFromFD(e);return Le.llseek(o,t,i),Y[n>>3]=BigInt(o.position),o.getdents&&0===t&&0===i&&(o.getdents=null),0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return e.errno}},W:function(e,t,i,n){try{var o=((e,t,i,n)=>{for(var o=0,r=0;r<i;r++){var s=j[t>>2],a=j[t+4>>2];t+=8;var l=Le.write(e,G,s,a,n);if(l<0)return-1;if(o+=l,l<a)break;void 0!==n&&(n+=l)}return o})($e.getStreamFromFD(e),t,i);return j[n>>2]=o,0}catch(e){if(void 0===Le||"ErrnoError"!==e.name)throw e;return e.errno}},E:(e,t,i,n)=>{var o,r=0,s=0,a=0,l=0,c=0,d=0;function u(e,t,i,n,o,r){var s,a,l;return a=10===e?28:16,o=10===e?Je(o):He(o),s=Sc(a),O(!Ye(s,e,o,r)),l=Sc(32),K[l+4>>2]=e,K[l+8>>2]=t,K[l+12>>2]=i,j[l+24>>2]=n,j[l+20>>2]=s,K[l+16>>2]=10===e?28:16,K[l+28>>2]=0,l}if(i&&(a=K[i>>2],l=K[i+4>>2],c=K[i+8>>2],d=K[i+12>>2]),c&&!d&&(d=2===c?17:6),!c&&d&&(c=17===d?2:1),0===d&&(d=6),0===c&&(c=1),!e&&!t)return-2;if(-1088&a)return-1;if(0!==i&&2&K[i>>2]&&!e)return-1;if(32&a)return-2;if(0!==c&&1!==c&&2!==c)return-7;if(0!==l&&2!==l&&10!==l)return-6;if(t&&(t=Se(t),s=E(t,10),B(s)))return 1024&a?-2:-8;if(!e)return 0===l&&(l=2),1&a||(r=2===l?Rc(2130706433):[0,0,0,Rc(1)]),o=u(l,c,d,null,r,s),j[n>>2]=o,0;if(e=Se(e),null!==(r=Ke(e)))if(0===l||2===l)l=2;else{if(!(10===l&&8&a))return-2;r=[0,0,Rc(65535),r],l=10}else if(null!==(r=je(e))){if(0!==l&&10!==l)return-2;l=10}return null!=r?(o=u(l,c,d,e,r,s),j[n>>2]=o,0):4&a?-2:(e=ze.lookup_name(e),r=Ke(e),0===l?l=2:10===l&&(r=[0,0,Rc(65535),r]),o=u(l,c,d,null,r,s),j[n>>2]=o,0)},D:(e,t,i,n,o,r,s)=>{var a=_e(e,t);if(a.errno)return-6;var l=a.port,c=a.addr,d=!1;if(i&&n){var u;if(1&s||!(u=ze.lookup_addr(c))){if(8&s)return-2}else c=u;tt(c,i,n)+1>=n&&(d=!0)}return o&&r&&tt(l=""+l,o,r)+1>=r&&(d=!0),d?-12:0},F:Xt,ta:jt,na:_t,k:$t,L:ti,b:oi,G:gi,u:mi,eh:Ii,A:Zi,w:Vi,V:Ni,ah:Gi,jh:Hi,ua:_i,U:qi,t:en,pa:nn,_:an,ra:dn,f:hn,g:Vn,Y:Bn,n:En,v:so,dh:lo,R:bo,B:Io,va:So,T:wo,ya:Uo,p:Mo,M:Lo,oa:Jo,aa:ir,S:ur,gh:mr,sa:br,$g:Fr,ma:Gr,c:Qr,z:Pr,qa:Cs,ih:Fs,C:Ws,za:Js,Z:Ps,ca:sa,bh:ca,o:ba,d:Za,N:Aa,K:ka,mh:Ta,m:Wa,ph:Ka,i:Da,oh:Oa,lh:qa,nh:ol,kh:sl,fh:Il,y:Sl,ch:Yl,q:Hl,ka:function(e){var t=me();try{return Kc(e)}catch(e){if(pe(t),e!==e+0)throw e;Wc(1,0)}},h:function(e,t){var i=me();try{return jc(e,t)}catch(e){if(pe(i),e!==e+0)throw e;Wc(1,0)}},s:function(e,t,i){var n=me();try{return Oc(e,t,i)}catch(e){if(pe(n),e!==e+0)throw e;Wc(1,0)}},r:function(e,t,i,n){var o=me();try{return Yc(e,t,i,n)}catch(e){if(pe(o),e!==e+0)throw e;Wc(1,0)}},hh:function(e,t,i,n,o){var r=me();try{return _c(e,t,i,n,o)}catch(e){if(pe(r),e!==e+0)throw e;Wc(1,0)}},ba:function(e,t,i,n,o,r){var s=me();try{return zc(e,t,i,n,o,r)}catch(e){if(pe(s),e!==e+0)throw e;Wc(1,0)}},Pg:function(e,t,i,n,o,r,s){var a=me();try{return Pc(e,t,i,n,o,r,s)}catch(e){if(pe(a),e!==e+0)throw e;Wc(1,0)}},l:function(e){var t=me();try{Qc(e)}catch(e){if(pe(t),e!==e+0)throw e;Wc(1,0)}},e:function(e,t){var i=me();try{Hc(e,t)}catch(e){if(pe(i),e!==e+0)throw e;Wc(1,0)}},a:function(e,t,i){var n=me();try{Dc(e,t,i)}catch(e){if(pe(n),e!==e+0)throw e;Wc(1,0)}},J:function(e,t,i,n){var o=me();try{Jc(e,t,i,n)}catch(e){if(pe(o),e!==e+0)throw e;Wc(1,0)}},la:function(e,t,i,n,o){var r=me();try{Xc(e,t,i,n,o)}catch(e){if(pe(r),e!==e+0)throw e;Wc(1,0)}}},vc=await async function(){function e(e,t){return vc=e.exports,vc=dc.instrumentWasmExports(vc),F=vc.uh,P(),vc.wh,ie(),vc}te();var t={a:yc};if(h.instantiateWasm)return new Promise(((i,n)=>{h.instantiateWasm(t,((t,n)=>{i(e(t))}))}));q??=oe();try{var i=function(t){return e(t.instance)}(await se(M,q,t));return i}catch(e){return u(e),Promise.reject(e)}}(),Zc=(vc.vh,h._free=vc.xh),Sc=(h._cmd_take_screenshot=vc.yh,h._get_current_frame_count=vc.zh,h._save_file_path=vc.Ah,h._toggleMainLoop=vc.Bh,h._load_state=vc.Ch,h._system_restart=vc.Dh,h._get_disk_count=vc.Eh,h._set_current_disk=vc.Fh,h._get_current_disk=vc.Gh,h._toggle_fastforward=vc.Hh,h._set_ff_ratio=vc.Ih,h._toggle_slow_motion=vc.Jh,h._set_sm_ratio=vc.Kh,h._toggle_rewind=vc.Lh,h._set_rewind_granularity=vc.Mh,h._malloc=vc.Nh),Vc=(h._ejs_set_variable=vc.Oh,h._get_core_options=vc.Ph,h._set_video_rotation=vc.Qh,h._get_video_dimensions=vc.Rh,h._shader_enable=vc.Sh,h._save_state_info=vc.Th,h._supports_states=vc.Uh,h._refresh_save_files=vc.Vh,h._ejs_set_keyboard_enabled=vc.Wh,h._simulate_input=vc.Xh,h._cmd_savefiles=vc.Yh,h._cmd_save_state=vc.Zh,h._set_cheat=vc._h,h._reset_cheat=vc.$h,h._set_vsync=vc.ai,vc.bi),wc=vc.ci,Bc=vc.di,Ac=vc.ei,Ec=vc.fi,Uc=vc.gi,Nc=vc.hi,kc=vc.ii,Mc=h._main=vc.ji,Fc=vc.ki,Tc=vc.li,Rc=vc.mi,Wc=vc.ni,Gc=vc.oi,xc=vc.pi,Lc=vc.qi,Qc=h.dynCall_v=vc.ri,Xc=h.dynCall_viiii=vc.si,Kc=h.dynCall_i=vc.ti,jc=h.dynCall_ii=vc.ui,Dc=h.dynCall_vii=vc.vi,Yc=h.dynCall_iiii=vc.wi,zc=h.dynCall_iiiiii=vc.xi,Hc=h.dynCall_vi=vc.yi,Jc=h.dynCall_viii=vc.zi,_c=h.dynCall_iiiii=vc.Ai,Oc=h.dynCall_iii=vc.Bi,Pc=(h.dynCall_viiiii=vc.dynCall_viiiii,h.dynCall_iiiiiii=vc.Ci),qc=(h.dynCall_j=vc.dynCall_j,h.dynCall_fii=vc.dynCall_fii,h.dynCall_ji=vc.dynCall_ji,h.dynCall_jiji=vc.dynCall_jiji,h.dynCall_jiij=vc.dynCall_jiij,h.dynCall_jij=vc.dynCall_jij,h.dynCall_iijii=vc.dynCall_iijii,h.dynCall_iijijii=vc.dynCall_iijijii,h.dynCall_iiiiiiiiiii=vc.dynCall_iiiiiiiiiii,h.dynCall_fiii=vc.dynCall_fiii,h.dynCall_iiiiijiii=vc.dynCall_iiiiijiii,h.dynCall_fffff=vc.dynCall_fffff,h.dynCall_iif=vc.dynCall_iif,h.dynCall_viiiiii=vc.dynCall_viiiiii,h.dynCall_viiiiiiiii=vc.dynCall_viiiiiiiii,h.dynCall_iiiif=vc.dynCall_iiiif,h.dynCall_iidii=vc.dynCall_iidii,h.dynCall_iji=vc.dynCall_iji,h.dynCall_iiiiiiii=vc.dynCall_iiiiiiii,h.dynCall_viiiiiii=vc.dynCall_viiiiiii,h.dynCall_iiiiiiiii=vc.dynCall_iiiiiiiii,h.dynCall_viiiiiiii=vc.dynCall_viiiiiiii,h.dynCall_viiiiiiiiii=vc.dynCall_viiiiiiiiii,h.dynCall_iiifi=vc.dynCall_iiifi,h.dynCall_viiffff=vc.dynCall_viiffff,h.dynCall_viif=vc.dynCall_viif,h.dynCall_fi=vc.dynCall_fi,h.dynCall_viiiiif=vc.dynCall_viiiiif,h.dynCall_jiiii=vc.dynCall_jiiii,h.dynCall_vffff=vc.dynCall_vffff,h.dynCall_vf=vc.dynCall_vf,h.dynCall_vff=vc.dynCall_vff,h.dynCall_vfi=vc.dynCall_vfi,h.dynCall_vif=vc.dynCall_vif,h.dynCall_viff=vc.dynCall_viff,h.dynCall_vifff=vc.dynCall_vifff,h.dynCall_viffff=vc.dynCall_viffff,h.dynCall_vfff=vc.dynCall_vfff,h.dynCall_viiiiiiiiiii=vc.dynCall_viiiiiiiiiii,h.dynCall_viifi=vc.dynCall_viifi,h.dynCall_iidiiii=vc.dynCall_iidiiii,vc.Di),$c=vc.Ei,ed=vc.Fi,td=vc.Gi;function id(e=[]){var t=Mc;e.unshift(I);var i=e.length,n=Et(4*(i+1)),o=n;e.forEach((e=>{j[o>>2]=Ut(e),o+=4})),j[o>>2]=0;try{var r=t(i,n);return ct(r),r}catch(e){return ut(e)}}return function(){if(h.preInit)for("function"==typeof h.preInit&&(h.preInit=[h.preInit]);h.preInit.length>0;)h.preInit.shift()()}(),function e(t=C){function i(){h.calledRun=!0,_||(Qe.root=Le.mount(Qe,{},null),h.noFSInit||Le.initialized||Le.init(),ke.init(),vc.vh(),Le.ignorePermissions=!1,o(h),h.onRuntimeInitialized?.(),h.noInitialRun||id(t),function(){if(h.postRun)for("function"==typeof h.postRun&&(h.postRun=[h.postRun]);h.postRun.length;)de(h.postRun.shift());le(ce)}())}$>0?ee=e:(function(){if(h.preRun)for("function"==typeof h.preRun&&(h.preRun=[h.preRun]);h.preRun.length;)ge(h.preRun.shift());le(ue)}(),$>0?ee=e:h.setStatus?(h.setStatus("Running..."),setTimeout((()=>{setTimeout((()=>h.setStatus("")),1),i()}),1)):i())}(),p});"object"==typeof exports&&"object"==typeof module?(module.exports=Q,module.exports.default=Q):"function"==typeof define&&define.amd&&define([],(()=>Q))}).call(proxyWindow,window,self,globalThis,document,Document,Array,Object,String,Boolean,Math,Number,Symbol,Date,Function,Proxy,WeakMap,WeakSet,Set,Map,Reflect,Element,Node,RegExp,Error,TypeError,JSON,isNaN,parseFloat,parseInt,performance,console,decodeURI,encodeURI,decodeURIComponent,encodeURIComponent,navigator,undefined,location,history)}(window.__MICRO_APP_PROXY_WINDOW__);